<report_mosca>
 <Path>/src/bin/haxelibshim.js</Path>
 <Module>/app/Mosca/eggs/javascript_common_fail.egg</Module>
 <Title> Possible code injection</Title>
 <Description> Command injection is an attack in which the goal is execution of arbitrary commands on the host operating system via a vulnerable application.</Description>
 <Level> High</Level>
 <Reference> https://www.securecoding.cert.org/confluence/pages/viewpage.action?pageId=2130132 </Reference>
 <Match> eval\s?\(|setTimeout|setInterval</Match>
 <Result> Line: 16 -  wd()}catch(e){}var o=process.chdir;process.chdir=function(e){s=null;o.call(process,e)};e.exports=patch;function patch(e){if(i.hasOwnProperty("O_SYMLINK")&&process.version.match(/^v0\.6\.[0-2]|^v0\.5\./)){patchLchmod(e)}if(!e.lutimes){patchLutimes(e)}e.chown=chownFix(e.chown);e.fchown=chownFix(e.fchown);e.lchown=chownFix(e.lchown);e.chmod=chmodFix(e.chmod);e.fchmod=chmodFix(e.fchmod);e.lchmod=chmodFix(e.lchmod);e.chownSync=chownFixSync(e.chownSync);e.fchownSync=chownFixSync(e.fchownSync);e.lchownSync=chownFixSync(e.lchownSync);e.chmodSync=chmodFixSync(e.chmodSync);e.fchmodSync=chmodFixSync(e.fchmodSync);e.lchmodSync=chmodFixSync(e.lchmodSync);e.stat=statFix(e.stat);e.fstat=statFix(e.fstat);e.lstat=statFix(e.lstat);e.statSync=statFixSync(e.statSync);e.fstatSync=statFixSync(e.fstatSync);e.lstatSync=statFixSync(e.lstatSync);if(!e.lchmod){e.lchmod=function(e,t,n){if(n)process.nextTick(n)};e.lchmodSync=function(){}}if(!e.lchown){e.lchown=function(e,t,n,i){if(i)process.nextTick(i)};e.lchownSync=function(){}}if(a==="win32"){e.rename=function(t){return function(n,i,r){var s=Date.now();var a=0;t(n,i,function CB(o){if(o&&(o.code==="EACCES"||o.code==="EPERM")&&Date.now()-s<6e4){setTimeout(function(){e.stat(i,function(e,s){if(e&&e.code==="ENOENT")t(n,i,CB);else r(o)})},a);if(a<100)a+=10;return}if(r)r(o)})}}(e.rename)}e.read=function(t){function read(n,i,r,s,a,o){var l;if(o&&typeof o==="function"){var u=0;l=function(c,h,f){if(c&&c.code==="EAGAIN"&&u<10){u++;return t.call(e,n,i,r,s,a,l)}o.apply(this,arguments)}}return t.call(e,n,i,r,s,a,l)}read.__proto__=t;return read}(e.read);e.readSync=function(t){return function(n,i,r,s,a){var o=0;while(true){try{return t.call(e,n,i,r,s,a)}catch(e){if(e.code==="EAGAIN"&&o<10){o++;continue}throw e}}}}(e.readSync);function patchLchmod(e){e.lchmod=function(t,n,r){e.open(t,i.O_WRONLY|i.O_SYMLINK,n,function(t,i){if(t){if(r)r(t);return}e.fchmod(i,n,function(t){e.close(i,function(e){if(r)r(t||e)})})})};e.lchmodSync=function(t,n){var r=e.openSync(t,i.O_WRONLY|i.O_SYMLINK,n);var s=true;var a;try{a=e.fchmodSync(r,n);s=false}finally{if(s){try{e.closeSync(r)}catch(e) Line: 37 -   i="";n-=e.length;while(i.length<n)i+=t==null?"null":""+t;i+=e==null?"null":""+e;return i};y.replace=function(e,t,n){return e.split(t).join(n)};var g=function(){};g.__name__=true;g.prototype={writeByte:function(e){throw new ie("Not implemented")},writeBytes:function(e,t,n){if(t<0||n<0||t+n>e.length){throw new ie(B.OutsideBounds)}var i=e.b;var r=n;while(r>0){this.writeByte(i[t]);++t;--r}return n},writeFullBytes:function(e,t,n){while(n>0){var i=this.writeBytes(e,t,n);t+=i;n-=i}},writeString:function(e,t){var n=C.ofString(e,t);this.writeFullBytes(n,0,n.length)},__class__:g};var b=function(e){this.fd=e};b.__name__=true;b.__super__=g;b.prototype=$extend(g.prototype,{writeByte:function(e){K.writeSync(this.fd,String.fromCodePoint(e))},writeBytes:function(e,t,n){var i=e.b;return K.writeSync(this.fd,ue.from(i.buffer,i.byteOffset,e.length),t,n)},writeString:function(e,t){K.writeSync(this.fd,e)},__class__:b});var S=function(){};S.__name__=true;S.enumParameters=function(e){var t=i[e.__enum__];var n=t.__constructs__[e._hx_index];var r=t[n].__params__;if(r!=null){var s=[];var a=0;while(a<r.length){var o=r[a];++a;s.push(e[o])}return s}else{return[]}};var x=i["haxe.StackItem"]={__ename__:true,__constructs__:["CFunction","Module","FilePos","Method","LocalFunction"],CFunction:{_hx_index:0,__enum__:"haxe.StackItem",toString:t},Module:(r=function(e){return{_hx_index:1,m:e,__enum__:"haxe.StackItem",toString:t}},r.__params__=["m"],r),FilePos:(r=function(e,n,i,r){return{_hx_index:2,s:e,file:n,line:i,column:r,__enum__:"haxe.StackItem",toString:t}},r.__params__=["s","file","line","column"],r),Method:(r=function(e,n){return{_hx_index:3,classname:e,method:n,__enum__:"haxe.StackItem",toString:t}},r.__params__=["classname","method"],r),LocalFunction:(r=function(e){return{_hx_index:4,v:e,__enum__:"haxe.StackItem",toString:t}},r.__params__=["v"],r)};var E=function(){};E.__name__=true;E.__isInterface__=true;var R=function(e){var t=this;this.id=setInterval(function(){t.run()},e)};R.__name__=true;R.delay=function(e,t){var n=new R(t);n.run=function(){n.stop();e()};return n};R.prototype={stop:function(){if(this. Line: 56 -  in("   ");h(n)}}};i.on("data",function(e){a+=e.length;m()});var v=0;t(n,i,{onProgress:function(e,t,n){o=e;l=t;if(n){var i=a/s;var r=o/l;var u=i*r;if(u<v){u=v}v=u;o=Math.round(u*1e3);l=1e3}m()},done:function(t){e.success("-> Done!");r(t)}})}};we.download=function(e,t){return Ue.async(function(n){var i=le.parse(e);i.agent=false;if(i.headers==null){i.headers={}}i.headers["user-agent"]=we.USER_AGENT;var r=function(t){var i=$.Failure(Te.withData(null,"Failed to download "+e+" because "+t.message,t,{fileName:"src/lix/client/Download.hx",lineNumber:293,className:"lix.client.Download",methodName:"download"}));n(i)};var s=y.startsWith(e,"https:")?ae.get(i):se.get(i);s.setTimeout(3e4);s.on("error",r);s.on("response",function(s){if(s.statusCode>=400){var a=$.Failure(Te.withData(s.statusCode,s.statusMessage,s,{fileName:"src/lix/client/Download.hx",lineNumber:304,className:"lix.client.Download",methodName:"download"}));n(a)}else{var o=s.headers["location"];if(o==null){s.on("error",r);t(e,s,function(e){switch(e._hx_index){case 0:var t=e.data;n($.Success(t));break;case 1:var i=e.failure;n($.Failure(i));break}})}else{var l=o;var u=le.parse(l);var c=u.slashes;var h=u.search;var f=u.query;var d=u.port;var m=u.pathname;var v=u.path;var p=u.href;var w=u.hostname;var y=u.host;var g=u.hash;var b=u.auth;we.download(u.protocol==null?i.protocol+"//"+i.host+l:l,t).handle(n)}}})})};var ye={};ye.__name__=true;ye.get_isPrerelease=function(e){return e.indexOf("-")!=-1};ye.isNumber=function(e){return new d("^[0-9]*$","").match(e)};ye.fragment=function(e,t){if(ye.isNumber(e)&&ye.isNumber(t)){return c.parseInt(e)-c.parseInt(t)}else{return l.compare(e,t)}};ye.compare=function(e,t){var n=e.split("-");var i=t.split("-");var r=0;while(r<n.length&&r<i.length){var s=n[r].split(".");var a=i[r++].split(".");var o=0;while(o<s.length&&o<a.length){var l=ye.fragment(s[o],a[o]);if(l==0){++o}else{var u=l;return-u}}var c=s.length-a.length;if(c!=0){var h=c;return-h}}return(n.length-i.length)*(r==1?1:-1)};var ge=i["lix.client.haxe.ResolvedUserVersionData"]={__ename__:true,__constructs__:["RNightly","ROfficial","RCustom"],RNig</Result>
</report_mosca>

<report_mosca>
 <Path>/src/bin/haxelibshim.js</Path>
 <Module>/app/Mosca/eggs/javascript_common_fail.egg</Module>
 <Title> Possible SQL injection</Title>
 <Description> notification possible SQL injection</Description>
 <Level> High</Level>
 <Reference> https://www.owasp.org/index.php/Testing_for_Stack_Overflow </Reference>
 <Match> query|YQL|WHERE|FROM|SELECT|UPDATE|DELETE|INSERT|UNION|getResults</Match>
 <Result> Line: 3 -  turn a.unlink(e,t);const n=e+".DELETE."+F.randomBytes(16).toString("hex");a.rename(e,n,e=>{if(e)return t(e);a.unlink(n,t)})};const P=e=>{if(process.platform!=="win32")return a.unlinkSync(e);const t=e+".DELETE."+F.randomBytes(16).toString("hex");a.renameSync(e,t);a.unlinkSync(t)};const H=(e,t,n)=>e===e>>>0?e:t===t>>>0?t:n;class Unpack extends s{constructor(e){if(!e)e={};e.ondone=(e=>{this[C]=true;this[A]()});super(e);this.reservations=f();this.transform=typeof e.transform==="function"?e.transform:null;this.writable=true;this.readable=false;this[I]=0;this[C]=false;this.dirCache=e.dirCache||new Map;if(typeof e.uid==="number"||typeof e.gid==="number"){if(typeof e.uid!=="number"||typeof e.gid!=="number")throw new TypeError("cannot set owner without number uid and gid");if(e.preserveOwner)throw new TypeError("cannot preserve owner in archive and also set owner explicitly");this.uid=e.uid;this.gid=e.gid;this.setOwner=true}else{this.uid=null;this.gid=null;this.setOwner=false}if(e.preserveOwner===undefined&&typeof e.uid!=="number")this.preserveOwner=process.getuid&&process.getuid()===0;else this.preserveOwner=!!e.preserveOwner;this.processUid=(this.preserveOwner||this.setOwner)&&process.getuid?process.getuid():null;this.processGid=(this.preserveOwner||this.setOwner)&&process.getgid?process.getgid():null;this.forceChown=e.forceChown===true;this.win32=!!e.win32||process.platform==="win32";this.newer=!!e.newer;this.keep=!!e.keep;this.noMtime=!!e.noMtime;this.preservePaths=!!e.preservePaths;this.unlink=!!e.unlink;this.cwd=l.resolve(e.cwd||process.cwd());this.strip=+e.strip||0;this.processUmask=process.umask();this.umask=typeof e.umask==="number"?e.umask:this.processUmask;this.dmode=e.dmode||511&~this.umask;this.fmode=e.fmode||438&~this.umask;this.on("entry",e=>this[d](e))}warn(e,t,n={}){if(e==="TAR_BAD_ARCHIVE"||e==="TAR_ABORT")n.recoverable=false;return super.warn(e,t,n)}[A](){if(this[C]&&this[I]===0){this.emit("prefinish");this.emit("finish");this.emit("end");this.emit("close")}}[_](e){if(this.strip){const t=e.path.split(/\/|\\/);if(t.length<this.strip)return false;e.path=t.slice(this.str</Result>
</report_mosca>

<report_mosca>
 <Path>/src/bin/haxeshim.js</Path>
 <Module>/app/Mosca/eggs/javascript_common_fail.egg</Module>
 <Title> Possible code injection</Title>
 <Description> Command injection is an attack in which the goal is execution of arbitrary commands on the host operating system via a vulnerable application.</Description>
 <Level> High</Level>
 <Reference> https://www.securecoding.cert.org/confluence/pages/viewpage.action?pageId=2130132 </Reference>
 <Match> eval\s?\(|setTimeout|setInterval</Match>
 <Result> Line: 16 -  wd()}catch(t){}var l=process.chdir;process.chdir=function(t){s=null;l.call(process,t)};t.exports=patch;function patch(t){if(i.hasOwnProperty("O_SYMLINK")&&process.version.match(/^v0\.6\.[0-2]|^v0\.5\./)){patchLchmod(t)}if(!t.lutimes){patchLutimes(t)}t.chown=chownFix(t.chown);t.fchown=chownFix(t.fchown);t.lchown=chownFix(t.lchown);t.chmod=chmodFix(t.chmod);t.fchmod=chmodFix(t.fchmod);t.lchmod=chmodFix(t.lchmod);t.chownSync=chownFixSync(t.chownSync);t.fchownSync=chownFixSync(t.fchownSync);t.lchownSync=chownFixSync(t.lchownSync);t.chmodSync=chmodFixSync(t.chmodSync);t.fchmodSync=chmodFixSync(t.fchmodSync);t.lchmodSync=chmodFixSync(t.lchmodSync);t.stat=statFix(t.stat);t.fstat=statFix(t.fstat);t.lstat=statFix(t.lstat);t.statSync=statFixSync(t.statSync);t.fstatSync=statFixSync(t.fstatSync);t.lstatSync=statFixSync(t.lstatSync);if(!t.lchmod){t.lchmod=function(t,e,n){if(n)process.nextTick(n)};t.lchmodSync=function(){}}if(!t.lchown){t.lchown=function(t,e,n,i){if(i)process.nextTick(i)};t.lchownSync=function(){}}if(o==="win32"){t.rename=function(e){return function(n,i,r){var s=Date.now();var o=0;e(n,i,function CB(l){if(l&&(l.code==="EACCES"||l.code==="EPERM")&&Date.now()-s<6e4){setTimeout(function(){t.stat(i,function(t,s){if(t&&t.code==="ENOENT")e(n,i,CB);else r(l)})},o);if(o<100)o+=10;return}if(r)r(l)})}}(t.rename)}t.read=function(e){function read(n,i,r,s,o,l){var u;if(l&&typeof l==="function"){var a=0;u=function(f,c,h){if(f&&f.code==="EAGAIN"&&a<10){a++;return e.call(t,n,i,r,s,o,u)}l.apply(this,arguments)}}return e.call(t,n,i,r,s,o,u)}read.__proto__=e;return read}(t.read);t.readSync=function(e){return function(n,i,r,s,o){var l=0;while(true){try{return e.call(t,n,i,r,s,o)}catch(t){if(t.code==="EAGAIN"&&l<10){l++;continue}throw t}}}}(t.readSync);function patchLchmod(t){t.lchmod=function(e,n,r){t.open(e,i.O_WRONLY|i.O_SYMLINK,n,function(e,i){if(e){if(r)r(e);return}t.fchmod(i,n,function(e){t.close(i,function(t){if(r)r(e||t)})})})};t.lchmodSync=function(e,n){var r=t.openSync(e,i.O_WRONLY|i.O_SYMLINK,n);var s=true;var o;try{o=t.fchmodSync(r,n);s=false}finally{if(s){try{t.closeSync(r)}catch(t) Line: 32 -  ength){var l=r[o];++o;s.push(t[l])}return s}else{return[]}};var S=i["haxe.StackItem"]={__ename__:true,__constructs__:["CFunction","Module","FilePos","Method","LocalFunction"],CFunction:{_hx_index:0,__enum__:"haxe.StackItem",toString:e},Module:(r=function(t){return{_hx_index:1,m:t,__enum__:"haxe.StackItem",toString:e}},r.__params__=["m"],r),FilePos:(r=function(t,n,i,r){return{_hx_index:2,s:t,file:n,line:i,column:r,__enum__:"haxe.StackItem",toString:e}},r.__params__=["s","file","line","column"],r),Method:(r=function(t,n){return{_hx_index:3,classname:t,method:n,__enum__:"haxe.StackItem",toString:e}},r.__params__=["classname","method"],r),LocalFunction:(r=function(t){return{_hx_index:4,v:t,__enum__:"haxe.StackItem",toString:e}},r.__params__=["v"],r)};var R=function(){};R.__name__=true;R.__isInterface__=true;var O=function(t){var e=this;this.id=setInterval(function(){e.run()},t)};O.__name__=true;O.delay=function(t,e){var n=new O(e);n.run=function(){n.stop();t()};return n};O.prototype={stop:function(){if(this.id==null){return}clearInterval(this.id);this.id=null},run:function(){},__class__:O};var N=function(){};N.__name__=true;N.__interfaces__=[R];N.prototype={set:function(t,e){this.root=this.setLoop(t,e,this.root)},get:function(t){var e=this.root;while(e!=null){var n=this.compare(t,e.key);if(n==0){return e.value}if(n<0){e=e.left}else{e=e.right}}return null},setLoop:function(t,e,n){if(n==null){return new I(null,t,e,null)}var i=this.compare(t,n.key);if(i==0){return new I(n.left,t,e,n.right,n==null?0:n._height)}else if(i<0){var r=this.setLoop(t,e,n.left);return this.balance(r,n.key,n.value,n.right)}else{var s=this.setLoop(t,e,n.right);return this.balance(n.left,n.key,n.value,s)}},balance:function(t,e,n,i){var r=t==null?0:t._height;var s=i==null?0:i._height;if(r>s+2){var o=t.left;var l=t.right;if((o==null?0:o._height)>=(l==null?0:l._height)){return new I(t.left,t.key,t.value,new I(t.right,e,n,i))}else{return new I(new I(t.left,t.key,t.value,t.right.left),t.right.key,t.right.value,new I(t.right.right,e,n,i))}}else if(s>r+2){var u=i.right;var a=i.left;if((u==null?0:u._height)>(a==null?0:a Line: 55 -  +e.join("   ");c(n)}}};i.on("data",function(t){o+=t.length;v()});var w=0;e(n,i,{onProgress:function(t,e,n){l=t;u=e;if(n){var i=o/s;var r=l/u;var a=i*r;if(a<w){a=w}w=a;l=Math.round(a*1e3);u=1e3}v()},done:function(e){t.success("-> Done!");r(e)}})}};yt.download=function(t,e){return Gt.async(function(n){var i=ct.parse(t);i.agent=false;if(i.headers==null){i.headers={}}i.headers["user-agent"]=yt.USER_AGENT;var r=function(e){var i=et.Failure(Ut.withData(null,"Failed to download "+t+" because "+e.message,e,{fileName:"src/lix/client/Download.hx",lineNumber:293,className:"lix.client.Download",methodName:"download"}));n(i)};var s=p.startsWith(t,"https:")?ut.get(i):lt.get(i);s.setTimeout(3e4);s.on("error",r);s.on("response",function(s){if(s.statusCode>=400){var o=et.Failure(Ut.withData(s.statusCode,s.statusMessage,s,{fileName:"src/lix/client/Download.hx",lineNumber:304,className:"lix.client.Download",methodName:"download"}));n(o)}else{var l=s.headers["location"];if(l==null){s.on("error",r);e(t,s,function(t){switch(t._hx_index){case 0:var e=t.data;n(et.Success(e));break;case 1:var i=t.failure;n(et.Failure(i));break}})}else{var u=l;var a=ct.parse(u);var f=a.slashes;var c=a.search;var h=a.query;var d=a.port;var v=a.pathname;var w=a.path;var p=a.href;var m=a.hostname;var y=a.host;var b=a.hash;var S=a.auth;yt.download(a.protocol==null?i.protocol+"//"+i.host+u:u,e).handle(n)}}})})};var bt={};bt.__name__=true;bt.get_isPrerelease=function(t){return t.indexOf("-")!=-1};bt.isNumber=function(t){return new d("^[0-9]*$","").match(t)};bt.fragment=function(t,e){if(bt.isNumber(t)&&bt.isNumber(e)){return f.parseInt(t)-f.parseInt(e)}else{return u.compare(t,e)}};bt.compare=function(t,e){var n=t.split("-");var i=e.split("-");var r=0;while(r<n.length&&r<i.length){var s=n[r].split(".");var o=i[r++].split(".");var l=0;while(l<s.length&&l<o.length){var u=bt.fragment(s[l],o[l]);if(u==0){++l}else{var a=u;return-a}}var f=s.length-o.length;if(f!=0){var c=f;return-c}}return(n.length-i.length)*(r==1?1:-1)};var St=i["lix.client.haxe.ResolvedUserVersionData"]={__ename__:true,__constructs__:["RNightly","ROfficial","RCust</Result>
</report_mosca>

<report_mosca>
 <Path>/src/bin/haxeshim.js</Path>
 <Module>/app/Mosca/eggs/javascript_common_fail.egg</Module>
 <Title> Possible SQL injection</Title>
 <Description> notification possible SQL injection</Description>
 <Level> High</Level>
 <Reference> https://www.owasp.org/index.php/Testing_for_Stack_Overflow </Reference>
 <Match> query|YQL|WHERE|FROM|SELECT|UPDATE|DELETE|INSERT|UNION|getResults</Match>
 <Result> Line: 3 -  turn o.unlink(t,e);const n=t+".DELETE."+P.randomBytes(16).toString("hex");o.rename(t,n,t=>{if(t)return e(t);o.unlink(n,e)})};const Z=t=>{if(process.platform!=="win32")return o.unlinkSync(t);const e=t+".DELETE."+P.randomBytes(16).toString("hex");o.renameSync(t,e);o.unlinkSync(e)};const V=(t,e,n)=>t===t>>>0?t:e===e>>>0?e:n;class Unpack extends s{constructor(t){if(!t)t={};t.ondone=(t=>{this[T]=true;this[E]()});super(t);this.reservations=h();this.transform=typeof t.transform==="function"?t.transform:null;this.writable=true;this.readable=false;this[C]=0;this[T]=false;this.dirCache=t.dirCache||new Map;if(typeof t.uid==="number"||typeof t.gid==="number"){if(typeof t.uid!=="number"||typeof t.gid!=="number")throw new TypeError("cannot set owner without number uid and gid");if(t.preserveOwner)throw new TypeError("cannot preserve owner in archive and also set owner explicitly");this.uid=t.uid;this.gid=t.gid;this.setOwner=true}else{this.uid=null;this.gid=null;this.setOwner=false}if(t.preserveOwner===undefined&&typeof t.uid!=="number")this.preserveOwner=process.getuid&&process.getuid()===0;else this.preserveOwner=!!t.preserveOwner;this.processUid=(this.preserveOwner||this.setOwner)&&process.getuid?process.getuid():null;this.processGid=(this.preserveOwner||this.setOwner)&&process.getgid?process.getgid():null;this.forceChown=t.forceChown===true;this.win32=!!t.win32||process.platform==="win32";this.newer=!!t.newer;this.keep=!!t.keep;this.noMtime=!!t.noMtime;this.preservePaths=!!t.preservePaths;this.unlink=!!t.unlink;this.cwd=u.resolve(t.cwd||process.cwd());this.strip=+t.strip||0;this.processUmask=process.umask();this.umask=typeof t.umask==="number"?t.umask:this.processUmask;this.dmode=t.dmode||511&~this.umask;this.fmode=t.fmode||438&~this.umask;this.on("entry",t=>this[d](t))}warn(t,e,n={}){if(t==="TAR_BAD_ARCHIVE"||t==="TAR_ABORT")n.recoverable=false;return super.warn(t,e,n)}[E](){if(this[T]&&this[C]===0){this.emit("prefinish");this.emit("finish");this.emit("end");this.emit("close")}}[D](t){if(this.strip){const e=t.path.split(/\/|\\/);if(e.length<this.strip)return false;t.path=e.slice(this.str</Result>
</report_mosca>

<report_mosca>
 <Path>/src/bin/nekoshim.js</Path>
 <Module>/app/Mosca/eggs/javascript_common_fail.egg</Module>
 <Title> Possible code injection</Title>
 <Description> Command injection is an attack in which the goal is execution of arbitrary commands on the host operating system via a vulnerable application.</Description>
 <Level> High</Level>
 <Reference> https://www.securecoding.cert.org/confluence/pages/viewpage.action?pageId=2130132 </Reference>
 <Match> eval\s?\(|setTimeout|setInterval</Match>
 <Result> Line: 16 -  wd()}catch(e){}var a=process.chdir;process.chdir=function(e){s=null;a.call(process,e)};e.exports=patch;function patch(e){if(n.hasOwnProperty("O_SYMLINK")&&process.version.match(/^v0\.6\.[0-2]|^v0\.5\./)){patchLchmod(e)}if(!e.lutimes){patchLutimes(e)}e.chown=chownFix(e.chown);e.fchown=chownFix(e.fchown);e.lchown=chownFix(e.lchown);e.chmod=chmodFix(e.chmod);e.fchmod=chmodFix(e.fchmod);e.lchmod=chmodFix(e.lchmod);e.chownSync=chownFixSync(e.chownSync);e.fchownSync=chownFixSync(e.fchownSync);e.lchownSync=chownFixSync(e.lchownSync);e.chmodSync=chmodFixSync(e.chmodSync);e.fchmodSync=chmodFixSync(e.fchmodSync);e.lchmodSync=chmodFixSync(e.lchmodSync);e.stat=statFix(e.stat);e.fstat=statFix(e.fstat);e.lstat=statFix(e.lstat);e.statSync=statFixSync(e.statSync);e.fstatSync=statFixSync(e.fstatSync);e.lstatSync=statFixSync(e.lstatSync);if(!e.lchmod){e.lchmod=function(e,t,i){if(i)process.nextTick(i)};e.lchmodSync=function(){}}if(!e.lchown){e.lchown=function(e,t,i,n){if(n)process.nextTick(n)};e.lchownSync=function(){}}if(o==="win32"){e.rename=function(t){return function(i,n,r){var s=Date.now();var o=0;t(i,n,function CB(a){if(a&&(a.code==="EACCES"||a.code==="EPERM")&&Date.now()-s<6e4){setTimeout(function(){e.stat(n,function(e,s){if(e&&e.code==="ENOENT")t(i,n,CB);else r(a)})},o);if(o<100)o+=10;return}if(r)r(a)})}}(e.rename)}e.read=function(t){function read(i,n,r,s,o,a){var l;if(a&&typeof a==="function"){var u=0;l=function(c,h,f){if(c&&c.code==="EAGAIN"&&u<10){u++;return t.call(e,i,n,r,s,o,l)}a.apply(this,arguments)}}return t.call(e,i,n,r,s,o,l)}read.__proto__=t;return read}(e.read);e.readSync=function(t){return function(i,n,r,s,o){var a=0;while(true){try{return t.call(e,i,n,r,s,o)}catch(e){if(e.code==="EAGAIN"&&a<10){a++;continue}throw e}}}}(e.readSync);function patchLchmod(e){e.lchmod=function(t,i,r){e.open(t,n.O_WRONLY|n.O_SYMLINK,i,function(t,n){if(t){if(r)r(t);return}e.fchmod(n,i,function(t){e.close(n,function(e){if(r)r(t||e)})})})};e.lchmodSync=function(t,i){var r=e.openSync(t,n.O_WRONLY|n.O_SYMLINK,i);var s=true;var o;try{o=e.fchmodSync(r,i);s=false}finally{if(s){try{e.closeSync(r)}catch(e) Line: 58 -  replace=function(e,t,i){return e.split(t).join(i)};var m=function(){};m.__name__=true;m.prototype={writeByte:function(e){throw new H("Not implemented")},writeBytes:function(e,t,i){if(t<0||i<0||t+i>e.length){throw new H(L.OutsideBounds)}var n=e.b;var r=i;while(r>0){this.writeByte(n[t]);++t;--r}return i},writeFullBytes:function(e,t,i){while(i>0){var n=this.writeBytes(e,t,i);t+=n;i-=n}},writeString:function(e,t){var i=x.ofString(e,t);this.writeFullBytes(i,0,i.length)},__class__:m};var p=function(e){this.fd=e};p.__name__=true;p.__super__=m;p.prototype=$extend(m.prototype,{writeByte:function(e){U.writeSync(this.fd,String.fromCodePoint(e))},writeBytes:function(e,t,i){var n=e.b;return U.writeSync(this.fd,Q.from(n.buffer,n.byteOffset,e.length),t,i)},writeString:function(e,t){U.writeSync(this.fd,e)},__class__:p});var v=function(){};v.__name__=true;v.enumParameters=function(e){var t=n[e.__enum__];var i=t.__constructs__[e._hx_index];var r=t[i].__params__;if(r!=null){var s=[];var o=0;while(o<r.length){var a=r[o];++o;s.push(e[a])}return s}else{return[]}};var y=n["haxe.StackItem"]={__ename__:true,__constructs__:["CFunction","Module","FilePos","Method","LocalFunction"],CFunction:{_hx_index:0,__enum__:"haxe.StackItem",toString:t},Module:(r=function(e){return{_hx_index:1,m:e,__enum__:"haxe.StackItem",toString:t}},r.__params__=["m"],r),FilePos:(r=function(e,i,n,r){return{_hx_index:2,s:e,file:i,line:n,column:r,__enum__:"haxe.StackItem",toString:t}},r.__params__=["s","file","line","column"],r),Method:(r=function(e,i){return{_hx_index:3,classname:e,method:i,__enum__:"haxe.StackItem",toString:t}},r.__params__=["classname","method"],r),LocalFunction:(r=function(e){return{_hx_index:4,v:e,__enum__:"haxe.StackItem",toString:t}},r.__params__=["v"],r)};var _=function(){};_.__name__=true;_.__isInterface__=true;var w=function(e){var t=this;this.id=setInterval(function(){t.run()},e)};w.__name__=true;w.delay=function(e,t){var i=new w(t);i.run=function(){i.stop();e()};return i};w.prototype={stop:function(){if(this.id==null){return}clearInterval(this.id);this.id=null},run:function(){},__class__:w};var g=functi Line: 67 -  1){var n=t;i=""+n+".0"}else{var r=t;i=r}return d.lpad(i," ",5)+"%"};var m=new Date(0).getTime();var p=function(){if(!(a==l||a/l>=1)){var e=(new Date).getTime();if(e>m+137){m=e;var t=[];if(o<s){t.push("Downloaded: "+f(o/s))}if(a>0){t.push("Saved: "+f(a/l))}var i="   "+t.join("   ");h(i)}}};n.on("data",function(e){o+=e.length;p()});var v=0;t(i,n,{onProgress:function(e,t,i){a=e;l=t;if(i){var n=o/s;var r=a/l;var u=n*r;if(u<v){u=v}v=u;a=Math.round(u*1e3);l=1e3}p()},done:function(t){e.success("-> Done!");r(t)}})}};ne.download=function(e,t){return _e.async(function(i){var n=J.parse(e);n.agent=false;if(n.headers==null){n.headers={}}n.headers["user-agent"]=ne.USER_AGENT;var r=function(t){var n=W.Failure(me.withData(null,"Failed to download "+e+" because "+t.message,t,{fileName:"src/lix/client/Download.hx",lineNumber:293,className:"lix.client.Download",methodName:"download"}));i(n)};var s=d.startsWith(e,"https:")?q.get(n):j.get(n);s.setTimeout(3e4);s.on("error",r);s.on("response",function(s){if(s.statusCode>=400){var o=W.Failure(me.withData(s.statusCode,s.statusMessage,s,{fileName:"src/lix/client/Download.hx",lineNumber:304,className:"lix.client.Download",methodName:"download"}));i(o)}else{var a=s.headers["location"];if(a==null){s.on("error",r);t(e,s,function(e){switch(e._hx_index){case 0:var t=e.data;i(W.Success(t));break;case 1:var n=e.failure;i(W.Failure(n));break}})}else{var l=a;var u=J.parse(l);var c=u.slashes;var h=u.search;var f=u.query;var d=u.port;var m=u.pathname;var p=u.path;var v=u.href;var y=u.hostname;var _=u.host;var w=u.hash;var g=u.auth;ne.download(u.protocol==null?n.protocol+"//"+n.host+l:l,t).handle(i)}}})})};var re=function(){};re.__name__=true;re.ensureNeko=function(e){var t=G.PATH;if(M.exists(t)){return new ye(new z(W.Success(t)))}else{e.info("Neko seems to be missing. Attempting download ...");var i;switch(o.systemName()){case"Mac":i=ne.tar("https://github.com/HaxeFoundation/neko/releases/download/v2-3-0/neko-2.3.0-osx64.tar.gz",1,t,e);break;case"Windows":i=ne.zip("https://github.com/HaxeFoundation/neko/releases/download/v2-3-0/neko-2.3.0-win.zip",1,t,e);break;def</Result>
</report_mosca>

<report_mosca>
 <Path>/src/bin/nekoshim.js</Path>
 <Module>/app/Mosca/eggs/javascript_common_fail.egg</Module>
 <Title> Possible SQL injection</Title>
 <Description> notification possible SQL injection</Description>
 <Level> High</Level>
 <Reference> https://www.owasp.org/index.php/Testing_for_Stack_Overflow </Reference>
 <Match> query|YQL|WHERE|FROM|SELECT|UPDATE|DELETE|INSERT|UNION|getResults</Match>
 <Result> Line: 3 -  turn o.unlink(e,t);const i=e+".DELETE."+T.randomBytes(16).toString("hex");o.rename(e,i,e=>{if(e)return t(e);o.unlink(i,t)})};const W=e=>{if(process.platform!=="win32")return o.unlinkSync(e);const t=e+".DELETE."+T.randomBytes(16).toString("hex");o.renameSync(e,t);o.unlinkSync(t)};const Z=(e,t,i)=>e===e>>>0?e:t===t>>>0?t:i;class Unpack extends s{constructor(e){if(!e)e={};e.ondone=(e=>{this[A]=true;this[D]()});super(e);this.reservations=f();this.transform=typeof e.transform==="function"?e.transform:null;this.writable=true;this.readable=false;this[I]=0;this[A]=false;this.dirCache=e.dirCache||new Map;if(typeof e.uid==="number"||typeof e.gid==="number"){if(typeof e.uid!=="number"||typeof e.gid!=="number")throw new TypeError("cannot set owner without number uid and gid");if(e.preserveOwner)throw new TypeError("cannot preserve owner in archive and also set owner explicitly");this.uid=e.uid;this.gid=e.gid;this.setOwner=true}else{this.uid=null;this.gid=null;this.setOwner=false}if(e.preserveOwner===undefined&&typeof e.uid!=="number")this.preserveOwner=process.getuid&&process.getuid()===0;else this.preserveOwner=!!e.preserveOwner;this.processUid=(this.preserveOwner||this.setOwner)&&process.getuid?process.getuid():null;this.processGid=(this.preserveOwner||this.setOwner)&&process.getgid?process.getgid():null;this.forceChown=e.forceChown===true;this.win32=!!e.win32||process.platform==="win32";this.newer=!!e.newer;this.keep=!!e.keep;this.noMtime=!!e.noMtime;this.preservePaths=!!e.preservePaths;this.unlink=!!e.unlink;this.cwd=l.resolve(e.cwd||process.cwd());this.strip=+e.strip||0;this.processUmask=process.umask();this.umask=typeof e.umask==="number"?e.umask:this.processUmask;this.dmode=e.dmode||511&~this.umask;this.fmode=e.fmode||438&~this.umask;this.on("entry",e=>this[d](e))}warn(e,t,i={}){if(e==="TAR_BAD_ARCHIVE"||e==="TAR_ABORT")i.recoverable=false;return super.warn(e,t,i)}[D](){if(this[A]&&this[I]===0){this.emit("prefinish");this.emit("finish");this.emit("end");this.emit("close")}}[x](e){if(this.strip){const t=e.path.split(/\/|\\/);if(t.length<this.strip)return false;e.path=t.slice(this.str</Result>
</report_mosca>

<report_mosca>
 <Path>/src/bin/lix.js</Path>
 <Module>/app/Mosca/eggs/javascript_common_fail.egg</Module>
 <Title> Logic fail</Title>
 <Description>Possible logic bug that could lead to security bugs. Assigning a static string to a variable in an if condition is not normal and is likely a mistake.</Description>
 <Level> Low</Level>
 <Reference> https://en.wikipedia.org/wiki/Logic_error</Reference>
 <Match> if\s?\(\s?\$.*\s?(?<!\!)=\s?('|").*('|")\s?\)</Match>
 <Result> Line: 93 -  dll")!=-1;var v;if(i.indexOf("haxelib.json")!=-1){var o=JSON.parse(Rn.readFileSync(""+n+"/haxelib.json",{encoding:"utf8"}));var b=o.name;var N=o.version;var R;var S=o.classPath;if(S==null){R=""}else{var D=S;R=D}var A=o.dependencies;var B;if(A==null){B=zn.ofHaxeshim(new I)}else{var M=A;var E=new I;var C=M;var W=C;var T=h.fields(C);var Y=0;while(Y<T.length){var G=T[Y++];var q={value:W[G],key:G};var Z=q.key;var V=q.value;var X;var j;var J;switch(V){case"":case"*":J=de.fromString("haxelib:"+Z);break;default:X=de.fromString(V).scheme;if(X==null){var Q=V;J=de.fromString("haxelib:"+Z+"#"+Q)}else{j=de.fromString(V);var K=j.query==null?j.path:j.path+"?"+j.query;var y=j.scheme;var H=j.query;var L=j.payload;var z=j.path;var m=j.hosts;var p=j.host;var U=j.hash;var F=j.auth;if(y==null){var x=V;J=de.fromString(x)}else if(y=="git"){if(H==null){var k=de.fromString(L);var g=k.query==null?k.path:k.path+"?"+k.query;var $=k.scheme;var _=k.query;var nn=k.payload;var en=k.path;var tn=k.hosts;var sn=k.host;var rn=k.hash;var fn=k.auth;if(sn==null){var an=V;J=de.fromString(an)}else{var ln=Le.get_port(sn);var hn=Le.get_name(sn);if(hn==null){var wn=V;J=de.fromString(wn)}else{switch(hn){case"github.com":case"gitlab.com":if($==null){var cn=V;J=de.fromString(cn)}else if($=="https"){var dn=k;J=dn}else{var un=V;J=de.fromString(un)}break;default:var vn=V;J=de.fromString(vn)}}}}else{var on=de.fromString(L);var Dn=on.query==null?on.path:on.path+"?"+on.query;var An=on.scheme;var Bn=on.query;var Mn=on.payload;var En=on.path;var Cn=on.hosts;var Wn=on.host;var Tn=on.hash;var Yn=on.auth;if(Wn==null){var Gn=V;J=de.fromString(Gn)}else{var qn=Le.get_port(Wn);var Zn=Le.get_name(Wn);if(Zn==null){var Vn=V;J=de.fromString(Vn)}else{switch(Zn){case"github.com":case"gitlab.com":if(An==null){var Xn=V;J=de.fromString(Xn)}else if(An=="https"){var jn=on;J=jn}else{var Jn=V;J=de.fromString(Jn)}break;default:var Qn=V;J=de.fromString(Qn)}}}}}else{var Kn=V;J=de.fromString(Kn)}}}var yn=On.FromUrl(J);if(ni[Z]!=null){E.setReserved(Z,yn)}else{E.h[Z]=yn}}B=zn.ofMap(E)}v=new In(b,N,R,u,function(n){if(Nn.exists(""+n.libRoot+"/run.n")||o.main</Result>
</report_mosca>

<report_mosca>
 <Path>/src/bin/lix.js</Path>
 <Module>/app/Mosca/eggs/javascript_common_fail.egg</Module>
 <Title> Possible code injection</Title>
 <Description> Command injection is an attack in which the goal is execution of arbitrary commands on the host operating system via a vulnerable application.</Description>
 <Level> High</Level>
 <Reference> https://www.securecoding.cert.org/confluence/pages/viewpage.action?pageId=2130132 </Reference>
 <Match> eval\s?\(|setTimeout|setInterval</Match>
 <Result> Line: 16 -  wd()}catch(n){}var a=process.chdir;process.chdir=function(n){r=null;a.call(process,n)};n.exports=patch;function patch(n){if(t.hasOwnProperty("O_SYMLINK")&&process.version.match(/^v0\.6\.[0-2]|^v0\.5\./)){patchLchmod(n)}if(!n.lutimes){patchLutimes(n)}n.chown=chownFix(n.chown);n.fchown=chownFix(n.fchown);n.lchown=chownFix(n.lchown);n.chmod=chmodFix(n.chmod);n.fchmod=chmodFix(n.fchmod);n.lchmod=chmodFix(n.lchmod);n.chownSync=chownFixSync(n.chownSync);n.fchownSync=chownFixSync(n.fchownSync);n.lchownSync=chownFixSync(n.lchownSync);n.chmodSync=chmodFixSync(n.chmodSync);n.fchmodSync=chmodFixSync(n.fchmodSync);n.lchmodSync=chmodFixSync(n.lchmodSync);n.stat=statFix(n.stat);n.fstat=statFix(n.fstat);n.lstat=statFix(n.lstat);n.statSync=statFixSync(n.statSync);n.fstatSync=statFixSync(n.fstatSync);n.lstatSync=statFixSync(n.lstatSync);if(!n.lchmod){n.lchmod=function(n,e,i){if(i)process.nextTick(i)};n.lchmodSync=function(){}}if(!n.lchown){n.lchown=function(n,e,i,t){if(t)process.nextTick(t)};n.lchownSync=function(){}}if(f==="win32"){n.rename=function(e){return function(i,t,s){var r=Date.now();var f=0;e(i,t,function CB(a){if(a&&(a.code==="EACCES"||a.code==="EPERM")&&Date.now()-r<6e4){setTimeout(function(){n.stat(t,function(n,r){if(n&&n.code==="ENOENT")e(i,t,CB);else s(a)})},f);if(f<100)f+=10;return}if(s)s(a)})}}(n.rename)}n.read=function(e){function read(i,t,s,r,f,a){var l;if(a&&typeof a==="function"){var h=0;l=function(w,c,d){if(w&&w.code==="EAGAIN"&&h<10){h++;return e.call(n,i,t,s,r,f,l)}a.apply(this,arguments)}}return e.call(n,i,t,s,r,f,l)}read.__proto__=e;return read}(n.read);n.readSync=function(e){return function(i,t,s,r,f){var a=0;while(true){try{return e.call(n,i,t,s,r,f)}catch(n){if(n.code==="EAGAIN"&&a<10){a++;continue}throw n}}}}(n.readSync);function patchLchmod(n){n.lchmod=function(e,i,s){n.open(e,t.O_WRONLY|t.O_SYMLINK,i,function(e,t){if(e){if(s)s(e);return}n.fchmod(t,i,function(e){n.close(t,function(n){if(s)s(e||n)})})})};n.lchmodSync=function(e,i){var s=n.openSync(e,t.O_WRONLY|t.O_SYMLINK,i);var r=true;var f;try{f=n.fchmodSync(s,i);r=false}finally{if(r){try{n.closeSync(s)}catch(n) Line: 53 -  f.b+=String.fromCodePoint(y[g>>2]);this.buf.b+=String.fromCodePoint(y[g<<4&63])}break;default:if(this.useCache){this.cache.pop()}if(n.hxSerialize!=null){this.buf.b+="C";this.serializeString(f.__name__);if(this.useCache){this.cache.push(n)}n.hxSerialize(this);this.buf.b+="g"}else{this.buf.b+="c";this.serializeString(f.__name__);if(this.useCache){this.cache.push(n)}this.serializeFields(n)}}break;case 7:var $=e.e;if(this.useCache){if(this.serializeRef(n)){return}this.cache.pop()}this.buf.b+=c.string(this.useEnumIndex?"j":"w");this.serializeString($.__ename__);if(this.useEnumIndex){this.buf.b+=":";this.buf.b+=c.string(n._hx_index)}else{var _=n;this.serializeString(s[_.__enum__].__constructs__[_._hx_index])}this.buf.b+=":";var nn=E.enumParameters(n);this.buf.b+=c.string(nn.length);var en=0;while(en<nn.length){var tn=nn[en];++en;this.serialize(tn)}if(this.useCache){this.cache.push(n)}break;default:throw new Mn("Cannot serialize "+c.string(n))}},__class__:Y};var G=function(n){var e=this;this.id=setInterval(function(){e.run()},n)};e["haxe.Timer"]=G;G.__name__="haxe.Timer";G.delay=function(n,e){var i=new G(e);i.run=function(){i.stop();n()};return i};G.prototype={stop:function(){if(this.id==null){return}clearInterval(this.id);this.id=null},run:function(){},__class__:G};var q=function(){};e["haxe._Unserializer.DefaultResolver"]=q;q.__name__="haxe._Unserializer.DefaultResolver";q.prototype={resolveClass:function(n){return e[n]},resolveEnum:function(n){return s[n]},__class__:q};var Z=function(n){this.buf=n;this.length=n.length;this.pos=0;this.scache=[];this.cache=[];var e=Z.DEFAULT_RESOLVER;if(e==null){e=new q;Z.DEFAULT_RESOLVER=e}this.resolver=e};e["haxe.Unserializer"]=Z;Z.__name__="haxe.Unserializer";Z.initCodes=function(){var n=[];var e=0;var i=Z.BASE64.length;while(e<i){var t=e++;n[Z.BASE64.charCodeAt(t)]=t}return n};Z.prototype={readDigits:function(){var n=0;var e=false;var i=this.pos;while(true){var t=this.buf.charCodeAt(this.pos);if(t!=t){break}if(t==45){if(this.pos!=i){break}e=true;this.pos++;continue}if(t<48||t>57){break}n=n*10+(t-48);this.pos++}if(e){n*=-1}return n},readFloat:fun Line: 96 -  eak}}).handle(function(e){if(e._hx_index==1){var i=e.failure;n(Sn.Failure(i))}else{c()}})}).handle($bind(r,r.done))};pn.tar=function(n,e,i,t){var s=i;var r=e;return pn.download(n,pn.withLogger(t,function(n,e,i){return pn.untar(n,s,r,e,i)}))};pn.zip=function(n,e,i,t){var s=i;var r=e;return pn.download(n,pn.withLogger(t,function(n,e,i){pn.unzip(n,s,r,e,i)}))};pn.withLogger=function(n,e){return function(i,t,s){var r=c.parseInt(t.headers["content-length"]);var f=0;var a=0;var l=1;var h=null;var w=function(e){if(e==h){return}h=e;n.progress(e)};var d=function(n){n=Math.min(1,Math.max(0,n));var e=c.string(Math.round(1e3*n)/10);var i;if(e.indexOf(".")==-1){var t=e;i=""+t+".0"}else{var s=e;i=s}return D.lpad(i," ",5)+"%"};var u=new Date(0).getTime();var v=function(){if(!(a==l||a/l>=1)){var n=(new Date).getTime();if(n>u+137){u=n;var e=[];if(f<r){e.push("Downloaded: "+d(f/r))}if(a>0){e.push("Saved: "+d(a/l))}var i="   "+e.join("   ");w(i)}}};t.on("data",function(n){f+=n.length;v()});var o=0;e(i,t,{onProgress:function(n,e,i){a=n;l=e;if(i){var t=f/r;var s=a/l;var h=t*s;if(h<o){h=o}o=h;a=Math.round(h*1e3);l=1e3}v()},done:function(e){n.success("-> Done!");s(e)}})}};pn.download=function(n,e){return Ee.async(function(i){var t=Gn.parse(n);t.agent=false;if(t.headers==null){t.headers={}}t.headers["user-agent"]=pn.USER_AGENT;var s=function(e){var t=Sn.Failure(De.withData(null,"Failed to download "+n+" because "+e.message,e,{fileName:"src/lix/client/Download.hx",lineNumber:293,className:"lix.client.Download",methodName:"download"}));i(t)};var r=D.startsWith(n,"https:")?Wn.get(t):Cn.get(t);r.setTimeout(3e4);r.on("error",s);r.on("response",function(r){if(r.statusCode>=400){var f=Sn.Failure(De.withData(r.statusCode,r.statusMessage,r,{fileName:"src/lix/client/Download.hx",lineNumber:304,className:"lix.client.Download",methodName:"download"}));i(f)}else{var a=r.headers["location"];if(a==null){r.on("error",s);e(n,r,function(n){switch(n._hx_index){case 0:var e=n.data;i(Sn.Success(e));break;case 1:var t=n.failure;i(Sn.Failure(t));break}})}else{var l=a;var h=Gn.parse(l);var w=h.slashes;var c=h.search;var d=h</Result>
</report_mosca>

<report_mosca>
 <Path>/src/bin/lix.js</Path>
 <Module>/app/Mosca/eggs/javascript_common_fail.egg</Module>
 <Title> Possible SQL injection</Title>
 <Description> notification possible SQL injection</Description>
 <Level> High</Level>
 <Reference> https://www.owasp.org/index.php/Testing_for_Stack_Overflow </Reference>
 <Match> query|YQL|WHERE|FROM|SELECT|UPDATE|DELETE|INSERT|UNION|getResults</Match>
 <Result> Line: 3 -  turn f.unlink(n,e);const i=n+".DELETE."+K.randomBytes(16).toString("hex");f.rename(n,i,n=>{if(n)return e(n);f.unlink(i,e)})};const I=n=>{if(process.platform!=="win32")return f.unlinkSync(n);const e=n+".DELETE."+K.randomBytes(16).toString("hex");f.renameSync(n,e);f.unlinkSync(e)};const L=(n,e,i)=>n===n>>>0?n:e===e>>>0?e:i;class Unpack extends r{constructor(n){if(!n)n={};n.ondone=(n=>{this[Z]=true;this[V]()});super(n);this.reservations=d();this.transform=typeof n.transform==="function"?n.transform:null;this.writable=true;this.readable=false;this[Y]=0;this[Z]=false;this.dirCache=n.dirCache||new Map;if(typeof n.uid==="number"||typeof n.gid==="number"){if(typeof n.uid!=="number"||typeof n.gid!=="number")throw new TypeError("cannot set owner without number uid and gid");if(n.preserveOwner)throw new TypeError("cannot preserve owner in archive and also set owner explicitly");this.uid=n.uid;this.gid=n.gid;this.setOwner=true}else{this.uid=null;this.gid=null;this.setOwner=false}if(n.preserveOwner===undefined&&typeof n.uid!=="number")this.preserveOwner=process.getuid&&process.getuid()===0;else this.preserveOwner=!!n.preserveOwner;this.processUid=(this.preserveOwner||this.setOwner)&&process.getuid?process.getuid():null;this.processGid=(this.preserveOwner||this.setOwner)&&process.getgid?process.getgid():null;this.forceChown=n.forceChown===true;this.win32=!!n.win32||process.platform==="win32";this.newer=!!n.newer;this.keep=!!n.keep;this.noMtime=!!n.noMtime;this.preservePaths=!!n.preservePaths;this.unlink=!!n.unlink;this.cwd=l.resolve(n.cwd||process.cwd());this.strip=+n.strip||0;this.processUmask=process.umask();this.umask=typeof n.umask==="number"?n.umask:this.processUmask;this.dmode=n.dmode||511&~this.umask;this.fmode=n.fmode||438&~this.umask;this.on("entry",n=>this[u](n))}warn(n,e,i={}){if(n==="TAR_BAD_ARCHIVE"||n==="TAR_ABORT")i.recoverable=false;return super.warn(n,e,i)}[V](){if(this[Z]&&this[Y]===0){this.emit("prefinish");this.emit("finish");this.emit("end");this.emit("close")}}[C](n){if(this.strip){const e=n.path.split(/\/|\\/);if(e.length<this.strip)return false;n.path=e.slice(this.str</Result>
</report_mosca>

