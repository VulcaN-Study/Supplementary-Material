{
 "dra": [
  {
   "dra": "http://js.foundation",
   "type": "url",
   "file": "/src/nodes/99-sample.js.demo"
  },
  {
   "dra": "http://www.apache.org/licenses/LICENSE-2.0",
   "type": "url",
   "file": "/src/nodes/99-sample.js.demo"
  },
  {
   "dra": "https://github.com/nodejs/node/issues/6038",
   "type": "url",
   "file": "/src/nodes/core/io/21-httprequest.js"
  },
  {
   "dra": "https://github.com/einaros/ws/pull/253",
   "type": "url",
   "file": "/src/nodes/core/io/22-websocket.js"
  },
  {
   "dra": "https://help.github.com/articles/markdown-basics/",
   "type": "url",
   "file": "/src/nodes/core/locales/en-US/messages.json"
  },
  {
   "dra": "http://nodered.org/docs",
   "type": "url",
   "file": "/src/public/red/main.js"
  },
  {
   "dra": "https://catalogue.nodered.org/catalogue.json",
   "type": "url",
   "file": "/src/public/red/red.js"
  },
  {
   "dra": "https://git.example.com/path/my-project.git",
   "type": "url",
   "file": "/src/public/red/red.js"
  },
  {
   "dra": "http://www.w3.org/1999/xhtml",
   "type": "url",
   "file": "/src/public/vendor/ace/ace.js"
  },
  {
   "dra": "http://www.w3.org/TR/html4/strict.dtd",
   "type": "url",
   "file": "/src/public/vendor/ace/snippets/html.js"
  },
  {
   "dra": "http://www.w3.org/TR/html4/loose.dtd",
   "type": "url",
   "file": "/src/public/vendor/ace/snippets/html.js"
  },
  {
   "dra": "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd",
   "type": "url",
   "file": "/src/public/vendor/ace/snippets/html.js"
  },
  {
   "dra": "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd",
   "type": "url",
   "file": "/src/public/vendor/ace/snippets/html.js"
  },
  {
   "dra": "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd",
   "type": "url",
   "file": "/src/public/vendor/ace/snippets/html.js"
  },
  {
   "dra": "http://www.w3.org/TR/xhtml1/DTD/xhtml1-frameset.dtd",
   "type": "url",
   "file": "/src/public/vendor/ace/snippets/html.js"
  },
  {
   "dra": "https://cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv.min.js",
   "type": "url",
   "file": "/src/public/vendor/ace/snippets/html.js"
  },
  {
   "dra": "https://cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv-printshiv.min.js",
   "type": "url",
   "file": "/src/public/vendor/ace/snippets/html.js"
  },
  {
   "dra": "joe@example.com",
   "type": "email",
   "file": "/src/public/vendor/ace/snippets/html.js"
  },
  {
   "dra": "http://octopress.org/",
   "type": "url",
   "file": "/src/public/vendor/ace/snippets/markdown.js"
  },
  {
   "dra": "http://octopress.org/docs/plugins/pullquote/",
   "type": "url",
   "file": "/src/public/vendor/ace/snippets/markdown.js"
  },
  {
   "dra": "http://www.w3.org/1998/Math/MathML",
   "type": "url",
   "file": "/src/public/vendor/ace/worker-html.js"
  },
  {
   "dra": "http://www.w3.org/2000/svg",
   "type": "url",
   "file": "/src/public/vendor/ace/worker-html.js"
  },
  {
   "dra": "http://www.ibm.com/data/dtd/v11/ibmxhtml1-transitional.dtd",
   "type": "url",
   "file": "/src/public/vendor/ace/worker-html.js"
  },
  {
   "dra": "http://www.w3.org/TR/REC-html40/strict.dtd",
   "type": "url",
   "file": "/src/public/vendor/ace/worker-html.js"
  },
  {
   "dra": "http://www.w3.org/1999/xlink",
   "type": "url",
   "file": "/src/public/vendor/ace/worker-html.js"
  },
  {
   "dra": "http://www.w3.org/XML/1998/namespace",
   "type": "url",
   "file": "/src/public/vendor/ace/worker-html.js"
  },
  {
   "dra": "http://www.w3.org/2000/xmlns/",
   "type": "url",
   "file": "/src/public/vendor/ace/worker-html.js"
  },
  {
   "dra": "http://jshint.com/doc/options/#nonbsp",
   "type": "url",
   "file": "/src/public/vendor/ace/worker-javascript.js"
  },
  {
   "dra": "http://www.apache.org/licenses/LICENSE-2.0.txt",
   "type": "url",
   "file": "/src/public/vendor/vendor.js"
  },
  {
   "dra": "http://jqueryui.com",
   "type": "url",
   "file": "/src/public/vendor/vendor.js"
  },
  {
   "dra": "https://github.com/chjj/marked",
   "type": "url",
   "file": "/src/public/vendor/vendor.js"
  },
  {
   "dra": "http://i18next.com",
   "type": "url",
   "file": "/src/public/vendor/vendor.js"
  },
  {
   "dra": "https://github.com/websockets/ws/pull/632",
   "type": "url",
   "file": "/src/red/api/editor/comms.js"
  },
  {
   "dra": "https://github.com/nodejs/node/pull/3455",
   "type": "url",
   "file": "/src/red/runtime/nodes/registry/registry.js"
  },
  {
   "dra": "http://nodered.org",
   "type": "url",
   "file": "/src/red.js"
  },
  {
   "dra": "http://nodered.org/docs/security.html",
   "type": "url",
   "file": "/src/settings.js"
  },
  {
   "dra": "http://nodered.org/docs/security.html#generating-the-password-hash",
   "type": "url",
   "file": "/src/settings.js"
  },
  {
   "dra": "http://nodejs.org/api/https.html#https_https_createserver_options_requestlistener",
   "type": "url",
   "file": "/src/settings.js"
  },
  {
   "dra": "https://github.com/troygoode/node-cors#configuration-options",
   "type": "url",
   "file": "/src/settings.js"
  },
  {
   "dra": "http://myproxy.com:8080",
   "type": "url",
   "file": "/src/settings.js"
  }
 ],
 "sca": [
  {
   "cwe": "CWE-400",
   "cves": "",
   "sast": "",
   "title": "Denial of Service - js-yaml",
   "severity": "moderate",
   "advisoryId": 788,
   "description": "Versions of `js-yaml` prior to 3.13.0 are vulnerable to Denial of Service. By parsing a carefully-crafted YAML file, the node process stalls and may exhaust system resources leading to a Denial of Service.",
   "recomendation": "Upgrade to version 3.13.0."
  },
  {
   "cwe": "CWE-94",
   "cves": "",
   "sast": "",
   "title": "Code Injection - js-yaml",
   "severity": "high",
   "advisoryId": 813,
   "description": "Versions of `js-yaml` prior to 3.13.1 are vulnerable to Code Injection. The `load()` function may execute arbitrary code injected through a malicious YAML file. Objects that have `toString` as key, JavaScript code as value and are used as explicit mapping keys allow attackers to execute the supplied code through the `load()` function. The `safeLoad()` function is unaffected.\n\nAn example payload is \n`{ toString: !\u003ctag:yaml.org,2002:js/function\u003e 'function (){return Date.now()}' } : 1` \nwhich returns the object \n{\n  \"1553107949161\": 1\n}",
   "recomendation": "Upgrade to version 3.13.1."
  }
 ],
 "sast": {
  "name": "node-red",
  "version": "0.18.5",
  "averageCvss": 7.1,
  "securityScore": 29,
  "size": "6781267 Bytes",
  "numberOfLines": 56378
 },
 "libraries": [
  {
   "name": "bcryptjs",
   "current": "2.4.3"
  },
  {
   "name": "express",
   "current": "4.16.3"
  },
  {
   "name": "json-stringify-safe",
   "current": "5.0.1"
  },
  {
   "name": "node-red-node-feedparser",
   "current": "0.1.*"
  },
  {
   "name": "on-headers",
   "current": "1.0.1"
  },
  {
   "name": "uglify-js",
   "current": "3.3.24"
  },
  {
   "name": "basic-auth",
   "current": "2.0.0"
  },
  {
   "name": "cheerio",
   "current": "0.22.0"
  },
  {
   "name": "is-utf8",
   "current": "0.2.1"
  },
  {
   "name": "node-red-node-twitter",
   "current": "0.1.*"
  },
  {
   "name": "nopt",
   "current": "4.0.1"
  },
  {
   "name": "follow-redirects",
   "current": "1.4.1"
  },
  {
   "name": "media-typer",
   "current": "0.3.0"
  },
  {
   "name": "memorystore",
   "current": "1.6.0"
  },
  {
   "name": "node-red-node-email",
   "current": "0.1.*"
  },
  {
   "name": "xml2js",
   "current": "0.4.19"
  },
  {
   "name": "sentiment",
   "current": "2.1.0"
  },
  {
   "name": "fs-extra",
   "current": "5.0.0"
  },
  {
   "name": "i18next",
   "current": "1.10.6"
  },
  {
   "name": "node-red-node-rbe",
   "current": "0.2.*"
  },
  {
   "name": "oauth2orize",
   "current": "1.11.0"
  },
  {
   "name": "raw-body",
   "current": "2.3.3"
  },
  {
   "name": "fs.notify",
   "current": "0.0.4"
  },
  {
   "name": "js-yaml",
   "current": "3.11.0"
  },
  {
   "name": "multer",
   "current": "1.3.0"
  },
  {
   "name": "mustache",
   "current": "2.3.0"
  },
  {
   "name": "when",
   "current": "3.7.8"
  },
  {
   "name": "cookie",
   "current": "0.3.1"
  },
  {
   "name": "express-session",
   "current": "1.15.6"
  },
  {
   "name": "jsonata",
   "current": "1.5.3"
  },
  {
   "name": "passport-http-bearer",
   "current": "1.0.1"
  },
  {
   "name": "body-parser",
   "current": "1.18.2"
  },
  {
   "name": "clone",
   "current": "2.1.1"
  },
  {
   "name": "cron",
   "current": "1.3.0"
  },
  {
   "name": "hash-sum",
   "current": "1.0.2"
  },
  {
   "name": "passport",
   "current": "0.4.0"
  },
  {
   "name": "ws",
   "current": "1.1.5"
  },
  {
   "name": "cookie-parser",
   "current": "1.4.3"
  },
  {
   "name": "cors",
   "current": "2.8.4"
  },
  {
   "name": "mqtt",
   "current": "2.17.0"
  },
  {
   "name": "passport-oauth2-client-password",
   "current": "0.1.2"
  },
  {
   "name": "semver",
   "current": "5.5.0"
  }
 ],
 "vulnerabilities": [
  {
   "cvss": 7.1,
   "cwe": "CWE-327",
   "line": 78,
   "class": "index.js (78:41)",
   "vul_id": "b347dd0dad679bf83b1589a5ac1d03f0",
   "method": "result.rev = crypto.createHash('md5').update(JSON.stringify(result.flows)).digest(\"hex\");",
   "column": 41,
   "longMessage": "The MD5 hash algorithm that was used is considered weak. It can also cause hash collisions.",
   "classMessage": "/red/runtime/storage/index.js (78:41)",
   "shortMessage": "It is always recommended to use some CHF (Cryptographic Hash Function), which is mathematically strong and not reversible. SHA512 would be the most recommended hash for storing the password and it is also important to adopt some type of Salt, so that the Hash is more secure.",
   "affectedFiles": [
    "/red/red.js",
    "/red/runtime/index.js"
   ]
  },
  {
   "cvss": 7.1,
   "cwe": "CWE-327",
   "line": 96,
   "class": "index.js (96:35)",
   "vul_id": "25c0fa1f03c9db22529c8d1f56562fc4",
   "method": "return crypto.createHash('md5').update(JSON.stringify(config.flows)).digest(\"hex\");",
   "column": 35,
   "longMessage": "The MD5 hash algorithm that was used is considered weak. It can also cause hash collisions.",
   "classMessage": "/red/runtime/storage/index.js (96:35)",
   "shortMessage": "It is always recommended to use some CHF (Cryptographic Hash Function), which is mathematically strong and not reversible. SHA512 would be the most recommended hash for storing the password and it is also important to adopt some type of Salt, so that the Hash is more secure.",
   "affectedFiles": [
    "/red/red.js",
    "/red/runtime/index.js"
   ]
  },
  {
   "cvss": 7.1,
   "cwe": "CWE-327",
   "line": 215,
   "class": "red.js (215:27)",
   "vul_id": "ea4aac4e3b93737786473b716add3c02",
   "method": "return crypto.createHash('md5').update(p,'utf8').digest('hex') === pass;",
   "column": 27,
   "longMessage": "The MD5 hash algorithm that was used is considered weak. It can also cause hash collisions.",
   "classMessage": "/red.js (215:27)",
   "shortMessage": "It is always recommended to use some CHF (Cryptographic Hash Function), which is mathematically strong and not reversible. SHA512 would be the most recommended hash for storing the password and it is also important to adopt some type of Salt, so that the Hash is more secure.",
   "affectedFiles": [
    "/nodes/core/io/21-httprequest.js",
    "/public/vendor/ace/worker-javascript.js",
    "/red/api/editor/index.js",
    "/red/runtime/nodes/flows/index.js",
    "/red/runtime/nodes/index.js",
    "/red.js"
   ]
  }
 ]
}