<report_mosca>
 <Path>/src/red/api/editor/comms.js</Path>
 <Module>/app/Mosca/eggs/javascript_common_fail.egg</Module>
 <Title> Possible code injection</Title>
 <Description> Command injection is an attack in which the goal is execution of arbitrary commands on the host operating system via a vulnerable application.</Description>
 <Level> High</Level>
 <Reference> https://www.securecoding.cert.org/confluence/pages/viewpage.action?pageId=2130132 </Reference>
 <Match> eval\s?\(|setTimeout|setInterval</Match>
 <Result> Line: 160 -              heartbeatTimer = setInterval(function() {

 Line: 209 -          setTimeout(function() {

</Result>
</report_mosca>

<report_mosca>
 <Path>/src/red/runtime/index.js</Path>
 <Module>/app/Mosca/eggs/javascript_common_fail.egg</Module>
 <Title> Possible code injection</Title>
 <Description> Command injection is an attack in which the goal is execution of arbitrary commands on the host operating system via a vulnerable application.</Description>
 <Level> High</Level>
 <Reference> https://www.securecoding.cert.org/confluence/pages/viewpage.action?pageId=2130132 </Reference>
 <Match> eval\s?\(|setTimeout|setInterval</Match>
 <Result> Line: 95 -                  runtimeMetricInterval = setInterval(function() {

 Line: 195 -              reinstallTimeout = setTimeout(function() {

</Result>
</report_mosca>

<report_mosca>
 <Path>/src/red/runtime/nodes/Node.js</Path>
 <Module>/app/Mosca/eggs/javascript_common_fail.egg</Module>
 <Title> Possible SQL injection</Title>
 <Description> notification possible SQL injection</Description>
 <Level> High</Level>
 <Reference> https://www.owasp.org/index.php/Testing_for_Stack_Overflow </Reference>
 <Match> query|YQL|WHERE|FROM|SELECT|UPDATE|DELETE|INSERT|UNION|getResults</Match>
 <Result> Line: 43 -      //console.log("UPDATE",this.id);

</Result>
</report_mosca>

<report_mosca>
 <Path>/src/public/red/red.js</Path>
 <Module>/app/Mosca/eggs/javascript_common_fail.egg</Module>
 <Title> Logic fail</Title>
 <Description>Possible logic bug that could lead to security bugs. Assigning a static string to a variable in an if condition is not normal and is likely a mistake.</Description>
 <Level> Low</Level>
 <Reference> https://en.wikipedia.org/wiki/Logic_error</Reference>
 <Match> if\s?\(\s?\$.*\s?(?<!\!)=\s?('|").*('|")\s?\)</Match>
 <Result> Line: 13975 -              if ($(cl[i]).css('display') === 'none') { c += 1; }

 Line: 22131 -                                  if ($("input[name=projects-encryption-key]:checked").val() === 'custom') {

 Line: 22548 -                                  if ($("input[name=projects-encryption-key]:checked").val() === 'custom') {

</Result>
</report_mosca>

<report_mosca>
 <Path>/src/public/red/red.js</Path>
 <Module>/app/Mosca/eggs/javascript_common_fail.egg</Module>
 <Title> Possible code injection</Title>
 <Description> Command injection is an attack in which the goal is execution of arbitrary commands on the host operating system via a vulnerable application.</Description>
 <Level> High</Level>
 <Reference> https://www.securecoding.cert.org/confluence/pages/viewpage.action?pageId=2130132 </Reference>
 <Match> eval\s?\(|setTimeout|setInterval</Match>
 <Result> Line: 322 -              pendingSave = setTimeout(function() {

 Line: 718 -                  clearErrorTimer = setTimeout(function() {

 Line: 772 -                  setTimeout(connectWS,1000);

 Line: 777 -                  setTimeout(connectWS,2000);

 Line: 780 -                  connectCountdownTimer = setInterval(function() {

 Line: 5170 -                  setTimeout(function() {

 Line: 5182 -                          setTimeout(function() {

 Line: 5803 -                  timer = setTimeout(openPopup,delay.show);

 Line: 5810 -                  setTimeout(closePopup,delay.hide);

 Line: 5824 -              setTimeout(function() {

 Line: 5924 -                      this.currentTimeout = setTimeout(function() {

 Line: 6012 -              var interval = setInterval(function() {

 Line: 6085 -                  setTimeout(function() {

 Line: 6150 -          setTimeout(function() {

 Line: 7277 -              setTimeout(function() {

 Line: 7474 -                  setTimeout(function() {

 Line: 8765 -                  setTimeout(function() {

 Line: 9275 -                      setTimeout(function() {

 Line: 9796 -                  setTimeout(function() {

 Line: 10753 -                  touchStartTime = setTimeout(function() {

 Line: 11468 -                          spliceTimer = setTimeout(function() {

 Line: 12158 -              portLabelHoverTimeout = setTimeout(function() {

 Line: 12398 -                              touchStartTime = setTimeout(function() {

 Line: 12441 -                              touchStartTime = setTimeout(function() {

 Line: 12571 -                              touchStartTime = setTimeout(function() {

 Line: 12939 -                          touchStartTime = setTimeout(function() {

 Line: 13373 -                                  setTimeout(flashFunc,100);

 Line: 13879 -                              spliceTimer = setTimeout(function() {

 Line: 14455 -                  refreshTimeout = setInterval(cycleTips,cycleDelay);

 Line: 14472 -                      startTimeout = setTimeout(setTip,startDelay);

 Line: 14836 -              setTimeout(function() {

 Line: 14857 -                          setTimeout(flashFunc,100);

 Line: 14922 -          setTimeout(function() {

 Line: 14987 -              eventTimers[module] = setTimeout(function() {

 Line: 15227 -              setTimeout(function() {

 Line: 15309 -                  setTimeout(function() {

 Line: 17483 -                  window.setTimeout(function() { select.change();},50);

 Line: 17908 -                      changeTimer = setTimeout(testExpression,200);

 Line: 17913 -                      changeTimer = setTimeout(testExpression,200);

 Line: 18036 -                          changeTimer = setTimeout(checkValid,200);

 Line: 18268 -                      changeTimer = setTimeout(bufferStringUpdate,200);

 Line: 18376 -                  setTimeout(function() {

 Line: 18485 -                          setTimeout(function() {

 Line: 18535 -              setTimeout(function() {

 Line: 18536 -                  setTimeout(function() {

 Line: 18546 -                      setTimeout(function() {

 Line: 18610 -                  setTimeout(function() {

 Line: 18626 -                  setTimeout(function() {

 Line: 18635 -                              setTimeout(function() {

 Line: 18809 -          $("#clipboard-import").on('paste',function() { setTimeout(validateImport,10)});

 Line: 18963 -              setTimeout(function() {

 Line: 19724 -                      nn.timeoutid = window.setTimeout(nn.close,timeout);

 Line: 19743 -              n.timeoutid = window.setTimeout(n.close,timeout||5000);

 Line: 20096 -          setTimeout(function() {

 Line: 20267 -              setTimeout(function() {

 Line: 20283 -          setTimeout(function() {

 Line: 20392 -          setTimeout(function() {

 Line: 21098 -                          setTimeout(function() {

 Line: 21438 -                          setTimeout(function() {

 Line: 21557 -                              checkProjectName = setTimeout(function() {

 Line: 21570 -                          setTimeout(function() {

 Line: 21730 -                              checkProjectName = setTimeout(function() {

 Line: 21813 -                              setTimeout(function() {

 Line: 21948 -                                          setTimeout(function() {

 Line: 22020 -                          setTimeout(function() {

 Line: 22174 -                          setTimeout(function() {

 Line: 22266 -                                          setTimeout(function() {

 Line: 22505 -                              checkProjectName = setTimeout(function() {

 Line: 22669 -                              setTimeout(function() {

 Line: 22688 -                          setTimeout(function() {

 Line: 22850 -                                          setTimeout(function() {

 Line: 22881 -              setTimeout(function() {

 Line: 22928 -          setTimeout(function() {

 Line: 23325 -              setTimeout(function() {

 Line: 23445 -                              setTimeout(function() {

 Line: 23562 -              setTimeout(function() {

 Line: 23734 -                          setTimeout(function() {

 Line: 24117 -                                              setTimeout(function() {

 Line: 24438 -                      setTimeout(function() {

 Line: 24683 -                      setTimeout(function() {

 Line: 24930 -                                                              setTimeout(spinner.remove, 100);

 Line: 25531 -                                                              setTimeout(spinner.remove, 100);

 Line: 25803 -                                          setTimeout(function() {

 Line: 25999 -                      setTimeout(function() {

 Line: 26049 -              setTimeout(function() {

 Line: 26108 -                  setTimeout(function() {

 Line: 26145 -                      setTimeout(function() {

 Line: 26180 -                      setTimeout(function() {

 Line: 26208 -                      setTimeout(function() {

 Line: 26271 -              setTimeout(function() {

 Line: 26326 -                      setTimeout(function() {

 Line: 26339 -              setTimeout(function() {

 Line: 26350 -                  setTimeout(function() {

 Line: 26370 -                      setTimeout(function() {

 Line: 26450 -                              setTimeout(function() {

 Line: 26616 -                  setTimeout(function() {

</Result>
</report_mosca>

<report_mosca>
 <Path>/src/public/red/red.js</Path>
 <Module>/app/Mosca/eggs/javascript_common_fail.egg</Module>
 <Title> Possible SQL injection</Title>
 <Description> notification possible SQL injection</Description>
 <Level> High</Level>
 <Reference> https://www.owasp.org/index.php/Testing_for_Stack_Overflow </Reference>
 <Match> query|YQL|WHERE|FROM|SELECT|UPDATE|DELETE|INSERT|UNION|getResults</Match>
 <Result> Line: 14969 -              type: "DELETE"

 Line: 19371 -              var queryArgs = [];

 Line: 22913 -                      type: "DELETE",

 Line: 24772 -                                                  type: "DELETE",

 Line: 24925 -                                                  type: "DELETE",

 Line: 25526 -                                                  type: "DELETE",

 Line: 25787 -                                          type: "DELETE",

 Line: 25825 -                          type: (state==='unstaged')?"POST":"DELETE",

 Line: 25983 -                      type: "DELETE",

 Line: 26655 -              type: unstaged?"POST":"DELETE",

</Result>
</report_mosca>

<report_mosca>
 <Path>/src/public/red/red.min.js</Path>
 <Module>/app/Mosca/eggs/javascript_common_fail.egg</Module>
 <Title> Possible code injection</Title>
 <Description> Command injection is an attack in which the goal is execution of arbitrary commands on the host operating system via a vulnerable application.</Description>
 <Level> High</Level>
 <Reference> https://www.securecoding.cert.org/confluence/pages/viewpage.action?pageId=2130132 </Reference>
 <Match> eval\s?\(|setTimeout|setInterval</Match>
 <Result> Line: 16 -  rror:function(e,t,n){console.log("Unexpected error loading user settings:",e.status,t)}})}function s(){RED.user.hasPermission("settings.write")&&(e&&clearTimeout(e),e=setTimeout(function(){e=null,$.ajax({method:"POST",contentType:"application/json",url:"settings/user",data:JSON.stringify(o),success:function(e){},error:function(e,t,n){console.log("Unexpected error saving user settings:",e.status,t)}})},300))}return{init:function(e){var t=/[?&]access_token=(.*?)(?:$|&)/.exec(window.location.search);if(t){var n=t[1];RED.settings.set("auth-tokens",{access_token:n}),window.location.search=""}$.ajaxSetup({beforeSend:function(e,t){if(!/^\s*(https?:|\/|\.)/.test(t.url)){var n=RED.settings.get("auth-tokens");n&&e.setRequestHeader("Authorization","Bearer "+n.access_token),e.setRequestHeader("Node-RED-API-Version","v2")}}}),i(e)},load:i,loadUserSettings:t,set:function(e,t){a()&&("auth-tokens"===e?localStorage.setItem(e,JSON.stringify(t)):(o[e]=t,s()))},get:function(e){if(a())return"auth-tokens"===e?JSON.parse(localStorage.getItem(e)):o[e]},remove:function(e){a()&&("auth-tokens"===e?localStorage.removeItem(e):(delete o[e],s()))},theme:function(e,t){if(!RED.settings.editorTheme)return t;var n=e.split("."),o=RED.settings.editorTheme;try{for(var a=0;a<n.length;a++)o=o[n[a]];return void 0===o?t:o}catch(e){return t}}}}(),RED.user=function(){function p(){$("#btn-usermenu-submenu li").remove(),RED.settings.user.anonymous?RED.menu.addItem("btn-usermenu",{id:"usermenu-item-login",label:RED._("menu.label.login"),onselect:function(){RED.user.login({cancelable:!0},function(){RED.settings.load(function(){RED.notify(RED._("user.loggedInAs",{name:RED.settings.user.username}),"success"),p(),RED.events.emit("login",RED.settings.user.username)})})}}):(RED.menu.addItem("btn-usermenu",{id:"usermenu-item-username",label:"<b>"+RED.settings.user.username+"</b>"}),RED.menu.addItem("btn-usermenu",{id:"usermenu-item-logout",label:RED._("menu.label.logout"),onselect:function(){RED.user.logout()}}))}var a=/^((.+)\.)?read$/,i=/^((.+)\.)?write$/;return{init:function(){if(RED.settings.user&&(!RED.settings.editorTheme|| Line: 19 -  tings.user||function e(t,n){if(""===n)return!0;var o;if(Array.isArray(n)){for(o=0;o<n.length;o++)if(!e(t,n[o]))return!1;return!0}if(Array.isArray(t)){if(0===t.length)return!1;for(o=0;o<t.length;o++)if(e(t[o],n))return!0;return!1}return"*"===t||t===n||("read"===t||"*.read"===t?a.test(n):("write"===t||"*.write"===t)&&i.test(n))}(RED.settings.user.permissions||"",e)}}}(),RED.comms=function(){var o,a=null,i=null,s=null,l=10,c={},p=!1,u=0,f=!1;return{connect:function r(){f=!0;var e=location.hostname,t=location.port;0!==t.length&&(e=e+":"+t),e=(e+=document.location.pathname)+("/"==e.slice(-1)?"":"/")+"comms",e="ws"+("https:"==document.location.protocol?"s":"")+"://"+e;var n=RED.settings.get("auth-tokens");function d(){for(var e in c)c.hasOwnProperty(e)&&o.send(JSON.stringify({subscribe:e}))}p=null!=n,(o=new WebSocket(e)).onopen=function(){u=0,a&&(i=setTimeout(function(){a.close(),a=null},1e3)),p?o.send(JSON.stringify({auth:n.access_token})):d()},o.onmessage=function(e){for(var t=JSON.parse(e.data),n=0;n<t.length;n++){var o=t[n];if(p&&o.auth)"ok"===o.auth?(p=!1,d()):"fail"===o.auth&&(f=!1,RED.user.login({updateMenu:!0},function(){r()}));else if(o.topic)for(var a in c)if(c.hasOwnProperty(a)&&new RegExp("^"+a.replace(/([\[\]\?\(\)\\\\$\^\*\.|])/g,"\\$1").replace(/\+/g,"[^/]+").replace(/\/#$/,"(/.*)?")+"$").test(o.topic)){var i=c[a];if(i)for(var s=0;s<i.length;s++)i[s](o.topic,o.data)}}},o.onclose=function(){f&&(i&&(clearTimeout(i),i=null),++u<10?(setTimeout(r,1e3),5<u&&null==a&&(a=RED.notify(RED._("notification.errors.lostConnection"),"error",!0))):u<20?setTimeout(r,2e3):(l=60,s=setInterval(function(){if(0==--l)a.update(RED._("notification.errors.lostConnection")),clearInterval(s),r();else{var e=RED._("notification.errors.lostConnectionReconnect",{time:l})+' <a href="#">'+RED._("notification.errors.lostConnectionTry")+"</a>";a.update(e),$(a).find("a").click(function(e){e.preventDefault(),a.update(RED._("notification.errors.lostConnection")),clearInterval(s),r()})}},1e3)))}},subscribe:function(e,t){null==c[e]&&(c[e]=[]),c[e].push(t),o&&1==o.readyState&&o.send(JSON.stringify({subscribe:e Line: 47 -  eList-item-remove editor-button editor-button-small"}).appendTo(i);r("<i/>",{class:"fa fa-remove"}).appendTo(e),i.addClass("red-ui-editableList-item-removable"),e.click(function(e){e.preventDefault();var t=n.data("data");i.addClass("red-ui-editableList-item-deleting"),i.fadeOut(300,function(){r(this).remove(),a.options.removeItem&&a.options.removeItem(t)})})}if(this.options.addItem){var t=a.element.children().length-1;setTimeout(function(){if(a.options.addItem(n,t,o),a.activeFilter)try{a.activeFilter(o)||i.hide()}catch(e){}!a.activeSort&&a.scrollOnAdd&&setTimeout(function(){a.uiContainer.scrollTop(a.element.height())},0)},0)}},addItems:function(e){for(var t=0;t<e.length;t++)this.addItem(e[t])},removeItem:function(t){this.element.children().filter(function(e){return t===r(this).find(".red-ui-editableList-item-content").data("data")}).remove(),this.options.removeItem&&this.options.removeItem(t)},items:function(){return this.element.children().map(function(e){return r(this).find(".red-ui-editableList-item-content")})},empty:function(){this.element.empty()},filter:function(e){return void 0!==e&&(this.activeFilter=e),this._refreshFilter()},sort:function(e){return void 0!==e&&(this.activeSort=e),this._refreshSort()},length:function(){return this.element.children().length}})}(jQuery),function(t){t.widget("nodered.checkboxSet",{_create:function(){var n=this;this.uiElement=this.element.wrap("<span>").parent(),this.uiElement.addClass("red-ui-checkboxSet"),this.options.parent&&(this.parent=this.options.parent,this.parent.checkboxSet("addChild",this.element)),this.children=[],this.partialFlag=!1,this.stateValue=0;var e=this.element.prop("checked");this.options=[t('<span class="red-ui-checkboxSet-option hide"><i class="fa fa-square-o"></i></span>').appendTo(this.uiElement),t('<span class="red-ui-checkboxSet-option hide"><i class="fa fa-check-square-o"></i></span>').appendTo(this.uiElement),t('<span class="red-ui-checkboxSet-option hide"><i class="fa fa-minus-square-o"></i></span>').appendTo(this.uiElement)],e?this.options[1].show():this.options[0].show(),this.element.change(function(){this Line: 50 -  "-submenu")}}else n.appendTo("#"+e+"-submenu")},removeItem:function(e){$("#"+e).parent().remove()},setAction:function(e,t){var n=d[e];n&&(n.onselect=t)}}}(),RED.panels={create:function(i){var s=i.container||$("#"+i.id),r=s.children();if(2!==r.length)throw new Error("Container must have exactly two children");s.addClass("red-ui-panels");var d,l,e=$('<div class="red-ui-panels-separator"></div>').insertAfter(r[0]),c=[],o=!1;return e.draggable({axis:"y",containment:s,scroll:!1,start:function(e,t){s.height(),d=t.position.top,c=[$(r[0]).height(),$(r[1]).height()]},drag:function(e,t){var n=s.height(),o=t.position.top-d,a=[c[0]+o,c[1]-o];$(r[0]).height(a[0]),$(r[1]).height(a[1]),i.resize&&i.resize(a[0],a[1]),t.position.top-=o,l=a[0]/n},stop:function(e,t){o=!0}}),{resize:function(e){var t=[$(r[0]).height(),$(r[1]).height()];if(s.height(e),o){var n=l*e;t=[n,e-n-48],$(r[0]).height(t[0]),$(r[1]).height(t[1])}i.resize&&i.resize(t[0],t[1])}}}},RED.popover=function(){var g={default:{top:10,leftRight:17,leftLeft:25},small:{top:5,leftRight:17,leftLeft:16}};return{create:function(e){var s=e.target,r=e.direction||"right",t=e.trigger,d=e.content,n=e.delay,o=e.autoClose,l=e.width||"auto",c=e.size||"default";if(!g[c])throw new Error("Invalid RED.popover size value:",c);var p,u,a=null,i=function(e){if(p){u=$('<div class="red-ui-popover red-ui-popover-'+r+'"></div>').appendTo("body"),"default"!==c&&u.addClass("red-ui-popover-size-"+c),"function"==typeof d?d.call(h).appendTo(u):u.html(d),"auto"!==l&&u.width(l);var t=s.offset(),n=s.width(),o=s.height(),a=u.height(),i=u.width();"right"===r?u.css({top:t.top+o/2-a/2-g[c].top,left:t.left+n+g[c].leftRight}):"left"===r&&u.css({top:t.top+o/2-a/2-g[c].top,left:t.left-g[c].leftLeft-i}),e?u.show():u.fadeIn("fast")}},f=function(e){p||u&&(e?$(this).remove():u.fadeOut("fast",function(){$(this).remove()}),u=null)};"hover"===t?(s.on("mouseenter",function(e){clearTimeout(a),p=!0,a=setTimeout(i,n.show)}),s.on("mouseleave",function(e){a&&clearTimeout(a),p=!1,setTimeout(f,n.hide)})):"click"===t?s.click(function(e){e.preventDefault(),e.stopPropagation(),(p=!p)?i():f()}):o Line: 51 -  function(){p=!1,f()},o);var h={setContent:function(e){return d=e,h},open:function(e){return p=!0,i(e),h},close:function(e){return p=!1,f(e),h}};return h}}}(),function(n){n.widget("nodered.searchBox",{_create:function(){var t=this;this.currentTimeout=null,this.lastSent="",this.element.val(""),this.uiContainer=this.element.wrap("<div>").parent(),this.uiContainer.addClass("red-ui-searchBox-container"),n('<i class="fa fa-search"></i>').prependTo(this.uiContainer),this.clearButton=n('<a href="#"><i class="fa fa-times"></i></a>').appendTo(this.uiContainer),this.clearButton.on("click",function(e){e.preventDefault(),t.element.val(""),t._change("",!0),t.element.focus()}),this.resultCount=n("<span>",{class:"red-ui-searchBox-resultCount hide"}).appendTo(this.uiContainer),this.element.val(""),this.element.on("keydown",function(e){27===e.keyCode&&t.element.val("")}),this.element.on("keyup",function(e){t._change(n(this).val())}),this.element.on("focus",function(){n("body").one("mousedown",function(){t.element.blur()})})},_change:function(e,t){var n=!1;""===e?(this.clearButton.hide(),n=!0):(this.clearButton.show(),n=e.length>=(this.options.minimumLength||0));var o=this.element.val();if(n=n&&o!==this.lastSent)if(!t&&0<this.options.delay){clearTimeout(this.currentTimeout);var a=this;this.currentTimeout=setTimeout(function(){a.lastSent=a.element.val(),a._trigger("change")},this.options.delay)}else this._trigger("change")},value:function(e){if(void 0===e)return this.element.val();this.element.val(e),this._change(e)},count:function(e){null==e||""===e?this.resultCount.text("").hide():this.resultCount.text(e).show()},change:function(){this._trigger("change")}})}(jQuery),RED.tabs={create:function(d){var i,o,a,l={},s=0,c=d.element||$("#"+d.id),r=c.wrap("<div>").parent(),p=c.wrap("<div>").parent();function t(e,t){if(e.preventDefault(),!$(this).hasClass("disabled")){var n=p.scrollLeft();p.animate({scrollLeft:t},100);var o=setInterval(function(){var e=p.scrollLeft();e!==n?(n=e,p.animate({scrollLeft:t},100)):clearInterval(o)},100);$(this).one("mouseup",function(){clearInterval(o)})}}function u(){return d Line: 52 -  nclick(l[$(this).attr("href").slice(1)]),g($(this)),!1}function f(){if(0!==c.children().length){var e=p.scrollLeft(),t=p.width(),n=c.width();0===e?o.hide():o.show(),e===n-t?a.hide():a.show()}}function h(){return d.ondblclick&&d.ondblclick(l[$(this).attr("href").slice(1)]),!1}function g(e){if("string"==typeof e&&(e=c.find("a[href='#"+e+"']")),0!==e.length&&!e.parent().hasClass("active")){if(c.children().removeClass("active"),c.children().css({transition:"width 100ms"}),e.parent().addClass("active"),d.scrollable){var t=e.parent().position().left;t-21<0?p.animate({scrollLeft:"+="+(t-50)},300):t+120>p.width()&&p.animate({scrollLeft:"+="+(t+140-p.width())},300)}d.onchange&&d.onchange(l[e.attr("href").slice(1)]),v(),setTimeout(function(){c.children().css({transition:""})},100)}}function v(){if(!d.vertical){var e=c.find("li.red-ui-tab"),t=r.width(),n=e.size(),o=(t-12-6*n)/n;if(s=(i=100*o/t+"%")+"%",d.scrollable){o=Math.max(o,140),i=o+"px",s=0;var a=Math.max(r.width(),12+(o+6)*n);c.width(a),f()}else d.hasOwnProperty("minimumActiveTabWidth")&&(o<d.minimumActiveTabWidth?(n-=1,o=(t-12-d.minimumActiveTabWidth-6*n)/n,i=100*o/t+"%",s=d.minimumActiveTabWidth+"px"):s=0);e.css({width:i}),o<50?(c.find(".red-ui-tab-close").hide(),c.find(".red-ui-tab-icon").hide(),c.find(".red-ui-tab-label").css({paddingLeft:Math.min(12,Math.max(0,o-38))+"px"})):(c.find(".red-ui-tab-close").show(),c.find(".red-ui-tab-icon").show(),c.find(".red-ui-tab-label").css({paddingLeft:""})),0!==s&&(c.find("li.red-ui-tab.active").css({width:d.minimumActiveTabWidth}),c.find("li.red-ui-tab.active .red-ui-tab-close").show(),c.find("li.red-ui-tab.active .red-ui-tab-icon").show(),c.find("li.red-ui-tab.active .red-ui-tab-label").css({paddingLeft:""}))}}function m(e){var t=c.find("a[href='#"+e+"']").parent();if(t.hasClass("active")){var n=t.prev();0===n.size()&&(n=t.next()),g(n.find("a"))}t.remove(),d.onremove&&d.onremove(l[e]),delete l[e],v()}return r.addClass("red-ui-tabs"),d.vertical&&r.addClass("red-ui-tabs-vertical"),d.addButton&&"function"==typeof d.addButton&&(r.addClass("red-ui-tabs-add"),$('<div class="red-ui-tab-button"> Line: 53 -  i class="fa fa-plus"></i></a></div>').appendTo(r).find("a").click(function(e){e.preventDefault(),d.addButton()})),d.scrollable&&(r.addClass("red-ui-tabs-scrollable"),p.addClass("red-ui-tabs-scroll-container"),p.scroll(f),(o=$('<div class="red-ui-tab-button red-ui-tab-scroll red-ui-tab-scroll-left"><a href="#" style="display:none;"><i class="fa fa-caret-left"></i></a></div>').appendTo(r).find("a")).on("mousedown",function(e){t(e,"-=150")}).on("click",function(e){e.preventDefault()}),(a=$('<div class="red-ui-tab-button red-ui-tab-scroll red-ui-tab-scroll-right"><a href="#" style="display:none;"><i class="fa fa-caret-right"></i></a></div>').appendTo(r).find("a")).on("mousedown",function(e){t(e,"+=150")}).on("click",function(e){e.preventDefault()})),c.children().first().addClass("active"),c.children().addClass("red-ui-tab"),c.find("li.red-ui-tab a").on("click",u).on("dblclick",h),setTimeout(function(){v()},0),{addTab:function(t){l[t.id]=t;var n=$("<li/>",{class:"red-ui-tab"}).appendTo(c);n.attr("id","red-ui-tab-"+t.id.replace(".","-")),n.data("tabId",t.id);var e=$("<a/>",{href:"#"+t.id,class:"red-ui-tab-label"}).appendTo(n);if(t.icon&&$('<img src="'+t.icon+'" class="red-ui-tab-icon"/>').appendTo(e),$("<span/>",{class:"bidiAware"}).text(t.label).appendTo(e).attr("dir",RED.text.bidi.resolveBaseTextDir(t.label)),e.on("click",u),e.on("dblclick",h),t.closeable){var o=$("<a/>",{href:"#",class:"red-ui-tab-close"}).appendTo(n);o.append('<i class="fa fa-times" />'),o.on("click",function(e){e.preventDefault(),m(t.id)})}if(v(),d.onadd&&d.onadd(t),e.attr("title",t.label),1==c.find("li.red-ui-tab").size()&&g(e),d.onreorder){var a,i,s,r=[];n.draggable({axis:"x",distance:20,start:function(e,t){a=[],r=[],c.children().each(function(e){r[e]={el:$(this),text:$(this).text(),left:$(this).position().left,width:$(this).width()},$(this).is(n)&&(s=i=e),a.push($(this).data("tabId"))}),c.children().each(function(e){e!==i&&$(this).css({position:"absolute",left:r[e].left+"px",width:r[e].width+2,transition:"left 0.3s"})}),n.hasClass("active")||n.css({zIndex:1})},drag:function(e,t){t.position.left+=r[i].left+p. Line: 61 -  (n);n.i18n(),l=null;var s=[{text:RED._("common.label.cancel"),click:function(){r.close()}},{id:"node-dialog-confirm-deploy-review",text:RED._("deploy.confirm.button.review"),class:"primary disabled",click:function(){$("#node-dialog-confirm-deploy-review").hasClass("disabled")||(RED.diff.showRemoteDiff(),r.close())}},{id:"node-dialog-confirm-deploy-merge",text:RED._("deploy.confirm.button.merge"),class:"primary disabled",click:function(){$("#node-dialog-confirm-deploy-merge").hasClass("disabled")||(RED.diff.mergeDiff(l),r.close())}}];t&&s.push({id:"node-dialog-confirm-deploy-overwrite",text:RED._("deploy.confirm.button.overwrite"),class:"primary",click:function(){E(!0,t),r.close()}});var r=RED.notify(n,{modal:!0,fixed:!0,width:600,buttons:s}),d=Date.now();RED.diff.getRemoteDiff(function(e){var t=Math.max(1e3-(Date.now()-d),0);l=e,setTimeout(function(){o.hide(),0===Object.keys(e.conflicts).length?(a.show(),$("#node-dialog-confirm-deploy-merge").removeClass("disabled")):i.show(),$("#node-dialog-confirm-deploy-review").removeClass("disabled")},t)})}function D(e){if(5<e.length){var t=e.length-5;(e=e.slice(0,5)).push(RED._("deploy.confirm.plusNMore",{count:t}))}return e}function E(e,t){if(!$("#btn-deploy").hasClass("disabled")){if(!RED.user.hasPermission("flows.write"))return void RED.notify(RED._("user.errors.deploy"),"error");if(!e){var n,o=!1,a=!1,i=[],s=[];RED.nodes.eachNode(function(e){o=o||!e.valid,e.valid||s.push(b(e)),"unknown"===e.type&&-1==i.indexOf(e.name)&&i.push(e.name)}),n=0<i.length;var r=[];RED.nodes.eachConfig(function(e){0===e.users.length&&!1!==e._def.hasUsers&&(r.push(b(e)),a=!0)});var d,l,c=!1,p=[];if(n&&!g.unknown?(c=!0,d="<p>"+RED._("deploy.confirm.unknown")+'</p><ul class="node-dialog-configm-deploy-list"><li>'+D(i).join("</li><li>")+"</li></ul><p>"+RED._("deploy.confirm.confirm")+"</p>",p=[{id:"node-dialog-confirm-deploy-deploy",text:RED._("deploy.confirm.button.confirm"),class:"primary",click:function(){E(!0),l.close()}}]):o&&!g.invalid&&(c=!0,s.sort(y),d="<p>"+RED._("deploy.confirm.improperlyConfigured")+'</p><ul class="node-dialog-configm-deploy-list"><li Line: 63 -  f));setTimeout(function(){$(".deploy-button-content").css("opacity",1),$(".deploy-button-spinner").hide(),$("#header-shade").hide(),$("#editor-shade").hide(),$("#palette-shade").hide(),$("#sidebar-shade").hide()},e)})}}return{init:function(e){var a,t=(e=e||{}).type||"default";if("default"==t)$('<li><span class="deploy-button-group button-group"><a id="btn-deploy" class="deploy-button disabled" href="#"><span class="deploy-button-content"><img id="btn-deploy-icon" src="red/images/deploy-full-o.png"> <span>'+RED._("deploy.deploy")+'</span></span><span class="deploy-button-spinner hide"><img src="red/images/spin.svg"/></span></a><a id="btn-deploy-options" data-toggle="dropdown" class="deploy-button" href="#"><i class="fa fa-caret-down"></i></a></span></li>').prependTo(".header-toolbar"),RED.menu.init({id:"btn-deploy-options",options:[{id:"deploymenu-item-full",toggle:"deploy-type",icon:"red/images/deploy-full.png",label:RED._("deploy.full"),sublabel:RED._("deploy.fullDesc"),selected:!0,onselect:function(e){e&&i("full")}},{id:"deploymenu-item-flow",toggle:"deploy-type",icon:"red/images/deploy-flows.png",label:RED._("deploy.modifiedFlows"),sublabel:RED._("deploy.modifiedFlowsDesc"),onselect:function(e){e&&i("flows")}},{id:"deploymenu-item-node",toggle:"deploy-type",icon:"red/images/deploy-nodes.png",label:RED._("deploy.modifiedNodes"),sublabel:RED._("deploy.modifiedNodesDesc"),onselect:function(e){e&&i("nodes")}}]});else if("simple"==t){var n=e.label||RED._("deploy.deploy"),o="red/images/deploy-full-o.png";e.hasOwnProperty("icon")&&(o=e.icon),$('<li><span class="deploy-button-group button-group"><a id="btn-deploy" class="deploy-button disabled" href="#"><span class="deploy-button-content">'+(o?'<img id="btn-deploy-icon" src="'+o+'"> ':"")+"<span>"+n+'</span></span><span class="deploy-button-spinner hide"><img src="red/images/spin.svg"/></span></a></span></li>').prependTo(".header-toolbar")}$("#btn-deploy").click(function(e){e.preventDefault(),E()}),RED.actions.add("core:deploy-flows",E),RED.events.on("nodes:change",function(e){e.dirty?(window.onbeforeunload=function(){return RED._( Line: 76 -  de-diff-toolbar"><span><span id="node-diff-toolbar-resolved-conflicts"></span></span> </div>').prependTo(t),$('<div class="node-diff-container"></div>').appendTo(t)),o=R(n,a,i);o.list.hide(),s?($("#node-diff-view-diff-merge").show(),0===Object.keys(r).length?$("#node-diff-view-diff-merge").removeClass("disabled"):$("#node-diff-view-diff-merge").addClass("disabled")):$("#node-diff-view-diff-merge").hide(),x(a),setTimeout(function(){o.finish(),o.list.show()},300),$("#sidebar-shade").show()},close:function(){c=!1,$("#sidebar-shade").hide()},show:function(){}};"merge"===i.mode&&e.buttons.push({id:"node-diff-view-diff-merge",text:RED._("deploy.confirm.button.merge"),class:"primary disabled",click:function(){$("#node-diff-view-diff-merge").hasClass("disabled")||(x(a),o(a),RED.tray.close())}});RED.tray.show(e)}(e,{mode:"merge"})}function d(e){var t=[],n={},o={},a=[],i={};return e.forEach(function(e){"tab"===(i[e.id]=e).type?(t.push(e.id),n[e.id]={n:e,nodes:[]}):"subflow"===e.type&&(o[e.id]={n:e,nodes:[]})}),e.forEach(function(e){"tab"!==e.type&&"subflow"!==e.type&&(n[e.z]?n[e.z].nodes.push(e):o[e.z]?o[e.z].nodes.push(e):a.push(e))}),{all:i,tabOrder:t,tabs:n,subflows:o,globals:a}}function T(e,t){var n=d(e),o=d(t),a={},i={},s={},r={};return Object.keys(n.all).forEach(function(e){RED.nodes.workspace(e)||RED.nodes.subflow(e)||RED.nodes.node(e);o.all.hasOwnProperty(e)?JSON.stringify(n.all[e])!==JSON.stringify(o.all[e])&&(s[e]=!0,n.all[e].z!==o.all[e].z&&(r[e]=!0)):i[e]=!0}),Object.keys(o.all).forEach(function(e){n.all.hasOwnProperty(e)||(a[e]=!0)}),{currentConfig:n,newConfig:o,added:a,deleted:i,changed:s,moved:r}}function k(e,t){var n,o,a={},i={},s={localDiff:e,remoteDiff:t,conflicts:a,resolutions:i},r={};for(n in e.currentConfig.all)if(e.currentConfig.all.hasOwnProperty(n)){r[n]=!0;var d=e.newConfig.all[n];if(e.changed[n]&&t.deleted[n])a[n]=!0;else if(e.deleted[n]&&t.changed[n])a[n]=!0;else if(e.changed[n]&&t.changed[n]){var l=t.newConfig.all[n];JSON.stringify(d)!==JSON.stringify(l)&&(a[n]=!0)}a[n]||(t.added[n]||t.changed[n]||t.deleted[n]?i[n]="remote":i[n]="local")}for(n in e.added)e.ad Line: 80 -  ({dataType:"json",url:r}).then(function(e){d[2].resolve(e)}).fail(function(){d[2].resolve({content:"[]"})}),$.when.apply($,d).always(function(e,t,n){var o,a,i;if(e)try{o=JSON.parse(e.content||"[]")}catch(e){return console.log("Common Version doesn't contain valid JSON:",p),void console.log(e)}try{a=JSON.parse(t.content||"[]")}catch(e){return console.log("Old Version doesn't contain valid JSON:",u),void console.log(e)}o||(o=a);try{i=JSON.parse(n.content||"[]")}catch(e){return console.log("New Version doesn't contain valid JSON:",i),void console.log(e)}var s=T(o,a),r=T(o,i);E.currentDiff=k(s,r);var d=R(l,E.currentDiff,{title:c,mode:E.commonRev?"merge":"view",oldRevTitle:E.oldRevTitle,newRevTitle:E.newRevTitle});d.list.hide(),x(E.currentDiff),setTimeout(function(){d.finish(),d.list.show()},300)})}else if(t){var f=$('<tr class="node-text-diff-header">').appendTo(m),h=$('<td colspan="3"></td>').appendTo(f);$("<span></span>").text("Cannot show binary file contents").appendTo(h)}else E.unmerged&&(b=$('<span style="float: right;"><span>'+w+"</span> of <span>"+y+"</span> conflicts resolved</span>").appendTo(a)),e.forEach(function(u){var e=$('<tr class="node-text-diff-header">').appendTo(m),t=$('<td colspan="3"></td>').appendTo(e),f=($("<span></span>").text(u.header).appendTo(t),u.conflict),h=u.localStartLine,g=u.remoteStartLine;f&&y++,u.lines.forEach(function(e,t){var n,o=u.diffStart+t,a=f&&/^\+\+(<<<<<<<|=======$|>>>>>>>)/.test(e),i=$("<tr>").appendTo(m),s=$('<td class="lineno">').appendTo(i);a?s.attr("colspan",2):n=$('<td class="lineno">').appendTo(i);var r=$('<td class="linetext">').appendTo(i),d=1;if(f&&(d=2),a){if(i.addClass("mergeHeader"),/^\+\+=======$/.test(e))u.changeSeparator=o,i.addClass("mergeHeader-separator");else{var l=/^..<<<<<<</.test(e);l?($("<span>").text("<<<<<<< Local Changes").appendTo(r),u.localChangeStart=o):(u.remoteChangeEnd=o,$("<span>").text(">>>>>>> Remote Changes").appendTo(r)),i.addClass("mergeHeader-"+(l?"ours":"theirs")),$('<button class="editor-button editor-button-small" style="float: right; margin-right: 20px;"><i class="fa fa-angle-double-'+(l?"down Line: 86 -  ttings-tab-keyboard-filter" type="text" data-i18n="[placeholder]keyboard.filterActions"></div><div class="keyboard-shortcut-entry-key" data-i18n="keyboard.shortcut"></div><div class="keyboard-shortcut-entry-scope" data-i18n="keyboard.scope"></div></div>').appendTo(e),e.find("input").searchBox({delay:100,change:function(){var t=$(this).val().trim();""===t?n.editableList("filter",null):(t=t.replace(/\s/g,""),n.editableList("filter",function(e){return-1<e.id.toLowerCase().replace(/^.*:/,"").replace("-","").indexOf(t)}))}});var n=$('<ol class="keyboard-shortcut-list"></ol>').css({position:"absolute",top:"32px",bottom:"0",left:"0",right:"0"}).appendTo(e).editableList({addButton:!1,scrollOnAdd:!1,addItem:function(e,t,n){v(e,n)}}),t=RED.actions.list();return t.sort(function(e,t){var n=e.id.replace(/^.*:/,"").replace(/[ -]/g,"").toLowerCase(),o=t.id.replace(/^.*:/,"").replace(/[ -]/g,"").toLowerCase();return n.localeCompare(o)}),t.forEach(function(e){n.editableList("addItem",e)}),e}return{init:function(){!function(){if("localStorage"in window&&null!==window.localStorage){var e=localStorage.getItem("keymap");if(null!==e){localStorage.removeItem("keymap");var t=RED.settings.get("editor")||{};t.keymap=JSON.parse(e),RED.settings.set("editor",t)}}}();var s=(RED.settings.get("editor")||{}).keymap||{};$.getJSON("red/keymap.json",function(e){for(var t in e)if(e.hasOwnProperty(t)){var n=e[t];for(var o in n)n.hasOwnProperty(o)&&(s.hasOwnProperty(n[o])||c(t,o,n[o],!1),d[n[o]]={scope:t,key:o,user:!1})}for(var a in s)if(s.hasOwnProperty(a)){var i=s[a];i.hasOwnProperty("key")&&c(i.scope,i.key,a,!0)}}),RED.userSettings.add({id:"keyboard",title:RED._("keyboard.keyboard"),get:e,focus:function(){setTimeout(function(){$("#user-settings-tab-keyboard-filter").focus()},200)}})},add:c,remove:o,getShortcut:function(e){return u[e]},revertToDefault:function(e){var t=u[e];if(t&&o(t.key),d.hasOwnProperty(e)){var n=d[e];c(n.scope,n.key,e,!1)}},formatKey:function(e){var t=n?e.replace(/ctrl-?/,"&#8984;"):e;return'<span class="help-key-block"><span class="help-key">'+(t=(t=(t=(t=(t=(t=n?t.replace(/alt-?/,"&#8997;"): Line: 91 -  Link(d),o.links=[d],w(),s.portType===H&&0<n.outputs?Z([{node:n,port:0,portType:H}]):s.portType===W&&0<n.inputs?Z([{node:n,port:0,portType:W}]):ge()}else w(),ge()}else 0<n.outputs?Z([{node:n,port:0,portType:H}]):0<n.inputs?Z([{node:n,port:0,portType:W}]):ge();RED.history.push(o),RED.nodes.add(n),RED.editor.validateNode(n),RED.nodes.dirty(!0),ae(),n.selected=!0,F.push({n:n}),X(),se(),_e()}}}),X(),se(),_e()}0!==G||d3.event.metaKey||d3.event.ctrlKey||b||(l=d3.mouse(this),q=x.append("rect").attr("ox",l[0]).attr("oy",l[1]).attr("rx",1).attr("ry",1).attr("x",l[0]).attr("y",l[1]).attr("width",0).attr("height",0).attr("class","lasso"),d3.event.preventDefault())}).on("mouseup",a).on("touchend",function(){clearTimeout(b),b=null,RED.touch.radialMenu.active()||(q&&e.attr("fill","#fff"),a.call(this))}).on("touchcancel",a).on("touchstart",function(){var e;if(1<d3.event.touches.length){clearTimeout(b),b=null,d3.event.preventDefault(),e=d3.event.touches.item(0);var t=d3.event.touches.item(1),n=e.pageY-t.pageY,o=e.pageX-t.pageX,a=$("#chart").offset(),i=[$("#chart").scrollLeft(),$("#chart").scrollTop()];m=[(t.pageX+o/2-a.left+i[0])/c,(t.pageY+n/2-a.top+i[1])/c],[t.pageX+o/2,t.pageY+n/2],v=Math.sqrt(n*n+o*o)}else{var s=d3.select(document.body),r=[(e=d3.event.touches.item(0)).pageX,e.pageY];m=[e.pageX,e.pageY],v=0;d3.touches(this)[0];b=setTimeout(function(){b=null,ke(s,r)},g)}}).on("touchmove",function(){var e;if(RED.touch.radialMenu.active())d3.event.preventDefault();else if(d3.event.touches.length<2){if(b){var t=(e=d3.event.touches.item(0)).pageX-m[0],n=e.pageY-m[1];64<Math.abs(t*t+n*n)&&(clearTimeout(b),b=null)}else q&&d3.event.preventDefault();Q.call(this)}else{e=d3.event.touches.item(0);var o=d3.event.touches.item(1),a=e.pageY-o.pageY,i=e.pageX-o.pageX,s=($("#chart").offset(),[$("#chart").scrollLeft(),$("#chart").scrollTop()]),r=Math.sqrt(a*a+i*i),d=[o.pageX+i/2,o.pageY+a/2];if(!isNaN(r)){oldScaleFactor=c,c=Math.min(2,Math.max(.3,c+Math.floor(100*r-100*v)/1e4));var l=[m[0]*(c-oldScaleFactor),m[1]*(c-oldScaleFactor)];v=r,d,$("#chart").scrollLeft(s[0]+l[0]),$("#chart").scrollTop(s[1]+l[1]),_e() Line: 94 -  .max(p.n.y+p.n.h/2+5,R);if(0!==D||0!==E)for(e=0;e<F.length;e++)(p=F[e]).n.x-=D,p.n.y-=E;if($!==C||R!==j)for(e=0;e<F.length;e++)(p=F[e]).n.x-=$-C,p.n.y-=R-j;if(N!=d3.event.shiftKey&&0<F.length){var T=[0,0];if(p=F[0],T[0]=p.n.x-(P*Math.floor((p.n.x-p.n.w/2)/P)+p.n.w/2),T[1]=p.n.y-P*Math.floor(p.n.y/P),0!==T[0]||0!==T[1])for(e=0;e<F.length;e++)(p=F[e]).n.x-=T[0],p.n.y-=T[1],p.n.x==p.n.ox&&p.n.y==p.n.oy&&(p.dirty=!1)}G!=RED.state.MOVING_ACTIVE&&G!=RED.state.IMPORT_DRAGGING||1!==F.length||(p=F[0],I&&(_||(_=setTimeout(function(){var e=[],t=1/0,n=null,o=p.n.x,a=p.n.y;if(K[0][0].getIntersectionList){var i=K[0][0].createSVGRect();i.x=o,i.y=a,i.width=1,i.height=1,e=K[0][0].getIntersectionList(i,K[0][0])}else e=RED.view.getLinksAtPoint(o,a);for(var s=0;s<e.length;s++)if(d3.select(e[s]).classed("link_background"))for(var r=e[s].getTotalLength(),d=0;d<r;d+=10){var l=e[s].getPointAtLength(d),c=(l.x-o)*(l.x-o)+(l.y-a)*(l.y-a);c<200&&c<t&&(t=c,n=e[s])}k&&k!==n&&d3.select(k.parentNode).classed("link_splice",!1),n?d3.select(n.parentNode).classed("link_splice",!0):d3.select(".link_splice").classed("link_splice",!1),k=n,_=null},100))))}0!==G&&_e()}}function a(){var e,t;if(G!==RED.state.QUICK_JOINING){if(z&&G==RED.state.JOINING){var n=[];for(e=0;e<Y.length;e++)Y[e].link&&n.push(Y[e].link);t={t:"delete",links:n,dirty:RED.nodes.dirty()},RED.history.push(t),w()}if(q){var o=parseInt(q.attr("x")),a=parseInt(q.attr("y")),i=o+parseInt(q.attr("width")),s=a+parseInt(q.attr("height"));d3.event.ctrlKey||ae(),RED.nodes.eachNode(function(e){e.z!=RED.workspaces.active()||e.selected||(e.selected=e.x>o&&e.x<i&&e.y>a&&e.y<s,e.selected&&(e.dirty=!0,F.push({n:e})))}),D&&(D.in.forEach(function(e){e.selected=e.x>o&&e.x<i&&e.y>a&&e.y<s,e.selected&&(e.dirty=!0,F.push({n:e}))}),D.out.forEach(function(e){e.selected=e.x>o&&e.x<i&&e.y>a&&e.y<s,e.selected&&(e.dirty=!0,F.push({n:e}))})),se(),q.remove(),q=null}else G!=RED.state.DEFAULT||null!=f||d3.event.ctrlKey||d3.event.metaKey||(ae(),se());if(G==RED.state.MOVING_ACTIVE&&0<F.length){for(var r=[],d=0;d<F.length;d++){var l=F[d];l.ox===l.n.x&&l.oy===l.n.y||(r.push({n:l.n,ox:l.o Line: 97 -  document.body.removeChild(a),[n+i,o+s]}function ge(){G=0,k=M=f=h=z=null,I=!1,d3.select(".link_splice").classed("link_splice",!1),_&&(clearTimeout(_),_=null)}function ve(e){17!==e.keyCode&&"Meta"!==e.key&&91!==e.keyCode||(ge(),w(),_e(),$(window).off("keyup",ve))}function me(e,t,n){z=e,M=t,B=n||0,G!==RED.state.QUICK_JOINING&&(G=RED.state.JOINING,document.body.style.cursor="crosshair",(d3.event.ctrlKey||d3.event.metaKey)&&(G=RED.state.QUICK_JOINING,Z([{node:z,port:B,portType:M}]),$(window).on("keyup",ve))),d3.event.stopPropagation(),d3.event.preventDefault()}function be(e,o,a){var t;if(!(G===RED.state.QUICK_JOINING&&0<Y.length&&Y[0].node===e)&&(document.body.style.cursor="",G==RED.state.JOINING||G==RED.state.QUICK_JOINING)){"undefined"!=typeof TouchEvent&&d3.event instanceof TouchEvent?RED.nodes.eachNode(function(e){if(e.z==RED.workspaces.active()){var t=e.w/2,n=e.h/2;e.x-t<U[0]&&e.x+t>U[0]&&e.y-n<U[1]&&e.y+n>U[1]&&(o=0<(h=e).inputs?W:H,a=0)}}):h=e;var n=[],i=[];for(t=0;t<Y.length;t++)Y[t].link&&i.push(Y[t].link);for(t=0;t<Y.length;t++)if(o!=Y[t].portType&&h!==Y[t].node){var s,r,d,l=Y[t];if(l.portType===H?(s=l.node,d=l.port,r=h):l.portType===W&&(s=h,r=l.node,d=a),!(0!==RED.nodes.filterLinks({source:s,target:r,sourcePort:d}).length)){var c={source:s,sourcePort:d,target:r};RED.nodes.addLink(c),n.push(c)}}if(0<n.length||0<i.length){var p={t:"add",links:n,removedLinks:i,dirty:RED.nodes.dirty()};if(D){var u=RED.subflow.refresh(!0);u&&(p.subflow={id:D.id,changed:D.changed,instances:u.instances})}RED.history.push(p),X(),RED.nodes.dirty(!0)}if(G===RED.state.QUICK_JOINING)return 0<n.length&&(w(),o===W&&0<e.outputs?Z([{node:e,port:0,portType:H}]):o===H&&0<e.inputs?Z([{node:e,port:0,portType:W}]):ge()),void _e();ge(),w(),A=null,_e()}}var ye=null,we=null;function De(l,c,p,u){clearTimeout(ye);var e=G!=RED.state.JOINING||0<Y.length&&Y[0].portType!==p;e&&(p===W&&(c._def&&c._def.inputLabels||c.inputLabels)||p===H&&(c._def&&c._def.outputLabels||c.outputLabels))&&(ye=setTimeout(function(){var e=function(t,n,e){var o,a=n===W?t.inputLabels:t.outputLabels;if(a&&a[e])return a[e];var i=n===W?t._def.inp Line: 100 -  ss","node subflowoutput").attr("transform",function(e){return"translate("+(e.x-20)+","+(e.y-20)+")"});t.each(function(e,t){e.w=40,e.h=40}),t.append("rect").attr("class","subflowport").attr("rx",8).attr("ry",8).attr("width",40).attr("height",40).on("mouseup",$e).on("mousedown",Re).on("touchstart",function(e){var t=d3.select(this),n=d3.event.touches.item(0),o=[n.pageX,n.pageY];m=[n.pageX,n.pageY],v=0,b=setTimeout(function(){ke(t,o)},g),Re.call(this,e)}).on("touchend",function(e){clearTimeout(b),b=null,RED.touch.radialMenu.active()?d3.event.stopPropagation():$e.call(this,e)}),t.append("g").attr("transform","translate(-5,15)").append("rect").attr("class","port").attr("rx",3).attr("ry",3).attr("width",10).attr("height",10).on("mousedown",function(e,t){me(e,W,0)}).on("touchstart",function(e,t){me(e,W,0)}).on("mouseup",function(e,t){be(e,W,0)}).on("touchend",function(e,t){be(e,W,0)}).on("mouseover",function(e){De(d3.select(this),e,W,0)}).on("mouseout",function(e){Ee(d3.select(this))}),t.append("svg:text").attr("class","port_label").attr("x",20).attr("y",8).style("font-size","10px").text("output"),t.append("svg:text").attr("class","port_label port_index").attr("x",20).attr("y",24).text(function(e,t){return t+1});var n=x.selectAll(".subflowinput").data(D.in,function(e,t){return e.id});n.exit().remove();var o=n.enter().insert("svg:g").attr("class","node subflowinput").attr("transform",function(e){return"translate("+(e.x-20)+","+(e.y-20)+")"});o.each(function(e,t){e.w=40,e.h=40}),o.append("rect").attr("class","subflowport").attr("rx",8).attr("ry",8).attr("width",40).attr("height",40).on("mouseup",$e).on("mousedown",Re).on("touchstart",function(e){var t=d3.select(this),n=d3.event.touches.item(0),o=[n.pageX,n.pageY];m=[n.pageX,n.pageY],v=0,b=setTimeout(function(){ke(t,o)},g),Re.call(this,e)}).on("touchend",function(e){clearTimeout(b),b=null,RED.touch.radialMenu.active()?d3.event.stopPropagation():$e.call(this,e)}),o.append("g").attr("transform","translate(35,15)").append("rect").attr("class","port").attr("rx",3).attr("ry",3).attr("width",10).attr("height",10).on("mousedown",function(e,t){ Line: 102 -  "node_right_button":"node_left_button")});r.append("rect").attr("rx",5).attr("ry",5).attr("width",32).attr("height",L-4).attr("fill","#eee"),r.append("rect").attr("class","node_button_button").attr("x",function(e){return"right"==e._def.align?11:5}).attr("y",4).attr("rx",4).attr("ry",4).attr("width",16).attr("height",L-12).attr("fill",function(e){return e._def.color}).attr("cursor","pointer").on("mousedown",function(e){!q&&xe(e)&&(Ce(),d3.select(this).attr("fill-opacity",.2),d3.event.preventDefault(),d3.event.stopPropagation())}).on("mouseup",function(e){!q&&xe(e)&&(d3.select(this).attr("fill-opacity",.4),d3.event.preventDefault(),d3.event.stopPropagation())}).on("mouseover",function(e){!q&&xe(e)&&d3.select(this).attr("fill-opacity",.4)}).on("mouseout",function(e){if(!q&&xe(e)){var t=1;e._def.button.toggle&&(t=e[e._def.button.toggle]?1:.2),d3.select(this).attr("fill-opacity",t)}}).on("click",Te).on("touchstart",Te)}n.append("rect").attr("class","node").classed("node_unknown",function(e){return"unknown"==e.type}).attr("rx",5).attr("ry",5).attr("fill",function(e){return e._def.color}).on("mouseup",$e).on("mousedown",Re).on("touchstart",function(e){var t=d3.select(this),n=d3.event.touches.item(0),o=[n.pageX,n.pageY];m=[n.pageX,n.pageY],v=0,b=setTimeout(function(){ke(t,o)},g),Re.call(this,e)}).on("touchend",function(e){clearTimeout(b),b=null,RED.touch.radialMenu.active()?d3.event.stopPropagation():$e.call(this,e)}).on("mouseover",function(e){0===G&&d3.select(this).classed("node_hovered",!0)}).on("mouseout",function(e){d3.select(this).classed("node_hovered",!1)});if(e._def.icon){var d=RED.utils.getNodeIcon(e._def,e),l=n.append("g").attr("class","node_icon_group").attr("x",0).attr("y",0),c=(l.append("rect").attr("x",0).attr("y",0).attr("class","node_icon_shade").attr("width","30").attr("stroke","none").attr("fill","#000").attr("fill-opacity","0.05").attr("height",function(e){return Math.min(50,e.h-4)}),l.append("image").attr("xlink:href",d).attr("class","node_icon").attr("x",0).attr("width","30").attr("height","30")),p=l.append("path").attr("d",function(e){return"M 30 1 l 0 "+(e.h-2 Line: 106 -  selectAll(".node_status_label").text("")}else i.selectAll(".node_status_group").style("display","none");e.dirty=!1}var g,v,m,b,y});var i=x.selectAll(".link").data(d,function(e){return e.source.id+":"+e.sourcePort+":"+e.target.id+":"+e.target.i});i.enter().insert("g",".node").attr("class","link").each(function(e,t){var n=d3.select(this);e.added=!0,n.append("svg:path").attr("class","link_background link_path").on("mousedown",function(e){f=e,ae(),A=f,se(),_e(),Ce(),d3.event.stopPropagation()}).on("touchstart",function(e){f=e,ae(),A=f,se(),_e(),Ce(),d3.event.stopPropagation();var t=d3.select(document.body),n=d3.event.touches.item(0),o=[n.pageX,n.pageY];b=setTimeout(function(){b=null,ke(t,o)},g)}),n.append("svg:path").attr("class","link_outline link_path"),n.append("svg:path").attr("class","link_line link_path").classed("link_link",function(e){return e.link}).classed("link_subflow",function(e){return!e.link&&D})}),i.exit().remove(),x.selectAll(".link_path").each(function(e){var t=d3.select(this);(e.added||e===A||e.selected||w[e.source.id]||w[e.target.id])&&t.attr("d",function(e){var t=-((e.source.outputs||1)-1)/2*13+13*(e.sourcePort||0),n=e.target.y-(e.source.y+t),o=e.target.x-e.target.w/2-(e.source.x+e.source.w/2),a=Math.sqrt(n*n+o*o),i=S,s=0;return a<O&&(i=.75-(O-a)/O*.75),o<0&&(i+=Math.min(5*O,Math.abs(o))/(5*O)*2,Math.abs(n)<3*L&&(s=(0<n?.5:-.5)*((3*L-Math.abs(n))/(3*L))*(Math.min(O,Math.abs(o))/O))),e.x1=e.source.x+e.source.w/2,e.y1=e.source.y+t,e.x2=e.target.x-e.target.w/2,e.y2=e.target.y,"M "+e.x1+" "+e.y1+" C "+(e.x1+i*O)+" "+(e.y1+s*L)+" "+(e.x2-i*O)+" "+(e.y2-s*L)+" "+e.x2+" "+e.y2})}),i.classed("link_selected",function(e){return e===A||e.selected}),i.classed("link_unknown",function(e){return delete e.added,"unknown"==e.target.type||"unknown"==e.source.type});var s=x.selectAll(".link_flow_link_g").data(l,function(e){return e.node.id+":"+e.refresh});s.enter().insert("g",".node").attr("class","link_flow_link_g").each(function(n,e){var t=d3.select(this),a=1,i="start";"link in"===n.node.type&&(a=-1,i="end");var s=30*a,r=20*a,o=(t.append("svg:path").attr("class","link_flow_li Line: 110 -  ==e?RED.userSettings.toggle("view-snap-grid"):(N=e,_e())}),RED.actions.add("core:toggle-status",function(e){void 0===e?RED.userSettings.toggle("view-node-status"):(E=e,RED.nodes.eachNode(function(e){e.dirty=!0}),_e())}),RED.actions.add("core:move-selection-up",function(){le(0,-1)}),RED.actions.add("core:step-selection-up",function(){le(0,-20)}),RED.actions.add("core:move-selection-right",function(){le(1,0)}),RED.actions.add("core:step-selection-right",function(){le(20,0)}),RED.actions.add("core:move-selection-down",function(){le(0,1)}),RED.actions.add("core:step-selection-down",function(){le(0,20)}),RED.actions.add("core:move-selection-left",function(){le(-1,0)}),RED.actions.add("core:step-selection-left",function(){le(-20,0)})},state:function(e){if(null==e)return G;G=e},redraw:function(e){e&&(X(),se()),_e()},focus:Ce,importNodes:je,calculateTextWidth:fe,select:function(e){if(void 0!==e&&(ae(),"string"==typeof e)){var t=RED.nodes.node(e);t&&(t.selected=!0,t.dirty=!0,F=[{n:t}])}se(),_e()},selection:function(){var e={};return 0<F.length&&(e.nodes=F.map(function(e){return e.n})),null!=A&&(e.link=A),e},scale:function(){return c},getLinksAtPoint:function(e,t){for(var n=[],o=K.selectAll(".link_background")[0],a=0;a<o.length;a++){var i=o[a].getBBox();e>=i.x&&t>=i.y&&e<=i.x+i.width&&t<=i.y+i.height&&n.push(o[a])}return n},reveal:function(e){if(RED.nodes.workspace(e)||RED.nodes.subflow(e))RED.workspaces.show(e);else{var t=RED.nodes.node(e);if("config"!==t._def.category&&t.z){t.highlighted=!0,t.dirty=!0,RED.workspaces.show(t.z);var n=[$("#chart").width(),$("#chart").height()],o=[$("#chart").scrollLeft(),$("#chart").scrollTop()];if(t.x<o[0]||t.y<o[1]||t.x>n[0]+o[0]||t.y>n[1]+o[1]){var a="-="+(o[0]-t.x+n[0]/2),i="-="+(o[1]-t.y+n[1]/2);$("#chart").animate({scrollLeft:a,scrollTop:i},200)}if(!t._flashing){t._flashing=!0;var s=22,r=function(){s--,t.dirty=!0,0<=s?(t.highlighted=!t.highlighted,setTimeout(r,100)):(t.highlighted=!1,delete t._flashing),RED.view.redraw()};r()}}else"config"===t._def.category&&RED.sidebar.config.show(e)}},gridSize:function(e){if(void 0===e)return P;P=Math.max(5,e),t Line: 114 -  e="palette_port palette_port_output",i.appendChild(l)}if(0<n.inputs){var c=document.createElement("div");c.className="palette_port palette_port_input",i.appendChild(c)}if(0===$("#palette-base-category-"+a).length)if(-1!==x.indexOf(a))k(a,RED._("node-red:palette.label."+a,{defaultValue:a}));else{var p=n.set.id;k(a,RED._(p+":palette.label."+a,{defaultValue:a}))}$("#palette-container-"+a).show(),0===$("#palette-"+o).length&&$("#palette-base-category-"+a).append('<div id="palette-'+o+'"></div>'),$("#palette-"+o).append(i),i.onmousedown=function(e){e.preventDefault()};var u=RED.popover.create({target:$(i),trigger:"hover",width:"300px",content:"hi",delay:{show:750,hide:50}});$(i).data("popover",u),$(i).click(function(){var e;RED.view.focus(),e=0===t.indexOf("subflow:")?marked(RED.nodes.subflow(t.substring(8)).info||"")||'<span class="node-info-none">'+RED._("sidebar.info.none")+"</span>":$("script[data-help-name='"+i.type+"']").html()||'<span class="node-info-none">'+RED._("sidebar.info.none")+"</span>",RED.sidebar.info.set(e,RED._("sidebar.info.nodeHelp"))});var f,h,g,v,m,b,y=$("#chart"),w=y.offset(),D=$("#chart>svg").get(0);$(i).draggable({helper:"clone",appendTo:"body",revert:!0,revertDuration:50,containment:"#main-container",start:function(){m=$("#palette").width(),b=$("#palette").parent().position().top+$("#palette-container").position().top,RED.view.focus()},stop:function(){d3.select(".link_splice").classed("link_splice",!1),v&&(clearTimeout(v),v=null)},drag:function(e,l){l.position.left+=17.5,0<n.inputs&&0<n.outputs&&(h=l.position.left-m+l.helper.width()/2-w.left+y.scrollLeft(),g=l.position.top-b+l.helper.height()/2-w.top+y.scrollTop(),v||(v=setTimeout(function(){var e=[],t=1/0,n=null;if(D.getIntersectionList){var o=D.createSVGRect();o.x=h,o.y=g,o.width=1,o.height=1,e=D.getIntersectionList(o,D),h/=RED.view.scale(),g/=RED.view.scale()}else h/=RED.view.scale(),g/=RED.view.scale(),e=RED.view.getLinksAtPoint(h,g);for(var a=0;a<e.length;a++)if(d3.select(e[a]).classed("link_background"))for(var i=e[a].getTotalLength(),s=0;s<i;s+=10){var r=e[a].getPointAtLength(s),d=(r.x-h)*(r.x-h) Line: 119 -  e._def.info){k.title.html(RED._("sidebar.info.nodeHelp"));var E=e._def.info,R="function"==typeof E?E.call(e):E;D+=marked(R)}D&&C(D),$(".node-info-property-header").click(function(e){e.preventDefault(),_.property=!_.property,$(this).toggleClass("expanded",_.property),$(".node-info-property-row").toggle(_.property)})}}else j()}function C(e){var t,n=(t=$('<div class="node-help"><span class="bidiAware" dir="'+RED.text.bidi.resolveBaseTextDir(e)+'">'+e+"</span></div>"),$(t).find("a").each(function(e){var t=$(this).attr("href");/^https?:/.test(t)&&$(this).attr("target","_blank")}),t).appendTo(k.content);n.find(".bidiAware").contents().filter(function(){return 3===this.nodeType&&""!==this.textContent.trim()}).wrap("<span></span>");n.find("H3").wrapInner('<a class="node-info-header expanded" href="#"></a>').find("a").prepend('<i class="fa fa-angle-right">').click(function(e){e.preventDefault();for(var t=$(this).hasClass("expanded"),n=$(this).parent().next();1===n.length&&"H3"!==n[0].nodeName;)n.toggle(!t),n=n.next();$(this).toggleClass("expanded",!t)})}var s=function(){var a,i,t=!0,s=15e3,r=-1;function e(){for(var e,t=Math.floor(Math.random()*r),n=RED._("infotips:info.tip"+t);e=/({{(.*?)}})/.exec(n);){var o=RED.keyboard.getShortcut(e[2]);if(!o)return;n=n.replace(e[1],RED.keyboard.formatKey(o.key))}for(;e=/(\[(.*?)\])/.exec(n);)n=n.replace(e[1],RED.keyboard.formatKey(e[2]));l.html(n).fadeIn(200),a&&(a=null,i=setInterval(d,s))}function d(){l.fadeOut(300,function(){e()})}function n(){if($(".sidebar-node-info").addClass("show-tips"),t&&!a&&!i){if(-1===r)for(;r++,RED._("infotips:info.tip"+r)!=="infotips:info.tip"+r;);a=setTimeout(e,1e3)}}function o(){$(".sidebar-node-info").removeClass("show-tips"),clearInterval(i),clearTimeout(a),a=i=null}return RED.actions.add("core:toggle-show-tips",function(e){void 0===e?RED.userSettings.toggle("view-show-tips"):(t=e)?n():o()}),{start:n,stop:o,next:function(){clearInterval(i),a=!0,e()},enabled:function(){return t}}}();function j(e){if(void 0===e&&(e=RED.view.selection()),e.nodes)if(1==e.nodes.length){var t=e.nodes[0];"subflow"===t.type&&t.direction?i( Line: 123 -  ("#workspace-config-node-filter-unused").on("click",function(e){e.preventDefault(),r||($(this).addClass("selected"),$("#workspace-config-node-filter-all").removeClass("selected"),r=!r,n())})},show:function(r){"boolean"==typeof r&&(r?$("#workspace-config-node-filter-unused").click():$("#workspace-config-node-filter-all").click()),n(),"string"==typeof r&&($("#workspace-config-node-filter-all").click(),r=r.replace(/\./g,"-"),setTimeout(function(){var e=$(".palette_node_id_"+r),t=e.position().top,n=e.height(),o=$(".sidebar-node-config"),a=o.height();a<t+n?o.animate({scrollTop:"-="+(a-(t+n)-30)},150):t<0&&o.animate({scrollTop:"+="+(t-10)},150);var i=21,s=function(){i%2==0?e.removeClass("node_highlighted"):e.addClass("node_highlighted"),0<=--i&&setTimeout(s,100)};s()},100)),RED.sidebar.show("config")},refresh:n}}(),RED.palette.editor=function(){var c,p,u,m,f,i,h=[],g=[],w={},b={},y={},t={},v="";function s(e,t){var n=Date.now()-e;n=n<300?300:0,setTimeout(function(){t()},n)}function D(e,t,o,a){o.show();var i=Date.now();$.ajax({url:"nodes/"+e,type:"PUT",data:JSON.stringify({enabled:t}),contentType:"application/json; charset=utf-8"}).done(function(e,t,n){s(i,function(){o.hide(),a()})}).fail(function(e,t,n){s(i,function(){o.hide(),a(e)})})}function E(e,t,o){var n={module:e};t&&(n.version=t),$.ajax({url:"nodes",type:"POST",data:JSON.stringify(n),contentType:"application/json; charset=utf-8"}).done(function(e,t,n){o()}).fail(function(e,t,n){o(e)})}function R(e){t.hasOwnProperty(e)||(t[e]=setTimeout(function(){delete t[e],n(e)},100))}function x(e){var t=/^rgba?\(\s*(\d+),\s*(\d+),\s*(\d+)[,)]/.exec(e);if(t){var n=parseInt(t[1]),o=parseInt(t[2]),a=parseInt(t[3]);if(160<(299*n+587*o+114*a)/1e3)return"rgb("+(n=Math.floor(.8*n))+","+(o=Math.floor(.8*o))+","+(a=Math.floor(.8*a))+")"}return e}function n(e){if(y.hasOwnProperty(e)){var t=y[e].info,n=y[e].elements;if(n){var o=0,a=0,i=0;for(var s in n.errorList.empty(),y[e].totalUseCount=0,y[e].setUseCount={},t.sets)if(t.sets.hasOwnProperty(s)){var r=0,d=t.sets[s],l=n.sets[s];d.err&&(i++,$("<li>").text(d.err).appendTo(n.errorList)),d.enabled&&(o+=d. Line: 125 -  modules&&(o.modules.forEach(function(e){(w[e.id]=e).index=[e.id],e.keywords&&(e.index=e.index.concat(e.keywords)),e.updated_at?e.timestamp=new Date(e.updated_at).getTime():e.timestamp=0,e.index=e.index.join(",").toLowerCase()}),h=h.concat(o.modules)),u.searchBox("count",h.length)),1<i&&$(".palette-module-shade-status").html(RED._("palette.editor.loading")+"<br>"+d.length+"/"+i),d.length===i){l&&RED.notify(RED._("palette.editor.errors.catalogLoadFailed",{url:t}),"error",!1,8e3);var a=250-(Date.now()-r);setTimeout(function(){$("#palette-module-install-shade").hide()},Math.max(a,0))}}function _(){if(0===h.length){h=[],w={},f.editableList("empty"),$(".palette-module-shade-status").html(RED._("palette.editor.loading"));var e=RED.settings.theme("palette.catalogues")||["https://catalogue.nodered.org/catalogue.json"];l=!(d=[]),i=e.length,1<e.length&&$(".palette-module-shade-status").html(RED._("palette.editor.loading")+"<br>0/"+e.length),$("#palette-module-install-shade").show(),r=Date.now();var t=0;e.forEach(function(o,e){$.getJSON(o,{_:(new Date).getTime()},function(e){a(null,o,0,e),function(){for(var e in y)y.hasOwnProperty(e)&&n(e)}()}).fail(function(e,t,n){a(e,o)}).always(function(){++t===i&&u.searchBox("change")})})}}function C(){if(f.editableList("empty"),""!==u.searchBox("value").trim()){g.sort(k);for(var e=0;e<Math.min(10,g.length);e++)f.editableList("addItem",g[e]);0===g.length&&f.editableList("addItem",{}),10<g.length&&f.editableList("addItem",{start:10,more:g.length-10})}else f.editableList("addItem",{count:h.length})}function j(e,t){return e.info.id.localeCompare(t.info.id)}function S(e,t){return-1*(e.info.timestamp-t.info.timestamp)}function e(){return _(),c.activateTab("nodes"),T}function O(n,e,o){if(!1!==RED.settings.theme("palette.editable")){var t=[{text:RED._("common.label.cancel"),click:function(){a.close()}}];n.url&&t.push({text:RED._("palette.editor.confirm.button.review"),class:"primary palette-module-install-confirm-button-install",click:function(){var e=n.url||"";window.open(e)}}),t.push({text:RED._("palette.editor.confirm.button.install"),class:"primary pale Line: 131 -  -shade-status"></div><img src="red/images/spin.svg" class="palette-spinner"/></div>').appendTo(o)}(),RED.userSettings.add({id:"palette",title:RED._("palette.editor.palette"),get:e,close:function(){T.detach()},focus:function(){c.resize(),setTimeout(function(){p.focus()},200)}}),RED.actions.add("core:manage-palette",function(){RED.userSettings.show("palette")}),RED.events.on("registry:module-updated",function(e){R(e.module)}),RED.events.on("registry:node-set-enabled",function(e){R(e.module)}),RED.events.on("registry:node-set-disabled",function(e){R(e.module)}),RED.events.on("registry:node-type-added",function(e){/^subflow:/.test(e)||R(RED.nodes.registry.getNodeSetForType(e).module)}),RED.events.on("registry:node-type-removed",function(e){/^subflow:/.test(e)||R(RED.nodes.registry.getNodeSetForType(e).module)}),RED.events.on("registry:node-set-added",function(e){R(e.module);for(var t=0;t<g.length;t++)if(g[t].info.id===e.module){var n=g[t].elements.installButton;n.addClass("disabled"),n.html(RED._("palette.editor.installed"));break}}),RED.events.on("registry:node-set-removed",function(e){if(!RED.nodes.registry.getModule(e.module)){var t=y[e.module];if(t){m.editableList("removeItem",t),delete y[e.module];for(var n=0;n<g.length;n++)if(g[n].info.id===e.module){var o=g[n].elements.installButton;o.removeClass("disabled"),o.html(RED._("palette.editor.install"));break}}}}),RED.events.on("nodes:add",function(e){/^subflow:/.test(e.type)||(b[e.type]=(b[e.type]||0)+1,1===b[e.type]&&R(RED.nodes.registry.getNodeSetForType(e.type).module))}),RED.events.on("nodes:remove",function(e){b.hasOwnProperty(e.type)&&(b[e.type]--,0===b[e.type]&&(delete b[e.type],R(RED.nodes.registry.getNodeSetForType(e.type).module)))}))},install:O}}(),RED.editor=function(){var c=[],p={};function _(e){var t,n,o,a=e.valid,i=e.changed;if(e.valid=!0,0===e.type.indexOf("subflow:"))n=(t=RED.nodes.subflow(e.type.substring(8))).valid,o=t.changed,void 0===n&&(n=_(t),o=t.changed),e.valid=n&&u(e,e._def.defaults,e),e.changed=e.changed||o;else if(e._def)e.valid=u(e,e._def.defaults,e),e._def._creds&&(e.valid=e.valid&&u(e,e._def.crede Line: 140 -  e.log("Definition error: "+s.type+".sort",e)}d.forEach(function(e){i.append('<option value="'+e.id+'"'+(t==e.id?" selected":"")+">"+RED.text.bidi.enforceTextDirectionWithUCC(e.__label__)+"</option>"),delete e.__label__}),i.append('<option value="_ADD_"'+(""===t?" selected":"")+">"+RED._("editor.addNewType",{type:n})+"</option>"),window.setTimeout(function(){i.change()},50)}}}var O={};return{init:function(){RED.tray.init(),RED.actions.add("core:confirm-edit-tray",function(){$("#node-dialog-ok").click(),$("#node-config-dialog-ok").click()}),RED.actions.add("core:cancel-edit-tray",function(){$("#node-dialog-cancel").click(),$("#node-config-dialog-cancel").click()})},edit:function(d){var x,T,k=d;c.push(d),RED.view.state(RED.state.EDITING);var l=d.type;"subflow:"==d.type.substring(0,8)&&(l="subflow");var e={title:y(),buttons:[{id:"node-dialog-delete",class:"leftButton",text:RED._("common.label.delete"),click:function(){var e=RED.nodes.dirty(),t=[],n=[],o=RED.nodes.remove(k.id);t.push(k);var a={t:"delete",nodes:t=t.concat(o.nodes),links:n=n.concat(o.links),changes:{},dirty:e};RED.nodes.dirty(!0),RED.view.redraw(!0),RED.history.push(a),RED.tray.close()}},{id:"node-dialog-cancel",text:RED._("common.label.cancel"),click:function(){if(k._def){if(k._def.oneditcancel)try{k._def.oneditcancel.call(k)}catch(e){console.log("oneditcancel",k.id,k.type,e.toString())}for(var e in k._def.defaults)if(k._def.defaults.hasOwnProperty(e)){var t=k._def.defaults[e];if(t.type){var n=RED.nodes.getType(t.type);if(n&&n.exclusive){var o=$("#node-input-"+e).val()||"";""===o||k[e]||RED.nodes.remove(o)}}}}RED.tray.close()}},{id:"node-dialog-ok",text:RED._("common.label.done"),class:"primary",click:function(){var e,t,n,o={},a=!1,i=RED.nodes.dirty();if(k._def.oneditsave){var s={};for(e in k._def.defaults)k._def.defaults.hasOwnProperty(e)&&("string"==typeof k[e]||"number"==typeof k[e]?s[e]=k[e]:s[e]=$.extend(!0,{},{v:k[e]}).v);try{!0===k._def.oneditsave.call(k)&&(a=!0)}catch(e){console.log("oneditsave",k.id,k.type,e.toString())}for(e in k._def.defaults)k._def.defaults.hasOwnProperty(e)&&(null===s[e]||"string"==typ Line: 146 -  tor.errors.invalid-msg",{message:e.toString()}))}try{var s,r=t.evaluate(i?{msg:e}:e);if(a)return void f.setValue(RED._("expressionEditor.errors.context-unsupported"),-1);s=void 0!==r?JSON.stringify(r,null,4):RED._("expressionEditor.noMatch"),f.setValue(s,-1)}catch(e){f.setValue(RED._("expressionEditor.errors.eval",{message:e.message}),-1)}};d.getSession().on("change",function(){clearTimeout(n),n=setTimeout(a,200),O[i]=d.getValue()}),u.getSession().on("change",function(){clearTimeout(n),n=setTimeout(a,200)}),f=RED.editor.createEditor({id:"node-input-expression-test-result",value:"",mode:"ace/mode/json",lineNumbers:!1,readOnly:!0}),s=RED.panels.create({id:"node-input-expression-panels",resize:function(e,t){var n=$("#node-input-expression-panel-expr");e-=$(n.children()[0]).outerHeight(!0);var o=$(n.children()[1]);e-=parseInt(o.css("marginTop"))+parseInt(o.css("marginBottom")),$("#node-input-expression").css("height",e-5+"px"),u.resize(),t-=$("#node-input-expression-panel-info > .form-row > div:first-child").outerHeight(!0)+20,$(".node-input-expression-tab-content").height(t),$("#node-input-expression-test-data").css("height",t-5+"px"),d.resize(),$("#node-input-expression-test-result").css("height",t-5+"px"),f.resize()}}),$("#node-input-example-reformat").click(function(e){e.preventDefault();var t=d.getValue()||"";try{t=JSON.stringify(JSON.parse(t),null,4)}catch(e){}d.getSession().setValue(t||"",-1)}),a()},close:function(){c.pop(),u.destroy(),d.destroy()},show:function(){}};RED.tray.show(h)},editJSON:function(n){var a,o,i=n.value,e=n.complete;c.push({type:"_json"}),RED.view.state(RED.state.EDITING);var s=function(){var e=a.getValue();try{return JSON.parse(e),$("#node-dialog-ok").removeClass("disabled"),!0}catch(e){return $("#node-dialog-ok").addClass("disabled"),!1}},t={title:n.title||y(),width:"inherit",buttons:[{id:"node-dialog-cancel",text:RED._("common.label.cancel"),click:function(){RED.tray.close()}},{id:"node-dialog-ok",text:RED._("common.label.done"),class:"primary",click:function(){n.requireValid&&!s()||(e(a.getValue()),RED.tray.close())}}],resize:function(e){p._json=e.w Line: 147 -  =$("#dialog-form>div:not(.node-text-editor-row)"),n=($("#dialog-form>div.node-text-editor-row"),$("#dialog-form").height()),o=0;o<t.size();o++)n-=$(t[o]).outerHeight(!0);n-=parseInt($("#dialog-form").css("marginTop"))+parseInt($("#dialog-form").css("marginBottom")),$(".node-text-editor").css("height",n+"px"),a.resize()},open:function(e){e.find(".editor-tray-body");var t=w(e.find(".editor-tray-body"),"dialog-form","_json","editor");(a=RED.editor.createEditor({id:"node-input-json",value:"",mode:"ace/mode/json"})).getSession().setValue(i||"",-1),n.requireValid&&(a.getSession().on("change",function(){clearTimeout(o),o=setTimeout(s,200)}),s()),$("#node-input-json-reformat").click(function(e){e.preventDefault();var t=a.getValue()||"";try{t=JSON.stringify(JSON.parse(t),null,4)}catch(e){}a.getSession().setValue(t||"",-1)}),t.i18n()},close:function(){c.pop(),a.destroy()},show:function(){}};RED.tray.show(t)},editMarkdown:function(n){var a,o=n.value,e=n.complete,i="_markdown";c.push({type:i}),RED.view.state(RED.state.EDITING);var t={title:n.title||y(),width:"inherit",buttons:[{id:"node-dialog-cancel",text:RED._("common.label.cancel"),click:function(){RED.tray.close()}},{id:"node-dialog-ok",text:RED._("common.label.done"),class:"primary",click:function(){e(a.getValue()),RED.tray.close()}}],resize:function(e){p[i]=e.width;for(var t=$("#dialog-form>div:not(.node-text-editor-row)"),n=($("#dialog-form>div.node-text-editor-row"),$("#dialog-form").height()),o=0;o<t.size();o++)n-=$(t[o]).outerHeight(!0);n-=parseInt($("#dialog-form").css("marginTop"))+parseInt($("#dialog-form").css("marginBottom")),$(".node-text-editor").css("height",n+"px"),a.resize()},open:function(e){e.find(".editor-tray-body");var t=w(e.find(".editor-tray-body"),"dialog-form",i,"editor");a=RED.editor.createEditor({id:"node-input-markdown",value:o,mode:"ace/mode/markdown"}),n.header&&n.header.appendTo(e.find("#node-input-markdown-title")),t.i18n()},close:function(){c.pop(),a.destroy()},show:function(){}};RED.tray.show(t)},editBuffer:function(e){var i=e.value,t=e.complete,s="_buffer";c.push({type:s}),RED.view.state(RED.state.E Line: 148 -  d,l=[],n={title:y(),width:"inherit",buttons:[{id:"node-dialog-cancel",text:RED._("common.label.cancel"),click:function(){RED.tray.close()}},{id:"node-dialog-ok",text:RED._("common.label.done"),class:"primary",click:function(){t(JSON.stringify(r)),RED.tray.close()}}],resize:function(e){e&&(p[s]=e.width);var t=$("#dialog-form").height();d&&d.resize(t)},open:function(e){e.find(".editor-tray-body");var t,n=w(e.find(".editor-tray-body"),"dialog-form",s,"editor");(l=RED.editor.createEditor({id:"node-input-buffer-str",value:"",mode:"ace/mode/text"})).getSession().setValue(i||"",-1),bufferBinEditor=RED.editor.createEditor({id:"node-input-buffer-bin",value:"",mode:"ace/mode/text",readOnly:!0});var o=function(e){var t=!0,n="string"==typeof e,o=[],a=0,i=(r=n?function(e){var t=[],n=0,o=e.length;for(n=0;n<o;n++){var a=e.charCodeAt(n);a<128?t.push(a):(a<2048?t.push(192|a>>6):(a<55296||57344<=a?t.push(224|a>>12):(n++,a=65536+((1023&a)<<10|1023&e.charAt(n)),t.push(240|a>>18),t.push(128|a>>12&63)),t.push(128|a>>6&63)),t.push(128|63&a))}return t}(e):e).length;for(a=0;a<i;a++){var s=parseInt(r[a]);if(!n&&(isNaN(s)||s<0||255<s)){t=!1;break}0<a&&(a%8==0?a%16==0?o.push("\n"):o.push("  "):o.push(" ")),o.push((s<16?"0":"")+s.toString(16).toUpperCase())}return t&&($("#node-input-buffer-type-string").toggle(n),$("#node-input-buffer-type-array").toggle(!n),bufferBinEditor.setValue(o.join(""),1)),t},a=function(){var e=l.getValue(),t=!1;if(/^[\s]*\[[\s\S]*\][\s]*$/.test(e)){t=!0;try{var n=JSON.parse(e);t=o(n)}catch(e){t=!1}}t||o(e)};l.getSession().on("change",function(){clearTimeout(t),t=setTimeout(a,200)}),a(),n.i18n(),d=RED.panels.create({id:"node-input-buffer-panels",resize:function(e,t){var n=$("#node-input-buffer-panel-str");e-=$(n.children()[0]).outerHeight(!0);var o=$(n.children()[1]);e-=parseInt(o.css("marginTop"))+parseInt(o.css("marginBottom")),$("#node-input-buffer-str").css("height",e-5+"px"),l.resize();var a=$("#node-input-buffer-panel-bin");o=$(a.children()[0]),t-=parseInt(o.css("marginTop"))+parseInt(o.css("marginBottom")),$("#node-input-buffer-bin").css("height",t-5+"px"),bufferBinEditor. Line: 149 -  ".node-input-buffer-type").click(function(e){e.preventDefault(),RED.sidebar.info.set(RED._("bufferEditor.modeDesc")),RED.sidebar.info.show()})},close:function(){c.pop(),l.destroy(),bufferBinEditor.destroy()},show:function(){}};RED.tray.show(n)},validateNode:_,updateNodeProperties:C,createEditor:function(e){var t=ace.edit(e.id||e.element);t.setTheme("ace/theme/tomorrow");var o=t.getSession();return o.on("changeAnnotation",function(){for(var e=o.getAnnotations()||[],t=e.length,n=e.length;t--;)/doctype first\. Expected/.test(e[t].text)?e.splice(t,1):/Unexpected End of file\. Expected/.test(e[t].text)&&e.splice(t,1);n>e.length&&o.setAnnotations(e)}),e.mode&&o.setMode(e.mode),e.foldStyle?o.setFoldStyle(e.foldStyle):o.setFoldStyle("markbeginend"),e.options?t.setOptions(e.options):t.setOptions({enableBasicAutocompletion:!0,enableSnippets:!0}),e.readOnly&&(t.setOption("readOnly",e.readOnly),t.container.classList.add("ace_read-only")),e.hasOwnProperty("lineNumbers")&&t.renderer.setOption("showGutter",e.lineNumbers),t.$blockScrolling=1/0,e.value&&o.setValue(e.value,-1),e.globals&&setTimeout(function(){o.$worker&&o.$worker.send("setOptions",[{globals:e.globals,esversion:6,sub:!0,asi:!0,maxerr:1e3}])},100),t}}}(),RED.tray=function(){var v=[],m=$("#editor-stack"),b=!1;function n(e){var n=$('<div class="editor-tray"></div>'),t=$('<div class="editor-tray-header"></div>').appendTo(n),o=$('<div class="editor-tray-body-wrapper"></div>').appendTo(n),a=$('<div class="editor-tray-body"></div>').appendTo(o),i=$('<div class="editor-tray-footer"></div>').appendTo(n),s=$('<div class="editor-tray-resize-handle"></div>').appendTo(n);if(e.title){var r=v.map(function(e){return e.options.title});r.push(e.title);var d='<ul class="editor-tray-breadcrumbs"><li>'+r.join("</li><li>")+"</li></ul>";$('<div class="editor-tray-titlebar">'+d+"</div>").appendTo(t)}e.width===1/0&&(e.maximized=!0,s.addClass("editor-tray-resize-maximised"));var l,c=$('<div class="editor-tray-toolbar"></div>').appendTo(t);if(e.buttons)for(var p=0;p<e.buttons.length;p++){var u=e.buttons[p],f=$("<button>").button().appendTo(c);u.id&&f.att Line: 150 -  .text&&f.html(u.text),u.click&&f.click(function(t){return function(e){$(this).hasClass("disabled")||t(e)}}(u.click)),u.class&&(f.addClass(u.class),"primary"===u.class&&(l=u))}n.appendTo(m);var h={tray:n,header:t,body:a,footer:i,options:e,primaryButton:l};function g(){$("#header-shade").show(),$("#editor-shade").show(),$("#palette-shade").show(),$(".sidebar-shade").show(),h.preferredWidth=Math.max(n.width(),500),e.maximized||a.css({minWidth:h.preferredWidth-40}),e.width?(e.width>$("#editor-stack").position().left-8&&(e.width=$("#editor-stack").position().left-8),n.width(e.width)):n.width(h.preferredWidth),h.width=n.width(),h.width>$("#editor-stack").position().left-8&&(h.width=Math.max(0,$("#editor-stack").position().left-8),n.width(h.width)),n.css({right:-(n.width()+10)+"px",transition:"right 0.25s ease"}),$("#workspace").scrollLeft(0),y(),b=!0,setTimeout(function(){setTimeout(function(){e.width||n.width(Math.min(h.preferredWidth,$("#editor-stack").position().left-8)),e.resize&&e.resize({width:n.width()}),e.show&&e.show(),setTimeout(function(){b=!1},200),a.find(":focusable:first").focus()},150),n.css({right:0})},0)}v.push(h),e.maximized||n.draggable({handle:s,axis:"x",start:function(e,t){n.width("auto")},drag:function(e,t){var n=m.position().left+t.position.left;n<7?t.position.left+=7-n:t.position.left>-h.preferredWidth-1&&(t.position.left=-Math.min(m.position().left-7,h.preferredWidth-1)),h.options.resize&&setTimeout(function(){h.options.resize({width:-t.position.left})},0),h.width=-t.position.left},stop:function(e,t){n.width(-t.position.left),n.css({left:""}),h.options.resize&&h.options.resize({width:-t.position.left}),h.width=-t.position.left}}),e.open?1===e.open.length?(e.open(n),g()):e.open(n,g):g()}function y(){if(0<v.length){var e=v[v.length-1],t=e.tray.height()-e.header.outerHeight()-e.footer.outerHeight();e.body.height(t),e.options.maximized||e.width>$("#editor-stack").position().left-8?(e.width=$("#editor-stack").position().left-8,e.tray.width(e.width)):e.width<e.preferredWidth&&(e.width=Math.min($("#editor-stack").position().left-8,e.preferredWidth),e.tray.width(e. Line: 151 -  ons.resize&&e.options.resize({width:e.width,height:t})}}return{init:function(){$(window).resize(y),RED.events.on("sidebar:resize",y),$("#editor-shade").click(function(){if(!b){var e=v[v.length-1];e&&e.primaryButton&&e.primaryButton.click()}})},show:function(e){if(0<v.length&&!e.overlay){var t=v[v.length-1];"inherit"===e.width&&(e.width=t.tray.width()),t.tray.css({right:-(t.tray.width()+10)+"px"}),setTimeout(function(){t.tray.detach(),n(e)},250)}else RED.events.emit("editor:open"),n(e)},close:function(t){if(0<v.length){var n=v.pop();n.tray.css({right:-(n.tray.width()+10)+"px"}),setTimeout(function(){if(n.options.close&&n.options.close(),n.tray.remove(),0<v.length){var e=v[v.length-1];e.options.overlay?(y(),e.options.show&&e.options.show()):(e.tray.appendTo("#editor-stack"),setTimeout(function(){y(),e.tray.css({right:0}),e.options.show&&e.options.show()},0))}t&&t(),0===v.length&&($("#header-shade").hide(),$("#editor-shade").hide(),$("#palette-shade").hide(),$(".sidebar-shade").hide(),RED.events.emit("editor:close"),RED.view.focus())},250)}}}}(),RED.clipboard=function(){var e,t,n,o,a=!1;function i(){var t=$("#clipboard-import"),n=t.val();n=n.substring(n.indexOf("["),n.lastIndexOf("]")+1);try{JSON.parse(n),t.removeClass("input-error"),t.val(n),$("#clipboard-dialog-ok").button("enable")}catch(e){""!==n&&t.addClass("input-error"),$("#clipboard-dialog-ok").button("disable")}}function s(){a||(t.empty(),t.append($(o)),t.i18n(),$("#clipboard-dialog-ok").show(),$("#clipboard-dialog-cancel").show(),$("#clipboard-dialog-close").hide(),$("#clipboard-dialog-copy").hide(),$("#clipboard-dialog-ok").button("disable"),$("#clipboard-import").keyup(i),$("#clipboard-import").on("paste",function(){setTimeout(i,10)}),$("#import-tab > a").click(function(e){e.preventDefault(),$(this).hasClass("disabled")||$(this).hasClass("selected")||($(this).parent().children().removeClass("selected"),$(this).addClass("selected"))}),e.dialog("option","title",RED._("clipboard.importNodes")).dialog("open"))}function r(){if(!a){t.empty(),t.append($(n)),t.i18n();var r=RED.settings.flowFilePretty?"export-format-full":"ex Line: 155 -  Default()}).on("dragleave",function(e){d()}).on("drop",function(e){if(-1!=$.inArray("text/plain",e.originalEvent.dataTransfer.types)){var t=e.originalEvent.dataTransfer.getData("text/plain");t=t.substring(t.indexOf("["),t.lastIndexOf("]")+1),RED.view.importNodes(t)}else if(-1!=$.inArray("Files",e.originalEvent.dataTransfer.types)){var n=e.originalEvent.dataTransfer.files;if(1===n.length){var o=n[0],a=new FileReader;a.onload=function(e){RED.view.importNodes(e.target.result)},a.readAsText(o)}}d(),e.preventDefault()})},import:s,export:r,copyText:function(e,t,n){var o=!1;"string"!=typeof e&&(e=JSON.stringify(e,function(e,t){return null!==t&&"object"==typeof t&&t.__encoded__&&t.hasOwnProperty("data")&&t.hasOwnProperty("length")?(o=t.data.length!==t.length,t.data):t})),o&&(n+="_truncated"),$("#clipboard-hidden").val(e).select();var a=document.execCommand("copy");if(a&&t){var i=RED.popover.create({target:t,direction:"left",size:"small",content:RED._(n)});setTimeout(function(){i.close()},1e3),i.open()}return a}}}(),RED.library=function(){var t,p="node-input-";function e(){$.getJSON("library/flows",function(e){var t,r=function(e,t){var n,o,a,i=document.createElement("ul");if(""===t&&(i.id="menu-item-import-library-submenu"),i.className="dropdown-menu",e.d)for(n in e.d)if(e.d.hasOwnProperty(n)){(o=document.createElement("li")).className="dropdown-submenu pull-left",(a=document.createElement("a")).href="#";var s=n.replace(/^@.*\//,"").replace(/^node-red-contrib-/,"").replace(/^node-red-node-/,"").replace(/-/," ").replace(/_/," ");a.innerHTML=s,o.appendChild(a),o.appendChild(r(e.d[n],t+(""!==t?"/":"")+n)),i.appendChild(o)}if(e.f)for(n in e.f)e.f.hasOwnProperty(n)&&(o=document.createElement("li"),(a=document.createElement("a")).href="#",a.innerHTML=e.f[n],a.flowName=t+(""!==t?"/":"")+e.f[n],a.onclick=function(){$.get("library/flows/"+this.flowName,function(e){RED.view.importNodes(e)})},o.appendChild(a),i.appendChild(o));return i};e.d&&e.d._examples_&&(t=e.d._examples_,delete e.d._examples_);var n=r(e,"");$("#menu-item-import-examples").remove(),t&&(RED.menu.addItem("menu-item-import",{id: Line: 160 -  endTo(v);e.id&&t.attr("id",e.id),e.class&&t.addClass(e.class)})}return $("#notifications").append(f),$(f).slideDown(300),f.close=(d=f,function(){d.closed||(d.closed=!0,y.splice(y.indexOf(d),1),a.id&&(delete b[a.id],0===Object.keys(b).length&&m.hide()),$(d).slideUp(300,function(){d.parentNode.removeChild(d)}),a.modal&&$("#full-shade").hide())}),f.hideNotification=(l=f,function(){l.closed||(l.hidden=!0,$(l).slideUp(300))}),f.showNotification=(c=f,function(){!c.closed&&c.hidden&&(c.hidden=!1,$(c).slideDown(300))}),f.update=(p=f,function(e,t){var n;if("string"==typeof e?(/<p>/i.test(e)||(e="<p>"+e+"</p>"),p.innerHTML=e):$(p).empty().append(e),"number"==typeof t)n=t;else if(void 0!==t&&(n=t.timeout,t.buttons)){var o=$('<div style="margin-top: 20px;" class="ui-dialog-buttonset"></div>').appendTo(p);t.buttons.forEach(function(e){var t=$("<button>").html(e.text).click(e.click).appendTo(o);e.id&&t.attr("id",e.id),e.class&&t.addClass(e.class)})}void 0!==n&&0<n?(window.clearTimeout(p.timeoutid),p.timeoutid=window.setTimeout(p.close,n)):window.clearTimeout(p.timeoutid),p.hidden&&p.showNotification()}),n||($(f).click((u=f,function(){u.close(),window.clearTimeout(u.timeoutid)})),f.timeoutid=window.setTimeout(f.close,o||5e3)),y.push(f),a.id&&(b[a.id]=f,m.show()),w+=1,f}return{init:function(){m=$('<li><a id="btn-notifications" class="button" href="#"><i class="fa fa-warning"></i></a></li>').prependTo(".header-toolbar").hide(),$("#btn-notifications").click(function(){!function(){for(var e in b)b.hasOwnProperty(e)&&b[e].showNotification()}()})},notify:RED.notify=e}}(),RED.search=function(){var n,d,e=!1,o=null,l=-1,t=!1,c={},p=[],u=[];function a(e){var t=RED.utils.getNodeLabel(e);t&&(t=(""+t).toLowerCase(),c[t]=c[t]||{},c[t][e.id]={node:e,label:t}),t=t||e.label||e.name||e.id||"";var n=["id","type","name","label","info"];e._def&&e._def.defaults&&(n=n.concat(Object.keys(e._def.defaults)));for(var o=0;o<n.length;o++)if(e.hasOwnProperty(n[o])){var a=e[n[o]];"string"!=typeof a&&"number"!=typeof a||(a=(""+a).toLowerCase(),c[a]=c[a]||{},c[a][e.id]={node:e,label:t})}}function i(){var e=d.find("li.selec Line: 163 -  h",class:"red-ui-search red-ui-type-search"}).appendTo("#main-container");var e=$("<div>",{class:"red-ui-search-container"}).appendTo(a);(r=$('<input type="text">').attr("placeholder",RED._("search.addNode")).appendTo(e).searchBox({delay:50,change:function(){var e;e=$(this).val(),s=e.toLowerCase(),d.editableList("filter"),d.editableList("sort"),setTimeout(function(){l=0,d.children().removeClass("selected"),d.children(":visible:first").addClass("selected")},100)}})).on("keydown",function(e){var t=d.children(":visible");if(0<t.length)if(40===e.keyCode)l<t.length-1&&(-1<l&&$(t[l]).removeClass("selected"),l++),$(t[l]).addClass("selected"),p(),e.preventDefault();else if(38===e.keyCode)0<l&&(l<t.length&&$(t[l]).removeClass("selected"),l--),$(t[l]).addClass("selected"),p(),e.preventDefault();else if(13===e.keyCode){var n=Math.max(0,l);n<t.length&&f($(t[n]).find(".red-ui-editableList-item-content").data("data"))}}),t=$("<div>",{class:"red-ui-search-results-container"}).appendTo(a),d=$("<ol>",{id:"search-result-list",style:"position: absolute;top: 0;bottom: 0;left: 0;right: 0;"}).appendTo(t).editableList({addButton:!1,filter:function(e){return""===s||!e.recent&&!e.common&&(""===s||-1<e.index.indexOf(s))},sort:function(e,t){if(""===s)return e.i-t.i;var n=e.index.indexOf(s),o=t.index.indexOf(s);return-1===n?1:-1===o?-1:n===o?m(e,t):n-o},addItem:function(e,t,n){var o=n.def;n.index=n.type.toLowerCase(),n.separator&&e.addClass("red-ui-search-result-separator");var a=$("<a>",{href:"#",class:"red-ui-search-result"}).appendTo(e),i=$("<div>",{class:"red-ui-search-result-node"}).appendTo(a),s=o.color,r=RED.utils.getNodeIcon(o);i.css("backgroundColor",s);var d=$("<div/>",{class:"palette_icon_container"}).appendTo(i);$("<div/>",{class:"palette_icon",style:"background-image: url("+r+")"}).appendTo(d),0<o.inputs&&$("<div/>",{class:"red-ui-search-result-node-port"}).appendTo(i),0<o.outputs&&$("<div/>",{class:"red-ui-search-result-node-port red-ui-search-result-node-output"}).appendTo(i);var l=$("<div>",{class:"red-ui-search-result-description"}).appendTo(a),c=n.label;n.index+="|"+c.toLowerCase(),$(" Line: 164 -  "red-ui-search-result-node-label"}).html(c).appendTo(l),a.click(function(e){e.preventDefault(),f(n)})},scrollOnAdd:!1})}function f(e){g(),c[e.type]=Date.now(),n(e.type)}function h(e){if(i){for(var t=$(e.target);"body"!==t.prop("nodeName").toLowerCase();){if("red-ui-type-search"===t.attr("id"))return;t=t.parent()}g(!0),o&&o()}}function g(e){i&&(RED.keyboard.remove("escape"),i=!1,null!==a&&t.slideUp(e?50:200,function(){a.hide(),r.searchBox("value","")}),RED.events.emit("type-search:close"),RED.view.focus(),$(document).off("mousedown.type-search"),$(document).off("mouseup.type-search"),$(document).off("click.type-search"))}function v(t,e){var n=t;if(void 0!==e.paletteLabel)try{n=("function"==typeof e.paletteLabel?e.paletteLabel.call(e):e.paletteLabel)||"",n+=" ("+t+")"}catch(e){console.log("Definition error: "+t+".paletteLabel",e)}return n}function m(e,t){var n=e.label.toLowerCase(),o=t.label.toLowerCase();return n<o?-1:n===o?0:1}return{show:function(e){i?(a.hide(),t.hide()):(RED.keyboard.add("*","escape",function(){g(),o&&o()}),null===a&&u(),i=!0,setTimeout(function(){$(document).on("mousedown.type-search",h),$(document).on("mouseup.type-search",h),$(document).on("click.type-search",h)},200)),function(){var e;d.editableList("empty"),r.searchBox("value",""),l=-1;var t=["inject","debug","function","change","switch"],n=Object.keys(c);n.sort(function(e,t){return c[t]-c[e]}),n=n.filter(function(e){return-1===t.indexOf(e)});var o=[];RED.nodes.registry.getNodeTypes().forEach(function(e){var t=RED.nodes.getType(e);"config"!==t.category&&"unknown"!==e&&"tab"!==e&&o.push({type:e,def:t,label:v(e,t)})}),o.sort(m);var a,i=0;for(e=0;e<t.length;e++){var s=RED.nodes.getType(t[e]);s&&((a={type:t[e],common:!0,def:s,i:i++}).label=v(a.type,a.def),e===t.length-1&&(a.separator=!0),d.editableList("addItem",a))}for(e=0;e<Math.min(5,n.length);e++)(a={type:n[e],def:RED.nodes.getType(n[e]),recent:!0,i:i++}).label=v(a.type,a.def),e===n.length-1&&(a.separator=!0),d.editableList("addItem",a);for(e=0;e<o.length;e++)o[e].i=i++,d.editableList("addItem",o[e]);setTimeout(function(){l=0,d.children(":first").addCl Line: 165 -  )},100)}(),n=e.add,closeCallback=e.close,RED.events.emit("type-search:open"),a.css({left:e.x+"px",top:e.y+"px"}).show(),t.slideDown(300),setTimeout(function(){t.find(".red-ui-editableList-container").scrollTop(0),r.focus()},100)},hide:g}}(),RED.subflow=function(){function d(e,t){var n={x:50,y:30};t||(n.x+=110);for(var o=0;o<e.out.length+e.in.length;o++){var a;(a=o<e.out.length?e.out[o]:e.in[o-e.out.length]).x==n.x&&a.y==n.y&&(n.x+=55,o=0)}return n}function s(){var t=RED.nodes.subflow(RED.workspaces.active());if(0!==t.in.length){var n=t.in[0],o=[];return RED.nodes.eachLink(function(e){"subflow"==e.source.type&&e.source.z==t.id&&e.source.i==n.i?o.push(e):e.target.type=="subflow:"+t.id&&o.push(e)}),o.forEach(function(e){RED.nodes.removeLink(e)}),t.in=[],$("#workspace-subflow-input-add").removeClass("active"),$("#workspace-subflow-input-remove").addClass("active"),t.changed=!0,{subflowInputs:[n],links:o}}}function r(e){var t=RED.nodes.subflow(RED.workspaces.active());if(0!==t.out.length){void 0===e&&(e=[t.out[t.out.length-1]]);var n=[];for(e.sort(function(e,t){return t.i-e.i}),i=0;i<e.length;i++){var o=e[i];t.out.splice(o.i,1);var a=[],s=[];RED.nodes.eachLink(function(e){"subflow"==e.target.type&&e.target.z==t.id&&e.target.i==o.i&&a.push(e),e.source.type=="subflow:"+t.id&&(e.sourcePort==o.i?a.push(e):e.sourcePort>o.i&&s.push(e))}),a.forEach(function(e){RED.nodes.removeLink(e)}),s.forEach(function(e){e.sourcePort--}),n=n.concat(a);for(var r=o.i;r<t.out.length;r++)t.out[r].i--,t.out[r].dirty=!0}return t.changed=!0,{subflowOutputs:e,links:n}}}function l(t){var n=RED.nodes.subflow(RED.workspaces.active());a(n);var o=[];if(n)return RED.nodes.filterNodes({type:"subflow:"+n.id}).forEach(function(e){for(o.push({id:e.id,changed:e.changed}),t&&(e.changed=!0),e.inputs=n.in.length,e.outputs=n.out.length;e.outputs<e.ports.length;)e.ports.pop();e.resize=!0,e.dirty=!0,RED.editor.updateNodeProperties(e)}),RED.editor.validateNode(n),{instances:o}}function a(e){e&&($("#workspace-subflow-input-add").toggleClass("active",0!==e.in.length),$("#workspace-subflow-input-remove").toggleClass("active",0=== Line: 169 -  get:n};o.push(t),RED.nodes.addLink(t)})}),t=0;t<n.length;t++)RED.nodes.removeLink(n[t]);for(t=0;t<e.nodes.length;t++)a=e.nodes[t],/^link /.test(a.type)&&(a.links=a.links.filter(function(e){var t=i.hasOwnProperty(e);if(!t){var n=RED.nodes.node(e);if(n&&n.links){var o=n.links.indexOf(a.id);-1<o&&n.links.splice(o,1)}}return t})),a.z=g.id;RED.history.push({t:"createSubflow",nodes:[v.id],links:o,subflow:{subflow:g},activeWorkspace:RED.workspaces.active(),removedLinks:n,dirty:RED.nodes.dirty()}),RED.view.select(null),RED.editor.validateNode(g),RED.nodes.dirty(!0),RED.view.redraw(!0)}}else RED.notify(RED._("subflow.errors.noNodesSelected"),"error")}return{init:function(){RED.events.on("workspace:change",function(e){var t=RED.nodes.subflow(e.workspace);t?n(t):($("#workspace-toolbar").hide().empty(),$("#chart").css({"margin-top":"0"}))}),RED.events.on("view:selection-changed",function(e){e.nodes?RED.menu.setDisabled("menu-item-subflow-convert",!1):RED.menu.setDisabled("menu-item-subflow-convert",!0)}),RED.actions.add("core:create-subflow",e),RED.actions.add("core:convert-to-subflow",t)},createSubflow:e,convertToSubflow:t,removeSubflow:o,refresh:l,removeInput:s,removeOutput:r}}(),RED.userSettings=function(){var t=700,n=!1,r=[];function e(e){r.push(e)}function o(s){if(!n)if(RED.user.hasPermission("settings.write")){n=!0;var e={title:RED._("menu.label.userSettings"),buttons:[{id:"node-dialog-ok",text:RED._("common.label.close"),class:"primary",click:function(){RED.tray.close()}}],resize:function(e){t=e.width},open:function(e){var t=e.find(".editor-tray-body"),n=$("<div></div>").appendTo(t),o=$("<div></div>",{id:"user-settings-tabs-container"}).appendTo(n);$("<ul></ul>",{id:"user-settings-tabs"}).appendTo(o);var a=RED.tabs.create({id:"user-settings-tabs",vertical:!0,onchange:function(e){setTimeout(function(){$("#user-settings-tabs-content").children().hide(),$("#"+e.id).show(),e.pane.focus&&e.pane.focus()},50)}}),i=$("<div></div>",{id:"user-settings-tabs-content"}).appendTo(n);r.forEach(function(e){a.addTab({id:"user-settings-tab-"+e.id,label:e.title,pane:e}),e.get().hide().appendTo(i)}), Line: 173 -  e settings later under the 'Git config' tab of the settings dialog.").appendTo(i);var s=$('<div class="form-row"></div>').appendTo(i);return $('<label for="">Username</label>').appendTo(s),(r=$('<input type="text">').val(n&&n.name||"").appendTo(s)).on("change keyup paste",o),s=$('<div class="form-row"></div>').appendTo(i),$('<label for="">Email</label>').appendTo(s),(p=$('<input type="text">').val(n&&n.email||"").appendTo(s)).on("change keyup paste",o),setTimeout(function(){r.focus(),o()},50),a},buttons:[{text:"Back",click:function(){m("welcome")}},{id:"projects-dialog-git-config",text:"Next",class:"primary",click:function(){var e=RED.settings.get("git")||{};e.user=e.user||{},e.user.name=r.val(),e.user.email=p.val(),RED.settings.set("git",e),"create"===g.action?m("project-details"):"clone"===g.action&&m("clone-project")}}]},"project-details":{content:function(e){var n=null,o=!1;$.getJSON("projects",function(e){n={},e.projects.forEach(function(e){n[e]=!0,o&&(o=!1,i())})});var t=$('<div class="projects-dialog-screen-start"></div>');b.appendTo(t);var a=$('<div class="projects-dialog-screen-start-body"></div>').appendTo(t);$("<p>").text("Create your project").appendTo(a),$("<p>").text("A project is maintained as a Git repository. It makes it much easier to share your flows with others and to collaborate on them.").appendTo(a),$("<p>").text("You can create multiple projects and quickly switch between them from the editor.").appendTo(a),$("<p>").text("To begin, your project needs a name and an optional description.").appendTo(a);var i=function(){var e=f.val(),t=!0;if(p){if(null===n)return void(o=!0);c.empty(),!/^[a-zA-Z0-9\-_]+$/.test(e)||n[e]?(f.addClass("input-error"),$('<i style="margin-top: 8px;" class="fa fa-exclamation-triangle"></i>').appendTo(c),t=d=!1,n[e]?projectNameSublabel.text("Project already exists"):projectNameSublabel.text("Must contain only A-Z 0-9 _ -")):(f.removeClass("input-error"),$('<i style="margin-top: 8px;" class="fa fa-check"></i>').appendTo(c),projectNameSublabel.text("Must contain only A-Z 0-9 _ -"),d=!0),u=e}t=d,$("#projects-dialog-create-name").prop(" Line: 174 -  toggleClass("disabled ui-button-disabled ui-state-disabled",!t)},s=$('<div class="form-row"></div>').appendTo(a);$('<label for="projects-dialog-screen-create-project-name">Project name</label>').appendTo(s);var r=$('<div style="position:relative;"></div>').appendTo(s);f=$('<input id="projects-dialog-screen-create-project-name" type="text"></input>').val(g.name||"").appendTo(r);var d,l,c=$('<div class="projects-dialog-screen-input-status"></div>').appendTo(r),p=!1,u="";return f.on("change keyup paste",function(){if(p=f.val()!==u,l)clearTimeout(l);else if(p&&(c.empty(),$('<img src="red/images/spin.svg"/>').appendTo(c),""===f.val()))return void i();l=setTimeout(function(){i(),l=null},300)}),projectNameSublabel=$('<label class="projects-edit-form-sublabel"><small>Must contain only A-Z 0-9 _ -</small></label>').appendTo(s).find("small"),s=$('<div class="form-row projects-dialog-screen-create-row projects-dialog-screen-create-row-empty"></div>').appendTo(a),$('<label for="projects-dialog-screen-create-project-desc">Description</label>').appendTo(s),h=$('<input id="projects-dialog-screen-create-project-desc" type="text">').val(g.summary||"").appendTo(s),$('<label class="projects-edit-form-sublabel"><small>Optional</small></label>').appendTo(s),setTimeout(function(){f.focus(),f.change()},50),t},buttons:function(e){return[{text:"Back",click:function(){m("git-config")}},{id:"projects-dialog-create-name",disabled:!0,text:"Next",class:"primary disabled",click:function(){g.name=f.val(),g.summary=h.val(),m("default-files",e)}}]}},"clone-project":{content:function(e){var t=$('<div class="projects-dialog-screen-start"></div>');b.appendTo(t);var n=$('<div class="projects-dialog-screen-start-body"></div>').appendTo(t);$("<p>").text("Clone a project").appendTo(n),$("<p>").text("If you already have a git repository containing a project, you can clone it to get started.").appendTo(n);var a=null,i=!1;$.getJSON("projects",function(e){a={},e.projects.forEach(function(e){a[e]=!0,i&&(i=!1,s())})});var o,s=function(){var e=y.val(),t=!0;if(p){if(null===a)return void(i=!0);c.empty(),!/^[a-zA-Z0-9\-_]+$/. Line: 175 -  (y.addClass("input-error"),$('<i style="margin-top: 8px;" class="fa fa-exclamation-triangle"></i>').appendTo(c),t=d=!1,a[e]?x.text("Project already exists"):x.text("Must contain only A-Z 0-9 _ -")):(y.removeClass("input-error"),$('<i style="margin-top: 8px;" class="fa fa-check"></i>').appendTo(c),x.text("Must contain only A-Z 0-9 _ -"),d=!0),u=e}t=d;var n=D.val(),o=0<n.length&&!/\s/.test(n);/^https?:\/\/[^/]+@/i.test(n)&&($("#projects-dialog-screen-create-project-repo-label small").text("Do not include the username/password in the url"),o=!1),o?D.removeClass("input-error"):(h&&D.addClass("input-error"),t=!1),/^https?:\/\//.test(n)?($(".projects-dialog-screen-create-row-creds").show(),$(".projects-dialog-screen-create-row-sshkey").hide()):/^(?:ssh|[\S]+?@[\S]+?):(?:\/\/)?/.test(n)?($(".projects-dialog-screen-create-row-creds").hide(),$(".projects-dialog-screen-create-row-sshkey").show()):($(".projects-dialog-screen-create-row-creds").hide(),$(".projects-dialog-screen-create-row-sshkey").hide()),$("#projects-dialog-clone-project").prop("disabled",!t).toggleClass("disabled ui-button-disabled ui-state-disabled",!t)};o=$('<div class="form-row projects-dialog-screen-create-row projects-dialog-screen-create-row-empty projects-dialog-screen-create-row-clone"></div>').appendTo(n),$('<label for="projects-dialog-screen-create-project-name">Project name</label>').appendTo(o);var r=$('<div style="position:relative;"></div>').appendTo(o);y=$('<input id="projects-dialog-screen-create-project-name" type="text"></input>').appendTo(r);var d,l,c=$('<div class="projects-dialog-screen-input-status"></div>').appendTo(r),p=!1,u="",f="";y.on("change keyup paste",function(){if(p=y.val()!==u,l)clearTimeout(l);else if(p&&(c.empty(),$('<img src="red/images/spin.svg"/>').appendTo(c),""===y.val()))return void s();l=setTimeout(function(){s(),l=null},300)}),x=$('<label class="projects-edit-form-sublabel"><small>Must contain only A-Z 0-9 _ -</small></label>').appendTo(o).find("small"),o=$('<div class="form-row projects-dialog-screen-create-row projects-dialog-screen-create-row-clone"></div>').appendTo(n),$(' Line: 177 -  e.name)),t++}),0===t?(z.addClass("input-error"),z.attr("disabled",!0),m.show()):(z.removeClass("input-error"),z.attr("disabled",!1),m.hide())}),r=$('<div style="width: calc(50% - 10px); margin-left: 20px; display:inline-block;"></div>').appendTo(o),$('<label for="projects-dialog-screen-create-project-repo-passphrase">Passphrase</label>').appendTo(r),M=$('<input id="projects-dialog-screen-create-project-repo-passphrase" type="password"></input>').appendTo(r),r=$('<div class="form-row projects-dialog-screen-create-row projects-dialog-screen-create-row-sshkey"></div>').appendTo(v);var m=$('<div class="projects-dialog-screen-create-row-auth-error-no-keys"></div>').hide().appendTo(r);return $('<div class="form-row"><i class="fa fa-warning"></i> Before you can clone a repository over ssh you must add an SSH key to access it.</div>').appendTo(m),r=$('<div style="text-align: center">').appendTo(m),$('<button class="editor-button">Add an ssh key</button>').appendTo(r).click(function(e){e.preventDefault(),$("#projects-dialog-cancel").click(),RED.userSettings.show("gitconfig"),setTimeout(function(){$("#user-settings-gitconfig-add-key").click()},500)}),o=$('<div class="form-row projects-dialog-screen-create-row projects-dialog-screen-create-row-clone"></div>').appendTo(n),$("<label>Credentials encryption key</label>").appendTo(o),w=$('<input type="password"></input>').appendTo(o),t},buttons:function(e){return[{text:"Back",click:function(){m("git-config")}},{id:"projects-dialog-clone-project",disabled:!0,text:"Clone project",class:"primary disabled",click:function(){$(".projects-dialog-screen-create-type.selected").data("type");var e={name:y.val()};e.credentialSecret=w.val();var t=D.val();if(/^(?:ssh|[\d\w\.\-_]+@[\w\.]+):(?:\/\/)?/.test(t)){var n=z.val();if(!n)return void console.log("Error! Can't get selected SSH key path.");e.git={remotes:{origin:{url:t,keyFile:n,passphrase:M.val()}}}}else e.git={remotes:{origin:{url:t,username:E.val(),password:R.val()}}};$(".projects-dialog-screen-create-row-auth-error").hide(),$("#projects-dialog-screen-create-project-repo-label small").text("https:/ Line: 178 -  ile://"),E.removeClass("input-error"),R.removeClass("input-error"),z.removeClass("input-error"),M.removeClass("input-error"),RED.deploy.setDeployInflight(!0),RED.projects.settings.switchProject(e.name),J({url:"projects",type:"POST",handleAuthFail:!1,responses:{200:function(e){u.dialog("close")},400:{project_exists:function(e){console.log("already exists")},git_error:function(e){console.log("git error",e)},git_connection_failed:function(e){D.addClass("input-error"),$("#projects-dialog-screen-create-project-repo-label small").text("Connection failed")},git_not_a_repository:function(e){D.addClass("input-error"),$("#projects-dialog-screen-create-project-repo-label small").text("Not a git repository")},git_repository_not_found:function(e){D.addClass("input-error"),$("#projects-dialog-screen-create-project-repo-label small").text("Repository not found")},git_auth_failed:function(e){$(".projects-dialog-screen-create-row-auth-error").show(),E.addClass("input-error"),R.addClass("input-error"),z.addClass("input-error"),M.addClass("input-error")},missing_flow_file:function(e){u.dialog("close")},project_empty:function(e){u.dialog("close")},credentials_load_failed:function(e){u.dialog("close")},"*":function(e){v(e),$(u).dialog("close")}}}},e).then(function(){RED.events.emit("project:change",{name:name})}).always(function(){setTimeout(function(){RED.deploy.setDeployInflight(!1)},500)})}}]}},"default-files":{content:function(e){var t=$('<div class="projects-dialog-screen-start"></div>');b.appendTo(t);var n=$('<div class="projects-dialog-screen-start-body"></div>').appendTo(t);$("<p>").text("Create your project files").appendTo(n),$("<p>").text("A project contains your flow files, a README file and a package.json file.").appendTo(n),$("<p>").text("It can contain any other files you want to maintain in the Git repository.").appendTo(n),!e.existingProject&&RED.settings.files&&$("<p>").text("Your existing flow and credential files will be copied into the project.").appendTo(n);var o=function(){var e=!0,t=d.val();""!==t&&/\.json$/.test(t)?(d.hasClass("input-error")&&(d.removeClass("input-error") Line: 179 -  y()),l.hasClass("input-error")&&(l.removeClass("input-error"),l.next().empty()),l.text(t.substring(0,t.length-5)+"_cred.json")):(e=!1,d.hasClass("input-error")||(d.addClass("input-error"),d.next().empty().append('<i style="margin-top: 8px;" class="fa fa-exclamation-triangle"></i>')),l.text(""),l.hasClass("input-error")||(l.addClass("input-error"),l.next().empty().append('<i style="margin-top: 8px;" class="fa fa-exclamation-triangle"></i>'))),$("#projects-dialog-create-default-files").prop("disabled",!e).toggleClass("disabled ui-button-disabled ui-state-disabled",!e)},a=$('<div class="form-row"></div>').appendTo(n);$('<label for="projects-dialog-screen-create-project-file">Flow file</label>').appendTo(a);var i=$('<div style="position:relative;"></div>').appendTo(a),s=g.files&&g.files.flow||RED.settings.files&&RED.settings.files.flow||"flow.json";d=$('<input id="projects-dialog-screen-create-project-file" type="text">').val(s).on("change keyup paste",o).appendTo(i),$('<div class="projects-dialog-screen-input-status"></div>').appendTo(i),$('<label class="projects-edit-form-sublabel"><small>*.json</small></label>').appendTo(a);var r=g.files&&g.files.credentials||RED.settings.files&&RED.settings.files.credentials||"flow_cred.json";return a=$('<div class="form-row"></div>').appendTo(n),$('<label for="projects-dialog-screen-create-project-credfile">Credentials file</label>').appendTo(a),i=$('<div style="position:relative;"></div>').appendTo(a),l=$('<div style="width: 100%" class="uneditable-input" id="projects-dialog-screen-create-project-credentials">').text(r).appendTo(i),$('<div class="projects-dialog-screen-input-status"></div>').appendTo(i),setTimeout(function(){d.focus(),o()},50),t},buttons:function(e){return[{text:e.existingProject?"Cancel":"Back",click:function(){e.existingProject?$(this).dialog("close"):m("project-details",e)}},{id:"projects-dialog-create-default-files",text:"Next",class:"primary",click:function(){g.files={flow:d.val(),credentials:l.text()},e.existingProject||(g.migrateFiles=!0),m("encryption-config",e)}}]}},"encryption-config":{content:function(e){var t=$( Line: 182 -  le="margin-left: 5px"><input '+("user"!==RED.settings.flowEncryptionType?"disabled":"")+' type="radio" style="vertical-align: middle; margin-top:0; margin-right: 10px;" value="default" name="projects-encryption-key"> <span style="vertical-align: middle;">Copy over existing key</span></label>').appendTo(a),a=$('<div class="form-row projects-encryption-enabled-row"></div>').appendTo(s),$('<label class="projects-edit-form-inline-label" style="margin-left: 5px"><input type="radio" style="vertical-align: middle; margin-top:0; margin-right: 10px;" value="custom" name="projects-encryption-key"> <span style="vertical-align: middle;">Use custom key</span></label>').appendTo(a),a=$('<div class="projects-encryption-enabled-row"></div>').appendTo(s),(c=$('<input disabled type="password" style="margin-left: 25px; width: calc(100% - 30px);"></input>').appendTo(a)).on("change keyup paste",o),a=$('<div class="form-row projects-encryption-disabled-row"></div>').hide().appendTo(s),$('<div class="" style="padding: 5px 20px;"><i class="fa fa-warning"></i> The credentials file will not be encrypted and its contents easily read</div>').appendTo(a),s.find("input[name=projects-encryption-key]").click(function(){var e=$(this).val();c.attr("disabled","default"===e),"custom"===e&&c.focus(),o()}),setTimeout(function(){r.find("input[name=projects-encryption-type][value=enabled]").click(),"user"!==RED.settings.flowEncryptionType?s.find("input[name=projects-encryption-key][value=custom]").click():s.find("input[name=projects-encryption-key][value=default]").click(),o()},100),t},buttons:function(o){return[{text:"Back",click:function(){m("default-files",o)}},{id:"projects-dialog-create-encryption",text:o.existingProject?"Create project files":"Create project",class:"primary disabled",disabled:!0,click:function(){"enabled"===$("input[name=projects-encryption-type]:checked").val()?"custom"===$("input[name=projects-encryption-key]:checked").val()&&(g.credentialSecret=c.val()):g.credentialSecret=!1,RED.deploy.setDeployInflight(!0),RED.projects.settings.switchProject(g.name);var e="POST",t="projects";o.existingPro Line: 183 -  alise=!0,e="PUT",t="projects/"+B.name);var n=this;J({url:t,type:e,requireCleanWorkspace:!0,handleAuthFail:!1,responses:{200:function(e){g={},o.existingProject?$(n).dialog("close"):(m("create-success"),RED.menu.setDisabled("menu-item-projects-open",!1),RED.menu.setDisabled("menu-item-projects-settings",!1))},400:{project_exists:function(e){console.log("already exists")},git_error:function(e){console.log("git error",e)},git_connection_failed:function(e){projectRepoInput.addClass("input-error")},git_auth_failed:function(e){projectRepoUserInput.addClass("input-error"),projectRepoPasswordInput.addClass("input-error"),console.log("git auth error",e)},"*":function(e){v(e),$(u).dialog("close")}}}},g).always(function(){setTimeout(function(){RED.deploy.setDeployInflight(!1)},500)})}}]}},"create-success":{content:function(e){var t=$('<div class="projects-dialog-screen-start"></div>');b.appendTo(t);var n=$('<div class="projects-dialog-screen-start-body"></div>').appendTo(t);return $("<p>").text("You have successfully created your first project!").appendTo(n),$("<p>").text("You can now continue to use Node-RED just as you always have.").appendTo(n),$("<p>").text("The 'info' tab in the sidebar shows you what your current active project is. The button next to the name can be used to access the project settings view.").appendTo(n),$("<p>").text("The 'history' tab in the sidebar can be used to view files that have changed in your project and to commit them. It shows you a complete history of your commits and allows you to push your changes to a remote repository.").appendTo(n),t},buttons:[{text:"Done",click:function(){$(this).dialog("close")}}]},create:{title:"Projects",content:function(e){var s=null;A=null;var r=!1;$.getJSON("projects",function(e){s={},e.projects.forEach(function(e){s[e]=!0,r&&(r=!1,o())})});var t,n=$('<div class="projects-dialog-screen-create"></div>'),o=function(){var e=T.val(),t=!0;if(f){if(null===s)return void(r=!0);u.empty(),!/^[a-zA-Z0-9\-_]+$/.test(e)||s[e]?(T.addClass("input-error"),$('<i style="margin-top: 8px;" class="fa fa-exclamation-triangle"></i>').appendTo(u), Line: 187 -  ects/"+n,type:"DELETE",responses:{200:function(e){o(!1)},400:{unexpected_error:function(e){a.remove(),o(!0)}}}})}),setTimeout(function(){a.css("left",0)},50)}),i.click(function(e){$(".projects-dialog-project-list-entry").removeClass("selected"),t.addClass("selected"),o=i.parent(),r.select&&r.select(s),d(),a.focus()}),r.dblclick&&i.dblclick(function(e){e.preventDefault(),r.dblclick(s)})}},filter:function(e){return""===t||-1!==e.name.toLowerCase().indexOf(t)}});return $.getJSON("projects",function(e){e.projects.forEach(function(e){l.editableList("addItem",{name:e})})}),e}({canSelectActive:!1,dblclick:function(e){A=e,$("#projects-dialog-create").click()},select:function(e){A=e,o()},delete:function(e){s&&delete s[e.name],A=null,o()}}).appendTo(t),t=$('<div class="form-row projects-dialog-screen-create-row projects-dialog-screen-create-row-empty projects-dialog-screen-create-row-clone"></div>').appendTo(n),$('<label for="projects-dialog-screen-create-project-name">Project name</label>').appendTo(t);var l=$('<div style="position:relative;"></div>').appendTo(t);T=$('<input id="projects-dialog-screen-create-project-name" type="text"></input>').appendTo(l);var c,p,u=$('<div class="projects-dialog-screen-input-status"></div>').appendTo(l),f=!1,h="",g="";T.on("change keyup paste",function(){if(f=T.val()!==h,p)clearTimeout(p);else if(f&&(u.empty(),$('<img src="red/images/spin.svg"/>').appendTo(u),""===T.val()))return void o();p=setTimeout(function(){o(),p=null},300)}),P=$('<label class="projects-edit-form-sublabel"><small>Must contain only A-Z 0-9 _ -</small></label>').appendTo(t).find("small"),t=$('<div class="form-row projects-dialog-screen-create-row projects-dialog-screen-create-row-empty"></div>').appendTo(n),$('<label for="projects-dialog-screen-create-project-desc">Description</label>').appendTo(t),k=$('<input id="projects-dialog-screen-create-project-desc" type="text">').appendTo(t),$('<label class="projects-edit-form-sublabel"><small>Optional</small></label>').appendTo(t),t=$('<div class="form-row projects-dialog-screen-create-row projects-dialog-screen-create-row-empty"></div>' Line: 191 -  ey"></div>').appendTo(R);var x=$('<div class="projects-dialog-screen-create-row-auth-error-no-keys"></div>').hide().appendTo(l);switch($('<div class="form-row"><i class="fa fa-warning"></i> Before you can clone a repository over ssh you must add an SSH key to access it.</div>').appendTo(x),l=$('<div style="text-align: center">').appendTo(x),$('<button class="editor-button">Add an ssh key</button>').appendTo(l).click(function(e){e.preventDefault(),$("#projects-dialog-cancel").click(),RED.userSettings.show("gitconfig"),setTimeout(function(){$("#user-settings-gitconfig-add-key").click()},500)}),t=$('<div class="hide form-row projects-dialog-screen-create-row projects-dialog-screen-create-row-clone"></div>').appendTo(n),$("<label>Credentials encryption key</label>").appendTo(t),C=$('<input type="password"></input>').appendTo(t),e.screen||"empty"){case"empty":i.click();break;case"open":a.click();break;case"clone":d.click()}return setTimeout(function(){"open"!==(e.screen||"empty")?T.focus():$("#projects-dialog-project-list-search").focus()},50),n},buttons:function(e){var t;switch(e.screen||"empty"){case"open":t="Open project";break;case"empty":t="Create project";break;case"clone":t="Clone project"}return[{id:"projects-dialog-cancel",text:RED._("common.label.cancel"),click:function(){$(this).dialog("close")}},{id:"projects-dialog-create",text:t,class:"primary disabled",disabled:!0,click:function(){var e,t,n=$(".projects-dialog-screen-create-type.selected").data("type"),o={name:T.val()};if("empty"===n){o.summary=k.val(),o.files={flow:_.val()};var a=$("input[name=projects-encryption-type]:checked").val();o.credentialSecret="enabled"===a&&S.val()}else if("copy"===n)o.copy=(void 0).name;else if("clone"===n){o.credentialSecret=C.val();var i=j.val();if(/^(?:ssh|[\d\w\.\-_]+@[\w\.]+):(?:\/\/)?/.test(i)){var s=N.val();if(!s)return void console.log("Error! Can't get selected SSH key path.");o.git={remotes:{origin:{url:i,keyFile:s,passphrase:I.val()}}}}else o.git={remotes:{origin:{url:i,username:O.val(),password:L.val()}}}}else if("open"===n)return e=A.name,t=function(e,t){u.dialog("close"),e Line: 192 -  _load_failed"!==e.error&&console.log("unexpected_error",e)},RED.deploy.setDeployInflight(!0),RED.projects.settings.switchProject(e),void J({url:"projects/"+e,type:"PUT",requireCleanWorkspace:!0,responses:{200:function(e){t(null,e)},400:{"*":t}}},{active:!0}).then(function(){RED.events.emit("project:change",{name:e})}).always(function(){setTimeout(function(){RED.deploy.setDeployInflight(!1)},500)});$(".projects-dialog-screen-create-row-auth-error").hide(),$("#projects-dialog-screen-create-project-repo-label small").text("https://, ssh:// or file://"),O.removeClass("input-error"),L.removeClass("input-error"),N.removeClass("input-error"),I.removeClass("input-error"),RED.deploy.setDeployInflight(!0),RED.projects.settings.switchProject(o.name),J({url:"projects",type:"POST",handleAuthFail:!1,responses:{200:function(e){u.dialog("close")},400:{project_exists:function(e){console.log("already exists")},git_error:function(e){console.log("git error",e)},git_connection_failed:function(e){j.addClass("input-error"),$("#projects-dialog-screen-create-project-repo-label small").text("Connection failed")},git_not_a_repository:function(e){j.addClass("input-error"),$("#projects-dialog-screen-create-project-repo-label small").text("Not a git repository")},git_repository_not_found:function(e){j.addClass("input-error"),$("#projects-dialog-screen-create-project-repo-label small").text("Repository not found")},git_auth_failed:function(e){$(".projects-dialog-screen-create-row-auth-error").show(),O.addClass("input-error"),L.addClass("input-error"),N.addClass("input-error"),I.addClass("input-error")},missing_flow_file:function(e){u.dialog("close")},project_empty:function(e){u.dialog("close")},credentials_load_failed:function(e){u.dialog("close")},"*":function(e){v(e),$(u).dialog("close")}}}},o).then(function(){RED.events.emit("project:change",{name:name})}).always(function(){setTimeout(function(){RED.deploy.setDeployInflight(!1)},500)})}}]}}}}function m(e,t){u||RED.projects.init();var n=s[e],o=n.content(t||{});i.empty();var a=n.buttons;"function"==typeof a&&(a=a(t||{})),u.dialog("option","buttons",a),i.a Line: 194 -  s",function(e){e.keys.forEach(function(e){d.append($("<option></option>").val(e.name).text(e.name)),0})}),r=$('<div class="form-row"></div>').appendTo(i),$('<label for="projects-user-auth-passphrase">Passphrase</label>').appendTo(r),$('<input id="projects-user-auth-passphrase" type="password"></input>').appendTo(r)}var l=RED.notify(i,{type:"error",fixed:!0,modal:!0,buttons:[{text:RED._("common.label.cancel"),click:function(){l.close()}},{text:$('<span><i class="fa fa-refresh"></i> Retry</span>'),click:function(){p=p||{};var e={};s?(e.keyFile=$("#projects-user-auth-key").val(),e.passphrase=$("#projects-user-auth-passphrase").val()):(e.username=$("#projects-user-auth-username").val(),e.password=$("#projects-user-auth-password").val());var t=function(e){e?(console.log("Failed to update auth"),console.log(e)):(J(c,p),l.close())};J({url:"projects/"+B.name+"/remotes/"+(n.responseJSON.remote||c.remote||"origin"),type:"PUT",responses:{0:function(e){t(e)},200:function(e){t(null)},400:{unexpected_error:function(e){t(e)}}}},{auth:e})}}]});return}if(o[n.responseJSON.error])return u=o[n.responseJSON.error],void(f=n.responseJSON);if(o["*"])return u=o["*"],void(f=n.responseJSON)}console.log("Unhandled error response:"),console.log(n),console.log(e),console.log(t)}).always(function(){var e=Date.now()-o;e=Math.max(0,500-e),setTimeout(function(){$(".projects-dialog-spinner").hide(),$("#projects-dialog").parent().find(".ui-dialog-buttonset").children().css("visibility",""),u&&u(f)},e)})}function n(a){var i,n="",o=[],s="",r=$('<div class="projects-branch-list">').appendTo(a.container),d=$('<input type="text">').attr("placeholder",a.placeholder).appendTo(r).searchBox({delay:200,change:function(){n=$(this).val(),/(\.\.|\/\.|[?*[~^: \\]|\/\/|\/.$|\/$)/.test(n)?(i.hasClass("input-error")||(i.addClass("input-error"),i.find("i").addClass("fa-warning").removeClass("fa-code-fork")),i.find("span").text("Invalid branch: "+s+n)):(i.hasClass("input-error")&&(i.removeClass("input-error"),i.find("i").removeClass("fa-warning").addClass("fa-code-fork")),i.find(".sidebar-version-control-branch-list-entry-create- Line: 195 -  n)),l.editableList("filter")}}),l=$("<ol>",{style:"height: 130px;"}).appendTo(r);return l.editableList({addButton:!1,scrollOnAdd:!1,addItem:function(e,t,n){var o=$('<div class="sidebar-version-control-branch-list-entry">').appendTo(e);n.hasOwnProperty("commit")?($('<i class="fa fa-code-fork"></i>').appendTo(o),$("<span>").text(n.name).appendTo(o),n.current&&(o.addClass("selected"),$('<span class="current"></span>').text(a.currentLabel||"current").appendTo(o))):(i=o,$('<i class="fa fa-code-fork"></i>').appendTo(o),$("<span>").text("Create branch:").appendTo(o),$('<div class="sidebar-version-control-branch-list-entry-create-name" style="margin-left: 10px;">').text(n.name).appendTo(o)),o.click(function(e){if(e.preventDefault(),!$(this).hasClass("input-error")){var t={};n.hasOwnProperty("commit")?($(this).hasClass("selected")&&(t.current=!0),t.name=n.name):(t.name=d.val(),t.create=!0,a.remote&&(t.name=a.remote()+"/"+t.name)),a.onselect&&a.onselect(t)}})},filter:function(e){var t=!e.hasOwnProperty("commit");return t&&""!==n&&-1===o.indexOf(s+n)||!t&&-1!==e.name.indexOf(n)}}),{refresh:function(e){d.searchBox("value",""),l.editableList("empty");var t=Date.now(),n=c(r).addClass("projects-dialog-spinner-contain");s=a.remote?a.remote()+"/":"",J({url:e,type:"GET",responses:{0:function(e){console.log(e)},200:function(e){o=e.branches,e.branches.forEach(function(e){l.editableList("addItem",e)}),l.editableList("addItem",{}),setTimeout(function(){n.remove()},Math.max(300-(Date.now()-t),0))},400:{git_connection_failed:function(e){RED.notify(e.message,"error")},git_not_a_repository:function(e){RED.notify(e.message,"error")},git_repository_not_found:function(e){RED.notify(e.message,"error")},unexpected_error:function(e){v(e)}}}})},filter:function(){l.editableList("filter")},focus:function(){d.focus()}}}function c(e){return $('<div class="projects-dialog-spinner"><img src="red/images/spin.svg"/></div>').appendTo(e)}function o(){createProjectOptions={},B?m("create",{screen:"empty"}):m("welcome")}return{init:function(){u=$('<div id="projects-dialog" class="hide node-red-dialog projects-edit-form"> Line: 197 -  e){},400:{git_error:function(e){console.log("git error",e)},missing_flow_file:function(e){$(u).dialog("close")},"*":function(e){v(e),$(u).dialog("close")}}}},{initialise:!0}).always(function(){setTimeout(function(){RED.deploy.setDeployInflight(!1)},500)})},refresh:function(t){$.getJSON("projects",function(e){e.active?$.getJSON("projects/"+e.active,function(e){B=e,RED.sidebar.versionControl.refresh(!0),t&&t(B)}):t&&t(null)})},editProject:function(){RED.projects.settings.show()},getActiveProject:function(){return B}}}(),RED.projects.settings=function(){var S,O,t=700,n=!1,d=[];function o(e){d.push(e)}function s(e,t){var n,o;t.empty(),n=e.description?marked(e.description):'<span class="node-info-none">No description available</span>',(o=$('<span class="bidiAware" dir="'+RED.text.bidi.resolveBaseTextDir(n)+'">'+n+"</span>"),$(o).find("a").each(function(e){var t=$(this).attr("href");/^https?:/.test(t)&&$(this).attr("target","_blank")}),o).appendTo(t).find(".bidiAware").contents().filter(function(){return 3===this.nodeType&&""!==this.textContent.trim()}).wrap("<span></span>")}function c(e,t){t.empty(),e?t.text(e).removeClass("node-info-node"):t.text("No summary available").addClass("node-info-none")}function a(t){var e=$('<div id="project-settings-tab-main" class="project-settings-tab-pane node-help"></div>');$("<h1>").text(t.name).appendTo(e);var n=$('<div style="position: relative">').appendTo(e),o=$("<div></div>",{style:"color: #999"}).appendTo(n);c(t.summary,o),RED.user.hasPermission("projects.write")&&$('<button class="editor-button editor-button-small" style="float: right;">edit description</button>').prependTo(n).click(function(e){e.preventDefault(),function a(i,s,r){var d=r.prev();d.hide(),r.empty();var e=$('<span class="button-row" style="position: relative; float: right; margin-right:0;"></span>').appendTo(r),l=$('<input type="text" style="width: calc(100% - 150px); margin-right: 10px;">').val(s||"").appendTo(r);$('<button class="editor-button">Cancel</button>').appendTo(e).click(function(e){e.preventDefault(),c(i.summary,r),d.show()}),$('<button class="editor-button">Save Line: 200 -  k(function(e){e.preventDefault();var t=$.extend(!0,{},l.dependencies);delete t[o.id],p(0,n,t,function(e){e?console.log(e):n.fadeOut(200,function(){c.editableList("removeItem",o)})})}):o.known||$('<a href="#" class="editor-button editor-button-small">add to project</a>').appendTo(d).click(function(e){e.preventDefault();var t=$.extend(!0,{},l.dependencies);t[o.id]=h[o.id].version,p(0,n,t,function(e){e?console.log(e):(d.remove(),a.removeClass("palette-module-unknown"))})}):$('<a href="#" class="editor-button editor-button-small">install</a>').appendTo(d).click(function(e){e.preventDefault(),RED.palette.editor.install(o,n,function(e){if(!e){o.installed=!0;RED.utils.addSpinnerOverlay(n,!0);setTimeout(function(){c.editableList("removeItem",o),h={},RED.nodes.eachNode(f),RED.nodes.eachConfig(f),o.count=h[o.id].count,c.editableList("addItem",o)},500)}})}))}},sort:function(e,t){return e.id.localeCompare(t.id)}}),r(l,c),t}function L(e,t,o,i,s){var r=$('<div class="project-file-listing-container"></div>',{style:"position: relative; min-height: 175px; height: 175px;"}).hide().appendTo(e),d=O.addSpinnerOverlay(r);return $.getJSON("projects/"+t.name+"/files",function(t){var e=Object.keys(t);e=e.filter(function(e){return!t[e].status||!/D/.test(t[e].status)});var n={};e.sort(),e.forEach(function(e){e.split("/").reduce(function(e,t,n,o){if(t)return n<o.length-1?e[t]=e[t]||{}:e[t]=!0,e[t]},n)});var a=function(e,t,n){var o={name:e||"/",path:n+(n?"/":"")+e};return!0===t?o.type="f":(o.type="d",o.children=[],o.path=o.path,Object.keys(t).forEach(function(e){o.children.push(a(e,t[e],o.path))}),o.children.sort(function(e,t){return e.hasOwnProperty("children")&&!t.hasOwnProperty("children")?-1:!e.hasOwnProperty("children")&&t.hasOwnProperty("children")?1:e.name.localeCompare(t.name)})),o};n=a("",n,"");!function s(e,t,r,d,l,n){n=n||"";var o=$("<ol>",{class:"projects-dialog-file-list",style:n}).appendTo(e).editableList({addButton:!1,scrollOnAdd:!1,addItem:function(e,t,n){var o=$("<div></div>",{class:"projects-dialog-file-list-entry"}).appendTo(e);if(n.children){if($('<span class="projects-dialog-file-lis Line: 203 -  .focus()):h.focus(),p()})}),r={empty:!0},d=!0,a=$('<div class="user-settings-row"></div>').appendTo(t),i=$('<div class="projects-dialog-list-dialog"></div>').hide().appendTo(a);a=$('<div class="user-settings-row projects-dialog-list"></div>').appendTo(t);var l=$("<ol>").appendTo(a);l.editableList({addButton:!1,height:"auto",addItem:function(o,e,a){var t=$('<div class="projects-dialog-list-entry">').appendTo(o);if(a.empty)return t.addClass("red-ui-search-empty"),void t.text("No remotes");$('<span class="entry-icon"><i class="fa fa-globe"></i></span>').appendTo(t);var n=$("<span>").appendTo(t);$('<div class="entry-name">').text(a.name).appendTo(n),a.urls.fetch===a.urls.push?$('<div class="entry-detail">').text(a.urls.fetch).appendTo(n):($('<div class="entry-detail">').text("fetch: "+a.urls.fetch).appendTo(n),$('<div class="entry-detail">').text("push: "+a.urls.push).appendTo(n));var i=$('<span class="entry-tools">').appendTo(t);$('<button class="editor-button editor-button-small"><i class="fa fa-trash"></i></button>').appendTo(i).click(function(e){e.preventDefault();var t=O.addSpinnerOverlay(o).addClass("projects-dialog-spinner-contain"),n=RED.notify("Are you sure you want to delete the remote '"+a.name+"'?",{type:"warning",modal:!0,fixed:!0,buttons:[{text:RED._("common.label.cancel"),click:function(){t.remove(),n.close()}},{text:"Delete remote",click:function(){n.close(),s.git.branches.remote&&0===s.git.branches.remote.indexOf(a.name+"/")&&delete s.git.branches.remote,s.git.branches.remoteAlt&&0===s.git.branches.remoteAlt.indexOf(a.name+"/")&&delete s.git.branches.remoteAlt;var e={url:"projects/"+s.name+"/remotes/"+a.name,type:"DELETE",responses:{200:function(e){o.fadeOut(200,function(){l.editableList("removeItem",a),setTimeout(t.remove,100),0===e.remotes.length?(delete s.git.remotes,d=!0,l.editableList("addItem",r)):(s.git.remotes={},e.remotes.forEach(function(e){var t=e.name;delete e.name,s.git.remotes[t]=e})),delete s.git.branches.remoteAlt,RED.sidebar.versionControl.refresh()})},400:{"*":function(e){O.reportUnexpectedError(e),t.remove()}}}};O.sendRequest(e)}}]})})}});var c Line: 205 -  tUnexpectedError(e),o(e)}}}},n)}),w=function(){l.editableList("empty");var e=0;if(s.git.hasOwnProperty("remotes"))for(var t in s.git.remotes)s.git.remotes.hasOwnProperty(t)&&(e++,l.editableList("addItem",{name:t,urls:s.git.remotes[t]}));(d=0===e)&&l.editableList("addItem",r)};w()}function u(e){var t=$('<div id="project-settings-tab-settings" class="project-settings-tab-pane node-help"></div>');return function(a,e){var t,n=$("<h3></h3>").text("Files").appendTo(e),i=$('<div class="user-settings-section"></div>').appendTo(e);if(RED.user.hasPermission("projects.write"))var o=$('<button class="editor-button editor-button-small" style="float: right;">edit</button>').appendTo(n).click(function(e){e.preventDefault(),_.show(),o.hide(),r.hide(),d.show(),l.show(),c.hide(),p.show(),d.focus(),f.addClass("uneditable-input"),$(".user-settings-row-credentials").show(),f.css("height","auto"),m.hide(),h.show()});t=$('<div class="user-settings-row"></div>').appendTo(i),$('<label for=""></label>').text("Flow").appendTo(t);var s=$('<div class="uneditable-input" style="padding:0">').appendTo(t),r=$('<span style="display:inline-block; padding: 6px">').text(a.files.flow).appendTo(s),d=$('<input id="" type="text" style="margin-bottom: 0;width: 100%; border: none;">').val(a.files.flow).hide().appendTo(s),l=$('<button class="editor-button" style="border-top-right-radius: 4px; border-bottom-right-radius: 4px; width: 36px; height: 34px; position: absolute; top: -1px; right: -1px;"><i class="fa fa-folder-open-o"></i></button>').hide().appendTo(s).click(function(e){if($(this).hasClass("selected"))$(this).removeClass("selected"),s.find(".project-file-listing-container").slideUp(200,function(){$(this).remove(),s.css("height","")}),s.css("color","");else{$(this).addClass("selected"),s.css("color","inherit");var t=L(s,a,d.val(),/.*\.json$/,function(e,t){e&&d.val(e),t&&$(l).click(),u()});s.css("height","auto"),setTimeout(function(){t.slideDown(200)},50)}});t=$('<div class="user-settings-row"></div>').appendTo(i),$('<label for=""></label>').text("Credentials").appendTo(t);var c=$('<div class="uneditable-input">' Line: 208 -  ret=E.val())),RED.deploy.setDeployInflight(!0),O.sendRequest({url:"projects/"+a.name,type:"PUT",responses:{0:function(e){n(e)},200:function(e){a=e,RED.sidebar.versionControl.refresh(!0),j(),n()},400:{credentials_load_failed:function(e){n(e)},missing_current_credential_key:function(e){E.addClass("input-error"),S=RED.popover.create({target:E,direction:"right",size:"small",content:"Incorrect key",autoClose:3e3}).open(),n(e)},"*":function(e){n(e)}}}},o).always(function(){setTimeout(function(){RED.deploy.setDeployInflight(!1)},500)})}),j=function(){a.settings.credentialSecretInvalid?(f.find(".user-settings-credentials-state-icon").removeClass().addClass("user-settings-credentials-state-icon fa fa-warning"),f.find(".user-settings-credentials-state").text("Invalid encryption key")):a.settings.credentialsEncrypted?(f.find(".user-settings-credentials-state-icon").removeClass().addClass("user-settings-credentials-state-icon fa fa-lock"),f.find(".user-settings-credentials-state").text("Encryption enabled")):(f.find(".user-settings-credentials-state-icon").removeClass().addClass("user-settings-credentials-state-icon fa fa-unlock"),f.find(".user-settings-credentials-state").text("Encryption disabled")),g.toggleClass("disabled",!a.settings.credentialSecretInvalid&&!a.settings.credentialsEncrypted),g.prop("disabled",!a.settings.credentialSecretInvalid&&!a.settings.credentialsEncrypted)};u(),j()}(e,t),l(e,t),t}function f(e){if(!/^subflow:/.test(e.type)){var t=RED.nodes.registry.getNodeSetForType(e.type).module;"node-red"!==t&&(h.hasOwnProperty(t)||(h[t]={module:t,version:RED.nodes.registry.getModule(t).version,count:0,known:!1}),h[t].count++)}}var h={};return{init:function(e){O=e,o({id:"main",title:"Project",get:a,close:function(){}}),o({id:"deps",title:"Dependencies",get:i,close:function(){}}),o({id:"settings",title:"Settings",get:u,close:function(){S&&(S.close(),S=null)}}),RED.events.on("nodes:add",f),RED.events.on("nodes:remove",function(e){if(!/^subflow:/.test(e.type)){var t=RED.nodes.registry.getNodeSetForType(e.type).module;"node-red"!==t&&h.hasOwnProperty(t)&&(h[t].count--,0===h[t].co Line: 209 -  wn||delete h[t]))}})},show:function(r){if(!n)if(RED.user.hasPermission("projects.write")){n=!0;var e={title:"Project Settings",buttons:[{id:"node-dialog-ok",text:RED._("common.label.close"),class:"primary",click:function(){RED.tray.close()}}],resize:function(e){t=e.width},open:function(e){var t=RED.projects.getActiveProject(),n=e.find(".editor-tray-body"),o=$("<div></div>").appendTo(n),a=$("<div></div>",{id:"user-settings-tabs-container"}).appendTo(o);$("<ul></ul>",{id:"user-settings-tabs"}).appendTo(a);var i=RED.tabs.create({id:"user-settings-tabs",vertical:!0,onchange:function(e){setTimeout(function(){$("#user-settings-tabs-content").children().hide(),$("#"+e.id).show(),e.pane.focus&&e.pane.focus()},50)}}),s=$("<div></div>",{id:"user-settings-tabs-content"}).appendTo(o);d.forEach(function(e){i.addTab({id:"project-settings-tab-"+e.id,label:e.title,pane:e}),e.get(t).hide().appendTo(s)}),o.i18n(),i.activateTab("project-settings-tab-"+(r||"main")),$("#sidebar-shade").show()},close:function(){n=!1,d.forEach(function(e){e.close&&e.close()}),$("#sidebar-shade").hide()},show:function(){}};null!==t&&(e.width=t),RED.tray.show(e)}else RED.notify(RED._("user.errors.notAuthorized"),"error")},switchProject:function(e){h={}}}}(),RED.projects.userSettings=function(){var a,D,E;function t(e){var t=$('<div id="user-settings-tab-gitconfig" class="project-settings-tab-pane node-help"></div>');return function(e){var t=RED.settings.get("git")||{};t.user=t.user||{},$("<h3></h3>").text("Committer Details").appendTo(e);var n=$('<div class="user-settings-section"></div>').appendTo(e);$('<div style="color:#aaa;"></div>').appendTo(n).text("Leave blank to use system default");var o=$('<div class="user-settings-row"></div>').appendTo(n);$('<label for=""></label>').text("Username").appendTo(o),(a=$('<input type="text">').appendTo(o)).val(t.user.name||""),o=$('<div class="user-settings-row"></div>').appendTo(n),$('<label for=""></label>').text("Email").appendTo(o),(D=$('<input type="text">').appendTo(o)).val(t.user.email||"")}(t),function(e){var o,t=$('<div class="user-settings-section"></div>').appendTo(e Line: 212 -  (function(e){e.stopPropagation();var t=E.addSpinnerOverlay(o).addClass("projects-dialog-spinner-contain"),n=RED.notify("Are you sure you want to delete the SSH key '"+a.name+"'? This cannot be undone.",{type:"warning",modal:!0,fixed:!0,buttons:[{text:RED._("common.label.cancel"),click:function(){t.remove(),n.close()}},{text:"Delete key",click:function(){n.close();var e={url:"settings/user/keys/"+a.name,type:"DELETE",responses:{200:function(e){o.fadeOut(200,function(){y.editableList("removeItem",a),setTimeout(t.remove,100),0===y.editableList("length")&&y.editableList("addItem",m)})},400:{unexpected_error:function(e){console.log(e),t.remove()}}}};E.sendRequest(e)}}]})}),a.expand&&(i=b(t,a))}}),w=function(t){$.getJSON("settings/user/keys",function(e){e.keys&&(e.keys.sort(function(e,t){return e.name.localeCompare(t.name)}),y.editableList("empty"),e.keys.forEach(function(e){e.name===t&&(e.expand=!0),y.editableList("addItem",e)}),0===y.editableList("length")&&y.editableList("addItem",m))})};w()}(t),t}return{init:function(e){E=e,RED.userSettings.add({id:"gitconfig",title:"Git config",get:t,close:function(){var e=RED.settings.get("git")||{};e.user=e.user||{},e.user.name=a.val(),e.user.email=D.val(),RED.settings.set("git",e)}})}}}(),RED.sidebar.versionControl=function(){var S,O,L,P,N,I,r,A,z,M,B,J,U,d,G,F={};function q(n,s,e,r){n.addClass("sidebar-version-control-change-entry");var o=$("<div>").appendTo(n);if(s.label){if(n.addClass("node-info-none"),o.text(s.label),s.button){o.css({display:"inline-block",maxWidth:"300px",textAlign:"left"});var t=$('<div style="float: right; margin: 5px; height: 50px;"></div>').appendTo(o);$('<button class="editor-button editor-button-small"></button>').text(s.button.label).appendTo(t).click(s.button.click)}}else{var a,i,d=$('<i class=""></i>').appendTo(o),l=$('<a href="#">').appendTo(o).click(function(e){var o,a,i,t;e.preventDefault(),o=s,a=r,i=RED.projects.getActiveProject(),t="staged"===a?"index":"tree",G.sendRequest({url:"projects/"+i.name+"/diff/"+t+"/"+encodeURIComponent(o.file),type:"GET",responses:{0:function(e){console.log(e)},200:function(e){ Line: 213 -  ged"===a?"Unstaged changes : "+o.file:"staged"===a?"Staged changes : "+o.file:"Resolve conflicts : "+o.file;var n={diff:e.diff,title:t,unmerged:"unmerged"===a,project:i};"unstaged"==a?(n.oldRevTitle=" "===o.indexStatus?"HEAD":"Staged",n.newRevTitle="Unstaged",n.oldRev=" "===o.indexStatus?"@":":0",n.newRev="_"):"staged"===a?(n.oldRevTitle="HEAD",n.newRevTitle="Staged",n.oldRev="@",n.newRev=":0"):(n.oldRevTitle="Local",n.newRevTitle="Remote",n.commonRev=":1",n.oldRev=":2",n.newRev=":3",n.onresolve=function(e){G.sendRequest({url:"projects/"+i.name+"/resolve/"+encodeURIComponent(o.file),type:"POST",responses:{0:function(e){console.log(e)},200:function(e){Z(!0)},400:{unexpected_error:function(e){console.log(e)}}}},{resolutions:e.resolutions[o.file]})}),RED.diff.showUnifiedDiff(n)},400:{unexpected_error:function(e){console.log(e)}}}})}),c=$("<span>").appendTo(l),p=$('<div class="sidebar-version-control-change-entry-tools">').appendTo(n);"unstaged"===r&&(a=$('<span class="button-group" style="margin-right: 5px;"></span>').appendTo(p),i=$('<button class="editor-button editor-button-small"><i class="fa fa-reply"></i></button>').appendTo(a).click(function(e){e.preventDefault();var t=G.addSpinnerOverlay(o).addClass("projects-dialog-spinner-contain"),n=RED.notify("Are you sure you want to revert the changes to '"+s.file+"'? This cannot be undone.",{type:"warning",modal:!0,fixed:!0,buttons:[{text:RED._("common.label.cancel"),click:function(){t.remove(),n.close()}},{text:"Revert changes",click:function(){n.close();var e={url:"projects/"+RED.projects.getActiveProject().name+"/files/_/"+s.file,type:"DELETE",responses:{200:function(e){t.remove()},400:{unexpected_error:function(e){t.remove(),console.log(e)}}}};RED.deploy.setDeployInflight(!0),G.sendRequest(e).always(function(){setTimeout(function(){RED.deploy.setDeployInflight(!1)},500)})}}]})})),a=$('<span class="button-group"></span>').appendTo(p),"unmerged"!==r&&$('<button class="editor-button editor-button-small"><i class="fa fa-'+("unstaged"===r?"plus":"minus")+'"></i></button>').appendTo(a).click(function(e){e.preventDefault();var t=RED. Line: 219 -  ){console.log(e)}}}}).always(function(){setTimeout(function(){RED.deploy.setDeployInflight(!1)},500)})});(z=$("<ol>",{style:"position: absolute; top: 30px; bottom: 0; right:0; left:0;"}).appendTo(A)).editableList({addButton:!1,scrollOnAdd:!1,addItem:function(e,t,n){n===H&&(n.button={label:"commit",click:function(e){e.preventDefault(),e.stopPropagation(),r()}}),q(e,n,n.treeStatus,"unmerged")},sort:function(e,t){return"?"===e.treeStatus&&"?"!==t.treeStatus?1:"?"!==e.treeStatus&&"?"===t.treeStatus?-1:e.file.localeCompare(t.file)}});var s=$('<div class="sidebar-version-control-change-container"></div>').appendTo(B.content);a=$('<div class="sidebar-version-control-change-header">Changes to commit</div>').appendTo(s),n=$('<div style="float: right"></div>').appendTo(a);var r=function(){d.val(""),p.attr("disabled",!0),o.css("height","30px"),A.is(":visible")?(A.css("height","30px"),s.css("height","calc(100% - 60px - 175px)")):s.css("height","calc(100% - 30px - 175px)"),commitBox.show(),setTimeout(function(){commitBox.css("height","175px")},10),P.attr("disabled",!0),I.attr("disabled",!0),M.attr("disabled",!0),i.attr("disabled",!0),d.focus()};M=$('<button class="editor-button editor-button-small" style="margin-right: 5px;">commit</button>').appendTo(n).click(function(e){e.preventDefault(),e.stopPropagation(),r()}),I=$('<button class="editor-button editor-button-small"><i class="fa fa-minus"></i> all</button>').appendTo(n).click(function(e){e.preventDefault(),e.stopPropagation(),W(Object.keys(F).filter(function(e){return" "!==F[e].indexStatus&&"?"!==F[e].indexStatus}),!1)}),(N=$("<ol>",{style:"position: absolute; top: 30px; bottom: 0; right:0; left:0;"}).appendTo(s)).editableList({addButton:!1,scrollOnAdd:!1,addItem:function(e,t,n){q(e,n,n.indexStatus,"staged")},sort:function(e,t){return e.file.localeCompare(t.file)}}),commitBox=$('<div class="sidebar-version-control-slide-box sidebar-version-control-slide-box-bottom"></div>').hide().appendTo(B.content);var d=$('<textarea placeholder="Enter your commit message"></textarea>').appendTo(commitBox).on("change keyup paste",function(){p.attr(" Line: 220 -  =$(this).val().trim())}),l=$('<div class="sidebar-version-control-slide-box-toolbar button-group">').appendTo(commitBox),c=$('<button class="editor-button">Cancel</button>').appendTo(l).click(function(e){e.preventDefault(),d.val(""),o.css("height",""),A.css("height",""),s.css("height",""),commitBox.css("height",0),setTimeout(function(){commitBox.hide()},200),P.attr("disabled",!1),I.attr("disabled",!1),M.attr("disabled",!1),i.attr("disabled",!1)}),p=$('<button class="editor-button">Commit</button>').appendTo(l).click(function(e){e.preventDefault();var t=G.addSpinnerOverlay(p).addClass("projects-dialog-spinner-sidebar"),n=RED.projects.getActiveProject();RED.deploy.setDeployInflight(!0),G.sendRequest({url:"projects/"+n.name+"/commit",type:"POST",responses:{0:function(e){console.log(e)},200:function(e){t.remove(),c.click(),Z(!0)},400:{"*":function(e){G.reportUnexpectedError(e)}}}},{message:d.val()}).always(function(){setTimeout(function(){RED.deploy.setDeployInflight(!1)},500)})}),u=O.add({title:"Commit History",collapsible:!0});n=$('<div style="float: right"></div>').appendTo(u.header),$('<button class="editor-button editor-button-small"><i class="fa fa-refresh"></i></button>').appendTo(n).click(function(e){e.preventDefault(),Z(!0,!0)});var f=$('<div class="sidebar-version-control-change-header" style="text-align: right;"></div>').appendTo(u.content),h=$('<button class="editor-button editor-button-small"><i class="fa fa-code-fork"></i> Branch: <span id="sidebar-version-control-local-branch"></span></button>').appendTo(f).click(function(e){if(e.preventDefault(),$(this).hasClass("selected"))v();else{w(),U.show(),$(this).addClass("selected");var t=RED.projects.getActiveProject();b.refresh("projects/"+t.name+"/branches"),m.show(),setTimeout(function(){m.css("height","215px"),b.focus()},100)}}),g=$('<button class="editor-button editor-button-small" style="margin-left: 10px;" id="sidebar-version-control-repo-status-button"><span id="sidebar-version-control-repo-status-stats"><i class="fa fa-long-arrow-up"></i> <span id="sidebar-version-control-commits-ahead"></span> <i class="fa fa-lo Line: 221 -  ></i> <span id="sidebar-version-control-commits-behind"></span></span><span id="sidebar-version-control-repo-status-auth-issue"><i class="fa fa-warning"></i></span></button>').appendTo(f).click(function(e){if(e.preventDefault(),$(this).hasClass("selected"))w();else{v(),U.show(),$(this).addClass("selected");var t=RED.projects.getActiveProject();$("#sidebar-version-control-repo-toolbar-set-upstream-row").toggle(!!t.git.branches.remoteAlt),y.show(),setTimeout(function(){y.css("height","265px")},100)}});J=$("<ol>",{style:"position: absolute; top: 30px; bottom: 0px; right:0; left:0;"}).appendTo(u.content),U=$('<div class="component-shade" style="z-Index: 3"></div>').css("top","30px").hide().appendTo(u.content),J.editableList({addButton:!1,scrollOnAdd:!1,addItem:function(t,e,n){if(t.addClass("sidebar-version-control-commit-entry"),n.url)t.addClass("sidebar-version-control-commit-more"),t.text("+ "+(n.total-n.totalKnown)+" more commit(s)"),t.click(function(e){e.preventDefault(),K(n.url,J,t,n.limit,n.before)});else{t.click(function(e){var t=RED.projects.getActiveProject();t&&$.getJSON("projects/"+t.name+"/commits/"+n.sha,function(e){e.project=t,e.parents=n.parents,e.oldRev=n.sha+"~1",e.newRev=n.sha,e.oldRevTitle="Commit "+n.sha.substring(0,7)+"~1",e.newRevTitle="Commit "+n.sha.substring(0,7),e.date=V(parseInt(n.date)),RED.diff.showCommitDiff(e)})});var o=$("<div>").appendTo(t);if($('<div class="sidebar-version-control-commit-subject">').text(n.subject).appendTo(o),n.refs){var a=$('<div class="sidebar-version-control-commit-refs">').appendTo(o);n.refs.forEach(function(e){var t=e;/HEAD -> /.test(e)&&(t=e.substring(8)),$('<span class="sidebar-version-control-commit-ref">').text(t).appendTo(a)}),t.addClass("sidebar-version-control-commit-head")}$('<div class="sidebar-version-control-commit-sha">').text(n.sha.substring(0,7)).appendTo(o),$('<div class="sidebar-version-control-commit-date">').text(V(parseInt(n.date))).appendTo(o)}}});var v=function(e){h.removeClass("selected"),m.css("height","0"),U.hide(),setTimeout(function(){m.hide(),e&&e()},200)},m=$('<div class="sidebar-version-control- Line: 222 -  bar-version-control-slide-box-top" style="top:30px;"></div>').hide().appendTo(u.content);$('<div class="sidebar-version-control-slide-box-header"></div>').text("Change local branch").appendTo(m);var b=G.createBranchList({placeholder:"Find or create a branch",container:m,onselect:function(e){if(e.current)return v();var t=G.addSpinnerOverlay(m),n=RED.projects.getActiveProject();RED.deploy.setDeployInflight(!0),G.sendRequest({url:"projects/"+n.name+"/branches",type:"POST",requireCleanWorkspace:!0,cancel:function(){t.remove()},responses:{0:function(e){t.remove(),console.log(e)},200:function(e){v(function(){t.remove()})},400:{git_local_overwrite:function(e){t.remove(),RED.notify("You have local changes that would be overwritten by changing the branch. You must either commit or undo those changes first.",{type:"error",timeout:8e3})},unexpected_error:function(e){t.remove(),console.log(e)}}}},e).always(function(){setTimeout(function(){RED.deploy.setDeployInflight(!1)},500)})}}),y=$('<div class="sidebar-version-control-slide-box sidebar-version-control-slide-box-top" style="top:30px"></div>').hide().appendTo(u.content),w=function(){$("#sidebar-version-control-repo-toolbar-set-upstream").prop("checked",!1),g.removeClass("selected"),y.css("height","0"),U.hide(),setTimeout(function(){y.hide(),D()},200)},D=function(e){R.hasClass("selected")&&(R.removeClass("selected"),k.height(0),y.css("height","265px"),setTimeout(function(){k.hide(),e&&e()},200))};$('<div class="sidebar-version-control-slide-box-header"></div>').text("Manage remote branch").appendTo(y);var E=$('<div style="margin-bottom: 5px;"></div>').appendTo(y),R=$('<button id="sidebar-version-control-repo-branch" class="sidebar-version-control-repo-action editor-button"><i class="fa fa-code-fork"></i> Remote: <span id="sidebar-version-control-remote-branch"></span></button>').appendTo(E).click(function(e){if(e.preventDefault(),$(this).hasClass("selected"))D();else{$(this).addClass("selected");var t=RED.projects.getActiveProject();_.refresh("projects/"+t.name+"/branches/remote"),k.show(),setTimeout(function(){k.height(180),y.css("heig Line: 224 -  o=RED.projects.getActiveProject();o.git.branches.remote===e.name?delete o.git.branches.remoteAlt:o.git.branches.remoteAlt=e.name,$("#sidebar-version-control-repo-toolbar-set-upstream-row").toggle(!!o.git.branches.remoteAlt),D(function(){if(e.create)o.git.branches.remote?$("#sidebar-version-control-repo-toolbar-message").text("The branch will be created. Select below to set it as the tracked upstream branch."):($("#sidebar-version-control-repo-toolbar-message").text("The created branch will be set as the tracked upstream branch."),$("#sidebar-version-control-repo-toolbar-set-upstream").prop("checked",!0),$("#sidebar-version-control-repo-toolbar-set-upstream").prop("disabled",!0)),$("#sidebar-version-control-repo-pull").attr("disabled",!0),$("#sidebar-version-control-repo-push").attr("disabled",!1);else{var t=Date.now(),n=G.addSpinnerOverlay($("#sidebar-version-control-repo-toolbar-message")).addClass("projects-dialog-spinner-contain");$.getJSON("projects/"+o.name+"/branches/remote/"+e.name+"/status",function(e){setTimeout(function(){X(e.commits.ahead,e.commits.behind),n.remove()},Math.max(400-(Date.now()-t),0))})}})}}),C=$('<div style="margin-bottom: 5px;"></div>').appendTo(y);$('<button id="sidebar-version-control-repo-push" class="sidebar-version-control-repo-sub-action editor-button"><i class="fa fa-long-arrow-up"></i> <span>push</span></button>').appendTo(C).click(function(e){e.preventDefault();var t=G.addSpinnerOverlay(y).addClass("projects-dialog-spinner-contain"),n=RED.projects.getActiveProject(),o="projects/"+n.name+"/push";n.git.branches.remoteAlt&&(o+="/"+n.git.branches.remoteAlt);var a=$("#sidebar-version-control-repo-toolbar-set-upstream").prop("checked");a&&(o+="?u=true"),G.sendRequest({url:o,type:"POST",responses:{0:function(e){console.log(e)},200:function(e){a&&n.git.branches.remoteAlt&&(n.git.branches.remote=n.git.branches.remoteAlt,delete n.git.branches.remoteAlt),Z(!0),w()},400:{git_push_failed:function(e){RED.notify("NLS: Push failed as the remote has more recent commits. Pull first and write a better error message!","error")},unexpected_error:function(e){co Line: 226 -  ction(){setTimeout(function(){O.resize()},10)}})},show:Q,refresh:Z,showLocalChanges:function(){RED.sidebar.show("version-control"),B.expand()}}}(),RED.touch=RED.touch||{},RED.touch.radialMenu=function(){var f=null,h=!1,g=!1,v=null;return{show:function(e,i,t){h=!0;try{$("body").width(),$("body").height();for(var o=(f=d3.select("body").append("div").style({position:"absolute",top:0,left:0,bottom:0,right:0,"z-index":1e3}).on("touchstart",function(){u(),d3.event.preventDefault()})).append("div").style({position:"absolute",top:i[1]-80+"px",left:i[0]-80+"px","border-radius":"80px",width:"160px",height:"160px",background:"rgba(255,255,255,0.6)",border:"1px solid #666"}),s=[],n=function(e,t,n){n.el=o.append("div").style({position:"absolute",top:t+80-25+"px",left:e+80-25+"px","border-radius":"20px",width:"50px",height:"50px",background:"#fff",border:"2px solid #666","text-align":"center","line-height":"50px"}),n.el.html(n.name),n.disabled&&n.el.style({"border-color":"#ccc",color:"#ccc"}),n.x=e,n.y=t,s.push(n),n.el.on("touchstart",function(){n.el.style("background","#999"),d3.event.preventDefault(),d3.event.stopPropagation()}),n.el.on("touchend",function(){u(),n.onselect(),d3.event.preventDefault(),d3.event.stopPropagation()})},a=t.length,r=Math.max(Math.PI/(a-1),Math.PI/4),d=Math.PI,l=0;l<a;l++){var c=Math.floor(80*Math.cos(d)),p=Math.floor(80*Math.sin(d));t[l].name&&n(c,p,t[l]),d+=r}var u=function(){h=!1,v=null,f.remove(),f=null};e.on("touchend.radial",function(){if(e.on("touchend.radial",null),e.on("touchmenu.radial",null),v){try{v.onselect()}catch(e){RED._debug(e)}u()}else g&&u()}),e.on("touchmove.radial",function(){try{for(var e=d3.event.touches.item(0),t=[e.pageX-i[0],e.pageY-i[1]],n=0;n<s.length;n++){var o=s[n];o.disabled||(t[0]>o.x-30&&t[0]<o.x+30&&t[1]>o.y-30&&t[1]<o.y+30?o!==v&&(o.el.style("background","#999"),v=o):o===v?(o.el.style("background","#fff"),v=null):o.el.style("background","#fff"))}if(!v){var a=Math.abs(t[0]*t[0]+t[1]*t[1]);g=6400<a}}catch(e){RED._debug(e)}})}catch(e){RED._debug(e)}},active:function(){return h}}}();
</Result>
</report_mosca>

<report_mosca>
 <Path>/src/public/red/red.min.js</Path>
 <Module>/app/Mosca/eggs/javascript_common_fail.egg</Module>
 <Title> Possible SQL injection</Title>
 <Description> notification possible SQL injection</Description>
 <Level> High</Level>
 <Reference> https://www.owasp.org/index.php/Testing_for_Stack_Overflow </Reference>
 <Match> query|YQL|WHERE|FROM|SELECT|UPDATE|DELETE|INSERT|UNION|getResults</Match>
 <Result> Line: 128 -  message}))},$.ajax({url:"nodes/"+e,type:"DELETE"}).done(function(e,t,n){o()}).fail(function(e,t,n){o(e)}),i.close()}}]})}(r,t,function(e){})}),r.local||g.hide();var v=$('<a href="#" class="editor-button editor-button-small"></a>').html(RED._("palette.editor.disableall")).appendTo(f),m=$("<div>",{class:"palette-module-content"}).appendTo(t),b=$('<div class="palette-module-shade hide"><img src="red/images/spin.svg" class="palette-spinner"/></div>').appendTo(t);s.elements={updateButton:h,removeButton:g,enableButton:v,errorRow:d,errorList:l,setCount:u,container:t,shade:b,versionSpan:i,sets:{}},p.click(function(e){e.preventDefault(),t.hasClass("expanded")?(t.removeClass("expanded"),m.slideUp()):(t.addClass("expanded"),m.slideDown())});var y=Object.keys(r.sets);y.sort(function(e,t){return e.toLowerCase().localeCompare(t.toLowerCase())}),y.forEach(function(o){var a=r.sets[o],n=$("<div>",{class:"palette-module-set"}).appendTo(m),e=$("<div>",{class:"palette-module-set-button-group"}).appendTo(n),i={};a.types.forEach(function(e){var t=$("<div>",{class:"palette-module-type"}).appendTo(n);i[e]=$("<span>",{class:"palette-module-type-swatch"}).appendTo(t),$("<span>",{class:"palette-module-type-node"}).html(e).appendTo(t)});var t=$('<a href="#" class="editor-button editor-button-small"></a>').appendTo(e);t.click(function(e){if(e.preventDefault(),0===s.setUseCount[o]){var t=RED.nodes.registry.getNodeSet(a.id);b.show();var n=!t.enabled;D(a.id,n,b,function(e){e&&e.responseJSON&&RED.notify(RED._("palette.editor.errors."+(n?"enable":"disable")+"Failed",{module:id,message:e.responseJSON.message}))})}}),s.elements.sets[a.name]={setRow:n,enableButton:t,swatches:i}}),v.click(function(e){e.preventDefault(),0===s.totalUseCount&&D(r.name,t.hasClass("disabled"),b,function(e){e&&e.responseJSON&&RED.notify(RED._("palette.editor.errors.installFailed",{module:id,message:e.responseJSON.message}))})}),R(r.name)}else $("<div>",{class:"red-ui-search-empty"}).html(RED._("search.empty")).appendTo(t)}});var o=$("<div>",{class:"palette-editor-tab hide"}).appendTo(t);c.addTab({id:"install",label:RED._("palette.edito Line: 187 -  ects/"+n,type:"DELETE",responses:{200:function(e){o(!1)},400:{unexpected_error:function(e){a.remove(),o(!0)}}}})}),setTimeout(function(){a.css("left",0)},50)}),i.click(function(e){$(".projects-dialog-project-list-entry").removeClass("selected"),t.addClass("selected"),o=i.parent(),r.select&&r.select(s),d(),a.focus()}),r.dblclick&&i.dblclick(function(e){e.preventDefault(),r.dblclick(s)})}},filter:function(e){return""===t||-1!==e.name.toLowerCase().indexOf(t)}});return $.getJSON("projects",function(e){e.projects.forEach(function(e){l.editableList("addItem",{name:e})})}),e}({canSelectActive:!1,dblclick:function(e){A=e,$("#projects-dialog-create").click()},select:function(e){A=e,o()},delete:function(e){s&&delete s[e.name],A=null,o()}}).appendTo(t),t=$('<div class="form-row projects-dialog-screen-create-row projects-dialog-screen-create-row-empty projects-dialog-screen-create-row-clone"></div>').appendTo(n),$('<label for="projects-dialog-screen-create-project-name">Project name</label>').appendTo(t);var l=$('<div style="position:relative;"></div>').appendTo(t);T=$('<input id="projects-dialog-screen-create-project-name" type="text"></input>').appendTo(l);var c,p,u=$('<div class="projects-dialog-screen-input-status"></div>').appendTo(l),f=!1,h="",g="";T.on("change keyup paste",function(){if(f=T.val()!==h,p)clearTimeout(p);else if(f&&(u.empty(),$('<img src="red/images/spin.svg"/>').appendTo(u),""===T.val()))return void o();p=setTimeout(function(){o(),p=null},300)}),P=$('<label class="projects-edit-form-sublabel"><small>Must contain only A-Z 0-9 _ -</small></label>').appendTo(t).find("small"),t=$('<div class="form-row projects-dialog-screen-create-row projects-dialog-screen-create-row-empty"></div>').appendTo(n),$('<label for="projects-dialog-screen-create-project-desc">Description</label>').appendTo(t),k=$('<input id="projects-dialog-screen-create-project-desc" type="text">').appendTo(t),$('<label class="projects-edit-form-sublabel"><small>Optional</small></label>').appendTo(t),t=$('<div class="form-row projects-dialog-screen-create-row projects-dialog-screen-create-row-empty"></div>' Line: 202 -  ('<span class="entry-detail entry-remote-name">').text(i.remote||"").appendTo(s),0<i.status.ahead+i.status.behind&&$('<span class="entry-detail"><i class="fa fa-long-arrow-up"></i> <span>'+i.status.ahead+'</span> <i class="fa fa-long-arrow-down"></i> <span>'+i.status.behind+"</span></span>").appendTo(s)}if(!i.current){var r=$('<span class="entry-tools">').appendTo(t);$('<button class="editor-button editor-button-small"><i class="fa fa-trash"></i></button>').appendTo(r).click(function(e){e.preventDefault();var n=O.addSpinnerOverlay(a).addClass("projects-dialog-spinner-contain"),o=RED.notify("Are you sure you want to delete the local branch '"+i.name+"'? This cannot be undone.",{type:"warning",modal:!0,fixed:!0,buttons:[{text:RED._("common.label.cancel"),click:function(){n.remove(),o.close()}},{text:"Delete branch",click:function(){o.close();var t={url:"projects/"+d.name+"/branches/"+i.name,type:"DELETE",responses:{200:function(e){a.fadeOut(200,function(){l.editableList("removeItem",i),n.remove()})},400:{git_delete_branch_unmerged:function(e){o=RED.notify("The local branch '"+i.name+"' has unmerged changes that will be lost. Are you sure you want to delete it?",{type:"warning",modal:!0,fixed:!0,buttons:[{text:RED._("common.label.cancel"),click:function(){n.remove(),o.close()}},{text:"Delete unmerged branch",click:function(){t.url+="?force=true",o.close(),O.sendRequest(t)}}]})},"*":function(e){O.reportUnexpectedError(e),n.remove()}}}};O.sendRequest(t)}}]})})}}});$.getJSON("projects/"+d.name+"/branches",function(e){e.branches&&(0<e.branches.length?(e.branches.sort(function(e,t){return e.current?-1:t.current?1:e.name.localeCompare(t.name)}),e.branches.forEach(function(e){l.editableList("addItem",e)})):l.editableList("addItem",{empty:!0}))})}(s,e);var t=$('<div class="user-settings-section"></div>').appendTo(e),n=$("<h4></h4>").text("Git remotes").appendTo(t),o=$('<button class="editor-button editor-button-small" style="float: right; margin-right: 10px;">add remote</button>').appendTo(n).click(function(e){o.attr("disabled",!0),i.slideDown(200,function(){i[0].scrollIntoView(),d?(h.v Line: 203 -  .focus()):h.focus(),p()})}),r={empty:!0},d=!0,a=$('<div class="user-settings-row"></div>').appendTo(t),i=$('<div class="projects-dialog-list-dialog"></div>').hide().appendTo(a);a=$('<div class="user-settings-row projects-dialog-list"></div>').appendTo(t);var l=$("<ol>").appendTo(a);l.editableList({addButton:!1,height:"auto",addItem:function(o,e,a){var t=$('<div class="projects-dialog-list-entry">').appendTo(o);if(a.empty)return t.addClass("red-ui-search-empty"),void t.text("No remotes");$('<span class="entry-icon"><i class="fa fa-globe"></i></span>').appendTo(t);var n=$("<span>").appendTo(t);$('<div class="entry-name">').text(a.name).appendTo(n),a.urls.fetch===a.urls.push?$('<div class="entry-detail">').text(a.urls.fetch).appendTo(n):($('<div class="entry-detail">').text("fetch: "+a.urls.fetch).appendTo(n),$('<div class="entry-detail">').text("push: "+a.urls.push).appendTo(n));var i=$('<span class="entry-tools">').appendTo(t);$('<button class="editor-button editor-button-small"><i class="fa fa-trash"></i></button>').appendTo(i).click(function(e){e.preventDefault();var t=O.addSpinnerOverlay(o).addClass("projects-dialog-spinner-contain"),n=RED.notify("Are you sure you want to delete the remote '"+a.name+"'?",{type:"warning",modal:!0,fixed:!0,buttons:[{text:RED._("common.label.cancel"),click:function(){t.remove(),n.close()}},{text:"Delete remote",click:function(){n.close(),s.git.branches.remote&&0===s.git.branches.remote.indexOf(a.name+"/")&&delete s.git.branches.remote,s.git.branches.remoteAlt&&0===s.git.branches.remoteAlt.indexOf(a.name+"/")&&delete s.git.branches.remoteAlt;var e={url:"projects/"+s.name+"/remotes/"+a.name,type:"DELETE",responses:{200:function(e){o.fadeOut(200,function(){l.editableList("removeItem",a),setTimeout(t.remove,100),0===e.remotes.length?(delete s.git.remotes,d=!0,l.editableList("addItem",r)):(s.git.remotes={},e.remotes.forEach(function(e){var t=e.name;delete e.name,s.git.remotes[t]=e})),delete s.git.branches.remoteAlt,RED.sidebar.versionControl.refresh()})},400:{"*":function(e){O.reportUnexpectedError(e),t.remove()}}}};O.sendRequest(e)}}]})})}});var c Line: 212 -  (function(e){e.stopPropagation();var t=E.addSpinnerOverlay(o).addClass("projects-dialog-spinner-contain"),n=RED.notify("Are you sure you want to delete the SSH key '"+a.name+"'? This cannot be undone.",{type:"warning",modal:!0,fixed:!0,buttons:[{text:RED._("common.label.cancel"),click:function(){t.remove(),n.close()}},{text:"Delete key",click:function(){n.close();var e={url:"settings/user/keys/"+a.name,type:"DELETE",responses:{200:function(e){o.fadeOut(200,function(){y.editableList("removeItem",a),setTimeout(t.remove,100),0===y.editableList("length")&&y.editableList("addItem",m)})},400:{unexpected_error:function(e){console.log(e),t.remove()}}}};E.sendRequest(e)}}]})}),a.expand&&(i=b(t,a))}}),w=function(t){$.getJSON("settings/user/keys",function(e){e.keys&&(e.keys.sort(function(e,t){return e.name.localeCompare(t.name)}),y.editableList("empty"),e.keys.forEach(function(e){e.name===t&&(e.expand=!0),y.editableList("addItem",e)}),0===y.editableList("length")&&y.editableList("addItem",m))})};w()}(t),t}return{init:function(e){E=e,RED.userSettings.add({id:"gitconfig",title:"Git config",get:t,close:function(){var e=RED.settings.get("git")||{};e.user=e.user||{},e.user.name=a.val(),e.user.email=D.val(),RED.settings.set("git",e)}})}}}(),RED.sidebar.versionControl=function(){var S,O,L,P,N,I,r,A,z,M,B,J,U,d,G,F={};function q(n,s,e,r){n.addClass("sidebar-version-control-change-entry");var o=$("<div>").appendTo(n);if(s.label){if(n.addClass("node-info-none"),o.text(s.label),s.button){o.css({display:"inline-block",maxWidth:"300px",textAlign:"left"});var t=$('<div style="float: right; margin: 5px; height: 50px;"></div>').appendTo(o);$('<button class="editor-button editor-button-small"></button>').text(s.button.label).appendTo(t).click(s.button.click)}}else{var a,i,d=$('<i class=""></i>').appendTo(o),l=$('<a href="#">').appendTo(o).click(function(e){var o,a,i,t;e.preventDefault(),o=s,a=r,i=RED.projects.getActiveProject(),t="staged"===a?"index":"tree",G.sendRequest({url:"projects/"+i.name+"/diff/"+t+"/"+encodeURIComponent(o.file),type:"GET",responses:{0:function(e){console.log(e)},200:function(e){ Line: 213 -  ged"===a?"Unstaged changes : "+o.file:"staged"===a?"Staged changes : "+o.file:"Resolve conflicts : "+o.file;var n={diff:e.diff,title:t,unmerged:"unmerged"===a,project:i};"unstaged"==a?(n.oldRevTitle=" "===o.indexStatus?"HEAD":"Staged",n.newRevTitle="Unstaged",n.oldRev=" "===o.indexStatus?"@":":0",n.newRev="_"):"staged"===a?(n.oldRevTitle="HEAD",n.newRevTitle="Staged",n.oldRev="@",n.newRev=":0"):(n.oldRevTitle="Local",n.newRevTitle="Remote",n.commonRev=":1",n.oldRev=":2",n.newRev=":3",n.onresolve=function(e){G.sendRequest({url:"projects/"+i.name+"/resolve/"+encodeURIComponent(o.file),type:"POST",responses:{0:function(e){console.log(e)},200:function(e){Z(!0)},400:{unexpected_error:function(e){console.log(e)}}}},{resolutions:e.resolutions[o.file]})}),RED.diff.showUnifiedDiff(n)},400:{unexpected_error:function(e){console.log(e)}}}})}),c=$("<span>").appendTo(l),p=$('<div class="sidebar-version-control-change-entry-tools">').appendTo(n);"unstaged"===r&&(a=$('<span class="button-group" style="margin-right: 5px;"></span>').appendTo(p),i=$('<button class="editor-button editor-button-small"><i class="fa fa-reply"></i></button>').appendTo(a).click(function(e){e.preventDefault();var t=G.addSpinnerOverlay(o).addClass("projects-dialog-spinner-contain"),n=RED.notify("Are you sure you want to revert the changes to '"+s.file+"'? This cannot be undone.",{type:"warning",modal:!0,fixed:!0,buttons:[{text:RED._("common.label.cancel"),click:function(){t.remove(),n.close()}},{text:"Revert changes",click:function(){n.close();var e={url:"projects/"+RED.projects.getActiveProject().name+"/files/_/"+s.file,type:"DELETE",responses:{200:function(e){t.remove()},400:{unexpected_error:function(e){t.remove(),console.log(e)}}}};RED.deploy.setDeployInflight(!0),G.sendRequest(e).always(function(){setTimeout(function(){RED.deploy.setDeployInflight(!1)},500)})}}]})})),a=$('<span class="button-group"></span>').appendTo(p),"unmerged"!==r&&$('<button class="editor-button editor-button-small"><i class="fa fa-'+("unstaged"===r?"plus":"minus")+'"></i></button>').appendTo(a).click(function(e){e.preventDefault();var t=RED. Line: 214 -  tiveProject();s.spinner=G.addSpinnerOverlay(n).addClass("projects-version-control-spinner-sidebar"),G.sendRequest({url:"projects/"+t.name+"/stage/"+encodeURIComponent(s.file),type:"unstaged"===r?"POST":"DELETE",responses:{0:function(e){console.log(e)},200:function(e){Y(e)},400:{unexpected_error:function(e){console.log(e)}}}},{})}),s["update"+("unstaged"===r?"Unstaged":"Staged")]=function(e,t){o.removeClass();var n="";"A"===t?(o.addClass("node-diff-added"),n="fa-plus-square"):"?"===t?(o.addClass("node-diff-unchanged"),n="fa-question-circle-o"):"D"===t?(o.addClass("node-diff-deleted"),n="fa-minus-square"):"M"===t?(o.addClass("node-diff-changed"),n="fa-square"):"R"===t?(o.addClass("node-diff-changed"),n="fa-toggle-right"):("U"===t&&o.addClass("node-diff-conflicted"),n="fa-exclamation-triangle"),c.empty(),$("<span>").text(e.file.replace(/\\(.)/g,"$1")).appendTo(c),e.oldName&&($('<i class="fa fa-long-arrow-right"></i>').prependTo(c),$("<span>").text(e.oldName.replace(/\\(.)/g,"$1")).prependTo(c)),d.removeClass(),d.addClass("fa "+n),e.spinner&&(e.spinner.remove(),delete e.spinner),i&&i.toggle("?"!==t),l.toggleClass("disabled","D"===t||"?"===t)},s["update"+("unstaged"===r?"Unstaged":"Staged")](s,e)}}function V(e){var t=Date.now()/1e3-e,n=Math.floor(t/86400);if(30<n)return new Date(1e3*e).toLocaleDateString();if(0<n)return n+" day"+(1<n?"s":"")+" ago";var o=Math.floor(t/3600);if(0<o)return o+" hour"+(1<o?"s":"")+" ago";var a=Math.floor(t/60);return 0<a?a+" minute"+(1<a?"s":"")+" ago":"Seconds ago"}function W(e,t){var n=RED.projects.getActiveProject();(r=t?G.addSpinnerOverlay(L.parent()):G.addSpinnerOverlay(N.parent())).addClass("projects-dialog-spinner-sidebar");var o=t?{files:e}:void 0;G.sendRequest({url:"projects/"+n.name+"/stage",type:t?"POST":"DELETE",responses:{0:function(e){console.log(e)},200:function(e){Y(e)},400:{unexpected_error:function(e){console.log(e)}}}},o)}var a=!1,l={label:"None"},H={label:"All conflicts resolved. Commit the changes to complete the merge."};function K(o,a,e,i,t){var s=G.addSpinnerOverlay(e),n=o+"?limit="+(i||20);t&&(n+="&before="+t),G.sendRequest({ur Line: 218 -  ActiveProject();e&&(F={},L.editableList("empty"),N.editableList("empty"),z.editableList("empty"),$.getJSON("projects/"+e.name+"/status",function(e){Y(e)}))}),RED.events.on("login",function(){Z(!0)}),S=$("<div>",{class:"sidebar-version-control"});var t=$("<div>",{class:"sidebar-version-control-stack"}).appendTo(S);O=RED.stack.create({container:t,fill:!0,singleExpanded:!0}),(B=O.add({title:"Local Changes",collapsible:!0})).expand(),B.content.css({height:"100%"});var n=$('<div style="float: right"></div>').appendTo(B.header);$('<button class="editor-button editor-button-small"><i class="fa fa-refresh"></i></button>').appendTo(n).click(function(e){e.preventDefault(),Z(!0)});var o=$('<div class="sidebar-version-control-change-container"></div>').appendTo(B.content),a=$('<div class="sidebar-version-control-change-header">Local files</div>').appendTo(o);P=$('<button class="editor-button editor-button-small" style="float: right"><i class="fa fa-plus"></i> all</button>').appendTo(a).click(function(e){e.preventDefault(),e.stopPropagation(),W(Object.keys(F).filter(function(e){return" "!==F[e].treeStatus}),!0)}),(L=$("<ol>",{style:"position: absolute; top: 30px; bottom: 0; right:0; left:0;"}).appendTo(o)).editableList({addButton:!1,scrollOnAdd:!1,addItem:function(e,t,n){q(e,n,n.treeStatus,"unstaged")},sort:function(e,t){return"?"===e.treeStatus&&"?"!==t.treeStatus?1:"?"!==e.treeStatus&&"?"===t.treeStatus?-1:e.file.localeCompare(t.file)}}),A=$('<div class="sidebar-version-control-change-container"></div>').appendTo(B.content),a=$('<div class="sidebar-version-control-change-header">Unmerged changes</div>').appendTo(A),n=$('<div style="float: right"></div>').appendTo(a);var i=$('<button class="editor-button editor-button-small" style="margin-right: 5px;">abort merge</button>').appendTo(n).click(function(e){e.preventDefault(),e.stopPropagation();var t=G.addSpinnerOverlay(A),n=RED.projects.getActiveProject();RED.deploy.setDeployInflight(!0),G.sendRequest({url:"projects/"+n.name+"/merge",type:"DELETE",responses:{0:function(e){console.log(e)},200:function(e){t.remove(),Z(!0)},400:{unexpected_er</Result>
</report_mosca>

<report_mosca>
 <Path>/src/public/vendor/vendor.js</Path>
 <Module>/app/Mosca/eggs/javascript_common_fail.egg</Module>
 <Title> Possible code injection</Title>
 <Description> Command injection is an attack in which the goal is execution of arbitrary commands on the host operating system via a vulnerable application.</Description>
 <Level> High</Level>
 <Reference> https://www.securecoding.cert.org/confluence/pages/viewpage.action?pageId=2130132 </Reference>
 <Match> eval\s?\(|setTimeout|setInterval</Match>
 <Result> Line: 15 -  ait:1,holdReady:function(a){a?m.readyWait++:m.ready(!0)},ready:function(a){if(a===!0?!--m.readyWait:!m.isReady){if(!y.body)return setTimeout(m.ready);m.isReady=!0,a!==!0&&--m.readyWait>0||(H.resolveWith(y,[m]),m.fn.triggerHandler&&(m(y).triggerHandler("ready"),m(y).off("ready")))}}});function I(){y.addEventListener?(y.removeEventListener("DOMContentLoaded",J,!1),a.removeEventListener("load",J,!1)):(y.detachEvent("onreadystatechange",J),a.detachEvent("onload",J))}function J(){(y.addEventListener||"load"===event.type||"complete"===y.readyState)&&(I(),m.ready())}m.ready.promise=function(b){if(!H)if(H=m.Deferred(),"complete"===y.readyState)setTimeout(m.ready);else if(y.addEventListener)y.addEventListener("DOMContentLoaded",J,!1),a.addEventListener("load",J,!1);else{y.attachEvent("onreadystatechange",J),a.attachEvent("onload",J);var c=!1;try{c=null==a.frameElement&&y.documentElement}catch(d){}c&&c.doScroll&&!function e(){if(!m.isReady){try{c.doScroll("left")}catch(a){return setTimeout(e,50)}I(),m.ready()}}()}return H.promise(b)};var K="undefined",L;for(L in m(k))break;k.ownLast="0"!==L,k.inlineBlockNeedsLayout=!1,m(function(){var a,b,c,d;c=y.getElementsByTagName("body")[0],c&&c.style&&(b=y.createElement("div"),d=y.createElement("div"),d.style.cssText="position:absolute;border:0;width:0;height:0;top:0;left:-9999px",c.appendChild(d).appendChild(b),typeof b.style.zoom!==K&&(b.style.cssText="display:inline;margin:0;border:0;padding:1px;width:1px;zoom:1",k.inlineBlockNeedsLayout=a=3===b.offsetWidth,a&&(c.style.zoom=1)),c.removeChild(d))}),function(){var a=y.createElement("div");if(null==k.deleteExpando){k.deleteExpando=!0;try{delete a.test}catch(b){k.deleteExpando=!1}}a=null}(),m.acceptData=function(a){var b=m.noData[(a.nodeName+" ").toLowerCase()],c=+a.nodeType||1;return 1!==c&&9!==c?!1:!b||b!==!0&&a.getAttribute("classid")===b};var M=/^(?:\{[\w\W]*\}|\[[\w\W]*\])$/,N=/([A-Z])/g;function O(a,b,c){if(void 0===c&&1===a.nodeType){var d="data-"+b.replace(N,"-$1").toLowerCase();if(c=a.getAttribute(d),"string"==typeof c){try{c="true"===c?!0:"false"===c?!1:"null"===c?null:+c+""===c?+c:M.test( Line: 34 -  return new Za.prototype.init(a,b,c,d,e)}m.Tween=Za,Za.prototype={constructor:Za,init:function(a,b,c,d,e,f){this.elem=a,this.prop=c,this.easing=e||"swing",this.options=b,this.start=this.now=this.cur(),this.end=d,this.unit=f||(m.cssNumber[c]?"":"px")},cur:function(){var a=Za.propHooks[this.prop];return a&&a.get?a.get(this):Za.propHooks._default.get(this)},run:function(a){var b,c=Za.propHooks[this.prop];return this.options.duration?this.pos=b=m.easing[this.easing](a,this.options.duration*a,0,1,this.options.duration):this.pos=b=a,this.now=(this.end-this.start)*b+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),c&&c.set?c.set(this):Za.propHooks._default.set(this),this}},Za.prototype.init.prototype=Za.prototype,Za.propHooks={_default:{get:function(a){var b;return null==a.elem[a.prop]||a.elem.style&&null!=a.elem.style[a.prop]?(b=m.css(a.elem,a.prop,""),b&&"auto"!==b?b:0):a.elem[a.prop]},set:function(a){m.fx.step[a.prop]?m.fx.step[a.prop](a):a.elem.style&&(null!=a.elem.style[m.cssProps[a.prop]]||m.cssHooks[a.prop])?m.style(a.elem,a.prop,a.now+a.unit):a.elem[a.prop]=a.now}}},Za.propHooks.scrollTop=Za.propHooks.scrollLeft={set:function(a){a.elem.nodeType&&a.elem.parentNode&&(a.elem[a.prop]=a.now)}},m.easing={linear:function(a){return a},swing:function(a){return.5-Math.cos(a*Math.PI)/2}},m.fx=Za.prototype.init,m.fx.step={};var $a,_a,ab=/^(?:toggle|show|hide)$/,bb=new RegExp("^(?:([+-])=|)("+S+")([a-z%]*)$","i"),cb=/queueHooks$/,db=[ib],eb={"*":[function(a,b){var c=this.createTween(a,b),d=c.cur(),e=bb.exec(b),f=e&&e[3]||(m.cssNumber[a]?"":"px"),g=(m.cssNumber[a]||"px"!==f&&+d)&&bb.exec(m.css(c.elem,a)),h=1,i=20;if(g&&g[3]!==f){f=f||g[3],e=e||[],g=+d||1;do h=h||".5",g/=h,m.style(c.elem,a,g+f);while(h!==(h=c.cur()/d)&&1!==h&&--i)}return e&&(g=c.start=+g||+d||0,c.unit=f,c.end=e[1]?g+(e[1]+1)*e[2]:+e[2]),c}]};function fb(){return setTimeout(function(){$a=void 0}),$a=m.now()}function gb(a,b){var c,d={height:a},e=0;for(b=b?1:0;4>e;e+=2-b)c=T[e],d["margin"+c]=d["padding"+c]=a;return b&&(d.opacity=d.width=a),d}function hb(a,b,c){for(var d,e=(eb[b]||[]).concat(eb["*"]) Line: 37 -  each(function(){var b,c=m._data(this),d=c[a+"queue"],e=c[a+"queueHooks"],f=m.timers,g=d?d.length:0;for(c.finish=!0,m.queue(this,a,[]),e&&e.stop&&e.stop.call(this,!0),b=f.length;b--;)f[b].elem===this&&f[b].queue===a&&(f[b].anim.stop(!0),f.splice(b,1));for(b=0;g>b;b++)d[b]&&d[b].finish&&d[b].finish.call(this);delete c.finish})}}),m.each(["toggle","show","hide"],function(a,b){var c=m.fn[b];m.fn[b]=function(a,d,e){return null==a||"boolean"==typeof a?c.apply(this,arguments):this.animate(gb(b,!0),a,d,e)}}),m.each({slideDown:gb("show"),slideUp:gb("hide"),slideToggle:gb("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(a,b){m.fn[a]=function(a,c,d){return this.animate(b,a,c,d)}}),m.timers=[],m.fx.tick=function(){var a,b=m.timers,c=0;for($a=m.now();c<b.length;c++)a=b[c],a()||b[c]!==a||b.splice(c--,1);b.length||m.fx.stop(),$a=void 0},m.fx.timer=function(a){m.timers.push(a),a()?m.fx.start():m.timers.pop()},m.fx.interval=13,m.fx.start=function(){_a||(_a=setInterval(m.fx.tick,m.fx.interval))},m.fx.stop=function(){clearInterval(_a),_a=null},m.fx.speeds={slow:600,fast:200,_default:400},m.fn.delay=function(a,b){return a=m.fx?m.fx.speeds[a]||a:a,b=b||"fx",this.queue(b,function(b,c){var d=setTimeout(b,a);c.stop=function(){clearTimeout(d)}})},function(){var a,b,c,d,e;b=y.createElement("div"),b.setAttribute("className","t"),b.innerHTML="  <link/><table></table><a href='/a'>a</a><input type='checkbox'/>",d=b.getElementsByTagName("a")[0],c=y.createElement("select"),e=c.appendChild(y.createElement("option")),a=b.getElementsByTagName("input")[0],d.style.cssText="top:1px",k.getSetAttribute="t"!==b.className,k.style=/top/.test(d.getAttribute("style")),k.hrefNormalized="/a"===d.getAttribute("href"),k.checkOn=!!a.value,k.optSelected=e.selected,k.enctype=!!y.createElement("form").enctype,c.disabled=!0,k.optDisabled=!e.disabled,a=y.createElement("input"),a.setAttribute("value",""),k.input=""===a.getAttribute("value"),a.value="t",a.setAttribute("type","radio"),k.radioValue="t"===a.value}();var lb=/\r/g;m.fn.extend({val:function(a){var b,c,d,e=this[0];{if(argum Line: 44 -  eader(d,k.headers[d]);if(k.beforeSend&&(k.beforeSend.call(l,v,k)===!1||2===t))return v.abort();u="abort";for(d in{success:1,error:1,complete:1})v[d](k[d]);if(i=Mb(Ib,k,b,v)){v.readyState=1,h&&n.trigger("ajaxSend",[v,k]),k.async&&k.timeout>0&&(g=setTimeout(function(){v.abort("timeout")},k.timeout));try{t=1,i.send(r,x)}catch(w){if(!(2>t))throw w;x(-1,w)}}else x(-1,"No Transport");function x(a,b,c,d){var j,r,s,u,w,x=b;2!==t&&(t=2,g&&clearTimeout(g),i=void 0,f=d||"",v.readyState=a>0?4:0,j=a>=200&&300>a||304===a,c&&(u=Ob(k,v,c)),u=Pb(k,u,v,j),j?(k.ifModified&&(w=v.getResponseHeader("Last-Modified"),w&&(m.lastModified[e]=w),w=v.getResponseHeader("etag"),w&&(m.etag[e]=w)),204===a||"HEAD"===k.type?x="nocontent":304===a?x="notmodified":(x=u.state,r=u.data,s=u.error,j=!s)):(s=x,(a||!x)&&(x="error",0>a&&(a=0))),v.status=a,v.statusText=(b||x)+"",j?o.resolveWith(l,[r,x,v]):o.rejectWith(l,[v,x,s]),v.statusCode(q),q=void 0,h&&n.trigger(j?"ajaxSuccess":"ajaxError",[v,k,j?r:s]),p.fireWith(l,[v,x]),h&&(n.trigger("ajaxComplete",[v,k]),--m.active||m.event.trigger("ajaxStop")))}return v},getJSON:function(a,b,c){return m.get(a,b,c,"json")},getScript:function(a,b){return m.get(a,void 0,b,"script")}}),m.each(["get","post"],function(a,b){m[b]=function(a,c,d,e){return m.isFunction(c)&&(e=e||d,d=c,c=void 0),m.ajax({url:a,type:b,dataType:e,data:c,success:d})}}),m._evalUrl=function(a){return m.ajax({url:a,type:"GET",dataType:"script",async:!1,global:!1,"throws":!0})},m.fn.extend({wrapAll:function(a){if(m.isFunction(a))return this.each(function(b){m(this).wrapAll(a.call(this,b))});if(this[0]){var b=m(a,this[0].ownerDocument).eq(0).clone(!0);this[0].parentNode&&b.insertBefore(this[0]),b.map(function(){var a=this;while(a.firstChild&&1===a.firstChild.nodeType)a=a.firstChild;return a}).append(this)}return this},wrapInner:function(a){return this.each(m.isFunction(a)?function(b){m(this).wrapInner(a.call(this,b))}:function(){var b=m(this),c=b.contents();c.length?c.wrapAll(a):b.append(a)})},wrap:function(a){var b=m.isFunction(a);return this.each(function(c){m(this).wrapAll(b?a.call(this,c):a)})},unwrap:function(){ Line: 46 -  &f.overrideMimeType(a.mimeType),a.crossDomain||c["X-Requested-With"]||(c["X-Requested-With"]="XMLHttpRequest");for(e in c)void 0!==c[e]&&f.setRequestHeader(e,c[e]+"");f.send(a.hasContent&&a.data||null),b=function(c,e){var h,i,j;if(b&&(e||4===f.readyState))if(delete Xb[g],b=void 0,f.onreadystatechange=m.noop,e)4!==f.readyState&&f.abort();else{j={},h=f.status,"string"==typeof f.responseText&&(j.text=f.responseText);try{i=f.statusText}catch(k){i=""}h||!a.isLocal||a.crossDomain?1223===h&&(h=204):h=j.text?200:404}j&&d(h,i,j,f.getAllResponseHeaders())},a.async?4===f.readyState?setTimeout(b):f.onreadystatechange=Xb[g]=b:b()},abort:function(){b&&b(void 0,!0)}}}});function Zb(){try{return new a.XMLHttpRequest}catch(b){}}function $b(){try{return new a.ActiveXObject("Microsoft.XMLHTTP")}catch(b){}}m.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/(?:java|ecma)script/},converters:{"text script":function(a){return m.globalEval(a),a}}}),m.ajaxPrefilter("script",function(a){void 0===a.cache&&(a.cache=!1),a.crossDomain&&(a.type="GET",a.global=!1)}),m.ajaxTransport("script",function(a){if(a.crossDomain){var b,c=y.head||m("head")[0]||y.documentElement;return{send:function(d,e){b=y.createElement("script"),b.async=!0,a.scriptCharset&&(b.charset=a.scriptCharset),b.src=a.url,b.onload=b.onreadystatechange=function(a,c){(c||!b.readyState||/loaded|complete/.test(b.readyState))&&(b.onload=b.onreadystatechange=null,b.parentNode&&b.parentNode.removeChild(b),b=null,c||e(200,"success"))},c.insertBefore(b,c.firstChild)},abort:function(){b&&b.onload(void 0,!0)}}}});var _b=[],ac=/(=)\?(?=&|$)|\?\?/;m.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var a=_b.pop()||m.expando+"_"+vb++;return this[a]=!0,a}}),m.ajaxPrefilter("json jsonp",function(b,c,d){var e,f,g,h=b.jsonp!==!1&&(ac.test(b.url)?"url":"string"==typeof b.data&&!(b.contentType||"").indexOf("application/x-www-form-urlencoded")&&ac.test(b.data)&&"data");return h||"jsonp"===b.dataTypes[0]?(e=b.jsonpCallback=m.isFunction(b.jsonpCallback)?b.jsonpCallback():b.jso Line: 54 -  !function(e){"use strict";e(function(){e.support.transition=function(){var e=function(){var e=document.createElement("bootstrap"),t={WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd otransitionend",transition:"transitionend"},n;for(n in t)if(e.style[n]!==undefined)return t[n]}();return e&&{end:e}}()})}(window.jQuery),!function(e){"use strict";var t='[data-dismiss="alert"]',n=function(n){e(n).on("click",t,this.close)};n.prototype.close=function(t){function s(){i.trigger("closed").remove()}var n=e(this),r=n.attr("data-target"),i;r||(r=n.attr("href"),r=r&&r.replace(/.*(?=#[^\s]*$)/,"")),i=e(r),t&&t.preventDefault(),i.length||(i=n.hasClass("alert")?n:n.parent()),i.trigger(t=e.Event("close"));if(t.isDefaultPrevented())return;i.removeClass("in"),e.support.transition&&i.hasClass("fade")?i.on(e.support.transition.end,s):s()};var r=e.fn.alert;e.fn.alert=function(t){return this.each(function(){var r=e(this),i=r.data("alert");i||r.data("alert",i=new n(this)),typeof t=="string"&&i[t].call(r)})},e.fn.alert.Constructor=n,e.fn.alert.noConflict=function(){return e.fn.alert=r,this},e(document).on("click.alert.data-api",t,n.prototype.close)}(window.jQuery),!function(e){"use strict";var t=function(t,n){this.$element=e(t),this.options=e.extend({},e.fn.button.defaults,n)};t.prototype.setState=function(e){var t="disabled",n=this.$element,r=n.data(),i=n.is("input")?"val":"html";e+="Text",r.resetText||n.data("resetText",n[i]()),n[i](r[e]||this.options[e]),setTimeout(function(){e=="loadingText"?n.addClass(t).attr(t,t):n.removeClass(t).removeAttr(t)},0)},t.prototype.toggle=function(){var e=this.$element.closest('[data-toggle="buttons-radio"]');e&&e.find(".active").removeClass("active"),this.$element.toggleClass("active")};var n=e.fn.button;e.fn.button=function(n){return this.each(function(){var r=e(this),i=r.data("button"),s=typeof n=="object"&&n;i||r.data("button",i=new t(this,s)),n=="toggle"?i.toggle():n&&i.setState(n)})},e.fn.button.defaults={loadingText:"loading..."},e.fn.button.Constructor=t,e.fn.button.noConflict=function(){return e.fn.button=n,this Line: 55 -  .on("click.button.data-api","[data-toggle^=button]",function(t){var n=e(t.target);n.hasClass("btn")||(n=n.closest(".btn")),n.button("toggle")})}(window.jQuery),!function(e){"use strict";var t=function(t,n){this.$element=e(t),this.$indicators=this.$element.find(".carousel-indicators"),this.options=n,this.options.pause=="hover"&&this.$element.on("mouseenter",e.proxy(this.pause,this)).on("mouseleave",e.proxy(this.cycle,this))};t.prototype={cycle:function(t){return t||(this.paused=!1),this.interval&&clearInterval(this.interval),this.options.interval&&!this.paused&&(this.interval=setInterval(e.proxy(this.next,this),this.options.interval)),this},getActiveIndex:function(){return this.$active=this.$element.find(".item.active"),this.$items=this.$active.parent().children(),this.$items.index(this.$active)},to:function(t){var n=this.getActiveIndex(),r=this;if(t>this.$items.length-1||t<0)return;return this.sliding?this.$element.one("slid",function(){r.to(t)}):n==t?this.pause().cycle():this.slide(t>n?"next":"prev",e(this.$items[t]))},pause:function(t){return t||(this.paused=!0),this.$element.find(".next, .prev").length&&e.support.transition.end&&(this.$element.trigger(e.support.transition.end),this.cycle(!0)),clearInterval(this.interval),this.interval=null,this},next:function(){if(this.sliding)return;return this.slide("next")},prev:function(){if(this.sliding)return;return this.slide("prev")},slide:function(t,n){var r=this.$element.find(".item.active"),i=n||r[t](),s=this.interval,o=t=="next"?"left":"right",u=t=="next"?"first":"last",a=this,f;this.sliding=!0,s&&this.pause(),i=i.length?i:this.$element.find(".item")[u](),f=e.Event("slide",{relatedTarget:i[0],direction:o});if(i.hasClass("active"))return;this.$indicators.length&&(this.$indicators.find(".active").removeClass("active"),this.$element.one("slid",function(){var t=e(a.$indicators.children()[a.getActiveIndex()]);t&&t.addClass("active")}));if(e.support.transition&&this.$element.hasClass("slide")){this.$element.trigger(f);if(f.isDefaultPrevented())return;i.addClass(t),i[0].offsetWidth,r.addClass(o),i.addClass(o),this.$element.one(e.suppor Line: 56 -  end,function(){i.removeClass([t,o].join(" ")).addClass("active"),r.removeClass(["active",o].join(" ")),a.sliding=!1,setTimeout(function(){a.$element.trigger("slid")},0)})}else{this.$element.trigger(f);if(f.isDefaultPrevented())return;r.removeClass("active"),i.addClass("active"),this.sliding=!1,this.$element.trigger("slid")}return s&&this.cycle(),this}};var n=e.fn.carousel;e.fn.carousel=function(n){return this.each(function(){var r=e(this),i=r.data("carousel"),s=e.extend({},e.fn.carousel.defaults,typeof n=="object"&&n),o=typeof n=="string"?n:s.slide;i||r.data("carousel",i=new t(this,s)),typeof n=="number"?i.to(n):o?i[o]():s.interval&&i.pause().cycle()})},e.fn.carousel.defaults={interval:5e3,pause:"hover"},e.fn.carousel.Constructor=t,e.fn.carousel.noConflict=function(){return e.fn.carousel=n,this},e(document).on("click.carousel.data-api","[data-slide], [data-slide-to]",function(t){var n=e(this),r,i=e(n.attr("data-target")||(r=n.attr("href"))&&r.replace(/.*(?=#[^\s]+$)/,"")),s=e.extend({},i.data(),n.data()),o;i.carousel(s),(o=n.attr("data-slide-to"))&&i.data("carousel").pause().to(o).cycle(),t.preventDefault()})}(window.jQuery),!function(e){"use strict";var t=function(t,n){this.$element=e(t),this.options=e.extend({},e.fn.collapse.defaults,n),this.options.parent&&(this.$parent=e(this.options.parent)),this.options.toggle&&this.toggle()};t.prototype={constructor:t,dimension:function(){var e=this.$element.hasClass("width");return e?"width":"height"},show:function(){var t,n,r,i;if(this.transitioning||this.$element.hasClass("in"))return;t=this.dimension(),n=e.camelCase(["scroll",t].join("-")),r=this.$parent&&this.$parent.find("> .accordion-group > .in");if(r&&r.length){i=r.data("collapse");if(i&&i.transitioning)return;r.collapse("hide"),i||r.data("collapse",null)}this.$element[t](0),this.transition("addClass",e.Event("show"),"shown"),e.support.transition&&this.$element[t](this.$element[0][n])},hide:function(){var t;if(this.transitioning||!this.$element.hasClass("in"))return;t=this.dimension(),this.reset(this.$element[t]()),this.transition("removeClass",e.Event("hide"),"hidden"),this.$e Line: 59 -  dal()},enforceFocus:function(){var t=this;e(document).on("focusin.modal",function(e){t.$element[0]!==e.target&&!t.$element.has(e.target).length&&t.$element.focus()})},escape:function(){var e=this;this.isShown&&this.options.keyboard?this.$element.on("keyup.dismiss.modal",function(t){t.which==27&&e.hide()}):this.isShown||this.$element.off("keyup.dismiss.modal")},hideWithTransition:function(){var t=this,n=setTimeout(function(){t.$element.off(e.support.transition.end),t.hideModal()},500);this.$element.one(e.support.transition.end,function(){clearTimeout(n),t.hideModal()})},hideModal:function(){var e=this;this.$element.hide(),this.backdrop(function(){e.removeBackdrop(),e.$element.trigger("hidden")})},removeBackdrop:function(){this.$backdrop&&this.$backdrop.remove(),this.$backdrop=null},backdrop:function(t){var n=this,r=this.$element.hasClass("fade")?"fade":"";if(this.isShown&&this.options.backdrop){var i=e.support.transition&&r;this.$backdrop=e('<div class="modal-backdrop '+r+'" />').appendTo(document.body),this.$backdrop.click(this.options.backdrop=="static"?e.proxy(this.$element[0].focus,this.$element[0]):e.proxy(this.hide,this)),i&&this.$backdrop[0].offsetWidth,this.$backdrop.addClass("in");if(!t)return;i?this.$backdrop.one(e.support.transition.end,t):t()}else!this.isShown&&this.$backdrop?(this.$backdrop.removeClass("in"),e.support.transition&&this.$element.hasClass("fade")?this.$backdrop.one(e.support.transition.end,t):t()):t&&t()}};var n=e.fn.modal;e.fn.modal=function(n){return this.each(function(){var r=e(this),i=r.data("modal"),s=e.extend({},e.fn.modal.defaults,r.data(),typeof n=="object"&&n);i||r.data("modal",i=new t(this,s)),typeof n=="string"?i[n]():s.show&&i.show()})},e.fn.modal.defaults={backdrop:!0,keyboard:!0,show:!0},e.fn.modal.Constructor=t,e.fn.modal.noConflict=function(){return e.fn.modal=n,this},e(document).on("click.modal.data-api",'[data-toggle="modal"]',function(t){var n=e(this),r=n.attr("href"),i=e(n.attr("data-target")||r&&r.replace(/.*(?=#[^\s]+$)/,"")),s=i.data("modal")?"toggle":e.extend({remote:!/#/.test(r)&&r},i.data(),n.data());t.preventDefault(),i.moda Line: 60 -  e",function(){n.focus()})})}(window.jQuery),!function(e){"use strict";var t=function(e,t){this.init("tooltip",e,t)};t.prototype={constructor:t,init:function(t,n,r){var i,s,o,u,a;this.type=t,this.$element=e(n),this.options=this.getOptions(r),this.enabled=!0,o=this.options.trigger.split(" ");for(a=o.length;a--;)u=o[a],u=="click"?this.$element.on("click."+this.type,this.options.selector,e.proxy(this.toggle,this)):u!="manual"&&(i=u=="hover"?"mouseenter":"focus",s=u=="hover"?"mouseleave":"blur",this.$element.on(i+"."+this.type,this.options.selector,e.proxy(this.enter,this)),this.$element.on(s+"."+this.type,this.options.selector,e.proxy(this.leave,this)));this.options.selector?this._options=e.extend({},this.options,{trigger:"manual",selector:""}):this.fixTitle()},getOptions:function(t){return t=e.extend({},e.fn[this.type].defaults,this.$element.data(),t),t.delay&&typeof t.delay=="number"&&(t.delay={show:t.delay,hide:t.delay}),t},enter:function(t){var n=e.fn[this.type].defaults,r={},i;this._options&&e.each(this._options,function(e,t){n[e]!=t&&(r[e]=t)},this),i=e(t.currentTarget)[this.type](r).data(this.type);if(!i.options.delay||!i.options.delay.show)return i.show();clearTimeout(this.timeout),i.hoverState="in",this.timeout=setTimeout(function(){i.hoverState=="in"&&i.show()},i.options.delay.show)},leave:function(t){var n=e(t.currentTarget)[this.type](this._options).data(this.type);this.timeout&&clearTimeout(this.timeout);if(!n.options.delay||!n.options.delay.hide)return n.hide();n.hoverState="out",this.timeout=setTimeout(function(){n.hoverState=="out"&&n.hide()},n.options.delay.hide)},show:function(){var t,n,r,i,s,o,u=e.Event("show");if(this.hasContent()&&this.enabled){this.$element.trigger(u);if(u.isDefaultPrevented())return;t=this.tip(),this.setContent(),this.options.animation&&t.addClass("fade"),s=typeof this.options.placement=="function"?this.options.placement.call(this,t[0],this.$element[0]):this.options.placement,t.detach().css({top:0,left:0,display:"block"}),this.options.container?t.appendTo(this.options.container):t.insertAfter(this.$element),n=this.getPosition(),r=t[0].offset Line: 61 -  offsetHeight;switch(s){case"bottom":o={top:n.top+n.height,left:n.left+n.width/2-r/2};break;case"top":o={top:n.top-i,left:n.left+n.width/2-r/2};break;case"left":o={top:n.top+n.height/2-i/2,left:n.left-r};break;case"right":o={top:n.top+n.height/2-i/2,left:n.left+n.width}}this.applyPlacement(o,s),this.$element.trigger("shown")}},applyPlacement:function(e,t){var n=this.tip(),r=n[0].offsetWidth,i=n[0].offsetHeight,s,o,u,a;n.offset(e).addClass(t).addClass("in"),s=n[0].offsetWidth,o=n[0].offsetHeight,t=="top"&&o!=i&&(e.top=e.top+i-o,a=!0),t=="bottom"||t=="top"?(u=0,e.left<0&&(u=e.left*-2,e.left=0,n.offset(e),s=n[0].offsetWidth,o=n[0].offsetHeight),this.replaceArrow(u-r+s,s,"left")):this.replaceArrow(o-i,o,"top"),a&&n.offset(e)},replaceArrow:function(e,t,n){this.arrow().css(n,e?50*(1-e/t)+"%":"")},setContent:function(){var e=this.tip(),t=this.getTitle();e.find(".tooltip-inner")[this.options.html?"html":"text"](t),e.removeClass("fade in top bottom left right")},hide:function(){function i(){var t=setTimeout(function(){n.off(e.support.transition.end).detach()},500);n.one(e.support.transition.end,function(){clearTimeout(t),n.detach()})}var t=this,n=this.tip(),r=e.Event("hide");this.$element.trigger(r);if(r.isDefaultPrevented())return;return n.removeClass("in"),e.support.transition&&this.$tip.hasClass("fade")?i():n.detach(),this.$element.trigger("hidden"),this},fixTitle:function(){var e=this.$element;(e.attr("title")||typeof e.attr("data-original-title")!="string")&&e.attr("data-original-title",e.attr("title")||"").attr("title","")},hasContent:function(){return this.getTitle()},getPosition:function(){var t=this.$element[0];return e.extend({},typeof t.getBoundingClientRect=="function"?t.getBoundingClientRect():{width:t.offsetWidth,height:t.offsetHeight},this.$element.offset())},getTitle:function(){var e,t=this.$element,n=this.options;return e=t.attr("data-original-title")||(typeof n.title=="function"?n.title.call(t[0]):n.title),e},tip:function(){return this.$tip=this.$tip||e(this.options.template)},arrow:function(){return this.$arrow=this.$arrow||this.tip().find(".tooltip-arrow")},validate: Line: 66 -  k;case 38:e.preventDefault(),this.prev();break;case 40:e.preventDefault(),this.next()}e.stopPropagation()},keydown:function(t){this.suppressKeyPressRepeat=~e.inArray(t.keyCode,[40,38,9,13,27]),this.move(t)},keypress:function(e){if(this.suppressKeyPressRepeat)return;this.move(e)},keyup:function(e){switch(e.keyCode){case 40:case 38:case 16:case 17:case 18:break;case 9:case 13:if(!this.shown)return;this.select();break;case 27:if(!this.shown)return;this.hide();break;default:this.lookup()}e.stopPropagation(),e.preventDefault()},focus:function(e){this.focused=!0},blur:function(e){this.focused=!1,!this.mousedover&&this.shown&&this.hide()},click:function(e){e.stopPropagation(),e.preventDefault(),this.select(),this.$element.focus()},mouseenter:function(t){this.mousedover=!0,this.$menu.find(".active").removeClass("active"),e(t.currentTarget).addClass("active")},mouseleave:function(e){this.mousedover=!1,!this.focused&&this.shown&&this.hide()}};var n=e.fn.typeahead;e.fn.typeahead=function(n){return this.each(function(){var r=e(this),i=r.data("typeahead"),s=typeof n=="object"&&n;i||r.data("typeahead",i=new t(this,s)),typeof n=="string"&&i[n]()})},e.fn.typeahead.defaults={source:[],items:8,menu:'<ul class="typeahead dropdown-menu"></ul>',item:'<li><a href="#"></a></li>',minLength:1},e.fn.typeahead.Constructor=t,e.fn.typeahead.noConflict=function(){return e.fn.typeahead=n,this},e(document).on("focus.typeahead.data-api",'[data-provide="typeahead"]',function(t){var n=e(this);if(n.data("typeahead"))return;n.typeahead(n.data())})}(window.jQuery),!function(e){"use strict";var t=function(t,n){this.options=e.extend({},e.fn.affix.defaults,n),this.$window=e(window).on("scroll.affix.data-api",e.proxy(this.checkPosition,this)).on("click.affix.data-api",e.proxy(function(){setTimeout(e.proxy(this.checkPosition,this),1)},this)),this.$element=e(t),this.checkPosition()};t.prototype.checkPosition=function(){if(!this.$element.is(":visible"))return;var t=e(document).height(),n=this.$window.scrollTop(),r=this.$element.offset(),i=this.options.offset,s=i.bottom,o=i.top,u="affix affix-top affix-bottom",a;typeof i! Line: 72 -  (function(e,t){function i(t,i){var a,n,r,o=t.nodeName.toLowerCase();return"area"===o?(a=t.parentNode,n=a.name,t.href&&n&&"map"===a.nodeName.toLowerCase()?(r=e("img[usemap=#"+n+"]")[0],!!r&&s(r)):!1):(/input|select|textarea|button|object/.test(o)?!t.disabled:"a"===o?t.href||i:i)&&s(t)}function s(t){return e.expr.filters.visible(t)&&!e(t).parents().addBack().filter(function(){return"hidden"===e.css(this,"visibility")}).length}var a=0,n=/^ui-id-\d+$/;e.ui=e.ui||{},e.extend(e.ui,{version:"1.10.3",keyCode:{BACKSPACE:8,COMMA:188,DELETE:46,DOWN:40,END:35,ENTER:13,ESCAPE:27,HOME:36,LEFT:37,NUMPAD_ADD:107,NUMPAD_DECIMAL:110,NUMPAD_DIVIDE:111,NUMPAD_ENTER:108,NUMPAD_MULTIPLY:106,NUMPAD_SUBTRACT:109,PAGE_DOWN:34,PAGE_UP:33,PERIOD:190,RIGHT:39,SPACE:32,TAB:9,UP:38}}),e.fn.extend({focus:function(t){return function(i,s){return"number"==typeof i?this.each(function(){var t=this;setTimeout(function(){e(t).focus(),s&&s.call(t)},i)}):t.apply(this,arguments)}}(e.fn.focus),scrollParent:function(){var t;return t=e.ui.ie&&/(static|relative)/.test(this.css("position"))||/absolute/.test(this.css("position"))?this.parents().filter(function(){return/(relative|absolute|fixed)/.test(e.css(this,"position"))&&/(auto|scroll)/.test(e.css(this,"overflow")+e.css(this,"overflow-y")+e.css(this,"overflow-x"))}).eq(0):this.parents().filter(function(){return/(auto|scroll)/.test(e.css(this,"overflow")+e.css(this,"overflow-y")+e.css(this,"overflow-x"))}).eq(0),/fixed/.test(this.css("position"))||!t.length?e(document):t},zIndex:function(i){if(i!==t)return this.css("zIndex",i);if(this.length)for(var s,a,n=e(this[0]);n.length&&n[0]!==document;){if(s=n.css("position"),("absolute"===s||"relative"===s||"fixed"===s)&&(a=parseInt(n.css("zIndex"),10),!isNaN(a)&&0!==a))return a;n=n.parent()}return 0},uniqueId:function(){return this.each(function(){this.id||(this.id="ui-id-"+ ++a)})},removeUniqueId:function(){return this.each(function(){n.test(this.id)&&e(this).removeAttr("id")})}}),e.extend(e.expr[":"],{data:e.expr.createPseudo?e.expr.createPseudo(function(t){return function(i){return!!e.data(i,t)}}):function(t,i,s){return!!e.d Line: 76 -  disabled",!1)},disable:function(){return this._setOption("disabled",!0)},_on:function(i,s,n){var a,r=this;"boolean"!=typeof i&&(n=s,s=i,i=!1),n?(s=a=e(s),this.bindings=this.bindings.add(s)):(n=s,s=this.element,a=this.widget()),e.each(n,function(n,o){function h(){return i||r.options.disabled!==!0&&!e(this).hasClass("ui-state-disabled")?("string"==typeof o?r[o]:o).apply(r,arguments):t}"string"!=typeof o&&(h.guid=o.guid=o.guid||h.guid||e.guid++);var l=n.match(/^(\w+)\s*(.*)$/),u=l[1]+r.eventNamespace,c=l[2];c?a.delegate(c,u,h):s.bind(u,h)})},_off:function(e,t){t=(t||"").split(" ").join(this.eventNamespace+" ")+this.eventNamespace,e.unbind(t).undelegate(t)},_delay:function(e,t){function i(){return("string"==typeof e?s[e]:e).apply(s,arguments)}var s=this;return setTimeout(i,t||0)},_hoverable:function(t){this.hoverable=this.hoverable.add(t),this._on(t,{mouseenter:function(t){e(t.currentTarget).addClass("ui-state-hover")},mouseleave:function(t){e(t.currentTarget).removeClass("ui-state-hover")}})},_focusable:function(t){this.focusable=this.focusable.add(t),this._on(t,{focusin:function(t){e(t.currentTarget).addClass("ui-state-focus")},focusout:function(t){e(t.currentTarget).removeClass("ui-state-focus")}})},_trigger:function(t,i,s){var n,a,r=this.options[t];if(s=s||{},i=e.Event(i),i.type=(t===this.widgetEventPrefix?t:this.widgetEventPrefix+t).toLowerCase(),i.target=this.element[0],a=i.originalEvent)for(n in a)n in i||(i[n]=a[n]);return this.element.trigger(i,s),!(e.isFunction(r)&&r.apply(this.element[0],[i].concat(s))===!1||i.isDefaultPrevented())}},e.each({show:"fadeIn",hide:"fadeOut"},function(t,i){e.Widget.prototype["_"+t]=function(s,n,a){"string"==typeof n&&(n={effect:n});var r,o=n?n===!0||"number"==typeof n?i:n.effect||i:t;n=n||{},"number"==typeof n&&(n={duration:n}),r=!e.isEmptyObject(n),n.complete=a,n.delay&&s.delay(n.delay),r&&e.effects&&e.effects.effect[o]?s[t](n):o!==t&&s[o]?s[o](n.duration,n.easing,a):s.queue(function(i){e(this)[t](),a&&a.call(s[0]),i()})}})})(jQuery);(function(e){var t=!1;e(document).mouseup(function(){t=!1}),e.widget("ui.mouse",{version:"1.10.3",options:{c Line: 77 -  textarea,button,select,option",distance:1,delay:0},_mouseInit:function(){var t=this;this.element.bind("mousedown."+this.widgetName,function(e){return t._mouseDown(e)}).bind("click."+this.widgetName,function(i){return!0===e.data(i.target,t.widgetName+".preventClickEvent")?(e.removeData(i.target,t.widgetName+".preventClickEvent"),i.stopImmediatePropagation(),!1):undefined}),this.started=!1},_mouseDestroy:function(){this.element.unbind("."+this.widgetName),this._mouseMoveDelegate&&e(document).unbind("mousemove."+this.widgetName,this._mouseMoveDelegate).unbind("mouseup."+this.widgetName,this._mouseUpDelegate)},_mouseDown:function(i){if(!t){this._mouseStarted&&this._mouseUp(i),this._mouseDownEvent=i;var s=this,n=1===i.which,a="string"==typeof this.options.cancel&&i.target.nodeName?e(i.target).closest(this.options.cancel).length:!1;return n&&!a&&this._mouseCapture(i)?(this.mouseDelayMet=!this.options.delay,this.mouseDelayMet||(this._mouseDelayTimer=setTimeout(function(){s.mouseDelayMet=!0},this.options.delay)),this._mouseDistanceMet(i)&&this._mouseDelayMet(i)&&(this._mouseStarted=this._mouseStart(i)!==!1,!this._mouseStarted)?(i.preventDefault(),!0):(!0===e.data(i.target,this.widgetName+".preventClickEvent")&&e.removeData(i.target,this.widgetName+".preventClickEvent"),this._mouseMoveDelegate=function(e){return s._mouseMove(e)},this._mouseUpDelegate=function(e){return s._mouseUp(e)},e(document).bind("mousemove."+this.widgetName,this._mouseMoveDelegate).bind("mouseup."+this.widgetName,this._mouseUpDelegate),i.preventDefault(),t=!0,!0)):!0}},_mouseMove:function(t){return e.ui.ie&&(!document.documentMode||9>document.documentMode)&&!t.button?this._mouseUp(t):this._mouseStarted?(this._mouseDrag(t),t.preventDefault()):(this._mouseDistanceMet(t)&&this._mouseDelayMet(t)&&(this._mouseStarted=this._mouseStart(this._mouseDownEvent,t)!==!1,this._mouseStarted?this._mouseDrag(t):this._mouseUp(t)),!this._mouseStarted)},_mouseUp:function(t){return e(document).unbind("mousemove."+this.widgetName,this._mouseMoveDelegate).unbind("mouseup."+this.widgetName,this._mouseUpDelegate),this._mouseStarted&&(this Line: 121 -  +(t>1?" results are":" result is")+" available, use up and down arrow keys to navigate."}}},__response:function(t){var e;this._superApply(arguments),this.options.disabled||this.cancelSearch||(e=t&&t.length?this.options.messages.results(t.length):this.options.messages.noResults,this.liveRegion.text(e))}})})(jQuery);(function(t){var e,i,s,n,a="ui-button ui-widget ui-state-default ui-corner-all",o="ui-state-hover ui-state-active ",r="ui-button-icons-only ui-button-icon-only ui-button-text-icons ui-button-text-icon-primary ui-button-text-icon-secondary ui-button-text-only",h=function(){var e=t(this);setTimeout(function(){e.find(":ui-button").button("refresh")},1)},l=function(e){var i=e.name,s=e.form,n=t([]);return i&&(i=i.replace(/'/g,"\\'"),n=s?t(s).find("[name='"+i+"']"):t("[name='"+i+"']",e.ownerDocument).filter(function(){return!this.form})),n};t.widget("ui.button",{version:"1.10.3",defaultElement:"<button>",options:{disabled:null,text:!0,label:null,icons:{primary:null,secondary:null}},_create:function(){this.element.closest("form").unbind("reset"+this.eventNamespace).bind("reset"+this.eventNamespace,h),"boolean"!=typeof this.options.disabled?this.options.disabled=!!this.element.prop("disabled"):this.element.prop("disabled",this.options.disabled),this._determineButtonType(),this.hasTitle=!!this.buttonElement.attr("title");var o=this,r=this.options,c="checkbox"===this.type||"radio"===this.type,u=c?"":"ui-state-active",d="ui-state-focus";null===r.label&&(r.label="input"===this.type?this.buttonElement.val():this.buttonElement.html()),this._hoverable(this.buttonElement),this.buttonElement.addClass(a).attr("role","button").bind("mouseenter"+this.eventNamespace,function(){r.disabled||this===e&&t(this).addClass("ui-state-active")}).bind("mouseleave"+this.eventNamespace,function(){r.disabled||t(this).removeClass(u)}).bind("click"+this.eventNamespace,function(t){r.disabled&&(t.preventDefault(),t.stopImmediatePropagation())}),this.element.bind("focus"+this.eventNamespace,function(){o.buttonElement.addClass(d)}).bind("blur"+this.eventNamespace,function(){o.buttonElement.removeClass(d)}) Line: 131 -  generateHTML(e)),this._attachHandlers(e),e.dpDiv.find("."+this._dayOverClass+" a").mouseover();var i,s=this._getNumberOfMonths(e),n=s[1],r=17;e.dpDiv.removeClass("ui-datepicker-multi-2 ui-datepicker-multi-3 ui-datepicker-multi-4").width(""),n>1&&e.dpDiv.addClass("ui-datepicker-multi-"+n).css("width",r*n+"em"),e.dpDiv[(1!==s[0]||1!==s[1]?"add":"remove")+"Class"]("ui-datepicker-multi"),e.dpDiv[(this._get(e,"isRTL")?"add":"remove")+"Class"]("ui-datepicker-rtl"),e===t.datepicker._curInst&&t.datepicker._datepickerShowing&&t.datepicker._shouldFocusInput(e)&&e.input.focus(),e.yearshtml&&(i=e.yearshtml,setTimeout(function(){i===e.yearshtml&&e.yearshtml&&e.dpDiv.find("select.ui-datepicker-year:first").replaceWith(e.yearshtml),i=e.yearshtml=null},0))},_shouldFocusInput:function(t){return t.input&&t.input.is(":visible")&&!t.input.is(":disabled")&&!t.input.is(":focus")},_checkOffset:function(e,i,s){var n=e.dpDiv.outerWidth(),a=e.dpDiv.outerHeight(),r=e.input?e.input.outerWidth():0,o=e.input?e.input.outerHeight():0,h=document.documentElement.clientWidth+(s?0:t(document).scrollLeft()),l=document.documentElement.clientHeight+(s?0:t(document).scrollTop());return i.left-=this._get(e,"isRTL")?n-r:0,i.left-=s&&i.left===e.input.offset().left?t(document).scrollLeft():0,i.top-=s&&i.top===e.input.offset().top+o?t(document).scrollTop():0,i.left-=Math.min(i.left,i.left+n>h&&h>n?Math.abs(i.left+n-h):0),i.top-=Math.min(i.top,i.top+a>l&&l>a?Math.abs(a+o):0),i},_findPos:function(e){for(var i,s=this._getInst(e),n=this._get(s,"isRTL");e&&("hidden"===e.type||1!==e.nodeType||t.expr.filters.hidden(e));)e=e[n?"previousSibling":"nextSibling"];return i=t(e).offset(),[i.left,i.top]},_hideDatepicker:function(e){var i,s,n,a,o=this._curInst;!o||e&&o!==t.data(e,r)||this._datepickerShowing&&(i=this._get(o,"showAnim"),s=this._get(o,"duration"),n=function(){t.datepicker._tidyDialog(o)},t.effects&&(t.effects.effect[i]||t.effects[i])?o.dpDiv.hide(i,t.datepicker._get(o,"showOptions"),s,n):o.dpDiv["slideDown"===i?"slideUp":"fadeIn"===i?"fadeOut":"hide"](i?s:null,n),i||n(),this._datepickerShowing=!1,a=this._get(o,"onClose"), Line: 165 -  is.tabs,function(t,e){return e!==i?e:null})),this._setupDisabled(s))},disable:function(i){var s=this.options.disabled;if(s!==!0){if(i===e)s=!0;else{if(i=this._getIndex(i),-1!==t.inArray(i,s))return;s=t.isArray(s)?t.merge([i],s).sort():[i]}this._setupDisabled(s)}},load:function(e,i){e=this._getIndex(e);var n=this,a=this.tabs.eq(e),o=a.find(".ui-tabs-anchor"),r=this._getPanelForTab(a),h={tab:a,panel:r};s(o[0])||(this.xhr=t.ajax(this._ajaxSettings(o,i,h)),this.xhr&&"canceled"!==this.xhr.statusText&&(a.addClass("ui-tabs-loading"),r.attr("aria-busy","true"),this.xhr.success(function(t){setTimeout(function(){r.html(t),n._trigger("load",i,h)},1)}).complete(function(t,e){setTimeout(function(){"abort"===e&&n.panels.stop(!1,!0),a.removeClass("ui-tabs-loading"),r.removeAttr("aria-busy"),t===n.xhr&&delete n.xhr},1)})))},_ajaxSettings:function(e,i,s){var n=this;return{url:e.attr("href"),beforeSend:function(e,a){return n._trigger("beforeLoad",i,t.extend({jqXHR:e,ajaxSettings:a},s))}}},_getPanelForTab:function(e){var i=t(e).attr("aria-controls");return this.element.find(this._sanitizeSelector("#"+i))}})})(jQuery);(function(t){function e(e,i){var s=(e.attr("aria-describedby")||"").split(/\s+/);s.push(i),e.data("ui-tooltip-id",i).attr("aria-describedby",t.trim(s.join(" ")))}function i(e){var i=e.data("ui-tooltip-id"),s=(e.attr("aria-describedby")||"").split(/\s+/),n=t.inArray(i,s);-1!==n&&s.splice(n,1),e.removeData("ui-tooltip-id"),s=t.trim(s.join(" ")),s?e.attr("aria-describedby",s):e.removeAttr("aria-describedby")}var s=0;t.widget("ui.tooltip",{version:"1.10.3",options:{content:function(){var e=t(this).attr("title")||"";return t("<a>").text(e).html()},hide:!0,items:"[title]:not([disabled])",position:{my:"left top+15",at:"left bottom",collision:"flipfit flip"},show:!0,tooltipClass:null,track:!1,close:null,open:null},_create:function(){this._on({mouseover:"open",focusin:"open"}),this.tooltips={},this.parents={},this.options.disabled&&this._disable()},_setOption:function(e,i){var s=this;return"disabled"===e?(this[i?"_disable":"_enable"](),this.options[e]=i,void 0):(this._super(e,i),"content"== Line: 166 -  s.tooltips,function(t,e){s._updateContent(e)}),void 0)},_disable:function(){var e=this;t.each(this.tooltips,function(i,s){var n=t.Event("blur");n.target=n.currentTarget=s[0],e.close(n,!0)}),this.element.find(this.options.items).addBack().each(function(){var e=t(this);e.is("[title]")&&e.data("ui-tooltip-title",e.attr("title")).attr("title","")})},_enable:function(){this.element.find(this.options.items).addBack().each(function(){var e=t(this);e.data("ui-tooltip-title")&&e.attr("title",e.data("ui-tooltip-title"))})},open:function(e){var i=this,s=t(e?e.target:this.element).closest(this.options.items);s.length&&!s.data("ui-tooltip-id")&&(s.attr("title")&&s.data("ui-tooltip-title",s.attr("title")),s.data("ui-tooltip-open",!0),e&&"mouseover"===e.type&&s.parents().each(function(){var e,s=t(this);s.data("ui-tooltip-open")&&(e=t.Event("blur"),e.target=e.currentTarget=this,i.close(e,!0)),s.attr("title")&&(s.uniqueId(),i.parents[this.id]={element:this,title:s.attr("title")},s.attr("title",""))}),this._updateContent(s,e))},_updateContent:function(t,e){var i,s=this.options.content,n=this,a=e?e.type:null;return"string"==typeof s?this._open(e,t,s):(i=s.call(t[0],function(i){t.data("ui-tooltip-open")&&n._delay(function(){e&&(e.type=a),this._open(e,t,i)})}),i&&this._open(e,t,i),void 0)},_open:function(i,s,n){function a(t){l.of=t,o.is(":hidden")||o.position(l)}var o,r,h,l=t.extend({},this.options.position);if(n){if(o=this._find(s),o.length)return o.find(".ui-tooltip-content").html(n),void 0;s.is("[title]")&&(i&&"mouseover"===i.type?s.attr("title",""):s.removeAttr("title")),o=this._tooltip(s),e(s,o.attr("id")),o.find(".ui-tooltip-content").html(n),this.options.track&&i&&/^mouse/.test(i.type)?(this._on(this.document,{mousemove:a}),a(i)):o.position(t.extend({of:s},this.options.position)),o.hide(),this._show(o,this.options.show),this.options.show&&this.options.show.delay&&(h=this.delayedShow=setInterval(function(){o.is(":visible")&&(a(l.of),clearInterval(h))},t.fx.interval)),this._trigger("open",i,{tooltip:o}),r={keyup:function(e){if(e.keyCode===t.ui.keyCode.ESCAPE){var i=t.Event(e);i.currentTarget Line: 207 -  {return Iu(t,xa),t}function Cn(t,n){return Iu(t,wa),t.id=n,t}function zn(t,n,e,r){var i=t.__transition__||(t.__transition__={active:0,count:0}),a=i[e];if(!a){var o=r.time;return a=i[e]={tween:new u,event:d3.dispatch("start","end"),time:o,ease:r.ease,delay:r.delay,duration:r.duration},++i.count,d3.timer(function(r){function u(r){return i.active>e?l():(i.active=e,h.start.call(t,s,n),a.tween.forEach(function(e,r){(r=r.call(t,s,n))&&p.push(r)}),c(r)||d3.timer(c,0,o),1)}function c(r){if(i.active!==e)return l();for(var u=(r-d)/g,a=f(u),o=p.length;o>0;)p[--o].call(t,a);return u>=1?(l(),h.end.call(t,s,n),1):void 0}function l(){return--i.count?delete i[e]:delete t.__transition__,1}var s=t.__data__,f=a.ease,h=a.event,d=a.delay,g=a.duration,p=[];return r>=d?u(r):d3.timer(u,d,o),1},0,o),a}}function Dn(t){return null==t&&(t=""),function(){this.textContent=t}}function Ln(t,n,e,r){var i=t.id;return Tn(t,"function"==typeof e?function(t,u,a){t.__transition__[i].tween.set(n,r(e.call(t,t.__data__,u,a)))}:(e=r(e),function(t){t.__transition__[i].tween.set(n,e)}))}function Fn(){for(var t,n=Date.now(),e=qa;e;)t=n-e.then,t>=e.delay&&(e.flush=e.callback(t)),e=e.next;var r=Hn()-n;r>24?(isFinite(r)&&(clearTimeout(Aa),Aa=setTimeout(Fn,r)),Ea=0):(Ea=1,Ca(Fn))}function Hn(){for(var t=null,n=qa,e=1/0;n;)n.flush?(delete Ta[n.callback.id],n=t?t.next=n.next:qa=n.next):(e=Math.min(e,n.then+n.delay),n=(t=n).next);return e}function Rn(t,n){var e=t.ownerSVGElement||t;if(e.createSVGPoint){var r=e.createSVGPoint();if(0>za&&(window.scrollX||window.scrollY)){e=d3.select(document.body).append("svg").style("position","absolute").style("top",0).style("left",0);var i=e[0][0].getScreenCTM();za=!(i.f||i.e),e.remove()}return za?(r.x=n.pageX,r.y=n.pageY):(r.x=n.clientX,r.y=n.clientY),r=r.matrixTransform(t.getScreenCTM().inverse()),[r.x,r.y]}var u=t.getBoundingClientRect();return[n.clientX-u.left-t.clientLeft,n.clientY-u.top-t.clientTop]}function Pn(){}function jn(t){var n=t[0],e=t[t.length-1];return e>n?[n,e]:[e,n]}function On(t){return t.rangeExtent?t.rangeExtent():jn(t.range())}function Yn(t,n){var e,r=0,i=t.length-1,u=t[r Line: 242 -  nction(){for(var t,n=Date.now(),e=qa;e;)t=n-e.then,e.delay||(e.flush=e.callback(t)),e=e.next;Hn()};var Ca=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(t){setTimeout(t,17)};d3.mouse=function(t){return Rn(t,P())};var za=/WebKit/.test(navigator.userAgent)?-1:0;d3.touches=function(t,n){return 2>arguments.length&&(n=P().touches),n?Yu(n).map(function(n){var e=Rn(t,n);return e.identifier=n.identifier,e}):[]},d3.scale={},d3.scale.linear=function(){return In([0,1],[0,1],d3.interpolate,!1)},d3.scale.log=function(){return Kn(d3.scale.linear(),Wn)};var Da=d3.format(".0e");Wn.pow=function(t){return Math.pow(10,t)},Qn.pow=function(t){return-Math.pow(10,-t)},d3.scale.pow=function(){return te(d3.scale.linear(),1)},d3.scale.sqrt=function(){return d3.scale.pow().exponent(.5)},d3.scale.ordinal=function(){return ee([],{t:"range",a:[[]]})},d3.scale.category10=function(){return d3.scale.ordinal().range(La)},d3.scale.category20=function(){return d3.scale.ordinal().range(Fa)},d3.scale.category20b=function(){return d3.scale.ordinal().range(Ha)},d3.scale.category20c=function(){return d3.scale.ordinal().range(Ra)};var La=["#1f77b4","#ff7f0e","#2ca02c","#d62728","#9467bd","#8c564b","#e377c2","#7f7f7f","#bcbd22","#17becf"],Fa=["#1f77b4","#aec7e8","#ff7f0e","#ffbb78","#2ca02c","#98df8a","#d62728","#ff9896","#9467bd","#c5b0d5","#8c564b","#c49c94","#e377c2","#f7b6d2","#7f7f7f","#c7c7c7","#bcbd22","#dbdb8d","#17becf","#9edae5"],Ha=["#393b79","#5254a3","#6b6ecf","#9c9ede","#637939","#8ca252","#b5cf6b","#cedb9c","#8c6d31","#bd9e39","#e7ba52","#e7cb94","#843c39","#ad494a","#d6616b","#e7969c","#7b4173","#a55194","#ce6dbd","#de9ed6"],Ra=["#3182bd","#6baed6","#9ecae1","#c6dbef","#e6550d","#fd8d3c","#fdae6b","#fdd0a2","#31a354","#74c476","#a1d99b","#c7e9c0","#756bb1","#9e9ac8","#bcbddc","#dadaeb","#636363","#969696","#bdbdbd","#d9d9d9"];d3.scale.quantile=function(){return re([],[])},d3.scale.quantize=function(){return ie(0,1,[0,1])},d3.scale.threshold=function(){return ue([.5],[0,1])},d3.sca</Result>
</report_mosca>

<report_mosca>
 <Path>/src/public/vendor/vendor.js</Path>
 <Module>/app/Mosca/eggs/javascript_common_fail.egg</Module>
 <Title> Possible SQL injection</Title>
 <Description> notification possible SQL injection</Description>
 <Level> High</Level>
 <Reference> https://www.owasp.org/index.php/Testing_for_Stack_Overflow </Reference>
 <Match> query|YQL|WHERE|FROM|SELECT|UPDATE|DELETE|INSERT|UNION|getResults</Match>
 <Result> Line: 72 -  (function(e,t){function i(t,i){var a,n,r,o=t.nodeName.toLowerCase();return"area"===o?(a=t.parentNode,n=a.name,t.href&&n&&"map"===a.nodeName.toLowerCase()?(r=e("img[usemap=#"+n+"]")[0],!!r&&s(r)):!1):(/input|select|textarea|button|object/.test(o)?!t.disabled:"a"===o?t.href||i:i)&&s(t)}function s(t){return e.expr.filters.visible(t)&&!e(t).parents().addBack().filter(function(){return"hidden"===e.css(this,"visibility")}).length}var a=0,n=/^ui-id-\d+$/;e.ui=e.ui||{},e.extend(e.ui,{version:"1.10.3",keyCode:{BACKSPACE:8,COMMA:188,DELETE:46,DOWN:40,END:35,ENTER:13,ESCAPE:27,HOME:36,LEFT:37,NUMPAD_ADD:107,NUMPAD_DECIMAL:110,NUMPAD_DIVIDE:111,NUMPAD_ENTER:108,NUMPAD_MULTIPLY:106,NUMPAD_SUBTRACT:109,PAGE_DOWN:34,PAGE_UP:33,PERIOD:190,RIGHT:39,SPACE:32,TAB:9,UP:38}}),e.fn.extend({focus:function(t){return function(i,s){return"number"==typeof i?this.each(function(){var t=this;setTimeout(function(){e(t).focus(),s&&s.call(t)},i)}):t.apply(this,arguments)}}(e.fn.focus),scrollParent:function(){var t;return t=e.ui.ie&&/(static|relative)/.test(this.css("position"))||/absolute/.test(this.css("position"))?this.parents().filter(function(){return/(relative|absolute|fixed)/.test(e.css(this,"position"))&&/(auto|scroll)/.test(e.css(this,"overflow")+e.css(this,"overflow-y")+e.css(this,"overflow-x"))}).eq(0):this.parents().filter(function(){return/(auto|scroll)/.test(e.css(this,"overflow")+e.css(this,"overflow-y")+e.css(this,"overflow-x"))}).eq(0),/fixed/.test(this.css("position"))||!t.length?e(document):t},zIndex:function(i){if(i!==t)return this.css("zIndex",i);if(this.length)for(var s,a,n=e(this[0]);n.length&&n[0]!==document;){if(s=n.css("position"),("absolute"===s||"relative"===s||"fixed"===s)&&(a=parseInt(n.css("zIndex"),10),!isNaN(a)&&0!==a))return a;n=n.parent()}return 0},uniqueId:function(){return this.each(function(){this.id||(this.id="ui-id-"+ ++a)})},removeUniqueId:function(){return this.each(function(){n.test(this.id)&&e(this).removeAttr("id")})}}),e.extend(e.expr[":"],{data:e.expr.createPseudo?e.expr.createPseudo(function(t){return function(i){return!!e.data(i,t)}}):function(t,i,s){return!!e.d Line: 270 -  (i="application/json"===j["content-type"]?JSON.stringify(e.data):c(e.data),"GET"===a){var k=[];if(i&&(k.push(i),i=null),e.cache||k.push("_="+(new Date).getTime()),e.jsonp&&(k.push("callback="+e.jsonp),k.push("jsonp="+e.jsonp)),k=k.join("&"),k.length>1&&(d+=d.indexOf("?")>-1?"&"+k:"?"+k),e.jsonp){var l=document.getElementsByTagName("head")[0],m=document.createElement("script");return m.type="text/javascript",m.src=d,void l.appendChild(m)}}b(function(b,c){if(b)return h(b);c.open(a,d,e.async);for(var f in j)j.hasOwnProperty(f)&&c.setRequestHeader(f,j[f]);c.onreadystatechange=function(){if(4===c.readyState){var a=c.responseText||"";if(!h)return;h(c.status,{text:function(){return a},json:function(){try{return JSON.parse(a)}catch(b){return T.error("Can not parse JSON. URL: "+d),{}}}})}},c.send(i)})},h={authBasic:function(a,b){g.headers.Authorization="Basic "+e(a+":"+b)},connect:function(a,b,c){return g("CONNECT",a,b,c)},del:function(a,b,c){return g("DELETE",a,b,c)},get:function(a,b,c){return g("GET",a,b,c)},head:function(a,b,c){return g("HEAD",a,b,c)},headers:function(a){g.headers=a||{}},isAllowed:function(a,b,c){this.options(a,function(a,d){c(-1!==d.text().indexOf(b))})},options:function(a,b,c){return g("OPTIONS",a,b,c)},patch:function(a,b,c){return g("PATCH",a,b,c)},post:function(a,b,c){return g("POST",a,b,c)},put:function(a,b,c){return g("PUT",a,b,c)},trace:function(a,b,c){return g("TRACE",a,b,c)}},i=a.type?a.type.toLowerCase():"get";h[i](a.url,a,function(b,c){200===b||0===b&&c.text()?a.success(c.json(),b,null):a.error(c.text(),b,null)})}function g(a,b){"function"==typeof a&&(b=a,a={}),a=a||{},T.extend(P,a),delete P.fixLng,P.functions&&(delete P.functions,T.extend(T,a.functions)),"string"==typeof P.ns&&(P.ns={namespaces:[P.ns],defaultNs:P.ns}),"string"==typeof P.fallbackNS&&(P.fallbackNS=[P.fallbackNS]),("string"==typeof P.fallbackLng||"boolean"==typeof P.fallbackLng)&&(P.fallbackLng=[P.fallbackLng]),P.interpolationPrefixEscaped=T.regexEscape(P.interpolationPrefix),P.interpolationSuffixEscaped=T.regexEscape(P.interpolationSuffix),P.lng||(P.lng=T.detectLanguage()),M=T.toLanguages</Result>
</report_mosca>

<report_mosca>
 <Path>/src/public/vendor/ace/worker-jsonata.js</Path>
 <Module>/app/Mosca/eggs/javascript_common_fail.egg</Module>
 <Title> Possible code injection</Title>
 <Description> Command injection is an attack in which the goal is execution of arbitrary commands on the host operating system via a vulnerable application.</Description>
 <Level> High</Level>
 <Reference> https://www.securecoding.cert.org/confluence/pages/viewpage.action?pageId=2130132 </Reference>
 <Match> eval\s?\(|setTimeout|setInterval</Match>
 <Result> Line: 38 -  r n=e("./_global"),o=n["__core-js_shared__"]||(n["__core-js_shared__"]={});t.exports=function(e){return o[e]||(o[e]={})}},{"./_global":41}],84:[function(e,t,r){var n=e("./_an-object"),o=e("./_a-function"),i=e("./_wks")("species");t.exports=function(e,t){var r,a=n(e).constructor;return void 0===a||void 0==(r=n(a)[i])?t:o(r)}},{"./_a-function":23,"./_an-object":26,"./_wks":96}],85:[function(e,t,r){var n=e("./_to-integer"),o=e("./_defined");t.exports=function(e){return function(t,r){var i,a,s=String(o(t)),u=n(r),c=s.length;return u<0||u>=c?e?"":void 0:(i=s.charCodeAt(u))<55296||i>56319||u+1===c||(a=s.charCodeAt(u+1))<56320||a>57343?e?s.charAt(u):i:e?s.slice(u,u+2):a-56320+(i-55296<<10)+65536}}},{"./_defined":33,"./_to-integer":88}],86:[function(e,t,r){var n,o,i,a=e("./_ctx"),s=e("./_invoke"),u=e("./_html"),c=e("./_dom-create"),f=e("./_global"),l=f.process,p=f.setImmediate,d=f.clearImmediate,h=f.MessageChannel,b=f.Dispatch,v=0,g={},m=function(){var e=+this;if(g.hasOwnProperty(e)){var t=g[e];delete g[e],t()}},y=function(e){m.call(e.data)};p&&d||(p=function(e){for(var t=[],r=1;arguments.length>r;)t.push(arguments[r++]);return g[++v]=function(){s("function"==typeof e?e:Function(e),t)},n(v),v},d=function(e){delete g[e]},"process"==e("./_cof")(l)?n=function(e){l.nextTick(a(m,e,1))}:b&&b.now?n=function(e){b.now(a(m,e,1))}:h?(i=(o=new h).port2,o.port1.onmessage=y,n=a(i.postMessage,i,1)):f.addEventListener&&"function"==typeof postMessage&&!f.importScripts?(n=function(e){f.postMessage(e+"","*")},f.addEventListener("message",y,!1)):n="onreadystatechange"in c("script")?function(e){u.appendChild(c("script")).onreadystatechange=function(){u.removeChild(this),m.call(e)}}:function(e){setTimeout(a(m,e,1),0)}),t.exports={set:p,clear:d}},{"./_cof":29,"./_ctx":32,"./_dom-create":35,"./_global":41,"./_html":44,"./_invoke":46}],87:[function(e,t,r){var n=e("./_to-integer"),o=Math.max,i=Math.min;t.exports=function(e,t){return(e=n(e))<0?o(e+t,0):i(e,t)}},{"./_to-integer":88}],88:[function(e,t,r){var n=Math.ceil,o=Math.floor;t.exports=function(e){return isNaN(e=+e)?0:(e>0?o:n)(e)}},{}],89:[function(e,t,r) Line: 1331 -                  timer = setTimeout(callback, timeout || 0);

 Line: 1366 -                  timer = setTimeout(callback, timeout || defaultTimeout);

 Line: 1371 -                  timer = setTimeout(callback, timeout || defaultTimeout);

 Line: 1431 -              this.setTimeout = function(timeout) {

 Line: 2157 -              this.setTimeout(200);

</Result>
</report_mosca>

<report_mosca>
 <Path>/src/public/vendor/ace/snippets/javascript.js</Path>
 <Module>/app/Mosca/eggs/javascript_common_fail.egg</Module>
 <Title> Possible code injection</Title>
 <Description> Command injection is an attack in which the goal is execution of arbitrary commands on the host operating system via a vulnerable application.</Description>
 <Level> High</Level>
 <Reference> https://www.securecoding.cert.org/confluence/pages/viewpage.action?pageId=2130132 </Reference>
 <Match> eval\s?\(|setTimeout|setInterval</Match>
 <Result> Line: 0 -  ace.define("ace/snippets/javascript",["require","exports","module"],function(e,t,n){"use strict";t.snippetText='# Prototype\nsnippet proto\n	${1:class_name}.prototype.${2:method_name} = function(${3:first_argument}) {\n		${4:// body...}\n	};\n# Function\nsnippet fun\n	function ${1?:function_name}(${2:argument}) {\n		${3:// body...}\n	}\n# Anonymous Function\nregex /((=)\\s*|(:)\\s*|(\\()|\\b)/f/(\\))?/\nsnippet f\n	function${M1?: ${1:functionName}}($2) {\n		${0:$TM_SELECTED_TEXT}\n	}${M2?;}${M3?,}${M4?)}\n# Immediate function\ntrigger \\(?f\\(\nendTrigger \\)?\nsnippet f(\n	(function(${1}) {\n		${0:${TM_SELECTED_TEXT:/* code */}}\n	}(${1}));\n# if\nsnippet if\n	if (${1:true}) {\n		${0}\n	}\n# if ... else\nsnippet ife\n	if (${1:true}) {\n		${2}\n	} else {\n		${0}\n	}\n# tertiary conditional\nsnippet ter\n	${1:/* condition */} ? ${2:a} : ${3:b}\n# switch\nsnippet switch\n	switch (${1:expression}) {\n		case \'${3:case}\':\n			${4:// code}\n			break;\n		${5}\n		default:\n			${2:// code}\n	}\n# case\nsnippet case\n	case \'${1:case}\':\n		${2:// code}\n		break;\n	${3}\n\n# while (...) {...}\nsnippet wh\n	while (${1:/* condition */}) {\n		${0:/* code */}\n	}\n# try\nsnippet try\n	try {\n		${0:/* code */}\n	} catch (e) {}\n# do...while\nsnippet do\n	do {\n		${2:/* code */}\n	} while (${1:/* condition */});\n# Object Method\nsnippet :f\nregex /([,{[])|^\\s*/:f/\n	${1:method_name}: function(${2:attribute}) {\n		${0}\n	}${3:,}\n# setTimeout function\nsnippet setTimeout\nregex /\\b/st|timeout|setTimeo?u?t?/\n	setTimeout(function() {${3:$TM_SELECTED_TEXT}}, ${1:10});\n# Get Elements\nsnippet gett\n	getElementsBy${1:TagName}(\'${2}\')${3}\n# Get Element\nsnippet get\n	getElementBy${1:Id}(\'${2}\')${3}\n# console.log (Firebug)\nsnippet cl\n	console.log(${1});\n# return\nsnippet ret\n	return ${1:result}\n# for (property in object ) { ... }\nsnippet fori\n	for (var ${1:prop} in ${2:Things}) {\n		${0:$2[$1]}\n	}\n# hasOwnProperty\nsnippet has\n	hasOwnProperty(${1})\n# docstring\nsnippet /**\n	/**\n	 * ${1:description}\n	 *\n	 */\nsnippet @par\nregex /^\\s*\\*\\s*/@(para?m?)?/\n	@param {${1:type}</Result>
</report_mosca>

<report_mosca>
 <Path>/src/public/vendor/ace/snippets/javascript.js</Path>
 <Module>/app/Mosca/eggs/javascript_common_fail.egg</Module>
 <Title> Possible SQL injection</Title>
 <Description> notification possible SQL injection</Description>
 <Level> High</Level>
 <Reference> https://www.owasp.org/index.php/Testing_for_Stack_Overflow </Reference>
 <Match> query|YQL|WHERE|FROM|SELECT|UPDATE|DELETE|INSERT|UNION|getResults</Match>
 <Result> Line: 0 -  ace.define("ace/snippets/javascript",["require","exports","module"],function(e,t,n){"use strict";t.snippetText='# Prototype\nsnippet proto\n	${1:class_name}.prototype.${2:method_name} = function(${3:first_argument}) {\n		${4:// body...}\n	};\n# Function\nsnippet fun\n	function ${1?:function_name}(${2:argument}) {\n		${3:// body...}\n	}\n# Anonymous Function\nregex /((=)\\s*|(:)\\s*|(\\()|\\b)/f/(\\))?/\nsnippet f\n	function${M1?: ${1:functionName}}($2) {\n		${0:$TM_SELECTED_TEXT}\n	}${M2?;}${M3?,}${M4?)}\n# Immediate function\ntrigger \\(?f\\(\nendTrigger \\)?\nsnippet f(\n	(function(${1}) {\n		${0:${TM_SELECTED_TEXT:/* code */}}\n	}(${1}));\n# if\nsnippet if\n	if (${1:true}) {\n		${0}\n	}\n# if ... else\nsnippet ife\n	if (${1:true}) {\n		${2}\n	} else {\n		${0}\n	}\n# tertiary conditional\nsnippet ter\n	${1:/* condition */} ? ${2:a} : ${3:b}\n# switch\nsnippet switch\n	switch (${1:expression}) {\n		case \'${3:case}\':\n			${4:// code}\n			break;\n		${5}\n		default:\n			${2:// code}\n	}\n# case\nsnippet case\n	case \'${1:case}\':\n		${2:// code}\n		break;\n	${3}\n\n# while (...) {...}\nsnippet wh\n	while (${1:/* condition */}) {\n		${0:/* code */}\n	}\n# try\nsnippet try\n	try {\n		${0:/* code */}\n	} catch (e) {}\n# do...while\nsnippet do\n	do {\n		${2:/* code */}\n	} while (${1:/* condition */});\n# Object Method\nsnippet :f\nregex /([,{[])|^\\s*/:f/\n	${1:method_name}: function(${2:attribute}) {\n		${0}\n	}${3:,}\n# setTimeout function\nsnippet setTimeout\nregex /\\b/st|timeout|setTimeo?u?t?/\n	setTimeout(function() {${3:$TM_SELECTED_TEXT}}, ${1:10});\n# Get Elements\nsnippet gett\n	getElementsBy${1:TagName}(\'${2}\')${3}\n# Get Element\nsnippet get\n	getElementBy${1:Id}(\'${2}\')${3}\n# console.log (Firebug)\nsnippet cl\n	console.log(${1});\n# return\nsnippet ret\n	return ${1:result}\n# for (property in object ) { ... }\nsnippet fori\n	for (var ${1:prop} in ${2:Things}) {\n		${0:$2[$1]}\n	}\n# hasOwnProperty\nsnippet has\n	hasOwnProperty(${1})\n# docstring\nsnippet /**\n	/**\n	 * ${1:description}\n	 *\n	 */\nsnippet @par\nregex /^\\s*\\*\\s*/@(para?m?)?/\n	@param {${1:type} Line: 1 -  ${3:description}\nsnippet @ret\n	@return {${1:type}} ${2:description}\n# JSON.parse\nsnippet jsonp\n	JSON.parse(${1:jstr});\n# JSON.stringify\nsnippet jsons\n	JSON.stringify(${1:object});\n# self-defining function\nsnippet sdf\n	var ${1:function_name} = function(${2:argument}) {\n		${3:// initial code ...}\n\n		$1 = function($2) {\n			${4:// main code}\n		};\n	}\n# singleton\nsnippet sing\n	function ${1:Singleton} (${2:argument}) {\n		// the cached instance\n		var instance;\n\n		// rewrite the constructor\n		$1 = function $1($2) {\n			return instance;\n		};\n		\n		// carry over the prototype properties\n		$1.prototype = this;\n\n		// the instance\n		instance = new $1();\n\n		// reset the constructor pointer\n		instance.constructor = $1;\n\n		${3:// code ...}\n\n		return instance;\n	}\n# class\nsnippet class\nregex /^\\s*/clas{0,2}/\n	var ${1:class} = function(${20}) {\n		$40$0\n	};\n	\n	(function() {\n		${60:this.prop = ""}\n	}).call(${1:class}.prototype);\n	\n	exports.${1:class} = ${1:class};\n# \nsnippet for-\n	for (var ${1:i} = ${2:Things}.length; ${1:i}--; ) {\n		${0:${2:Things}[${1:i}];}\n	}\n# for (...) {...}\nsnippet for\n	for (var ${1:i} = 0; $1 < ${2:Things}.length; $1++) {\n		${3:$2[$1]}$0\n	}\n# for (...) {...} (Improved Native For-Loop)\nsnippet forr\n	for (var ${1:i} = ${2:Things}.length - 1; $1 >= 0; $1--) {\n		${3:$2[$1]}$0\n	}\n\n\n#modules\nsnippet def\n	define(function(require, exports, module) {\n	"use strict";\n	var ${1/.*\\///} = require("${1}");\n	\n	$TM_SELECTED_TEXT\n	});\nsnippet req\nguard ^\\s*\n	var ${1/.*\\///} = require("${1}");\n	$0\nsnippet requ\nguard ^\\s*\n	var ${1/.*\\/(.)/\\u$1/} = require("${1}").${1/.*\\/(.)/\\u$1/};\n	$0\n',t.scope="javascript"})
</Result>
</report_mosca>

<report_mosca>
 <Path>/src/public/vendor/ace/ext-language_tools.js</Path>
 <Module>/app/Mosca/eggs/javascript_common_fail.egg</Module>
 <Title> Possible SQL injection</Title>
 <Description> notification possible SQL injection</Description>
 <Level> High</Level>
 <Reference> https://www.owasp.org/index.php/Testing_for_Stack_Overflow </Reference>
 <Match> query|YQL|WHERE|FROM|SELECT|UPDATE|DELETE|INSERT|UNION|getResults</Match>
 <Result> Line: 1 -  getTokenizer().getLineTokens(e,t).tokens.map(function(e){return e.value||e})},this.$getDefaultValue=function(e,t){if(/^[A-Z]\d+$/.test(t)){var n=t.substr(1);return(this.variables[t[0]+"__"]||{})[n]}if(/^\d+$/.test(t))return(this.variables.__||{})[t];t=t.replace(/^TM_/,"");if(!e)return;var r=e.session;switch(t){case"CURRENT_WORD":var i=r.getWordRange();case"SELECTION":case"SELECTED_TEXT":return r.getTextRange(i);case"CURRENT_LINE":return r.getLine(e.getCursorPosition().row);case"PREV_LINE":return r.getLine(e.getCursorPosition().row-1);case"LINE_INDEX":return e.getCursorPosition().column;case"LINE_NUMBER":return e.getCursorPosition().row+1;case"SOFT_TABS":return r.getUseSoftTabs()?"YES":"NO";case"TAB_SIZE":return r.getTabSize();case"FILENAME":case"FILEPATH":return"";case"FULLNAME":return"Ace"}},this.variables={},this.getVariableValue=function(e,t){return this.variables.hasOwnProperty(t)?this.variables[t](e,t)||"":this.$getDefaultValue(e,t)||""},this.tmStrFormat=function(e,t,n){var r=t.flag||"",i=t.guard;i=new RegExp(i,r.replace(/[^gi]/,""));var s=this.tokenizeTmSnippet(t.fmt,"formatString"),o=this,u=e.replace(i,function(){o.variables.__=arguments;var e=o.resolveVariables(s,n),t="E";for(var r=0;r<e.length;r++){var i=e[r];if(typeof i=="object"){e[r]="";if(i.changeCase&&i.local){var u=e[r+1];u&&typeof u=="string"&&(i.changeCase=="u"?e[r]=u[0].toUpperCase():e[r]=u[0].toLowerCase(),e[r+1]=u.substr(1))}else i.changeCase&&(t=i.changeCase)}else t=="U"?e[r]=i.toUpperCase():t=="L"&&(e[r]=i.toLowerCase())}return e.join("")});return this.variables.__=null,u},this.resolveVariables=function(e,t){function o(t){var n=e.indexOf(t,r+1);n!=-1&&(r=n)}var n=[];for(var r=0;r<e.length;r++){var i=e[r];if(typeof i=="string")n.push(i);else{if(typeof i!="object")continue;if(i.skip)o(i);else{if(i.processed<r)continue;if(i.text){var s=this.getVariableValue(t,i.text);s&&i.fmtString&&(s=this.tmStrFormat(s,i)),i.processed=r,i.expectIf==null?s&&(n.push(s),o(i)):s?i.skip=i.elseBranch:o(i)}else i.tabstopId!=null?n.push(i):i.changeCase!=null&&n.push(i)}}}return n},this.insertSnippetForSelection=function(e,t){functi</Result>
</report_mosca>

<report_mosca>
 <Path>/src/public/vendor/ace/worker-html.js</Path>
 <Module>/app/Mosca/eggs/javascript_common_fail.egg</Module>
 <Title> Possible code injection</Title>
 <Description> Command injection is an attack in which the goal is execution of arbitrary commands on the host operating system via a vulnerable application.</Description>
 <Level> High</Level>
 <Reference> https://www.securecoding.cert.org/confluence/pages/viewpage.action?pageId=2130132 </Reference>
 <Match> eval\s?\(|setTimeout|setInterval</Match>
 <Result> Line: 2 -   e)t[n]=e[n];return t},t.arrayRemove=function(e,t){for(var n=0;n<=e.length;n++)t===e[n]&&e.splice(n,1)},t.escapeRegExp=function(e){return e.replace(/([.*+?^${}()|[\]\/\\])/g,"\\$1")},t.escapeHTML=function(e){return e.replace(/&/g,"&#38;").replace(/"/g,"&#34;").replace(/'/g,"&#39;").replace(/</g,"&#60;")},t.getMatchOffsets=function(e,t){var n=[];return e.replace(t,function(e){n.push({offset:arguments[arguments.length-2],length:e.length})}),n},t.deferredCall=function(e){var t=null,n=function(){t=null,e()},r=function(e){return r.cancel(),t=setTimeout(n,e||0),r};return r.schedule=r,r.call=function(){return this.cancel(),e(),r},r.cancel=function(){return clearTimeout(t),t=null,r},r.isPending=function(){return t},r},t.delayedCall=function(e,t){var n=null,r=function(){n=null,e()},i=function(e){n==null&&(n=setTimeout(r,e||t))};return i.delay=function(e){n&&clearTimeout(n),n=setTimeout(r,e||t)},i.schedule=i,i.call=function(){this.cancel(),e()},i.cancel=function(){n&&clearTimeout(n),n=null},i.isPending=function(){return n},i}}),ace.define("ace/range",["require","exports","module"],function(e,t,n){"use strict";var r=function(e,t){return e.row-t.row||e.column-t.column},i=function(e,t,n,r){this.start={row:e,column:t},this.end={row:n,column:r}};(function(){this.isEqual=function(e){return this.start.row===e.start.row&&this.end.row===e.end.row&&this.start.column===e.start.column&&this.end.column===e.end.column},this.toString=function(){return"Range: ["+this.start.row+"/"+this.start.column+"] -> ["+this.end.row+"/"+this.end.column+"]"},this.contains=function(e,t){return this.compare(e,t)==0},this.compareRange=function(e){var t,n=e.end,r=e.start;return t=this.compare(n.row,n.column),t==1?(t=this.compare(r.row,r.column),t==1?2:t==0?1:0):t==-1?-2:(t=this.compare(r.row,r.column),t==-1?-1:t==1?42:0)},this.comparePoint=function(e){return this.compare(e.row,e.column)},this.containsRange=function(e){return this.comparePoint(e.start)==0&&this.comparePoint(e.end)==0},this.intersects=function(e){var t=this.compareRange(e);return t==-1||t==0||t==1},this.isEnd=function(e,t){return this.end.row==e&&this.end. Line: 9 -  .length-1;t>=0;t--)this.revertDelta(e[t])},this.applyDelta=function(e,t){var n=e.action=="insert";if(n?e.lines.length<=1&&!e.lines[0]:!o.comparePoints(e.start,e.end))return;n&&e.lines.length>2e4&&this.$splitAndapplyLargeDelta(e,2e4),i(this.$lines,e,t),this._signal("change",e)},this.$splitAndapplyLargeDelta=function(e,t){var n=e.lines,r=n.length,i=e.start.row,s=e.start.column,o=0,u=0;do{o=u,u+=t-1;var a=n.slice(o,u);if(u>r){e.lines=a,e.start.row=i+o,e.start.column=s;break}a.push(""),this.applyDelta({start:this.pos(i+o,s),end:this.pos(i+u,s=0),action:e.action,lines:a},!0)}while(!0)},this.revertDelta=function(e){this.applyDelta({start:this.clonePos(e.start),end:this.clonePos(e.end),action:e.action=="insert"?"remove":"insert",lines:e.lines.slice()})},this.indexToPosition=function(e,t){var n=this.$lines||this.getAllLines(),r=this.getNewLineCharacter().length;for(var i=t||0,s=n.length;i<s;i++){e-=n[i].length+r;if(e<0)return{row:i,column:e+n[i].length+r}}return{row:s-1,column:n[s-1].length}},this.positionToIndex=function(e,t){var n=this.$lines||this.getAllLines(),r=this.getNewLineCharacter().length,i=0,s=Math.min(e.row,n.length);for(var o=t||0;o<s;++o)i+=n[o].length+r;return i+e.column}}).call(a.prototype),t.Document=a}),ace.define("ace/worker/mirror",["require","exports","module","ace/range","ace/document","ace/lib/lang"],function(e,t,n){"use strict";var r=e("../range").Range,i=e("../document").Document,s=e("../lib/lang"),o=t.Mirror=function(e){this.sender=e;var t=this.doc=new i(""),n=this.deferredUpdate=s.delayedCall(this.onUpdate.bind(this)),r=this;e.on("change",function(e){var i=e.data;if(i[0].start)t.applyDeltas(i);else for(var s=0;s<i.length;s+=2){if(Array.isArray(i[s+1]))var o={action:"insert",start:i[s],lines:i[s+1]};else var o={action:"remove",start:i[s],end:i[s+1]};t.applyDelta(o,!0)}if(r.$timeout)return n.schedule(r.$timeout);r.onUpdate()})};(function(){this.$timeout=500,this.setTimeout=function(e){this.$timeout=e},this.setValue=function(e){this.doc.setValue(e),this.deferredUpdate.schedule(this.$timeout)},this.getValue=function(e){this.sender.callback(this.doc.getValue(),e) Line: 97 -  ar r=function(){};r.prototype=n.prototype,t.prototype=new r,t.prototype.constructor=t}},{}],18:[function(e,t,n){function i(){}var r=t.exports={};r.nextTick=function(){var e=typeof window!="undefined"&&window.setImmediate,t=typeof window!="undefined"&&window.postMessage&&window.addEventListener;if(e)return function(e){return window.setImmediate(e)};if(t){var n=[];return window.addEventListener("message",function(e){var t=e.source;if((t===window||t===null)&&e.data==="process-tick"){e.stopPropagation();if(n.length>0){var r=n.shift();r()}}},!0),function(t){n.push(t),window.postMessage("process-tick","*")}}return function(t){setTimeout(t,0)}}(),r.title="browser",r.browser=!0,r.env={},r.argv=[],r.on=i,r.once=i,r.off=i,r.emit=i,r.binding=function(e){throw new Error("process.binding is not supported")},r.cwd=function(){return"/"},r.chdir=function(e){throw new Error("process.chdir is not supported")}},{}],19:[function(e,t,n){t.exports=e(14)},{}],20:[function(e,t,n){t.exports=e(15)},{"./support/isBuffer":19,"/usr/local/lib/node_modules/browserify/node_modules/insert-module-globals/node_modules/process/browser.js":18,inherits:17}]},{},[9])(9)}),ace.define("ace/mode/html_worker",["require","exports","module","ace/lib/oop","ace/lib/lang","ace/worker/mirror","ace/mode/html/saxparser"],function(e,t,n){"use strict";var r=e("../lib/oop"),i=e("../lib/lang"),s=e("../worker/mirror").Mirror,o=e("./html/saxparser").SAXParser,u={"expected-doctype-but-got-start-tag":"info","expected-doctype-but-got-chars":"info","non-html-root":"info"},a=t.Worker=function(e){s.call(this,e),this.setTimeout(400),this.context=null};r.inherits(a,s),function(){this.setOptions=function(e){this.context=e.context},this.onUpdate=function(){var e=this.doc.getValue();if(!e)return;var t=new o,n=[],r=function(){};t.contentHandler={startDocument:r,endDocument:r,startElement:r,endElement:r,characters:r},t.errorHandler={error:function(e,t,r){n.push({row:t.line,column:t.column,text:e,type:u[r]||"error"})}},this.context?t.parseFragment(e,this.context):t.parse(e),this.sender.emit("error",n)}}.call(a.prototype)}),ace.define("ace/lib/es5</Result>
</report_mosca>

<report_mosca>
 <Path>/src/public/vendor/ace/worker-javascript.js</Path>
 <Module>/app/Mosca/eggs/javascript_common_fail.egg</Module>
 <Title> Possible code injection</Title>
 <Description> Command injection is an attack in which the goal is execution of arbitrary commands on the host operating system via a vulnerable application.</Description>
 <Level> High</Level>
 <Reference> https://www.securecoding.cert.org/confluence/pages/viewpage.action?pageId=2130132 </Reference>
 <Match> eval\s?\(|setTimeout|setInterval</Match>
 <Result> Line: 9 -  ct]")return e;t={};for(var n in e)t[n]=s(e[n]);return t},t.arrayToMap=function(e){var t={};for(var n=0;n<e.length;n++)t[e[n]]=1;return t},t.createMap=function(e){var t=Object.create(null);for(var n in e)t[n]=e[n];return t},t.arrayRemove=function(e,t){for(var n=0;n<=e.length;n++)t===e[n]&&e.splice(n,1)},t.escapeRegExp=function(e){return e.replace(/([.*+?^${}()|[\]\/\\])/g,"\\$1")},t.escapeHTML=function(e){return e.replace(/&/g,"&#38;").replace(/"/g,"&#34;").replace(/'/g,"&#39;").replace(/</g,"&#60;")},t.getMatchOffsets=function(e,t){var n=[];return e.replace(t,function(e){n.push({offset:arguments[arguments.length-2],length:e.length})}),n},t.deferredCall=function(e){var t=null,n=function(){t=null,e()},r=function(e){return r.cancel(),t=setTimeout(n,e||0),r};return r.schedule=r,r.call=function(){return this.cancel(),e(),r},r.cancel=function(){return clearTimeout(t),t=null,r},r.isPending=function(){return t},r},t.delayedCall=function(e,t){var n=null,r=function(){n=null,e()},i=function(e){n==null&&(n=setTimeout(r,e||t))};return i.delay=function(e){n&&clearTimeout(n),n=setTimeout(r,e||t)},i.schedule=i,i.call=function(){this.cancel(),e()},i.cancel=function(){n&&clearTimeout(n),n=null},i.isPending=function(){return n},i}}),ace.define("ace/worker/mirror",["require","exports","module","ace/range","ace/document","ace/lib/lang"],function(e,t,n){"use strict";var r=e("../range").Range,i=e("../document").Document,s=e("../lib/lang"),o=t.Mirror=function(e){this.sender=e;var t=this.doc=new i(""),n=this.deferredUpdate=s.delayedCall(this.onUpdate.bind(this)),r=this;e.on("change",function(e){var i=e.data;if(i[0].start)t.applyDeltas(i);else for(var s=0;s<i.length;s+=2){if(Array.isArray(i[s+1]))var o={action:"insert",start:i[s],lines:i[s+1]};else var o={action:"remove",start:i[s],end:i[s+1]};t.applyDelta(o,!0)}if(r.$timeout)return n.schedule(r.$timeout);r.onUpdate()})};(function(){this.$timeout=500,this.setTimeout=function(e){this.$timeout=e},this.setValue=function(e){this.doc.setValue(e),this.deferredUpdate.schedule(this.$timeout)},this.getValue=function(e){this.sender.callback(this.doc.getValue(),e) Line: 37 -  t=t["(context)"]}e||F("W136",f.tokens.prev,"new.target")});if(e)return e;var t=Q(155),n;if(t&&t.id!=="function")if(t.identifier){t["new"]=!0;switch(t.value){case"Number":case"String":case"Boolean":case"Math":case"JSON":F("W053",f.tokens.prev,t.value);break;case"Symbol":f.inES6()&&F("W053",f.tokens.prev,t.value);break;case"Function":f.option.evil||F("W054");break;case"Date":case"RegExp":case"this":break;default:t.id!=="function"&&(n=t.value.substr(0,1),f.option.newcap&&(n<"A"||n>"Z")&&!f.funct["(scope)"].isPredefined(t.value)&&F("W055",f.tokens.curr))}}else t.id!=="."&&t.id!=="["&&t.id!=="("&&F("W056",f.tokens.curr);else f.option.supernew||F("W057",this);return f.tokens.next.id!=="("&&!f.option.supernew&&F("W058",f.tokens.curr,f.tokens.curr.value),this.first=this.right=t,this}),f.syntax["new"].exps=!0,ut("void").exps=!0,ht(".",function(e,t){var n=Ct(!1,!0);return typeof n=="string"&&Dt(n),t.left=e,t.right=n,n&&n==="hasOwnProperty"&&f.tokens.next.value==="="&&F("W001"),!e||e.value!=="arguments"||n!=="callee"&&n!=="caller"?!f.option.evil&&e&&e.value==="document"&&(n==="write"||n==="writeln")&&F("W060",e):f.option.noarg?F("W059",e,n):f.isStrict()&&q("E008"),!f.option.evil&&(n==="eval"||n==="execScript")&&yt(e,f)&&F("W061"),t},160,!0),ht("(",function(e,t){f.option.immed&&e&&!e.immed&&e.id==="function"&&F("W062");var n=0,r=[];e&&e.type==="(identifier)"&&e.value.match(/^[A-Z]([A-Z0-9_$]*[a-z][A-Za-z0-9_$]*)?$/)&&"Array Number String Boolean Date Object Error Symbol".indexOf(e.value)===-1&&(e.value==="Math"?F("W063",e):f.option.newcap&&F("W064",e));if(f.tokens.next.id!==")")for(;;){r[r.length]=Q(10),n+=1;if(f.tokens.next.id!==",")break;tt()}return V(")"),typeof e=="object"&&(!f.inES5()&&e.value==="parseInt"&&n===1&&F("W065",f.tokens.curr),f.option.evil||(e.value==="eval"||e.value==="Function"||e.value==="execScript"?(F("W061",e),r[0]&&[0].id==="(string)"&&U(e,r[0].value)):!r[0]||r[0].id!=="(string)"||e.value!=="setTimeout"&&e.value!=="setInterval"?r[0]&&r[0].id==="(string)"&&e.value==="."&&e.left.value==="window"&&(e.right==="setTimeout"||e.right==="setInterval")&&(F("W066",e),U(e,r[0 Line: 68 -  nt:!1,HTMLImageElement:!1,HTMLInputElement:!1,HTMLIsIndexElement:!1,HTMLLabelElement:!1,HTMLLayerElement:!1,HTMLLegendElement:!1,HTMLLIElement:!1,HTMLLinkElement:!1,HTMLMapElement:!1,HTMLMenuElement:!1,HTMLMetaElement:!1,HTMLModElement:!1,HTMLObjectElement:!1,HTMLOListElement:!1,HTMLOptGroupElement:!1,HTMLOptionElement:!1,HTMLParagraphElement:!1,HTMLParamElement:!1,HTMLPreElement:!1,HTMLQuoteElement:!1,HTMLScriptElement:!1,HTMLSelectElement:!1,HTMLStyleElement:!1,HTMLTableCaptionElement:!1,HTMLTableCellElement:!1,HTMLTableColElement:!1,HTMLTableElement:!1,HTMLTableRowElement:!1,HTMLTableSectionElement:!1,HTMLTemplateElement:!1,HTMLTextAreaElement:!1,HTMLTitleElement:!1,HTMLUListElement:!1,HTMLVideoElement:!1,history:!1,Image:!1,Intl:!1,length:!1,localStorage:!1,location:!1,matchMedia:!1,MessageChannel:!1,MessageEvent:!1,MessagePort:!1,MouseEvent:!1,moveBy:!1,moveTo:!1,MutationObserver:!1,name:!1,Node:!1,NodeFilter:!1,NodeList:!1,Notification:!1,navigator:!1,onbeforeunload:!0,onblur:!0,onerror:!0,onfocus:!0,onload:!0,onresize:!0,onunload:!0,open:!1,openDatabase:!1,opener:!1,Option:!1,parent:!1,performance:!1,print:!1,Range:!1,requestAnimationFrame:!1,removeEventListener:!1,resizeBy:!1,resizeTo:!1,screen:!1,scroll:!1,scrollBy:!1,scrollTo:!1,sessionStorage:!1,setInterval:!1,setTimeout:!1,SharedWorker:!1,status:!1,SVGAElement:!1,SVGAltGlyphDefElement:!1,SVGAltGlyphElement:!1,SVGAltGlyphItemElement:!1,SVGAngle:!1,SVGAnimateColorElement:!1,SVGAnimateElement:!1,SVGAnimateMotionElement:!1,SVGAnimateTransformElement:!1,SVGAnimatedAngle:!1,SVGAnimatedBoolean:!1,SVGAnimatedEnumeration:!1,SVGAnimatedInteger:!1,SVGAnimatedLength:!1,SVGAnimatedLengthList:!1,SVGAnimatedNumber:!1,SVGAnimatedNumberList:!1,SVGAnimatedPathData:!1,SVGAnimatedPoints:!1,SVGAnimatedPreserveAspectRatio:!1,SVGAnimatedRect:!1,SVGAnimatedString:!1,SVGAnimatedTransformList:!1,SVGAnimationElement:!1,SVGCSSRule:!1,SVGCircleElement:!1,SVGClipPathElement:!1,SVGColor:!1,SVGColorProfileElement:!1,SVGColorProfileRule:!1,SVGComponentTransferFunctionElement:!1,SVGCursorElement:!1,SVGDefsElement:!1,SVGDescElement:!1,SVGDocument:!1 Line: 70 -  ement:!1,SVGRenderingIntent:!1,SVGSVGElement:!1,SVGScriptElement:!1,SVGSetElement:!1,SVGStopElement:!1,SVGStringList:!1,SVGStylable:!1,SVGStyleElement:!1,SVGSwitchElement:!1,SVGSymbolElement:!1,SVGTRefElement:!1,SVGTSpanElement:!1,SVGTests:!1,SVGTextContentElement:!1,SVGTextElement:!1,SVGTextPathElement:!1,SVGTextPositioningElement:!1,SVGTitleElement:!1,SVGTransform:!1,SVGTransformList:!1,SVGTransformable:!1,SVGURIReference:!1,SVGUnitTypes:!1,SVGUseElement:!1,SVGVKernElement:!1,SVGViewElement:!1,SVGViewSpec:!1,SVGZoomAndPan:!1,Text:!1,TextDecoder:!1,TextEncoder:!1,TimeEvent:!1,top:!1,URL:!1,WebGLActiveInfo:!1,WebGLBuffer:!1,WebGLContextEvent:!1,WebGLFramebuffer:!1,WebGLProgram:!1,WebGLRenderbuffer:!1,WebGLRenderingContext:!1,WebGLShader:!1,WebGLShaderPrecisionFormat:!1,WebGLTexture:!1,WebGLUniformLocation:!1,WebSocket:!1,window:!1,Window:!1,Worker:!1,XDomainRequest:!1,XMLHttpRequest:!1,XMLSerializer:!1,XPathEvaluator:!1,XPathException:!1,XPathExpression:!1,XPathNamespace:!1,XPathNSResolver:!1,XPathResult:!1},n.devel={alert:!1,confirm:!1,console:!1,Debug:!1,opera:!1,prompt:!1},n.worker={importScripts:!0,postMessage:!0,self:!0,FileReaderSync:!0},n.nonstandard={escape:!1,unescape:!1},n.couch={require:!1,respond:!1,getRow:!1,emit:!1,send:!1,start:!1,sum:!1,log:!1,exports:!1,module:!1,provides:!1},n.node={__filename:!1,__dirname:!1,GLOBAL:!1,global:!1,module:!1,require:!1,Buffer:!0,console:!0,exports:!0,process:!0,setTimeout:!0,clearTimeout:!0,setInterval:!0,clearInterval:!0,setImmediate:!0,clearImmediate:!0},n.browserify={__filename:!1,__dirname:!1,global:!1,module:!1,require:!1,Buffer:!0,exports:!0,process:!0},n.phantom={phantom:!0,require:!0,WebPage:!0,console:!0,exports:!0},n.qunit={asyncTest:!1,deepEqual:!1,equal:!1,expect:!1,module:!1,notDeepEqual:!1,notEqual:!1,notPropEqual:!1,notStrictEqual:!1,ok:!1,propEqual:!1,QUnit:!1,raises:!1,start:!1,stop:!1,strictEqual:!1,test:!1,"throws":!1},n.rhino={defineClass:!1,deserialize:!1,gc:!1,help:!1,importClass:!1,importPackage:!1,java:!1,load:!1,loadClass:!1,Packages:!1,print:!1,quit:!1,readFile:!1,readUrl:!1,runCommand:!1,seal:!1,serial Line: 72 -  js"])}),ace.define("ace/mode/javascript_worker",["require","exports","module","ace/lib/oop","ace/worker/mirror","ace/mode/javascript/jshint"],function(require,exports,module){"use strict";function startRegex(e){return RegExp("^("+e.join("|")+")")}var oop=require("../lib/oop"),Mirror=require("../worker/mirror").Mirror,lint=require("./javascript/jshint").JSHINT,disabledWarningsRe=startRegex(["Bad for in variable '(.+)'.",'Missing "use strict"']),errorsRe=startRegex(["Unexpected","Expected ","Confusing (plus|minus)","\\{a\\} unterminated regular expression","Unclosed ","Unmatched ","Unbegun comment","Bad invocation","Missing space after","Missing operator at"]),infoRe=startRegex(["Expected an assignment","Bad escapement of EOL","Unexpected comma","Unexpected space","Missing radix parameter.","A leading decimal point can","\\['{a}'\\] is better written in dot notation.","'{a}' used out of scope"]),JavaScriptWorker=exports.JavaScriptWorker=function(e){Mirror.call(this,e),this.setTimeout(500),this.setOptions()};oop.inherits(JavaScriptWorker,Mirror),function(){this.setOptions=function(e){this.options=e||{esnext:!0,moz:!0,devel:!0,browser:!0,node:!0,laxcomma:!0,laxbreak:!0,lastsemic:!0,onevar:!1,passfail:!1,maxerr:100,expr:!0,multistr:!0,globalstrict:!0},this.doc.getValue()&&this.deferredUpdate.schedule(100)},this.changeOptions=function(e){oop.mixin(this.options,e),this.doc.getValue()&&this.deferredUpdate.schedule(100)},this.isValidJS=function(str){try{eval("throw 0;"+str)}catch(e){if(e===0)return!0}return!1},this.onUpdate=function(){var e=this.doc.getValue();e=e.replace(/^#!.*\n/,"\n");if(!e)return this.sender.emit("annotate",[]);var t=[],n=this.isValidJS(e)?"warning":"error";lint(e,this.options,this.options.globals);var r=lint.errors,i=!1;for(var s=0;s<r.length;s++){var o=r[s];if(!o)continue;var u=o.raw,a="warning";if(u=="Missing semicolon."){var f=o.evidence.substr(o.character);f=f.charAt(f.search(/\S/)),n=="error"&&f&&/[\w\d{(['"]/.test(f)?(o.reason='Missing ";" before statement',a="error"):a="info"}else{if(disabledWarningsRe.test(u))continue;infoRe.test(u)?a="info":errorsRe.test(</Result>
</report_mosca>

<report_mosca>
 <Path>/src/public/vendor/ace/ext-searchbox.js</Path>
 <Module>/app/Mosca/eggs/javascript_common_fail.egg</Module>
 <Title> Possible code injection</Title>
 <Description> Command injection is an attack in which the goal is execution of arbitrary commands on the host operating system via a vulnerable application.</Description>
 <Level> High</Level>
 <Reference> https://www.securecoding.cert.org/confluence/pages/viewpage.action?pageId=2130132 </Reference>
 <Match> eval\s?\(|setTimeout|setInterval</Match>
 <Result> Line: 2 -  pan action="toggleCaseSensitive" class="ace_button" title="CaseSensitive Search">Aa</span>        <span action="toggleWholeWords" class="ace_button" title="Whole Word Search">\\b</span>        <span action="searchInSelection" class="ace_button" title="Search In Selection">S</span>    </div></div>'.replace(/> +/g,">"),c=function(e,t,n){var i=r.createElement("div");i.innerHTML=l,this.element=i.firstChild,this.setSession=this.setSession.bind(this),this.$init(),this.setEditor(e)};(function(){this.setEditor=function(e){e.searchBox=this,e.renderer.scroller.appendChild(this.element),this.editor=e},this.setSession=function(e){this.searchRange=null,this.$syncOptions(!0)},this.$initElements=function(e){this.searchBox=e.querySelector(".ace_search_form"),this.replaceBox=e.querySelector(".ace_replace_form"),this.searchOption=e.querySelector("[action=searchInSelection]"),this.replaceOption=e.querySelector("[action=toggleReplace]"),this.regExpOption=e.querySelector("[action=toggleRegexpMode]"),this.caseSensitiveOption=e.querySelector("[action=toggleCaseSensitive]"),this.wholeWordOption=e.querySelector("[action=toggleWholeWords]"),this.searchInput=this.searchBox.querySelector(".ace_search_field"),this.replaceInput=this.replaceBox.querySelector(".ace_search_field"),this.searchCounter=e.querySelector(".ace_search_counter")},this.$init=function(){var e=this.element;this.$initElements(e);var t=this;s.addListener(e,"mousedown",function(e){setTimeout(function(){t.activeInput.focus()},0),s.stopPropagation(e)}),s.addListener(e,"click",function(e){var n=e.target||e.srcElement,r=n.getAttribute("action");r&&t[r]?t[r]():t.$searchBarKb.commands[r]&&t.$searchBarKb.commands[r].exec(t),s.stopPropagation(e)}),s.addCommandKeyListener(e,function(e,n,r){var i=a.keyCodeToString(r),o=t.$searchBarKb.findKeyCommand(n,i);o&&o.exec&&(o.exec(t),s.stopEvent(e))}),this.$onChange=i.delayedCall(function(){t.find(!1,!1)}),s.addListener(this.searchInput,"input",function(){t.$onChange.schedule(20)}),s.addListener(this.searchInput,"focus",function(){t.activeInput=t.searchInput,t.searchInput.value&&t.highlight()}),s.addListener( Line: 3 -  Input,"focus",function(){t.activeInput=t.replaceInput,t.searchInput.value&&t.highlight()})},this.$closeSearchBarKb=new u([{bindKey:"Esc",name:"closeSearchBar",exec:function(e){e.searchBox.hide()}}]),this.$searchBarKb=new u,this.$searchBarKb.bindKeys({"Ctrl-f|Command-f":function(e){var t=e.isReplace=!e.isReplace;e.replaceBox.style.display=t?"":"none",e.replaceOption.checked=!1,e.$syncOptions(),e.searchInput.focus()},"Ctrl-H|Command-Option-F":function(e){e.replaceOption.checked=!0,e.$syncOptions(),e.replaceInput.focus()},"Ctrl-G|Command-G":function(e){e.findNext()},"Ctrl-Shift-G|Command-Shift-G":function(e){e.findPrev()},esc:function(e){setTimeout(function(){e.hide()})},Return:function(e){e.activeInput==e.replaceInput&&e.replace(),e.findNext()},"Shift-Return":function(e){e.activeInput==e.replaceInput&&e.replace(),e.findPrev()},"Alt-Return":function(e){e.activeInput==e.replaceInput&&e.replaceAll(),e.findAll()},Tab:function(e){(e.activeInput==e.replaceInput?e.searchInput:e.replaceInput).focus()}}),this.$searchBarKb.addCommands([{name:"toggleRegexpMode",bindKey:{win:"Alt-R|Alt-/",mac:"Ctrl-Alt-R|Ctrl-Alt-/"},exec:function(e){e.regExpOption.checked=!e.regExpOption.checked,e.$syncOptions()}},{name:"toggleCaseSensitive",bindKey:{win:"Alt-C|Alt-I",mac:"Ctrl-Alt-R|Ctrl-Alt-I"},exec:function(e){e.caseSensitiveOption.checked=!e.caseSensitiveOption.checked,e.$syncOptions()}},{name:"toggleWholeWords",bindKey:{win:"Alt-B|Alt-W",mac:"Ctrl-Alt-B|Ctrl-Alt-W"},exec:function(e){e.wholeWordOption.checked=!e.wholeWordOption.checked,e.$syncOptions()}},{name:"toggleReplace",exec:function(e){e.replaceOption.checked=!e.replaceOption.checked,e.$syncOptions()}},{name:"searchInSelection",exec:function(e){e.searchOption.checked=!e.searchRange,e.setSearchRange(e.searchOption.checked&&e.editor.getSelectionRange()),e.$syncOptions()}}]),this.setSearchRange=function(e){this.searchRange=e,e?this.searchRangeMarker=this.editor.session.addMarker(e,"ace_active-line"):this.searchRangeMarker&&(this.editor.session.removeMarker(this.searchRangeMarker),this.searchRangeMarker=null)},this.$syncOptions=function(e){r.setCssCl</Result>
</report_mosca>

<report_mosca>
 <Path>/src/public/vendor/ace/worker-json.js</Path>
 <Module>/app/Mosca/eggs/javascript_common_fail.egg</Module>
 <Title> Possible code injection</Title>
 <Description> Command injection is an attack in which the goal is execution of arbitrary commands on the host operating system via a vulnerable application.</Description>
 <Level> High</Level>
 <Reference> https://www.securecoding.cert.org/confluence/pages/viewpage.action?pageId=2130132 </Reference>
 <Match> eval\s?\(|setTimeout|setInterval</Match>
 <Result> Line: 9 -  ct]")return e;t={};for(var n in e)t[n]=s(e[n]);return t},t.arrayToMap=function(e){var t={};for(var n=0;n<e.length;n++)t[e[n]]=1;return t},t.createMap=function(e){var t=Object.create(null);for(var n in e)t[n]=e[n];return t},t.arrayRemove=function(e,t){for(var n=0;n<=e.length;n++)t===e[n]&&e.splice(n,1)},t.escapeRegExp=function(e){return e.replace(/([.*+?^${}()|[\]\/\\])/g,"\\$1")},t.escapeHTML=function(e){return e.replace(/&/g,"&#38;").replace(/"/g,"&#34;").replace(/'/g,"&#39;").replace(/</g,"&#60;")},t.getMatchOffsets=function(e,t){var n=[];return e.replace(t,function(e){n.push({offset:arguments[arguments.length-2],length:e.length})}),n},t.deferredCall=function(e){var t=null,n=function(){t=null,e()},r=function(e){return r.cancel(),t=setTimeout(n,e||0),r};return r.schedule=r,r.call=function(){return this.cancel(),e(),r},r.cancel=function(){return clearTimeout(t),t=null,r},r.isPending=function(){return t},r},t.delayedCall=function(e,t){var n=null,r=function(){n=null,e()},i=function(e){n==null&&(n=setTimeout(r,e||t))};return i.delay=function(e){n&&clearTimeout(n),n=setTimeout(r,e||t)},i.schedule=i,i.call=function(){this.cancel(),e()},i.cancel=function(){n&&clearTimeout(n),n=null},i.isPending=function(){return n},i}}),ace.define("ace/worker/mirror",["require","exports","module","ace/range","ace/document","ace/lib/lang"],function(e,t,n){"use strict";var r=e("../range").Range,i=e("../document").Document,s=e("../lib/lang"),o=t.Mirror=function(e){this.sender=e;var t=this.doc=new i(""),n=this.deferredUpdate=s.delayedCall(this.onUpdate.bind(this)),r=this;e.on("change",function(e){var i=e.data;if(i[0].start)t.applyDeltas(i);else for(var s=0;s<i.length;s+=2){if(Array.isArray(i[s+1]))var o={action:"insert",start:i[s],lines:i[s+1]};else var o={action:"remove",start:i[s],end:i[s+1]};t.applyDelta(o,!0)}if(r.$timeout)return n.schedule(r.$timeout);r.onUpdate()})};(function(){this.$timeout=500,this.setTimeout=function(e){this.$timeout=e},this.setValue=function(e){this.doc.setValue(e),this.deferredUpdate.schedule(this.$timeout)},this.getValue=function(e){this.sender.callback(this.doc.getValue(),e) Line: 11 -  se"],function(e,t,n){"use strict";var r=e("../lib/oop"),i=e("../worker/mirror").Mirror,s=e("./json/json_parse"),o=t.JsonWorker=function(e){i.call(this,e),this.setTimeout(200)};r.inherits(o,i),function(){this.onUpdate=function(){var e=this.doc.getValue(),t=[];try{e&&s(e)}catch(n){var r=this.doc.indexToPosition(n.at-1);t.push({row:r.row,column:r.column,text:n.message,type:"error"})}this.sender.emit("annotate",t)}}.call(o.prototype)}),ace.define("ace/lib/es5-shim",["require","exports","module"],function(e,t,n){function r(){}function w(e){try{return Object.defineProperty(e,"sentinel",{}),"sentinel"in e}catch(t){}}function H(e){return e=+e,e!==e?e=0:e!==0&&e!==1/0&&e!==-1/0&&(e=(e>0||-1)*Math.floor(Math.abs(e))),e}function B(e){var t=typeof e;return e===null||t==="undefined"||t==="boolean"||t==="number"||t==="string"}function j(e){var t,n,r;if(B(e))return e;n=e.valueOf;if(typeof n=="function"){t=n.call(e);if(B(t))return t}r=e.toString;if(typeof r=="function"){t=r.call(e);if(B(t))return t}throw new TypeError}Function.prototype.bind||(Function.prototype.bind=function(t){var n=this;if(typeof n!="function")throw new TypeError("Function.prototype.bind called on incompatible "+n);var i=u.call(arguments,1),s=function(){if(this instanceof s){var e=n.apply(this,i.concat(u.call(arguments)));return Object(e)===e?e:this}return n.apply(t,i.concat(u.call(arguments)))};return n.prototype&&(r.prototype=n.prototype,s.prototype=new r,r.prototype=null),s});var i=Function.prototype.call,s=Array.prototype,o=Object.prototype,u=s.slice,a=i.bind(o.toString),f=i.bind(o.hasOwnProperty),l,c,h,p,d;if(d=f(o,"__defineGetter__"))l=i.bind(o.__defineGetter__),c=i.bind(o.__defineSetter__),h=i.bind(o.__lookupGetter__),p=i.bind(o.__lookupSetter__);if([1,2].splice(0).length!=2)if(!function(){function e(e){var t=new Array(e+2);return t[0]=t[1]=0,t}var t=[],n;t.splice.apply(t,e(20)),t.splice.apply(t,e(26)),n=t.length,t.splice(5,0,"XXX"),n+1==t.length;if(n+1==t.length)return!0}())Array.prototype.splice=function(e,t){var n=this.length;e>0?e>n&&(e=n):e==void 0?e=0:e<0&&(e=Math.max(n+e,0)),e+t<n||(t=n-e);var r=this.slice(e,</Result>
</report_mosca>

<report_mosca>
 <Path>/src/public/vendor/ace/ace.js</Path>
 <Module>/app/Mosca/eggs/javascript_common_fail.egg</Module>
 <Title> Possible code injection</Title>
 <Description> Command injection is an attack in which the goal is execution of arbitrary commands on the host operating system via a vulnerable application.</Description>
 <Level> High</Level>
 <Reference> https://www.securecoding.cert.org/confluence/pages/viewpage.action?pageId=2130132 </Reference>
 <Match> eval\s?\(|setTimeout|setInterval</Match>
 <Result> Line: 10 -  nction(e,n){"onmousewheel"in e?t.addListener(e,"mousewheel",function(e){var t=8;e.wheelDeltaX!==undefined?(e.wheelX=-e.wheelDeltaX/t,e.wheelY=-e.wheelDeltaY/t):(e.wheelX=0,e.wheelY=-e.wheelDelta/t),n(e)}):"onwheel"in e?t.addListener(e,"wheel",function(e){var t=.35;switch(e.deltaMode){case e.DOM_DELTA_PIXEL:e.wheelX=e.deltaX*t||0,e.wheelY=e.deltaY*t||0;break;case e.DOM_DELTA_LINE:case e.DOM_DELTA_PAGE:e.wheelX=(e.deltaX||0)*5,e.wheelY=(e.deltaY||0)*5}n(e)}):t.addListener(e,"DOMMouseScroll",function(e){e.axis&&e.axis==e.HORIZONTAL_AXIS?(e.wheelX=(e.detail||0)*5,e.wheelY=0):(e.wheelX=0,e.wheelY=(e.detail||0)*5),n(e)})},t.addMultiMouseDownListener=function(e,n,r,s){function c(e){t.getButton(e)!==0?o=0:e.detail>1?(o++,o>4&&(o=1)):o=1;if(i.isIE){var c=Math.abs(e.clientX-u)>5||Math.abs(e.clientY-a)>5;if(!f||c)o=1;f&&clearTimeout(f),f=setTimeout(function(){f=null},n[o-1]||600),o==1&&(u=e.clientX,a=e.clientY)}e._clicks=o,r[s]("mousedown",e);if(o>4)o=0;else if(o>1)return r[s](l[o],e)}function h(e){o=2,f&&clearTimeout(f),f=setTimeout(function(){f=null},n[o-1]||600),r[s]("mousedown",e),r[s](l[o],e)}var o=0,u,a,f,l={2:"dblclick",3:"tripleclick",4:"quadclick"};Array.isArray(e)||(e=[e]),e.forEach(function(e){t.addListener(e,"mousedown",c),i.isOldIE&&t.addListener(e,"dblclick",h)})};var u=!i.isMac||!i.isOpera||"KeyboardEvent"in window?function(e){return 0|(e.ctrlKey?1:0)|(e.altKey?2:0)|(e.shiftKey?4:0)|(e.metaKey?8:0)}:function(e){return 0|(e.metaKey?1:0)|(e.altKey?2:0)|(e.shiftKey?4:0)|(e.ctrlKey?8:0)};t.getModifierString=function(e){return r.KEY_MODS[u(e)]},t.addCommandKeyListener=function(e,n){var r=t.addListener;if(i.isOldGecko||i.isOpera&&!("KeyboardEvent"in window)){var o=null;r(e,"keydown",function(e){o=e.keyCode}),r(e,"keypress",function(e){return a(n,e,o)})}else{var u=null;r(e,"keydown",function(e){s[e.keyCode]=(s[e.keyCode]||0)+1;var t=a(n,e,e.keyCode);return u=e.defaultPrevented,t}),r(e,"keypress",function(e){u&&(e.ctrlKey||e.altKey||e.shiftKey||e.metaKey)&&(t.stopEvent(e),u=null)}),r(e,"keyup",function(e){s[e.keyCode]=null}),s||(f(),r(window,"focus",f))}};if(typeof window=="object Line: 11 -  tMessage&&!i.isOldIE){var l=1;t.nextTick=function(e,n){n=n||window;var r="zero-timeout-message-"+l;t.addListener(n,"message",function i(s){s.data==r&&(t.stopPropagation(s),t.removeListener(n,"message",i),e())}),n.postMessage(r,"*")}}t.nextFrame=typeof window=="object"&&(window.requestAnimationFrame||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame||window.msRequestAnimationFrame||window.oRequestAnimationFrame),t.nextFrame?t.nextFrame=t.nextFrame.bind(window):t.nextFrame=function(e){setTimeout(e,17)}}),ace.define("ace/lib/lang",["require","exports","module"],function(e,t,n){"use strict";t.last=function(e){return e[e.length-1]},t.stringReverse=function(e){return e.split("").reverse().join("")},t.stringRepeat=function(e,t){var n="";while(t>0){t&1&&(n+=e);if(t>>=1)e+=e}return n};var r=/^\s\s*/,i=/\s\s*$/;t.stringTrimLeft=function(e){return e.replace(r,"")},t.stringTrimRight=function(e){return e.replace(i,"")},t.copyObject=function(e){var t={};for(var n in e)t[n]=e[n];return t},t.copyArray=function(e){var t=[];for(var n=0,r=e.length;n<r;n++)e[n]&&typeof e[n]=="object"?t[n]=this.copyObject(e[n]):t[n]=e[n];return t},t.deepCopy=function s(e){if(typeof e!="object"||!e)return e;var t;if(Array.isArray(e)){t=[];for(var n=0;n<e.length;n++)t[n]=s(e[n]);return t}if(Object.prototype.toString.call(e)!=="[object Object]")return e;t={};for(var n in e)t[n]=s(e[n]);return t},t.arrayToMap=function(e){var t={};for(var n=0;n<e.length;n++)t[e[n]]=1;return t},t.createMap=function(e){var t=Object.create(null);for(var n in e)t[n]=e[n];return t},t.arrayRemove=function(e,t){for(var n=0;n<=e.length;n++)t===e[n]&&e.splice(n,1)},t.escapeRegExp=function(e){return e.replace(/([.*+?^${}()|[\]\/\\])/g,"\\$1")},t.escapeHTML=function(e){return e.replace(/&/g,"&#38;").replace(/"/g,"&#34;").replace(/'/g,"&#39;").replace(/</g,"&#60;")},t.getMatchOffsets=function(e,t){var n=[];return e.replace(t,function(e){n.push({offset:arguments[arguments.length-2],length:e.length})}),n},t.deferredCall=function(e){var t=null,n=function(){t=null,e()},r=function(e){return r.cancel(),t=setTimeout(n,e||0),r};return r. Line: 12 -  call=function(){return this.cancel(),e(),r},r.cancel=function(){return clearTimeout(t),t=null,r},r.isPending=function(){return t},r},t.delayedCall=function(e,t){var n=null,r=function(){n=null,e()},i=function(e){n==null&&(n=setTimeout(r,e||t))};return i.delay=function(e){n&&clearTimeout(n),n=setTimeout(r,e||t)},i.schedule=i,i.call=function(){this.cancel(),e()},i.cancel=function(){n&&clearTimeout(n),n=null},i.isPending=function(){return n},i}}),ace.define("ace/keyboard/textinput_ios",["require","exports","module","ace/lib/event","ace/lib/useragent","ace/lib/dom","ace/lib/lang","ace/lib/keys"],function(e,t,n){"use strict";var r=e("../lib/event"),i=e("../lib/useragent"),s=e("../lib/dom"),o=e("../lib/lang"),u=e("../lib/keys"),a=u.KEY_MODS,f=i.isChrome<18,l=i.isIE,c=function(e,t){function x(e){if(m)return;m=!0;if(k)t=0,n=e?0:c.value.length-1;else var t=4,n=5;try{c.setSelectionRange(t,n)}catch(r){}m=!1}function T(){if(m)return;c.value=h,i.isWebKit&&S.schedule()}function R(){clearTimeout(q),q=setTimeout(function(){g&&(c.style.cssText=g,g=""),t.renderer.$keepTextAreaAtCursor==null&&(t.renderer.$keepTextAreaAtCursor=!0,t.renderer.$moveTextAreaToCursor())},0)}var n=this,c=s.createElement("textarea");c.className=i.isIOS?"ace_text-input ace_text-input-ios":"ace_text-input",i.isTouchPad&&c.setAttribute("x-palm-disable-auto-cap",!0),c.setAttribute("wrap","off"),c.setAttribute("autocorrect","off"),c.setAttribute("autocapitalize","off"),c.setAttribute("spellcheck",!1),c.style.opacity="0",e.insertBefore(c,e.firstChild);var h="\n aaaa a\n",p=!1,d=!1,v=!1,m=!1,g="",y=!0;try{var b=document.activeElement===c}catch(w){}r.addListener(c,"blur",function(e){t.onBlur(e),b=!1}),r.addListener(c,"focus",function(e){b=!0,t.onFocus(e),x()}),this.focus=function(){if(g)return c.focus();c.style.position="fixed",c.focus()},this.blur=function(){c.blur()},this.isFocused=function(){return b};var E=o.delayedCall(function(){b&&x(y)}),S=o.delayedCall(function(){m||(c.value=h,b&&x())});i.isWebKit||t.addEventListener("changeSelection",function(){t.selection.isEmpty()!=y&&(y=!y,E.schedule())}),T(),b&&t.onFocus();var N=fun Line: 13 -  rn e.selectionStart===0&&e.selectionEnd===e.value.length},C=function(e){N(c)?(t.selectAll(),x()):k&&x(t.selection.isEmpty())},k=null;this.setInputHandler=function(e){k=e},this.getInputHandler=function(){return k};var L=!1,A=function(e){if(c.selectionStart===4&&c.selectionEnd===5)return;k&&(e=k(e),k=null),v?(x(),e&&t.onPaste(e),v=!1):e==h.substr(0)&&c.selectionStart===4?L?t.execCommand("del",{source:"ace"}):t.execCommand("backspace",{source:"ace"}):p||(e.substring(0,9)==h&&e.length>h.length?e=e.substr(9):e.substr(0,4)==h.substr(0,4)?e=e.substr(4,e.length-h.length+1):e.charAt(e.length-1)==h.charAt(0)&&(e=e.slice(0,-1)),e!=h.charAt(0)&&e.charAt(e.length-1)==h.charAt(0)&&(e=e.slice(0,-1)),e&&t.onTextInput(e)),p&&(p=!1),L&&(L=!1)},O=function(e){if(m)return;var t=c.value;A(t),T()},M=function(e,t,n){var r=e.clipboardData||window.clipboardData;if(!r||f)return;var i=l||n?"Text":"text/plain";try{return t?r.setData(i,t)!==!1:r.getData(i)}catch(e){if(!n)return M(e,t,!0)}},_=function(e,n){var s=t.getCopyText();if(!s)return r.preventDefault(e);M(e,s)?(i.isIOS&&(d=n,c.value="\n aa"+s+"a a\n",c.setSelectionRange(4,4+s.length),p={value:s}),n?t.onCut():t.onCopy(),i.isIOS||r.preventDefault(e)):(p=!0,c.value=s,c.select(),setTimeout(function(){p=!1,T(),x(),n?t.onCut():t.onCopy()}))},D=function(e){_(e,!0)},P=function(e){_(e,!1)},H=function(e){var n=M(e);typeof n=="string"?(n&&t.onPaste(n,e),i.isIE&&setTimeout(x),r.preventDefault(e)):(c.value="",v=!0)};r.addCommandKeyListener(c,t.onCommandKey.bind(t)),r.addListener(c,"select",C),r.addListener(c,"input",O),r.addListener(c,"cut",D),r.addListener(c,"copy",P),r.addListener(c,"paste",H);var B=function(e){if(m||!t.onCompositionStart||t.$readOnly)return;m={},m.canUndo=t.session.$undoManager,t.onCompositionStart(),setTimeout(j,0),t.on("mousedown",F),m.canUndo&&!t.selection.isEmpty()&&(t.insert(""),t.session.markUndoGroup(),t.selection.clearSelection()),t.session.markUndoGroup()},j=function(){if(!m||!t.onCompositionUpdate||t.$readOnly)return;var e=c.value.replace(/\x01/g,"");if(m.lastValue===e)return;t.onCompositionUpdate(e),m.lastValue&&t.undo(),m.canUndo&& Line: 14 -  e);if(m.lastValue){var n=t.selection.getRange();t.insert(m.lastValue),t.session.markUndoGroup(),m.range=t.selection.getRange(),t.selection.setRange(n),t.selection.clearSelection()}},F=function(e){if(!t.onCompositionEnd||t.$readOnly)return;var n=m;m=!1;var r=setTimeout(function(){r=null;var e=c.value.replace(/\x01/g,"");if(m)return;e==n.lastValue?T():!n.lastValue&&e&&(T(),A(e))});k=function(i){return r&&clearTimeout(r),i=i.replace(/\x01/g,""),i==n.lastValue?"":(n.lastValue&&r&&t.undo(),i)},t.onCompositionEnd(),t.removeListener("mousedown",F),e.type=="compositionend"&&n.range&&t.selection.setRange(n.range);var s=!!i.isChrome&&i.isChrome>=53||!!i.isWebKit&&i.isWebKit>=603;s&&O()},I=o.delayedCall(j,50);r.addListener(c,"compositionstart",B),i.isGecko?r.addListener(c,"text",function(){I.schedule()}):(r.addListener(c,"keyup",function(){I.schedule()}),r.addListener(c,"keydown",function(){I.schedule()})),r.addListener(c,"compositionend",F),this.getElement=function(){return c},this.setReadOnly=function(e){c.readOnly=e},this.onContextMenu=function(e){L=!0,x(t.selection.isEmpty()),t._emit("nativecontextmenu",{target:t,domEvent:e}),this.moveToMouse(e,!0)},this.moveToMouse=function(e,n){g||(g=c.style.cssText),c.style.cssText=(n?"z-index:100000;":"")+"height:"+c.style.height+";"+(i.isIE?"opacity:0.1;":"");var o=t.container.getBoundingClientRect(),u=s.computedStyle(t.container),a=o.top+(parseInt(u.borderTopWidth)||0),f=o.left+(parseInt(o.borderLeftWidth)||0),l=o.bottom-a-c.clientHeight-2,h=function(e){c.style.left=e.clientX-f-2+"px",c.style.top=Math.min(e.clientY-a-2,l)+"px"};h(e);if(e.type!="mousedown")return;t.renderer.$keepTextAreaAtCursor&&(t.renderer.$keepTextAreaAtCursor=null),clearTimeout(q),i.isWin&&r.capture(t.container,h,R)},this.onContextMenuClose=R;var q,U=function(e){t.textInput.onContextMenu(e),R()};r.addListener(c,"mouseup",U),r.addListener(c,"mousedown",function(e){e.preventDefault(),R()}),r.addListener(t.renderer.scroller,"contextmenu",U),r.addListener(c,"contextmenu",U);if(i.isIOS){var z=null,W=!1;e.addEventListener("keydown",function(e){z&&clearTimeout(z),W=!0}),e.addEventL Line: 15 -  p",function(e){z=setTimeout(function(){W=!1},100)});var X=function(e){if(document.activeElement!==c)return;if(W)return;if(d)return setTimeout(function(){d=!1},100);var n=c.selectionStart,r=c.selectionEnd;c.setSelectionRange(4,5);if(n==r)switch(n){case 0:t.onCommandKey(null,0,u.up);break;case 1:t.onCommandKey(null,0,u.home);break;case 2:t.onCommandKey(null,a.option,u.left);break;case 4:t.onCommandKey(null,0,u.left);break;case 5:t.onCommandKey(null,0,u.right);break;case 7:t.onCommandKey(null,a.option,u.right);break;case 8:t.onCommandKey(null,0,u.end);break;case 9:t.onCommandKey(null,0,u.down)}else{switch(r){case 6:t.onCommandKey(null,a.shift,u.right);break;case 7:t.onCommandKey(null,a.shift|a.option,u.right);break;case 8:t.onCommandKey(null,a.shift,u.end);break;case 9:t.onCommandKey(null,a.shift,u.down)}switch(n){case 0:t.onCommandKey(null,a.shift,u.up);break;case 1:t.onCommandKey(null,a.shift,u.home);break;case 2:t.onCommandKey(null,a.shift|a.option,u.left);break;case 3:t.onCommandKey(null,a.shift,u.left)}}};document.addEventListener("selectionchange",X),t.on("destroy",function(){document.removeEventListener("selectionchange",X)})}};t.TextInput=c}),ace.define("ace/keyboard/textinput",["require","exports","module","ace/lib/event","ace/lib/useragent","ace/lib/dom","ace/lib/lang","ace/keyboard/textinput_ios"],function(e,t,n){"use strict";var r=e("../lib/event"),i=e("../lib/useragent"),s=e("../lib/dom"),o=e("../lib/lang"),u=i.isChrome<18,a=i.isIE,f=e("./textinput_ios").TextInput,l=function(e,t){function w(e){if(p)return;p=!0;if(T)var t=0,r=e?0:n.value.length-1;else var t=e?2:1,r=2;try{n.setSelectionRange(t,r)}catch(i){}p=!1}function E(){if(p)return;n.value=l,i.isWebKit&&b.schedule()}function F(){clearTimeout(j),j=setTimeout(function(){d&&(n.style.cssText=d,d=""),t.renderer.$keepTextAreaAtCursor==null&&(t.renderer.$keepTextAreaAtCursor=!0,t.renderer.$moveTextAreaToCursor())},0)}if(i.isIOS)return f.call(this,e,t);var n=s.createElement("textarea");n.className="ace_text-input",n.setAttribute("wrap","off"),n.setAttribute("autocorrect","off"),n.setAttribute("autocapitalize","off"),n.setA Line: 16 -  llcheck",!1),n.style.opacity="0",e.insertBefore(n,e.firstChild);var l="\u2028\u2028",c=!1,h=!1,p=!1,d="",v=!0;try{var m=document.activeElement===n}catch(g){}r.addListener(n,"blur",function(e){t.onBlur(e),m=!1}),r.addListener(n,"focus",function(e){m=!0,t.onFocus(e),w()}),this.focus=function(){if(d)return n.focus();var e=n.style.top;n.style.position="fixed",n.style.top="0px",n.focus(),setTimeout(function(){n.style.position="",n.style.top=="0px"&&(n.style.top=e)},0)},this.blur=function(){n.blur()},this.isFocused=function(){return m};var y=o.delayedCall(function(){m&&w(v)}),b=o.delayedCall(function(){p||(n.value=l,m&&w())});i.isWebKit||t.addEventListener("changeSelection",function(){t.selection.isEmpty()!=v&&(v=!v,y.schedule())}),E(),m&&t.onFocus();var S=function(e){return e.selectionStart===0&&e.selectionEnd===e.value.length},x=function(e){c?c=!1:S(n)?(t.selectAll(),w()):T&&w(t.selection.isEmpty())},T=null;this.setInputHandler=function(e){T=e},this.getInputHandler=function(){return T};var N=!1,C=function(e){T&&(e=T(e),T=null),h?(w(),e&&t.onPaste(e),h=!1):e==l.charAt(0)?N?t.execCommand("del",{source:"ace"}):t.execCommand("backspace",{source:"ace"}):(e.substring(0,2)==l?e=e.substr(2):e.charAt(0)==l.charAt(0)?e=e.substr(1):e.charAt(e.length-1)==l.charAt(0)&&(e=e.slice(0,-1)),e.charAt(e.length-1)==l.charAt(0)&&(e=e.slice(0,-1)),e&&t.onTextInput(e)),N&&(N=!1)},k=function(e){if(p)return;var t=n.value;C(t),E()},L=function(e,t,n){var r=e.clipboardData||window.clipboardData;if(!r||u)return;var i=a||n?"Text":"text/plain";try{return t?r.setData(i,t)!==!1:r.getData(i)}catch(e){if(!n)return L(e,t,!0)}},A=function(e,i){var s=t.getCopyText();if(!s)return r.preventDefault(e);L(e,s)?(i?t.onCut():t.onCopy(),r.preventDefault(e)):(c=!0,n.value=s,n.select(),setTimeout(function(){c=!1,E(),w(),i?t.onCut():t.onCopy()}))},O=function(e){A(e,!0)},M=function(e){A(e,!1)},_=function(e){var s=L(e);typeof s=="string"?(s&&t.onPaste(s,e),i.isIE&&setTimeout(w),r.preventDefault(e)):(n.value="",h=!0)};r.addCommandKeyListener(n,t.onCommandKey.bind(t)),r.addListener(n,"select",x),r.addListener(n,"input",k),r.addListen Line: 17 -  ,r.addListener(n,"copy",M),r.addListener(n,"paste",_),(!("oncut"in n)||!("oncopy"in n)||!("onpaste"in n))&&r.addListener(e,"keydown",function(e){if(i.isMac&&!e.metaKey||!e.ctrlKey)return;switch(e.keyCode){case 67:M(e);break;case 86:_(e);break;case 88:O(e)}});var D=function(e){if(p||!t.onCompositionStart||t.$readOnly)return;p={},p.canUndo=t.session.$undoManager,t.onCompositionStart(),setTimeout(P,0),t.on("mousedown",H),p.canUndo&&!t.selection.isEmpty()&&(t.insert(""),t.session.markUndoGroup(),t.selection.clearSelection()),t.session.markUndoGroup()},P=function(){if(!p||!t.onCompositionUpdate||t.$readOnly)return;var e=n.value.replace(/\u2028/g,"");if(p.lastValue===e)return;t.onCompositionUpdate(e),p.lastValue&&t.undo(),p.canUndo&&(p.lastValue=e);if(p.lastValue){var r=t.selection.getRange();t.insert(p.lastValue),t.session.markUndoGroup(),p.range=t.selection.getRange(),t.selection.setRange(r),t.selection.clearSelection()}},H=function(e){if(!t.onCompositionEnd||t.$readOnly)return;var r=p;p=!1;var s=setTimeout(function(){s=null;var e=n.value.replace(/\u2028/g,"");if(p)return;e==r.lastValue?E():!r.lastValue&&e&&(E(),C(e))});T=function(n){return s&&clearTimeout(s),n=n.replace(/\u2028/g,""),n==r.lastValue?"":(r.lastValue&&s&&t.undo(),n)},t.onCompositionEnd(),t.removeListener("mousedown",H),e.type=="compositionend"&&r.range&&t.selection.setRange(r.range);var o=!!i.isChrome&&i.isChrome>=53||!!i.isWebKit&&i.isWebKit>=603;o&&k()},B=o.delayedCall(P,50);r.addListener(n,"compositionstart",D),i.isGecko?r.addListener(n,"text",function(){B.schedule()}):(r.addListener(n,"keyup",function(){B.schedule()}),r.addListener(n,"keydown",function(){B.schedule()})),r.addListener(n,"compositionend",H),this.getElement=function(){return n},this.setReadOnly=function(e){n.readOnly=e},this.onContextMenu=function(e){N=!0,w(t.selection.isEmpty()),t._emit("nativecontextmenu",{target:t,domEvent:e}),this.moveToMouse(e,!0)},this.moveToMouse=function(e,o){d||(d=n.style.cssText),n.style.cssText=(o?"z-index:100000;":"")+"height:"+n.style.height+";"+(i.isIE?"opacity:0.1;":"");var u=t.container.getBoundingClientRect(),a=s.c Line: 22 -  ion(r){if(!t.isFocused()||r.getButton()!=0)return;var i=n.getRegion(r);if(i=="foldWidgets")return;var s=r.getDocumentPosition().row,o=t.session.selection;if(r.getShiftKey())o.selectTo(s,0);else{if(r.domEvent.detail==2)return t.selectAll(),r.preventDefault();e.$clickSelection=t.selection.getLineRange(s)}return e.setState("selectByLines"),e.captureMouse(r),r.preventDefault()});var o,u,f;e.editor.setDefaultHandler("guttermousemove",function(t){var n=t.domEvent.target||t.domEvent.srcElement;if(r.hasCssClass(n,"ace_fold-widget"))return c();f&&e.$tooltipFollowsMouse&&h(t),u=t;if(o)return;o=setTimeout(function(){o=null,u&&!e.isMousePressed?l():c()},50)}),s.addListener(t.renderer.$gutter,"mouseout",function(e){u=null;if(!f||o)return;o=setTimeout(function(){o=null,c()},50)}),t.on("changeSession",c)}function a(e){o.call(this,e)}var r=e("../lib/dom"),i=e("../lib/oop"),s=e("../lib/event"),o=e("../tooltip").Tooltip;i.inherits(a,o),function(){this.setPosition=function(e,t){var n=window.innerWidth||document.documentElement.clientWidth,r=window.innerHeight||document.documentElement.clientHeight,i=this.getWidth(),s=this.getHeight();e+=15,t+=15,e+i>n&&(e-=e+i-n),t+s>r&&(t-=20+s),o.prototype.setPosition.call(this,e,t)}}.call(a.prototype),t.GutterHandler=u}),ace.define("ace/mouse/mouse_event",["require","exports","module","ace/lib/event","ace/lib/useragent"],function(e,t,n){"use strict";var r=e("../lib/event"),i=e("../lib/useragent"),s=t.MouseEvent=function(e,t){this.domEvent=e,this.editor=t,this.x=this.clientX=e.clientX,this.y=this.clientY=e.clientY,this.$pos=null,this.$inSelection=null,this.propagationStopped=!1,this.defaultPrevented=!1};(function(){this.stopPropagation=function(){r.stopPropagation(this.domEvent),this.propagationStopped=!0},this.preventDefault=function(){r.preventDefault(this.domEvent),this.defaultPrevented=!0},this.stop=function(){this.stopPropagation(),this.preventDefault()},this.getDocumentPosition=function(){return this.$pos?this.$pos:(this.$pos=this.editor.renderer.screenToTextCoordinates(this.clientX,this.clientY),this.$pos)},this.inSelection=function(){if(this.$inSelecti Line: 23 -  urn this.$inSelection;var e=this.editor,t=e.getSelectionRange();if(t.isEmpty())this.$inSelection=!1;else{var n=this.getDocumentPosition();this.$inSelection=t.contains(n.row,n.column)}return this.$inSelection},this.getButton=function(){return r.getButton(this.domEvent)},this.getShiftKey=function(){return this.domEvent.shiftKey},this.getAccelKey=i.isMac?function(){return this.domEvent.metaKey}:function(){return this.domEvent.ctrlKey}}).call(s.prototype)}),ace.define("ace/mouse/dragdrop_handler",["require","exports","module","ace/lib/dom","ace/lib/event","ace/lib/useragent"],function(e,t,n){"use strict";function f(e){function T(e,n){var r=Date.now(),i=!n||e.row!=n.row,s=!n||e.column!=n.column;if(!S||i||s)t.$blockScrolling+=1,t.moveCursorToPosition(e),t.$blockScrolling-=1,S=r,x={x:p,y:d};else{var o=l(x.x,x.y,p,d);o>a?S=null:r-S>=u&&(t.renderer.scrollCursorIntoView(),S=null)}}function N(e,n){var r=Date.now(),i=t.renderer.layerConfig.lineHeight,s=t.renderer.layerConfig.characterWidth,u=t.renderer.scroller.getBoundingClientRect(),a={x:{left:p-u.left,right:u.right-p},y:{top:d-u.top,bottom:u.bottom-d}},f=Math.min(a.x.left,a.x.right),l=Math.min(a.y.top,a.y.bottom),c={row:e.row,column:e.column};f/s<=2&&(c.column+=a.x.left<a.x.right?-3:2),l/i<=1&&(c.row+=a.y.top<a.y.bottom?-1:1);var h=e.row!=c.row,v=e.column!=c.column,m=!n||e.row!=n.row;h||v&&!m?E?r-E>=o&&t.renderer.scrollCursorIntoView(c):E=r:E=null}function C(){var e=g;g=t.renderer.screenToTextCoordinates(p,d),T(g,e),N(g,e)}function k(){m=t.selection.toOrientedRange(),h=t.session.addMarker(m,"ace_selection",t.getSelectionStyle()),t.clearSelection(),t.isFocused()&&t.renderer.$cursorLayer.setBlinking(!1),clearInterval(v),C(),v=setInterval(C,20),y=0,i.addListener(document,"mousemove",O)}function L(){clearInterval(v),t.session.removeMarker(h),h=null,t.$blockScrolling+=1,t.selection.fromOrientedRange(m),t.$blockScrolling-=1,t.isFocused()&&!w&&t.renderer.$cursorLayer.setBlinking(!t.getReadOnly()),m=null,g=null,y=0,E=null,S=null,i.removeListener(document,"mousemove",O)}function O(){A==null&&(A=setTimeout(function(){A!=null&&h&&L()},20))}functi Line: 24 -  =e.types;return!t||Array.prototype.some.call(t,function(e){return e=="text/plain"||e=="Text"})}function _(e){var t=["copy","copymove","all","uninitialized"],n=["move","copymove","linkmove","all","uninitialized"],r=s.isMac?e.altKey:e.ctrlKey,i="uninitialized";try{i=e.dataTransfer.effectAllowed.toLowerCase()}catch(e){}var o="none";return r&&t.indexOf(i)>=0?o="copy":n.indexOf(i)>=0?o="move":t.indexOf(i)>=0&&(o="copy"),o}var t=e.editor,n=r.createElement("img");n.src="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==",s.isOpera&&(n.style.cssText="width:1px;height:1px;position:fixed;top:0;left:0;z-index:2147483647;opacity:0;");var f=["dragWait","dragWaitEnd","startDrag","dragReadyEnd","onMouseDrag"];f.forEach(function(t){e[t]=this[t]},this),t.addEventListener("mousedown",this.onMouseDown.bind(e));var c=t.container,h,p,d,v,m,g,y=0,b,w,E,S,x;this.onDragStart=function(e){if(this.cancelDrag||!c.draggable){var r=this;return setTimeout(function(){r.startSelect(),r.captureMouse(e)},0),e.preventDefault()}m=t.getSelectionRange();var i=e.dataTransfer;i.effectAllowed=t.getReadOnly()?"copy":"copyMove",s.isOpera&&(t.container.appendChild(n),n.scrollTop=0),i.setDragImage&&i.setDragImage(n,0,0),s.isOpera&&t.container.removeChild(n),i.clearData(),i.setData("Text",t.session.getTextRange()),w=!0,this.setState("drag")},this.onDragEnd=function(e){c.draggable=!1,w=!1,this.setState(null);if(!t.getReadOnly()){var n=e.dataTransfer.dropEffect;!b&&n=="move"&&t.session.remove(t.getSelectionRange()),t.renderer.$cursorLayer.setBlinking(!0)}this.editor.unsetStyle("ace_dragging"),this.editor.renderer.setCursorStyle("")},this.onDragEnter=function(e){if(t.getReadOnly()||!M(e.dataTransfer))return;return p=e.clientX,d=e.clientY,h||k(),y++,e.dataTransfer.dropEffect=b=_(e),i.preventDefault(e)},this.onDragOver=function(e){if(t.getReadOnly()||!M(e.dataTransfer))return;return p=e.clientX,d=e.clientY,h||(k(),y++),A!==null&&(A=null),e.dataTransfer.dropEffect=b=_(e),i.preventDefault(e)},this.onDragLeave=function(e){y--;if(y<=0&&h)return L(),b=null,i.preventDefault(e)},this.onDrop=function(e){if(!g)re Line: 27 -  andlers;if(!n)return;var r=n._disabled_[e];if(n[e]==t){var i=n[e];r&&this.setDefaultHandler(e,r.pop())}else if(r){var s=r.indexOf(t);s!=-1&&r.splice(s,1)}},r.on=r.addEventListener=function(e,t,n){this._eventRegistry=this._eventRegistry||{};var r=this._eventRegistry[e];return r||(r=this._eventRegistry[e]=[]),r.indexOf(t)==-1&&r[n?"unshift":"push"](t),t},r.off=r.removeListener=r.removeEventListener=function(e,t){this._eventRegistry=this._eventRegistry||{};var n=this._eventRegistry[e];if(!n)return;var r=n.indexOf(t);r!==-1&&n.splice(r,1)},r.removeAllListeners=function(e){this._eventRegistry&&(this._eventRegistry[e]=[])},t.EventEmitter=r}),ace.define("ace/lib/app_config",["require","exports","module","ace/lib/oop","ace/lib/event_emitter"],function(e,t,n){"no use strict";function o(e){typeof console!="undefined"&&console.warn&&console.warn.apply(console,arguments)}function u(e,t){var n=new Error(e);n.data=t,typeof console=="object"&&console.error&&console.error(n),setTimeout(function(){throw n})}var r=e("./oop"),i=e("./event_emitter").EventEmitter,s={setOptions:function(e){Object.keys(e).forEach(function(t){this.setOption(t,e[t])},this)},getOptions:function(e){var t={};return e?Array.isArray(e)||(t=e,e=Object.keys(t)):e=Object.keys(this.$options),e.forEach(function(e){t[e]=this.getOption(e)},this),t},setOption:function(e,t){if(this["$"+e]===t)return;var n=this.$options[e];if(!n)return o('misspelled option "'+e+'"');if(n.forwardTo)return this[n.forwardTo]&&this[n.forwardTo].setOption(e,t);n.handlesSet||(this["$"+e]=t),n&&n.set&&n.set.call(this,t)},getOption:function(e){var t=this.$options[e];return t?t.forwardTo?this[t.forwardTo]&&this[t.forwardTo].getOption(e):t&&t.get?t.get.call(this):this["$"+e]:o('misspelled option "'+e+'"')}},a=function(){this.$defaultOptions={}};(function(){r.implement(this,i),this.defineOptions=function(e,t,n){return e.$options||(this.$defaultOptions[t]=e.$options={}),Object.keys(n).forEach(function(t){var r=n[t];typeof r=="string"&&(r={forwardTo:r}),r.name||(r.name=t),e.$options[r.name]=r,"initialValue"in r&&(e["$"+r.name]=r.initialValue)}),r.implement(e,s), Line: 30 -  wn")),r.addListener(f,"click",this.onMouseEvent.bind(this,"gutterclick")),r.addListener(f,"dblclick",this.onMouseEvent.bind(this,"gutterdblclick")),r.addListener(f,"mousemove",this.onMouseEvent.bind(this,"guttermousemove")),r.addListener(u,"mousedown",n),r.addListener(f,"mousedown",n),i.isIE&&e.renderer.scrollBarV&&(r.addListener(e.renderer.scrollBarV.element,"mousedown",n),r.addListener(e.renderer.scrollBarH.element,"mousedown",n)),e.on("mousemove",function(n){if(t.state||t.$dragDelay||!t.$dragEnabled)return;var r=e.renderer.screenToTextCoordinates(n.x,n.y),i=e.session.selection.getRange(),s=e.renderer;!i.isEmpty()&&i.insideStart(r.row,r.column)?s.setCursorStyle("default"):s.setCursorStyle("")})};(function(){this.onMouseEvent=function(e,t){this.editor._emit(e,new u(t,this.editor))},this.onMouseMove=function(e,t){var n=this.editor._eventRegistry&&this.editor._eventRegistry.mousemove;if(!n||!n.length)return;this.editor._emit(e,new u(t,this.editor))},this.onMouseWheel=function(e,t){var n=new u(t,this.editor);n.speed=this.$scrollSpeed*2,n.wheelX=t.wheelX,n.wheelY=t.wheelY,this.editor._emit(e,n)},this.onTouchMove=function(e,t){var n=new u(t,this.editor);n.speed=1,n.wheelX=t.wheelX,n.wheelY=t.wheelY,this.editor._emit(e,n)},this.setState=function(e){this.state=e},this.captureMouse=function(e,t){this.x=e.x,this.y=e.y,this.isMousePressed=!0;var n=this.editor.renderer;n.$keepTextAreaAtCursor&&(n.$keepTextAreaAtCursor=null);var s=this,o=function(e){if(!e)return;if(i.isWebKit&&!e.which&&s.releaseMouse)return s.releaseMouse();s.x=e.clientX,s.y=e.clientY,t&&t(e),s.mouseEvent=new u(e,s.editor),s.$mouseMoved=!0},a=function(e){clearInterval(l),f(),s[s.state+"End"]&&s[s.state+"End"](e),s.state="",n.$keepTextAreaAtCursor==null&&(n.$keepTextAreaAtCursor=!0,n.$moveTextAreaToCursor()),s.isMousePressed=!1,s.$onCaptureMouseMove=s.releaseMouse=null,e&&s.onMouseEvent("mouseup",e)},f=function(){s[s.state]&&s[s.state](),s.$mouseMoved=!1};if(i.isOldIE&&e.domEvent.type=="dblclick")return setTimeout(function(){a(e)});s.$onCaptureMouseMove=o,s.releaseMouse=r.capture(this.editor.container,o,a);var l=setInter Line: 31 -  is.releaseMouse=null,this.cancelContextMenu=function(){var e=function(t){if(t&&t.domEvent&&t.domEvent.type!="contextmenu")return;this.editor.off("nativecontextmenu",e),t&&t.domEvent&&r.stopEvent(t.domEvent)}.bind(this);setTimeout(e,10),this.editor.on("nativecontextmenu",e)}}).call(l.prototype),f.defineOptions(l.prototype,"mouseHandler",{scrollSpeed:{initialValue:2},dragDelay:{initialValue:i.isMac?150:0},dragEnabled:{initialValue:!0},focusTimout:{initialValue:0},tooltipFollowsMouse:{initialValue:!0}}),t.MouseHandler=l}),ace.define("ace/mouse/fold_handler",["require","exports","module"],function(e,t,n){"use strict";function r(e){e.on("click",function(t){var n=t.getDocumentPosition(),r=e.session,i=r.getFoldAt(n.row,n.column,1);i&&(t.getAccelKey()?r.removeFold(i):r.expandFold(i),t.stop())}),e.on("gutterclick",function(t){var n=e.renderer.$gutterLayer.getRegion(t);if(n=="foldWidgets"){var r=t.getDocumentPosition().row,i=e.session;i.foldWidgets&&i.foldWidgets[r]&&e.session.onFoldWidgetClick(r,t),e.isFocused()||e.focus(),t.stop()}}),e.on("gutterdblclick",function(t){var n=e.renderer.$gutterLayer.getRegion(t);if(n=="foldWidgets"){var r=t.getDocumentPosition().row,i=e.session,s=i.getParentFoldRangeData(r,!0),o=s.range||s.firstRange;if(o){r=o.start.row;var u=i.getFoldAt(r,i.getLine(r).length,1);u?i.removeFold(u):(i.addFold("...",o),e.renderer.scrollCursorIntoView({row:o.start.row,column:0}))}t.stop()}})}t.FoldHandler=r}),ace.define("ace/keyboard/keybinding",["require","exports","module","ace/lib/keys","ace/lib/event"],function(e,t,n){"use strict";var r=e("../lib/keys"),i=e("../lib/event"),s=function(e){this.$editor=e,this.$data={editor:e},this.$handlers=[],this.setDefaultHandler(e.commands)};(function(){this.setDefaultHandler=function(e){this.removeKeyboardHandler(this.$defaultHandler),this.$defaultHandler=e,this.addKeyboardHandler(e,0)},this.setKeyboardHandler=function(e){var t=this.$handlers;if(t[t.length-1]==e)return;while(t[t.length-1]&&t[t.length-1]!=this.$defaultHandler)this.removeKeyboardHandler(t[t.length-1]);this.addKeyboardHandler(e,1)},this.addKeyboardHandler=function(e,t){if Line: 70 -  ength,i=0,s=Math.min(e.row,n.length);for(var o=t||0;o<s;++o)i+=n[o].length+r;return i+e.column}}).call(a.prototype),t.Document=a}),ace.define("ace/background_tokenizer",["require","exports","module","ace/lib/oop","ace/lib/event_emitter"],function(e,t,n){"use strict";var r=e("./lib/oop"),i=e("./lib/event_emitter").EventEmitter,s=function(e,t){this.running=!1,this.lines=[],this.states=[],this.currentLine=0,this.tokenizer=e;var n=this;this.$worker=function(){if(!n.running)return;var e=new Date,t=n.currentLine,r=-1,i=n.doc,s=t;while(n.lines[t])t++;var o=i.getLength(),u=0;n.running=!1;while(t<o){n.$tokenizeRow(t),r=t;do t++;while(n.lines[t]);u++;if(u%5===0&&new Date-e>20){n.running=setTimeout(n.$worker,20);break}}n.currentLine=t,r==-1&&(r=t),s<=r&&n.fireUpdateEvent(s,r)}};(function(){r.implement(this,i),this.setTokenizer=function(e){this.tokenizer=e,this.lines=[],this.states=[],this.start(0)},this.setDocument=function(e){this.doc=e,this.lines=[],this.states=[],this.stop()},this.fireUpdateEvent=function(e,t){var n={first:e,last:t};this._signal("update",{data:n})},this.start=function(e){this.currentLine=Math.min(e||0,this.currentLine,this.doc.getLength()),this.lines.splice(this.currentLine,this.lines.length),this.states.splice(this.currentLine,this.states.length),this.stop(),this.running=setTimeout(this.$worker,700)},this.scheduleStart=function(){this.running||(this.running=setTimeout(this.$worker,700))},this.$updateOnChange=function(e){var t=e.start.row,n=e.end.row-t;if(n===0)this.lines[t]=null;else if(e.action=="remove")this.lines.splice(t,n+1,null),this.states.splice(t,n+1,null);else{var r=Array(n+1);r.unshift(t,1),this.lines.splice.apply(this.lines,r),this.states.splice.apply(this.states,r)}this.currentLine=Math.min(t,this.currentLine,this.doc.getLength()),this.stop()},this.stop=function(){this.running&&clearTimeout(this.running),this.running=!1},this.getTokens=function(e){return this.lines[e]||this.$tokenizeRow(e)},this.getState=function(e){return this.currentLine==e&&this.$tokenizeRow(e),this.states[e]||"start"},this.$tokenizeRow=function(e){var t=this.doc.getLine(e),n=this.sta Line: 109 -  s.$onCursorChange),this.$onSelectionChange=this.onSelectionChange.bind(this),this.selection.on("changeSelection",this.$onSelectionChange),this.onChangeMode(),this.$blockScrolling+=1,this.onCursorChange(),this.$blockScrolling-=1,this.onScrollTopChange(),this.onScrollLeftChange(),this.onSelectionChange(),this.onChangeFrontMarker(),this.onChangeBackMarker(),this.onChangeBreakpoint(),this.onChangeAnnotation(),this.session.getUseWrapMode()&&this.renderer.adjustWrapLimit(),this.renderer.updateFull()):(this.selection=null,this.renderer.setSession(e)),this._signal("changeSession",{session:e,oldSession:t}),this.curOp=null,t&&t._signal("changeEditor",{oldEditor:this}),e&&e._signal("changeEditor",{editor:this}),e&&e.bgTokenizer&&e.bgTokenizer.scheduleStart()},this.getSession=function(){return this.session},this.setValue=function(e,t){return this.session.doc.setValue(e),t?t==1?this.navigateFileEnd():t==-1&&this.navigateFileStart():this.selectAll(),e},this.getValue=function(){return this.session.getValue()},this.getSelection=function(){return this.selection},this.resize=function(e){this.renderer.onResize(e)},this.setTheme=function(e,t){this.renderer.setTheme(e,t)},this.getTheme=function(){return this.renderer.getTheme()},this.setStyle=function(e){this.renderer.setStyle(e)},this.unsetStyle=function(e){this.renderer.unsetStyle(e)},this.getFontSize=function(){return this.getOption("fontSize")||i.computedStyle(this.container,"fontSize")},this.setFontSize=function(e){this.setOption("fontSize",e)},this.$highlightBrackets=function(){this.session.$bracketHighlight&&(this.session.removeMarker(this.session.$bracketHighlight),this.session.$bracketHighlight=null);if(this.$highlightPending)return;var e=this;this.$highlightPending=!0,setTimeout(function(){e.$highlightPending=!1;var t=e.session;if(!t||!t.bgTokenizer)return;var n=t.findMatchingBracket(e.getCursorPosition());if(n)var r=new p(n.row,n.column,n.row,n.column+1);else if(t.$mode.getMatching)var r=t.$mode.getMatching(e.session);r&&(t.$bracketHighlight=t.addMarker(r,"ace_bracket","text"))},50)},this.$highlightTags=function(){if(this.$highlightTag Line: 110 -  ;var e=this;this.$highlightTagPending=!0,setTimeout(function(){e.$highlightTagPending=!1;var t=e.session;if(!t||!t.bgTokenizer)return;var n=e.getCursorPosition(),r=new y(e.session,n.row,n.column),i=r.getCurrentToken();if(!i||!/\b(?:tag-open|tag-name)/.test(i.type)){t.removeMarker(t.$tagHighlight),t.$tagHighlight=null;return}if(i.type.indexOf("tag-open")!=-1){i=r.stepForward();if(!i)return}var s=i.value,o=0,u=r.stepBackward();if(u.value=="<"){do u=i,i=r.stepForward(),i&&i.value===s&&i.type.indexOf("tag-name")!==-1&&(u.value==="<"?o++:u.value==="</"&&o--);while(i&&o>=0)}else{do i=u,u=r.stepBackward(),i&&i.value===s&&i.type.indexOf("tag-name")!==-1&&(u.value==="<"?o++:u.value==="</"&&o--);while(u&&o<=0);r.stepForward()}if(!i){t.removeMarker(t.$tagHighlight),t.$tagHighlight=null;return}var a=r.getCurrentTokenRow(),f=r.getCurrentTokenColumn(),l=new p(a,f,a,f+i.value.length),c=t.$backMarkers[t.$tagHighlight];t.$tagHighlight&&c!=undefined&&l.compareRange(c.range)!==0&&(t.removeMarker(t.$tagHighlight),t.$tagHighlight=null),l&&!t.$tagHighlight&&(t.$tagHighlight=t.addMarker(l,"ace_bracket","text"))},50)},this.focus=function(){var e=this;setTimeout(function(){e.textInput.focus()}),this.textInput.focus()},this.isFocused=function(){return this.textInput.isFocused()},this.blur=function(){this.textInput.blur()},this.onFocus=function(e){if(this.$isFocused)return;this.$isFocused=!0,this.renderer.showCursor(),this.renderer.visualizeFocus(),this._emit("focus",e)},this.onBlur=function(e){if(!this.$isFocused)return;this.$isFocused=!1,this.renderer.hideCursor(),this.renderer.visualizeBlur(),this._emit("blur",e)},this.$cursorChange=function(){this.renderer.updateCursor()},this.onDocumentChange=function(e){var t=this.session.$useWrapMode,n=e.start.row==e.end.row?e.end.row:Infinity;this.renderer.updateLines(e.start.row,n,t),this._signal("change",e),this.$cursorChange(),this.$updateHighlightActiveLine()},this.onTokenizerUpdate=function(e){var t=e.data;this.renderer.updateLines(t.first,t.last)},this.onScrollTopChange=function(){this.renderer.scrollToY(this.session.getScrollTop())},this.onScrollLeftChan Line: 133 -  s.restartTimer=function(){var e=this.$updateCursors;clearInterval(this.intervalId),clearTimeout(this.timeoutId),this.smoothBlinking&&r.removeCssClass(this.element,"ace_smooth-blinking"),e(!0);if(!this.isBlinking||!this.blinkInterval||!this.isVisible)return;this.smoothBlinking&&setTimeout(function(){r.addCssClass(this.element,"ace_smooth-blinking")}.bind(this));var t=function(){this.timeoutId=setTimeout(function(){e(!1)},.6*this.blinkInterval)}.bind(this);this.intervalId=setInterval(function(){e(!0),t()},this.blinkInterval),t()},this.getPixelPosition=function(e,t){if(!this.config||!this.session)return{left:0,top:0};e||(e=this.session.selection.getCursor());var n=this.session.documentToScreenPosition(e),r=this.$padding+(this.session.$bidiHandler.isBidiRow(n.row,e.row)?this.session.$bidiHandler.getPosLeft(n.column):n.column*this.config.characterWidth),i=(n.row-(t?this.config.firstRowScreen:0))*this.config.lineHeight;return{left:r,top:i}},this.update=function(e){this.config=e;var t=this.session.$selectionMarkers,n=0,r=0;if(t===undefined||t.length===0)t=[{cursor:null}];for(var n=0,i=t.length;n<i;n++){var s=this.getPixelPosition(t[n].cursor,!0);if((s.top>e.height+e.offset||s.top<0)&&n>1)continue;var o=(this.cursors[r++]||this.addCursor()).style;this.drawCursor?this.drawCursor(o,s,e,t[n],this.session):(o.left=s.left+"px",o.top=s.top+"px",o.width=e.characterWidth+"px",o.height=e.lineHeight+"px")}while(this.cursors.length>r)this.removeCursor();var u=this.session.getOverwrite();this.$setOverwrite(u),this.$pixelPos=s,this.restartTimer()},this.drawCursor=null,this.$setOverwrite=function(e){e!=this.overwrite&&(this.overwrite=e,e?r.addCssClass(this.element,"ace_overwrite-cursors"):r.removeCssClass(this.element,"ace_overwrite-cursors"))},this.destroy=function(){clearInterval(this.intervalId),clearTimeout(this.timeoutId)}}).call(s.prototype),t.Cursor=s}),ace.define("ace/scrollbar",["require","exports","module","ace/lib/oop","ace/lib/dom","ace/lib/event","ace/lib/event_emitter"],function(e,t,n){"use strict";var r=e("./lib/oop"),i=e("./lib/dom"),s=e("./lib/event"),o=e("./lib/event_emitter").Ev Line: 136 -  on(){var e=this.$measureSizes();if(e&&(this.$characterSize.width!==e.width||this.$characterSize.height!==e.height)){this.$measureNode.style.fontWeight="bold";var t=this.$measureSizes();this.$measureNode.style.fontWeight="",this.$characterSize=e,this.charSizes=Object.create(null),this.allowBoldFonts=t&&t.width===e.width&&t.height===e.height,this._emit("changeCharacterSize",{data:e})}},this.$pollSizeChanges=function(){if(this.$pollSizeChangesTimer)return this.$pollSizeChangesTimer;var e=this;return this.$pollSizeChangesTimer=setInterval(function(){e.checkForSizeChanges()},500)},this.setPolling=function(e){e?this.$pollSizeChanges():this.$pollSizeChangesTimer&&(clearInterval(this.$pollSizeChangesTimer),this.$pollSizeChangesTimer=0)},this.$measureSizes=function(){if(a===50){var e=null;try{e=this.$measureNode.getBoundingClientRect()}catch(t){e={width:0,height:0}}var n={height:e.height,width:e.width/a}}else var n={height:this.$measureNode.clientHeight,width:this.$measureNode.clientWidth/a};return n.width===0||n.height===0?null:n},this.$measureCharWidth=function(e){this.$main.innerHTML=s.stringRepeat(e,a);var t=this.$main.getBoundingClientRect();return t.width/a},this.getCharacterWidth=function(e){var t=this.charSizes[e];return t===undefined&&(t=this.charSizes[e]=this.$measureCharWidth(e)/this.$characterSize.width),t},this.destroy=function(){clearInterval(this.$pollSizeChangesTimer),this.el&&this.el.parentNode&&this.el.parentNode.removeChild(this.el)}}).call(f.prototype)}),ace.define("ace/virtual_renderer",["require","exports","module","ace/lib/oop","ace/lib/dom","ace/config","ace/lib/useragent","ace/layer/gutter","ace/layer/marker","ace/layer/text","ace/layer/cursor","ace/scrollbar","ace/scrollbar","ace/renderloop","ace/layer/font_metrics","ace/lib/event_emitter"],function(e,t,n){"use strict";var r=e("./lib/oop"),i=e("./lib/dom"),s=e("./config"),o=e("./lib/useragent"),u=e("./layer/gutter").Gutter,a=e("./layer/marker").Marker,f=e("./layer/text").Text,l=e("./layer/cursor").Cursor,c=e("./scrollbar").HScrollBar,h=e("./scrollbar").VScrollBar,p=e("./renderloop").RenderLoop,d=e("./layer/fo Line: 152 -  f e=="number"&&(e={row:e,column:0});var n=this.$cursorLayer.getPixelPosition(e),r=this.$size.scrollerHeight-this.lineHeight,i=n.top-r*(t||0);return this.session.setScrollTop(i),i},this.STEPS=8,this.$calcSteps=function(e,t){var n=0,r=this.STEPS,i=[],s=function(e,t,n){return n*(Math.pow(e-1,3)+1)+t};for(n=0;n<r;++n)i.push(s(n/this.STEPS,e,t-e));return i},this.scrollToLine=function(e,t,n,r){var i=this.$cursorLayer.getPixelPosition({row:e,column:0}),s=i.top;t&&(s-=this.$size.scrollerHeight/2);var o=this.scrollTop;this.session.setScrollTop(s),n!==!1&&this.animateScrolling(o,r)},this.animateScrolling=function(e,t){var n=this.scrollTop;if(!this.$animatedScroll)return;var r=this;if(e==n)return;if(this.$scrollAnimation){var i=this.$scrollAnimation.steps;if(i.length){e=i[0];if(e==n)return}}var s=r.$calcSteps(e,n);this.$scrollAnimation={from:e,to:n,steps:s},clearInterval(this.$timer),r.session.setScrollTop(s.shift()),r.session.$scrollTop=n,this.$timer=setInterval(function(){s.length?(r.session.setScrollTop(s.shift()),r.session.$scrollTop=n):n!=null?(r.session.$scrollTop=-1,r.session.setScrollTop(n),n=null):(r.$timer=clearInterval(r.$timer),r.$scrollAnimation=null,t&&t())},10)},this.scrollToY=function(e){this.scrollTop!==e&&(this.$loop.schedule(this.CHANGE_SCROLL),this.scrollTop=e)},this.scrollToX=function(e){this.scrollLeft!==e&&(this.scrollLeft=e),this.$loop.schedule(this.CHANGE_H_SCROLL)},this.scrollTo=function(e,t){this.session.setScrollTop(t),this.session.setScrollLeft(t)},this.scrollBy=function(e,t){t&&this.session.setScrollTop(this.session.getScrollTop()+t),e&&this.session.setScrollLeft(this.session.getScrollLeft()+e)},this.isScrollableBy=function(e,t){if(t<0&&this.session.getScrollTop()>=1-this.scrollMargin.top)return!0;if(t>0&&this.session.getScrollTop()+this.$size.scrollerHeight-this.layerConfig.maxHeight<-1+this.scrollMargin.bottom)return!0;if(e<0&&this.session.getScrollLeft()>=1-this.scrollMargin.left)return!0;if(e>0&&this.session.getScrollLeft()+this.$size.scrollerWidth-this.layerConfig.width<-1+this.scrollMargin.right)return!0},this.pixelToScreenCoordinates=function(e,t){va Line: 156 -  |o.moduleUrl(n,"worker");else{var u=this.$normalizePath;i=i||u(e.toUrl("ace/worker/worker.js",null,"_"));var f={};t.forEach(function(t){f[t]=u(e.toUrl(t,null,"_").replace(/(\.js)?(\?.*)?$/,""))})}this.$worker=a(i),s&&this.send("importScripts",s),this.$worker.postMessage({init:!0,tlns:f,module:n,classname:r}),this.callbackId=1,this.callbacks={},this.$worker.onmessage=this.onMessage};(function(){r.implement(this,s),this.onMessage=function(e){var t=e.data;switch(t.type){case"event":this._signal(t.name,{data:t.data});break;case"call":var n=this.callbacks[t.id];n&&(n(t.data),delete this.callbacks[t.id]);break;case"error":this.reportError(t.data);break;case"log":window.console&&console.log&&console.log.apply(console,t.data)}},this.reportError=function(e){window.console&&console.error&&console.error(e)},this.$normalizePath=function(e){return i.qualifyURL(e)},this.terminate=function(){this._signal("terminate",{}),this.deltaQueue=null,this.$worker.terminate(),this.$worker=null,this.$doc&&this.$doc.off("change",this.changeListener),this.$doc=null},this.send=function(e,t){this.$worker.postMessage({command:e,args:t})},this.call=function(e,t,n){if(n){var r=this.callbackId++;this.callbacks[r]=n,t.push(r)}this.send(e,t)},this.emit=function(e,t){try{this.$worker.postMessage({event:e,data:{data:t.data}})}catch(n){console.error(n.stack)}},this.attachToDocument=function(e){this.$doc&&this.terminate(),this.$doc=e,this.call("setValue",[e.getValue()]),e.on("change",this.changeListener)},this.changeListener=function(e){this.deltaQueue||(this.deltaQueue=[],setTimeout(this.$sendDeltaQueue,0)),e.action=="insert"?this.deltaQueue.push(e.start,e.lines):this.deltaQueue.push(e.start,e.end)},this.$sendDeltaQueue=function(){var e=this.deltaQueue;if(!e)return;this.deltaQueue=null,e.length>50&&e.length>this.$doc.getLength()>>1?this.call("setValue",[this.$doc.getValue()]):this.emit("change",{data:e})}}).call(f.prototype);var l=function(e,t,n){this.$sendDeltaQueue=this.$sendDeltaQueue.bind(this),this.changeListener=this.changeListener.bind(this),this.callbackId=1,this.callbacks={},this.messageBuffer=[];var r=nul Line: 157 -  t.create(s),a=this;this.$worker={},this.$worker.terminate=function(){},this.$worker.postMessage=function(e){a.messageBuffer.push(e),r&&(i?setTimeout(f):f())},this.setEmitSync=function(e){i=e};var f=function(){var e=a.messageBuffer.shift();e.command?r[e.command].apply(r,e.args):e.event&&u._signal(e.event,e.data)};u.postMessage=function(e){a.onMessage({data:e})},u.callback=function(e,t){this.postMessage({type:"call",id:t,data:e})},u.emit=function(e,t){this.postMessage({type:"event",name:e,data:t})},o.loadModule(["worker",t],function(e){r=new e[n](u);while(a.messageBuffer.length)f()})};l.prototype=f.prototype,t.UIWorkerClient=l,t.WorkerClient=f,t.createWorker=a}),ace.define("ace/placeholder",["require","exports","module","ace/range","ace/lib/event_emitter","ace/lib/oop"],function(e,t,n){"use strict";var r=e("./range").Range,i=e("./lib/event_emitter").EventEmitter,s=e("./lib/oop"),o=function(e,t,n,r,i,s){var o=this;this.length=t,this.session=e,this.doc=e.getDocument(),this.mainClass=i,this.othersClass=s,this.$onUpdate=this.onUpdate.bind(this),this.doc.on("change",this.$onUpdate),this.$others=r,this.$onCursorChange=function(){setTimeout(function(){o.onCursorChange()})},this.$pos=n;var u=e.getUndoManager().$undoStack||e.getUndoManager().$undostack||{length:-1};this.$undoStackDepth=u.length,this.setup(),e.selection.on("changeCursor",this.$onCursorChange)};(function(){s.implement(this,i),this.setup=function(){var e=this,t=this.doc,n=this.session;this.selectionBefore=n.selection.toJSON(),n.selection.inMultiSelectMode&&n.selection.toSingleRange(),this.pos=t.createAnchor(this.$pos.row,this.$pos.column);var i=this.pos;i.$insertRight=!0,i.detach(),i.markerId=n.addMarker(new r(i.row,i.column,i.row,i.column+this.length),this.mainClass,null,!1),this.others=[],this.$others.forEach(function(n){var r=t.createAnchor(n.row,n.column);r.$insertRight=!0,r.detach(),e.others.push(r)}),n.setUndoSelect(!1)},this.showOtherMarkers=function(){if(this.othersActive)return;var e=this.session,t=this;this.othersActive=!0,this.others.forEach(function(n){n.markerId=e.addMarker(new r(n.row,n.column,n.row,n.column+ Line: 160 -  r.$clickSelection.clone()),C.forEach(l.addSelectionMarker,l),l.updateSelectionMarkers(),l.$blockScrolling--};l.$blockScrolling++,h&&!a?c.toSingleRange():!h&&a&&(N=c.toOrientedRange(),l.addSelectionMarker(N)),o?w=b.documentToScreenPosition(c.lead):c.moveToPosition(p),l.$blockScrolling--,E={row:-1,column:-1};var L=function(e){clearInterval(O),l.removeSelectionMarkers(C),C.length||(C=[c.toOrientedRange()]),l.$blockScrolling++,N&&(l.removeSelectionMarker(N),c.toSingleRange(N));for(var t=0;t<C.length;t++)c.addRange(C[t]);l.inVirtualSelectionMode=!1,l.$mouseHandler.$clickSelection=null,l.$blockScrolling--},A=k;r.capture(l.container,y,L);var O=setInterval(function(){A()},20);return e.preventDefault()}}var r=e("../lib/event"),i=e("../lib/useragent");t.onMouseDown=o}),ace.define("ace/commands/multi_select_commands",["require","exports","module","ace/keyboard/hash_handler"],function(e,t,n){t.defaultCommands=[{name:"addCursorAbove",exec:function(e){e.selectMoreLines(-1)},bindKey:{win:"Ctrl-Alt-Up",mac:"Ctrl-Alt-Up"},scrollIntoView:"cursor",readOnly:!0},{name:"addCursorBelow",exec:function(e){e.selectMoreLines(1)},bindKey:{win:"Ctrl-Alt-Down",mac:"Ctrl-Alt-Down"},scrollIntoView:"cursor",readOnly:!0},{name:"addCursorAboveSkipCurrent",exec:function(e){e.selectMoreLines(-1,!0)},bindKey:{win:"Ctrl-Alt-Shift-Up",mac:"Ctrl-Alt-Shift-Up"},scrollIntoView:"cursor",readOnly:!0},{name:"addCursorBelowSkipCurrent",exec:function(e){e.selectMoreLines(1,!0)},bindKey:{win:"Ctrl-Alt-Shift-Down",mac:"Ctrl-Alt-Shift-Down"},scrollIntoView:"cursor",readOnly:!0},{name:"selectMoreBefore",exec:function(e){e.selectMore(-1)},bindKey:{win:"Ctrl-Alt-Left",mac:"Ctrl-Alt-Left"},scrollIntoView:"cursor",readOnly:!0},{name:"selectMoreAfter",exec:function(e){e.selectMore(1)},bindKey:{win:"Ctrl-Alt-Right",mac:"Ctrl-Alt-Right"},scrollIntoView:"cursor",readOnly:!0},{name:"selectNextBefore",exec:function(e){e.selectMore(-1,!0)},bindKey:{win:"Ctrl-Alt-Shift-Left",mac:"Ctrl-Alt-Shift-Left"},scrollIntoView:"cursor",readOnly:!0},{name:"selectNextAfter",exec:function(e){e.selectMore(1,!0)},bindKey:{win:"Ctrl-Alt-Shift-Right",mac:"</Result>
</report_mosca>

<report_mosca>
 <Path>/src/public/vendor/jsonata/jsonata.min.js</Path>
 <Module>/app/Mosca/eggs/javascript_common_fail.egg</Module>
 <Title> Possible code injection</Title>
 <Description> Command injection is an attack in which the goal is execution of arbitrary commands on the host operating system via a vulnerable application.</Description>
 <Level> High</Level>
 <Reference> https://www.securecoding.cert.org/confluence/pages/viewpage.action?pageId=2130132 </Reference>
 <Match> eval\s?\(|setTimeout|setInterval</Match>
 <Result> Line: 38 -  r n=e("./_global"),o=n["__core-js_shared__"]||(n["__core-js_shared__"]={});t.exports=function(e){return o[e]||(o[e]={})}},{"./_global":41}],84:[function(e,t,r){var n=e("./_an-object"),o=e("./_a-function"),i=e("./_wks")("species");t.exports=function(e,t){var r,a=n(e).constructor;return void 0===a||void 0==(r=n(a)[i])?t:o(r)}},{"./_a-function":23,"./_an-object":26,"./_wks":96}],85:[function(e,t,r){var n=e("./_to-integer"),o=e("./_defined");t.exports=function(e){return function(t,r){var i,a,s=String(o(t)),u=n(r),c=s.length;return u<0||u>=c?e?"":void 0:(i=s.charCodeAt(u))<55296||i>56319||u+1===c||(a=s.charCodeAt(u+1))<56320||a>57343?e?s.charAt(u):i:e?s.slice(u,u+2):a-56320+(i-55296<<10)+65536}}},{"./_defined":33,"./_to-integer":88}],86:[function(e,t,r){var n,o,i,a=e("./_ctx"),s=e("./_invoke"),u=e("./_html"),c=e("./_dom-create"),f=e("./_global"),l=f.process,p=f.setImmediate,d=f.clearImmediate,h=f.MessageChannel,b=f.Dispatch,v=0,g={},m=function(){var e=+this;if(g.hasOwnProperty(e)){var t=g[e];delete g[e],t()}},y=function(e){m.call(e.data)};p&&d||(p=function(e){for(var t=[],r=1;arguments.length>r;)t.push(arguments[r++]);return g[++v]=function(){s("function"==typeof e?e:Function(e),t)},n(v),v},d=function(e){delete g[e]},"process"==e("./_cof")(l)?n=function(e){l.nextTick(a(m,e,1))}:b&&b.now?n=function(e){b.now(a(m,e,1))}:h?(i=(o=new h).port2,o.port1.onmessage=y,n=a(i.postMessage,i,1)):f.addEventListener&&"function"==typeof postMessage&&!f.importScripts?(n=function(e){f.postMessage(e+"","*")},f.addEventListener("message",y,!1)):n="onreadystatechange"in c("script")?function(e){u.appendChild(c("script")).onreadystatechange=function(){u.removeChild(this),m.call(e)}}:function(e){setTimeout(a(m,e,1),0)}),t.exports={set:p,clear:d}},{"./_cof":29,"./_ctx":32,"./_dom-create":35,"./_global":41,"./_html":44,"./_invoke":46}],87:[function(e,t,r){var n=e("./_to-integer"),o=Math.max,i=Math.min;t.exports=function(e,t){return(e=n(e))<0?o(e+t,0):i(e,t)}},{"./_to-integer":88}],88:[function(e,t,r){var n=Math.ceil,o=Math.floor;t.exports=function(e){return isNaN(e=+e)?0:(e>0?o:n)(e)}},{}],89:[function(e,t,r)</Result>
</report_mosca>

<report_mosca>
 <Path>/src/settings.js</Path>
 <Module>/app/Mosca/eggs/javascript_common_fail.egg</Module>
 <Title> Possible SQL injection</Title>
 <Description> notification possible SQL injection</Description>
 <Level> High</Level>
 <Reference> https://www.owasp.org/index.php/Testing_for_Stack_Overflow </Reference>
 <Match> query|YQL|WHERE|FROM|SELECT|UPDATE|DELETE|INSERT|UNION|getResults</Match>
 <Result> Line: 159 -      //    methods: "GET,PUT,POST,DELETE"

</Result>
</report_mosca>

<report_mosca>
 <Path>/src/nodes/core/logic/17-split.js</Path>
 <Module>/app/Mosca/eggs/javascript_common_fail.egg</Module>
 <Title> Possible code injection</Title>
 <Description> Command injection is an attack in which the goal is execution of arbitrary commands on the host operating system via a vulnerable application.</Description>
 <Level> High</Level>
 <Reference> https://www.securecoding.cert.org/confluence/pages/viewpage.action?pageId=2130132 </Reference>
 <Match> eval\s?\(|setTimeout|setInterval</Match>
 <Result> Line: 590 -                          inflight[partId].timeout = setTimeout(function() {

</Result>
</report_mosca>

<report_mosca>
 <Path>/src/nodes/core/logic/19-batch.js</Path>
 <Module>/app/Mosca/eggs/javascript_common_fail.egg</Module>
 <Title> Possible code injection</Title>
 <Description> Command injection is an attack in which the goal is execution of arbitrary commands on the host operating system via a vulnerable application.</Description>
 <Level> High</Level>
 <Reference> https://www.securecoding.cert.org/confluence/pages/viewpage.action?pageId=2130132 </Reference>
 <Match> eval\s?\(|setTimeout|setInterval</Match>
 <Result> Line: 206 -              var timer = setInterval(function() {

</Result>
</report_mosca>

<report_mosca>
 <Path>/src/nodes/core/storage/50-file.js</Path>
 <Module>/app/Mosca/eggs/javascript_common_fail.egg</Module>
 <Title> Possible code injection</Title>
 <Description> Command injection is an attack in which the goal is execution of arbitrary commands on the host operating system via a vulnerable application.</Description>
 <Level> High</Level>
 <Reference> https://www.securecoding.cert.org/confluence/pages/viewpage.action?pageId=2130132 </Reference>
 <Match> eval\s?\(|setTimeout|setInterval</Match>
 <Result> Line: 35 -                  node.tout = setTimeout(function() {

</Result>
</report_mosca>

<report_mosca>
 <Path>/src/nodes/core/io/31-tcpin.js</Path>
 <Module>/app/Mosca/eggs/javascript_common_fail.egg</Module>
 <Title> Possible code injection</Title>
 <Description> Command injection is an attack in which the goal is execution of arbitrary commands on the host operating system via a vulnerable application.</Description>
 <Level> High</Level>
 <Reference> https://www.securecoding.cert.org/confluence/pages/viewpage.action?pageId=2130132 </Reference>
 <Match> eval\s?\(|setTimeout|setInterval</Match>
 <Result> Line: 103 -                              reconnectTimeout = setTimeout(setupTcpClient, 20);

 Line: 107 -                              reconnectTimeout = setTimeout(setupTcpClient, reconnectTime);

 Line: 130 -                  if (socketTimeout !== null) { socket.setTimeout(socketTimeout); }

 Line: 257 -                              reconnectTimeout = setTimeout(setupTcpClient,20);

 Line: 261 -                              reconnectTimeout = setTimeout(setupTcpClient,reconnectTime);

 Line: 327 -                  if (socketTimeout !== null) { socket.setTimeout(socketTimeout); }

 Line: 445 -                  if (socketTimeout !== null) { clients[connection_id].client.setTimeout(socketTimeout);}

 Line: 489 -                                          clients[connection_id].timeout = setTimeout(function () {

</Result>
</report_mosca>

<report_mosca>
 <Path>/src/nodes/core/io/22-websocket.js</Path>
 <Module>/app/Mosca/eggs/javascript_common_fail.egg</Module>
 <Title> Possible code injection</Title>
 <Description> Command injection is an attack in which the goal is execution of arbitrary commands on the host operating system via a vulnerable application.</Description>
 <Level> High</Level>
 <Reference> https://www.securecoding.cert.org/confluence/pages/viewpage.action?pageId=2130132 </Reference>
 <Match> eval\s?\(|setTimeout|setInterval</Match>
 <Result> Line: 64 -                      node.tout = setTimeout(function() { startconn(); }, 3000); // try to reconnect every 3 secs... bit fast ?

 Line: 74 -                      node.tout = setTimeout(function() { startconn(); }, 3000); // try to reconnect every 3 secs... bit fast ?

</Result>
</report_mosca>

<report_mosca>
 <Path>/src/nodes/core/io/21-httprequest.js</Path>
 <Module>/app/Mosca/eggs/javascript_common_fail.egg</Module>
 <Title> Possible code injection</Title>
 <Description> Command injection is an attack in which the goal is execution of arbitrary commands on the host operating system via a vulnerable application.</Description>
 <Level> High</Level>
 <Reference> https://www.securecoding.cert.org/confluence/pages/viewpage.action?pageId=2130132 </Reference>
 <Match> eval\s?\(|setTimeout|setInterval</Match>
 <Result> Line: 273 -              req.setTimeout(node.reqTimeout, function() {

 Line: 275 -                  setTimeout(function() {

</Result>
</report_mosca>

<report_mosca>
 <Path>/src/nodes/core/io/21-httprequest.js</Path>
 <Module>/app/Mosca/eggs/javascript_common_fail.egg</Module>
 <Title> Possible SQL injection</Title>
 <Description> notification possible SQL injection</Description>
 <Level> High</Level>
 <Reference> https://www.owasp.org/index.php/Testing_for_Stack_Overflow </Reference>
 <Match> query|YQL|WHERE|FROM|SELECT|UPDATE|DELETE|INSERT|UNION|getResults</Match>
 <Result> Line: 22 -      var querystring = require("querystring");

 Line: 147 -                          payload = querystring.stringify(msg.payload);

</Result>
</report_mosca>

<report_mosca>
 <Path>/src/nodes/core/io/lib/mqttConnectionPool.js</Path>
 <Module>/app/Mosca/eggs/javascript_common_fail.egg</Module>
 <Title> Possible code injection</Title>
 <Description> Command injection is an attack in which the goal is execution of arbitrary commands on the host operating system via a vulnerable application.</Description>
 <Level> High</Level>
 <Reference> https://www.securecoding.cert.org/confluence/pages/viewpage.action?pageId=2130132 </Reference>
 <Match> eval\s?\(|setTimeout|setInterval</Match>
 <Result> Line: 143 -                          setTimeout(function() {

</Result>
</report_mosca>

<report_mosca>
 <Path>/src/nodes/core/io/lib/mqtt.js</Path>
 <Module>/app/Mosca/eggs/javascript_common_fail.egg</Module>
 <Title> Possible code injection</Title>
 <Description> Command injection is an attack in which the goal is execution of arbitrary commands on the host operating system via a vulnerable application.</Description>
 <Level> High</Level>
 <Reference> https://www.securecoding.cert.org/confluence/pages/viewpage.action?pageId=2130132 </Reference>
 <Match> eval\s?\(|setTimeout|setInterval</Match>
 <Result> Line: 90 -                        self.watchdog = setInterval(function(self) {

</Result>
</report_mosca>

<report_mosca>
 <Path>/src/nodes/core/core/80-function.js</Path>
 <Module>/app/Mosca/eggs/javascript_common_fail.egg</Module>
 <Title> Possible code injection</Title>
 <Description> Command injection is an attack in which the goal is execution of arbitrary commands on the host operating system via a vulnerable application.</Description>
 <Level> High</Level>
 <Reference> https://www.securecoding.cert.org/confluence/pages/viewpage.action?pageId=2130132 </Reference>
 <Match> eval\s?\(|setTimeout|setInterval</Match>
 <Result> Line: 153 -              setTimeout: function () {

 Line: 164 -                  timerId = setTimeout.apply(this,arguments);

 Line: 175 -              setInterval: function() {

 Line: 185 -                  timerId = setInterval.apply(this,arguments);

 Line: 198 -              sandbox.setTimeout[util.promisify.custom] = function(after, value) {

 Line: 200 -                      sandbox.setTimeout(function(){ resolve(value) }, after);

</Result>
</report_mosca>

<report_mosca>
 <Path>/src/nodes/core/core/75-exec.js</Path>
 <Module>/app/Mosca/eggs/javascript_common_fail.egg</Module>
 <Title> Possible code injection</Title>
 <Description> Command injection is an attack in which the goal is execution of arbitrary commands on the host operating system via a vulnerable application.</Description>
 <Level> High</Level>
 <Reference> https://www.securecoding.cert.org/confluence/pages/viewpage.action?pageId=2130132 </Reference>
 <Match> eval\s?\(|setTimeout|setInterval</Match>
 <Result> Line: 79 -                          child.tout = setTimeout(function() { cleanup(child.pid); }, node.timer);

 Line: 161 -                          child.tout = setTimeout(function() { cleanup(child.pid); }, node.timer);

</Result>
</report_mosca>

<report_mosca>
 <Path>/src/nodes/core/core/89-delay.js</Path>
 <Module>/app/Mosca/eggs/javascript_common_fail.egg</Module>
 <Title> Possible code injection</Title>
 <Description> Command injection is an attack in which the goal is execution of arbitrary commands on the host operating system via a vulnerable application.</Description>
 <Level> High</Level>
 <Reference> https://www.securecoding.cert.org/confluence/pages/viewpage.action?pageId=2130132 </Reference>
 <Match> eval\s?\(|setTimeout|setInterval</Match>
 <Result> Line: 92 -                  var id = setTimeout(function() {

 Line: 112 -                  var id = setTimeout(function() {

 Line: 128 -                      node.busy = setTimeout(function() {

 Line: 148 -                          node.intervalID = setInterval(function() {

 Line: 189 -              node.intervalID = setInterval(function() {

 Line: 228 -                  var id = setTimeout(function() {

</Result>
</report_mosca>

<report_mosca>
 <Path>/src/nodes/core/core/lib/debug/debug-utils.js</Path>
 <Module>/app/Mosca/eggs/javascript_common_fail.egg</Module>
 <Title> Possible code injection</Title>
 <Description> Command injection is an attack in which the goal is execution of arbitrary commands on the host operating system via a vulnerable application.</Description>
 <Level> High</Level>
 <Reference> https://www.securecoding.cert.org/confluence/pages/viewpage.action?pageId=2130132 </Reference>
 <Match> eval\s?\(|setTimeout|setInterval</Match>
 <Result> Line: 192 -                  hideFilterTimeout = setTimeout(function() {

 Line: 389 -              setTimeout(function() {

</Result>
</report_mosca>

<report_mosca>
 <Path>/src/nodes/core/core/20-inject.js</Path>
 <Module>/app/Mosca/eggs/javascript_common_fail.egg</Module>
 <Title> Possible code injection</Title>
 <Description> Command injection is an attack in which the goal is execution of arbitrary commands on the host operating system via a vulnerable application.</Description>
 <Level> High</Level>
 <Reference> https://www.securecoding.cert.org/confluence/pages/viewpage.action?pageId=2130132 </Reference>
 <Match> eval\s?\(|setTimeout|setInterval</Match>
 <Result> Line: 44 -              this.interval_id = setInterval(function() {

 Line: 56 -              this.onceTimeout = setTimeout( function() {

</Result>
</report_mosca>

<report_mosca>
 <Path>/src/nodes/core/core/89-trigger.js</Path>
 <Module>/app/Mosca/eggs/javascript_common_fail.egg</Module>
 <Title> Possible code injection</Title>
 <Description> Command injection is an attack in which the goal is execution of arbitrary commands on the host operating system via a vulnerable application.</Description>
 <Level> High</Level>
 <Reference> https://www.securecoding.cert.org/confluence/pages/viewpage.action?pageId=2130132 </Reference>
 <Match> eval\s?\(|setTimeout|setInterval</Match>
 <Result> Line: 109 -                              node.topics[topic].tout = setInterval(function() { node.send(RED.util.cloneMessage(msg2)); }, node.duration);

 Line: 114 -                              node.topics[topic].tout = setTimeout(function() {

 Line: 138 -                      node.topics[topic].tout = setTimeout(function() {

</Result>
</report_mosca>

