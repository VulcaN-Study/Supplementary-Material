/src/README.md-1758-| 0.1.11  | <ul><li>Bug Fixes<ul><li>Fixed Vertical Middle Alignment Issue</li></ul></li><li><a href="#styles">Row and Column Styles</a></li><li><a href="#rows">Worksheet.eachRow supports options</a></li><li><a href="#rows">Row.eachCell supports options</a></li><li><a href="#columns">New function Column.eachCell</a></li></ul> |
/src/README.md:1759:| 0.2.0   | <ul><li><a href="#streaming-xlxs-writer">Streaming XLSX Writer</a><ul><li>At long last ExcelJS can support writing massive XLSX files in a scalable memory efficient manner. Performance has been optimised and even smaller spreadsheets can be faster to write than the document writer. Options have been added to control the use of shared strings and styles as these can both have a considerable effect on performance</li></ul></li><li><a href="#rows">Worksheet.lastRow</a><ul><li>Access the last editable row in a worksheet.</li></ul></li><li><a href="#rows">Row.commit()</a><ul><li>For streaming writers, this method commits the row (and any previous rows) to the stream. Committed rows will no longer be editable (and are typically deleted from the worksheet object). For Document type workbooks, this method has no effect.</li></ul></li></ul> |
/src/README.md-1760-| 0.2.2   | <ul><li><a href="https://pbs.twimg.com/profile_images/2933552754/fc8c70829ee964c5542ae16453503d37.jpeg">One Billion Cells</a><ul><li>Achievement Unlocked: A simple test using ExcelJS has created a spreadsheet with 1,000,000,000 cells. Made using random data with 100,000,000 rows of 10 cells per row. I cannot validate the file yet as Excel will not open it and I have yet to implement the streaming reader but I have every confidence that it is good since 1,000,000 rows loads ok.</li></ul></li></ul> |
/src/README.md:1761:| 0.2.3   | <ul><li>Bug Fixes<ul><li><a href="https://github.com/guyonroche/exceljs/issues/18">Merge Cell Styles</a><ul><li>Merged cells now persist (and parse) their styles.</li></ul></li></ul></li><li><a href="#streaming-xlxs-writer">Streaming XLSX Writer</a><ul><li>At long last ExcelJS can support writing massive XLSX files in a scalable memory efficient manner. Performance has been optimised and even smaller spreadsheets can be faster to write than the document writer. Options have been added to control the use of shared strings and styles as these can both have a considerable effect on performance</li></ul></li><li><a href="#rows">Worksheet.lastRow</a><ul><li>Access the last editable row in a worksheet.</li></ul></li><li><a href="#rows">Row.commit()</a><ul><li>For streaming writers, this method commits the row (and any previous rows) to the stream. Committed rows will no longer be editable (and are typically deleted from the worksheet object). For Document type workbooks, this method has no effect.</li></ul></li></ul> |
/src/README.md-1762-| 0.2.4   | <ul><li>Bug Fixes<ul><li><a href="https://github.com/guyonroche/exceljs/issues/27">Worksheets with Ampersand Names</a><ul><li>Worksheet names are now xml-encoded and should work with all xml compatable characters</li></ul></li></ul></li><li><a href="#rows">Row.hidden</a> & <a href="#columns">Column.hidden</a><ul><li>Rows and Columns now support the hidden attribute.</li></ul></li><li><a href="#worksheet">Worksheet.addRows</a><ul><li>New function to add an array of rows (either array or object form) to the end of a worksheet.</li></ul></li></ul> |
##############################################
/src/dist/exceljs.min.js-9-Object.defineProperty(e.prototype,"parent",{get:function(){if(this instanceof e)return this.buffer}}),Object.defineProperty(e.prototype,"offset",{get:function(){if(this instanceof e)return this.byteOffset}}),"undefined"!=typeof Symbol&&Symbol.species&&e[Symbol.species]===e&&Object.defineProperty(e,Symbol.species,{value:null,configurable:!0,enumerable:!1,writable:!1}),e.poolSize=8192,e.from=function(a,b,c){return f(a,b,c)},e.prototype.__proto__=Uint8Array.prototype,e.__proto__=Uint8Array,e.alloc=function(a,b,c){return h(a,b,c)},e.allocUnsafe=function(a){return i(a)},e.allocUnsafeSlow=function(a){return i(a)},e.isBuffer=function(a){return null!=a&&!0===a._isBuffer},e.compare=function(a,b){if(!e.isBuffer(a)||!e.isBuffer(b))throw new TypeError("Arguments must be Buffers");if(a===b)return 0;for(var c=a.length,d=b.length,f=0,g=Math.min(c,d);f<g;++f)if(a[f]!==b[f]){c=a[f],d=b[f];break}return c<d?-1:d<c?1:0},e.isEncoding=function(a){switch(String(a).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},e.concat=function(a,b){if(!Array.isArray(a))throw new TypeError('"list" argument must be an Array of Buffers');if(0===a.length)return e.alloc(0);var c;if(void 0===b)for(b=0,c=0;c<a.length;++c)b+=a[c].length;var d=e.allocUnsafe(b),f=0;for(c=0;c<a.length;++c){var g=a[c];if(ArrayBuffer.isView(g)&&(g=e.from(g)),!e.isBuffer(g))throw new TypeError('"list" argument must be an Array of Buffers');g.copy(d,f),f+=g.length}return d},e.byteLength=p,e.prototype._isBuffer=!0,e.prototype.swap16=function(){var a=this.length;if(a%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var b=0;b<a;b+=2)r(this,b,b+1);return this},e.prototype.swap32=function(){var a=this.length;if(a%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var b=0;b<a;b+=4)r(this,b,b+3),r(this,b+1,b+2);return this},e.prototype.swap64=function(){var a=this.length;if(a%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var b=0;b<a;b+=8)r(this,b,b+7),r(this,b+1,b+6),r(this,b+2,b+5),r(this,b+3,b+4);return this},e.prototype.toString=function(){var a=this.length;return 0===a?"":0===arguments.length?B(this,0,a):q.apply(this,arguments)},e.prototype.toLocaleString=e.prototype.toString,e.prototype.equals=function(a){if(!e.isBuffer(a))throw new TypeError("Argument must be a Buffer");return this===a||0===e.compare(this,a)},e.prototype.inspect=function(){var a="",b=c.INSPECT_MAX_BYTES;return this.length>0&&(a=this.toString("hex",0,b).match(/.{2}/g).join(" "),this.length>b&&(a+=" ... ")),"<Buffer "+a+">"},e.prototype.compare=function(a,b,c,d,f){if(!e.isBuffer(a))throw new TypeError("Argument must be a Buffer");if(void 0===b&&(b=0),void 0===c&&(c=a?a.length:0),void 0===d&&(d=0),void 0===f&&(f=this.length),b<0||c>a.length||d<0||f>this.length)throw new RangeError("out of range index");if(d>=f&&b>=c)return 0;if(d>=f)return-1;if(b>=c)return 1;if(b>>>=0,c>>>=0,d>>>=0,f>>>=0,this===a)return 0;for(var g=f-d,h=c-b,i=Math.min(g,h),j=this.slice(d,f),k=a.slice(b,c),l=0;l<i;++l)if(j[l]!==k[l]){g=j[l],h=k[l];break}return g<h?-1:h<g?1:0},e.prototype.includes=function(a,b,c){return-1!==this.indexOf(a,b,c)},e.prototype.indexOf=function(a,b,c){return s(this,a,b,c,!0)},e.prototype.lastIndexOf=function(a,b,c){return s(this,a,b,c,!1)},e.prototype.write=function(a,b,c,d){if(void 0===b)d="utf8",c=this.length,b=0;else if(void 0===c&&"string"==typeof b)d=b,c=this.length,b=0;else{if(!isFinite(b))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");b>>>=0,isFinite(c)?(c>>>=0,void 0===d&&(d="utf8")):(d=c,c=void 0)}var e=this.length-b;if((void 0===c||c>e)&&(c=e),a.length>0&&(c<0||b<0)||b>this.length)throw new RangeError("Attempt to write outside buffer bounds");d||(d="utf8");for(var f=!1;;)switch(d){case"hex":return u(this,a,b,c);case"utf8":case"utf-8":return v(this,a,b,c);case"ascii":return w(this,a,b,c);case"latin1":case"binary":return x(this,a,b,c);case"base64":return y(this,a,b,c);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return z(this,a,b,c);default:if(f)throw new TypeError("Unknown encoding: "+d);d=(""+d).toLowerCase(),f=!0}},e.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var Y=4096;e.prototype.slice=function(a,b){var c=this.length;a=~~a,b=void 0===b?c:~~b,a<0?(a+=c)<0&&(a=0):a>c&&(a=c),b<0?(b+=c)<0&&(b=0):b>c&&(b=c),b<a&&(b=a);var d=this.subarray(a,b);return d.__proto__=e.prototype,d},e.prototype.readUIntLE=function(a,b,c){a>>>=0,b>>>=0,c||H(a,b,this.length);for(var d=this[a],e=1,f=0;++f<b&&(e*=256);)d+=this[a+f]*e;return d},e.prototype.readUIntBE=function(a,b,c){a>>>=0,b>>>=0,c||H(a,b,this.length);for(var d=this[a+--b],e=1;b>0&&(e*=256);)d+=this[a+--b]*e;return d},e.prototype.readUInt8=function(a,b){return a>>>=0,b||H(a,1,this.length),this[a]},e.prototype.readUInt16LE=function(a,b){return a>>>=0,b||H(a,2,this.length),this[a]|this[a+1]<<8},e.prototype.readUInt16BE=function(a,b){return a>>>=0,b||H(a,2,this.length),this[a]<<8|this[a+1]},e.prototype.readUInt32LE=function(a,b){return a>>>=0,b||H(a,4,this.length),(this[a]|this[a+1]<<8|this[a+2]<<16)+16777216*this[a+3]},e.prototype.readUInt32BE=function(a,b){return a>>>=0,b||H(a,4,this.length),16777216*this[a]+(this[a+1]<<16|this[a+2]<<8|this[a+3])},e.prototype.readIntLE=function(a,b,c){a>>>=0,b>>>=0,c||H(a,b,this.length);for(var d=this[a],e=1,f=0;++f<b&&(e*=256);)d+=this[a+f]*e;return e*=128,d>=e&&(d-=Math.pow(2,8*b)),d},e.prototype.readIntBE=function(a,b,c){a>>>=0,b>>>=0,c||H(a,b,this.length);for(var d=b,e=1,f=this[a+--d];d>0&&(e*=256);)f+=this[a+--d]*e;return e*=128,f>=e&&(f-=Math.pow(2,8*b)),f},e.prototype.readInt8=function(a,b){return a>>>=0,b||H(a,1,this.length),128&this[a]?-1*(255-this[a]+1):this[a]},e.prototype.readInt16LE=function(a,b){a>>>=0,b||H(a,2,this.length);var c=this[a]|this[a+1]<<8;return 32768&c?4294901760|c:c},e.prototype.readInt16BE=function(a,b){a>>>=0,b||H(a,2,this.length);var c=this[a+1]|this[a]<<8;return 32768&c?4294901760|c:c},e.prototype.readInt32LE=function(a,b){return a>>>=0,b||H(a,4,this.length),this[a]|this[a+1]<<8|this[a+2]<<16|this[a+3]<<24},e.prototype.readInt32BE=function(a,b){return a>>>=0,b||H(a,4,this.length),this[a]<<24|this[a+1]<<16|this[a+2]<<8|this[a+3]},e.prototype.readFloatLE=function(a,b){return a>>>=0,b||H(a,4,this.length),W.read(this,a,!0,23,4)},e.prototype.readFloatBE=function(a,b){return a>>>=0,b||H(a,4,this.length),W.read(this,a,!1,23,4)},e.prototype.readDoubleLE=function(a,b){return a>>>=0,b||H(a,8,this.length),W.read(this,a,!0,52,8)},e.prototype.readDoubleBE=function(a,b){return a>>>=0,b||H(a,8,this.length),W.read(this,a,!1,52,8)},e.prototype.writeUIntLE=function(a,b,c,d){if(a=+a,b>>>=0,c>>>=0,!d){I(this,a,b,c,Math.pow(2,8*c)-1,0)}var e=1,f=0;for(this[b]=255&a;++f<c&&(e*=256);)this[b+f]=a/e&255;return b+c},e.prototype.writeUIntBE=function(a,b,c,d){if(a=+a,b>>>=0,c>>>=0,!d){I(this,a,b,c,Math.pow(2,8*c)-1,0)}var e=c-1,f=1;for(this[b+e]=255&a;--e>=0&&(f*=256);)this[b+e]=a/f&255;return b+c},e.prototype.writeUInt8=function(a,b,c){return a=+a,b>>>=0,c||I(this,a,b,1,255,0),this[b]=255&a,b+1},e.prototype.writeUInt16LE=function(a,b,c){return a=+a,b>>>=0,c||I(this,a,b,2,65535,0),this[b]=255&a,this[b+1]=a>>>8,b+2},e.prototype.writeUInt16BE=function(a,b,c){return a=+a,b>>>=0,c||I(this,a,b,2,65535,0),this[b]=a>>>8,this[b+1]=255&a,b+2},e.prototype.writeUInt32LE=function(a,b,c){return a=+a,b>>>=0,c||I(this,a,b,4,4294967295,0),this[b+3]=a>>>24,this[b+2]=a>>>16,this[b+1]=a>>>8,this[b]=255&a,b+4},e.prototype.writeUInt32BE=function(a,b,c){return a=+a,b>>>=0,c||I(this,a,b,4,4294967295,0),this[b]=a>>>24,this[b+1]=a>>>16,this[b+2]=a>>>8,this[b+3]=255&a,b+4},e.prototype.writeIntLE=function(a,b,c,d){if(a=+a,b>>>=0,!d){var e=Math.pow(2,8*c-1);I(this,a,b,c,e-1,-e)}var f=0,g=1,h=0;for(this[b]=255&a;++f<c&&(g*=256);)a<0&&0===h&&0!==this[b+f-1]&&(h=1),this[b+f]=(a/g>>0)-h&255;return b+c},e.prototype.writeIntBE=function(a,b,c,d){if(a=+a,b>>>=0,!d){var e=Math.pow(2,8*c-1);I(this,a,b,c,e-1,-e)}var f=c-1,g=1,h=0;for(this[b+f]=255&a;--f>=0&&(g*=256);)a<0&&0===h&&0!==this[b+f+1]&&(h=1),this[b+f]=(a/g>>0)-h&255;return b+c},e.prototype.writeInt8=function(a,b,c){return a=+a,b>>>=0,c||I(this,a,b,1,127,-128),a<0&&(a=255+a+1),this[b]=255&a,b+1},e.prototype.writeInt16LE=function(a,b,c){return a=+a,b>>>=0,c||I(this,a,b,2,32767,-32768),this[b]=255&a,this[b+1]=a>>>8,b+2},e.prototype.writeInt16BE=function(a,b,c){return a=+a,b>>>=0,c||I(this,a,b,2,32767,-32768),this[b]=a>>>8,this[b+1]=255&a,b+2},e.prototype.writeInt32LE=function(a,b,c){return a=+a,b>>>=0,c||I(this,a,b,4,2147483647,-2147483648),this[b]=255&a,this[b+1]=a>>>8,this[b+2]=a>>>16,this[b+3]=a>>>24,b+4},e.prototype.writeInt32BE=function(a,b,c){return a=+a,b>>>=0,c||I(this,a,b,4,2147483647,-2147483648),a<0&&(a=4294967295+a+1),this[b]=a>>>24,this[b+1]=a>>>16,this[b+2]=a>>>8,this[b+3]=255&a,b+4},e.prototype.writeFloatLE=function(a,b,c){return K(this,a,b,!0,c)},e.prototype.writeFloatBE=function(a,b,c){return K(this,a,b,!1,c)},e.prototype.writeDoubleLE=function(a,b,c){return L(this,a,b,!0,c)},e.prototype.writeDoubleBE=function(a,b,c){return L(this,a,b,!1,c)},e.prototype.copy=function(a,b,c,d){if(!e.isBuffer(a))throw new TypeError("argument should be a Buffer");if(c||(c=0),d||0===d||(d=this.length),b>=a.length&&(b=a.length),b||(b=0),d>0&&d<c&&(d=c),d===c)return 0;if(0===a.length||0===this.length)return 0;if(b<0)throw new RangeError("targetStart out of bounds");if(c<0||c>=this.length)throw new RangeError("Index out of range");if(d<0)throw new RangeError("sourceEnd out of bounds");d>this.length&&(d=this.length),a.length-b<d-c&&(d=a.length-b+c);var f=d-c;if(this===a&&"function"==typeof Uint8Array.prototype.copyWithin)this.copyWithin(b,c,d);else if(this===a&&c<b&&b<d)for(var g=f-1;g>=0;--g)a[g+b]=this[g+c];else Uint8Array.prototype.set.call(a,this.subarray(c,d),b);return f},e.prototype.fill=function(a,b,c,d){if("string"==typeof a){if("string"==typeof b?(d=b,b=0,c=this.length):"string"==typeof c&&(d=c,c=this.length),void 0!==d&&"string"!=typeof d)throw new TypeError("encoding must be a string");if("string"==typeof d&&!e.isEncoding(d))throw new TypeError("Unknown encoding: "+d);if(1===a.length){var f=a.charCodeAt(0);("utf8"===d&&f<128||"latin1"===d)&&(a=f)}}else"number"==typeof a&&(a&=255);if(b<0||this.length<b||this.length<c)throw new RangeError("Out of range index");if(c<=b)return this;b>>>=0,c=void 0===c?this.length:c>>>0,a||(a=0);var g;if("number"==typeof a)for(g=b;g<c;++g)this[g]=a;else{var h=e.isBuffer(a)?a:new e(a,d),i=h.length;if(0===i)throw new TypeError('The value "'+a+'" is invalid for argument "value"');for(g=0;g<c-b;++g)this[g+b]=h[g%i]}return this};var Z=/[^+\/0-9A-Za-z-_]/g},{"base64-js":92,ieee754:135}],95:[function(a,b,c){a("../modules/web.immediate"),b.exports=a("../modules/_core").setImmediate},{"../modules/_core":99,"../modules/web.immediate":115}],96:[function(a,b,c){b.exports=function(a){if("function"!=typeof a)throw TypeError(a+" is not a function!");return a}},{}],97:[function(a,b,c){var d=a("./_is-object");b.exports=function(a){if(!d(a))throw TypeError(a+" is not an object!");return a}},{"./_is-object":110}],98:[function(a,b,c){var d={}.toString;b.exports=function(a){return d.call(a).slice(8,-1)}},{}],99:[function(a,b,c){var d=b.exports={version:"2.3.0"};"number"==typeof __e&&(__e=d)},{}],100:[function(a,b,c){var d=a("./_a-function");b.exports=function(a,b,c){if(d(a),void 0===b)return a;switch(c){case 1:return function(c){return a.call(b,c)};case 2:return function(c,d){return a.call(b,c,d)};case 3:return function(c,d,e){return a.call(b,c,d,e)}}return function(){return a.apply(b,arguments)}}},{"./_a-function":96}],101:[function(a,b,c){b.exports=!a("./_fails")(function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a})},{"./_fails":104}],102:[function(a,b,c){var d=a("./_is-object"),e=a("./_global").document,f=d(e)&&d(e.createElement);b.exports=function(a){return f?e.createElement(a):{}}},{"./_global":105,"./_is-object":110}],103:[function(a,b,c){var d=a("./_global"),e=a("./_core"),f=a("./_ctx"),g=a("./_hide"),h=function(a,b,c){var i,j,k,l=a&h.F,m=a&h.G,n=a&h.S,o=a&h.P,p=a&h.B,q=a&h.W,r=m?e:e[b]||(e[b]={}),s=r.prototype,t=m?d:n?d[b]:(d[b]||{}).prototype;m&&(c=b);for(i in c)(j=!l&&t&&void 0!==t[i])&&i in r||(k=j?t[i]:c[i],r[i]=m&&"function"!=typeof t[i]?c[i]:p&&j?f(k,d):q&&t[i]==k?function(a){var b=function(b,c,d){if(this instanceof a){switch(arguments.length){case 0:return new a;case 1:return new a(b);case 2:return new a(b,c)}return new a(b,c,d)}return a.apply(this,arguments)};return b.prototype=a.prototype,b}(k):o&&"function"==typeof k?f(Function.call,k):k,o&&((r.virtual||(r.virtual={}))[i]=k,a&h.R&&s&&!s[i]&&g(s,i,k)))};h.F=1,h.G=2,h.S=4,h.P=8,h.B=16,h.W=32,h.U=64,h.R=128,b.exports=h},{"./_core":99,"./_ctx":100,"./_global":105,"./_hide":106}],104:[function(a,b,c){b.exports=function(a){try{return!!a()}catch(a){return!0}}},{}],105:[function(a,b,c){var d=b.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=d)},{}],106:[function(a,b,c){var d=a("./_object-dp"),e=a("./_property-desc");b.exports=a("./_descriptors")?function(a,b,c){return d.f(a,b,e(1,c))}:function(a,b,c){return a[b]=c,a}},{"./_descriptors":101,"./_object-dp":111,"./_property-desc":112}],107:[function(a,b,c){b.exports=a("./_global").document&&document.documentElement},{"./_global":105}],108:[function(a,b,c){b.exports=!a("./_descriptors")&&!a("./_fails")(function(){return 7!=Object.defineProperty(a("./_dom-create")("div"),"a",{get:function(){return 7}}).a})},{"./_descriptors":101,"./_dom-create":102,"./_fails":104}],109:[function(a,b,c){b.exports=function(a,b,c){var d=void 0===c;switch(b.length){case 0:return d?a():a.call(c);case 1:return d?a(b[0]):a.call(c,b[0]);case 2:return d?a(b[0],b[1]):a.call(c,b[0],b[1]);case 3:return d?a(b[0],b[1],b[2]):a.call(c,b[0],b[1],b[2]);case 4:return d?a(b[0],b[1],b[2],b[3]):a.call(c,b[0],b[1],b[2],b[3])}return a.apply(c,b)}},{}],110:[function(a,b,c){b.exports=function(a){return"object"==typeof a?null!==a:"function"==typeof a}},{}],111:[function(a,b,c){var d=a("./_an-object"),e=a("./_ie8-dom-define"),f=a("./_to-primitive"),g=Object.defineProperty;c.f=a("./_descriptors")?Object.defineProperty:function(a,b,c){if(d(a),b=f(b,!0),d(c),e)try{return g(a,b,c)}catch(a){}if("get"in c||"set"in c)throw TypeError("Accessors not supported!");return"value"in c&&(a[b]=c.value),a}},{"./_an-object":97,"./_descriptors":101,"./_ie8-dom-define":108,"./_to-primitive":114}],112:[function(a,b,c){b.exports=function(a,b){return{enumerable:!(1&a),configurable:!(2&a),writable:!(4&a),value:b}}},{}],113:[function(a,b,c){var d,e,f,g=a("./_ctx"),h=a("./_invoke"),i=a("./_html"),j=a("./_dom-create"),k=a("./_global"),l=k.process,m=k.setImmediate,n=k.clearImmediate,o=k.MessageChannel,p=0,q={},r=function(){var a=+this;if(q.hasOwnProperty(a)){var b=q[a];delete q[a],b()}},s=function(a){r.call(a.data)};m&&n||(m=function(a){for(var b=[],c=1;arguments.length>c;)b.push(arguments[c++]);return q[++p]=function(){h("function"==typeof a?a:Function(a),b)},d(p),p},n=function(a){delete q[a]},"process"==a("./_cof")(l)?d=function(a){l.nextTick(g(r,a,1))}:o?(e=new o,f=e.port2,e.port1.onmessage=s,d=g(f.postMessage,f,1)):k.addEventListener&&"function"==typeof postMessage&&!k.importScripts?(d=function(a){k.postMessage(a+"","*")},k.addEventListener("message",s,!1)):d="onreadystatechange"in j("script")?function(a){i.appendChild(j("script")).onreadystatechange=function(){i.removeChild(this),r.call(a)}}:function(a){setTimeout(g(r,a,1),0)}),b.exports={set:m,clear:n}},{"./_cof":98,"./_ctx":100,"./_dom-create":102,"./_global":105,"./_html":107,"./_invoke":109}],114:[function(a,b,c){var d=a("./_is-object");b.exports=function(a,b){if(!d(a))return a;var c,e;if(b&&"function"==typeof(c=a.toString)&&!d(e=c.call(a)))return e;if("function"==typeof(c=a.valueOf)&&!d(e=c.call(a)))return e;if(!b&&"function"==typeof(c=a.toString)&&!d(e=c.call(a)))return e;throw TypeError("Can't convert object to primitive value")}},{"./_is-object":110}],115:[function(a,b,c){var d=a("./_export"),e=a("./_task");d(d.G+d.B,{setImmediate:e.set,clearImmediate:e.clear})},{"./_export":103,"./_task":113}],116:[function(a,b,c){(function(a){function b(a){return Array.isArray?Array.isArray(a):"[object Array]"===q(a)}function d(a){return"boolean"==typeof a}function e(a){return null===a}function f(a){return null==a}function g(a){return"number"==typeof a}function h(a){return"string"==typeof a}function i(a){return"symbol"==typeof a}function j(a){return void 0===a}function k(a){return"[object RegExp]"===q(a)}function l(a){return"object"==typeof a&&null!==a}function m(a){return"[object Date]"===q(a)}function n(a){return"[object Error]"===q(a)||a instanceof Error}function o(a){return"function"==typeof a}function p(a){return null===a||"boolean"==typeof a||"number"==typeof a||"string"==typeof a||"symbol"==typeof a||void 0===a}function q(a){return Object.prototype.toString.call(a)}c.isArray=b,c.isBoolean=d,c.isNull=e,c.isNullOrUndefined=f,c.isNumber=g,c.isString=h,c.isSymbol=i,c.isUndefined=j,c.isRegExp=k,c.isObject=l,c.isDate=m,c.isError=n,c.isFunction=o,c.isPrimitive=p,c.isBuffer=a.isBuffer}).call(this,{isBuffer:a("../../is-buffer/index.js")})},{"../../is-buffer/index.js":138}],117:[function(b,c,d){(function(){"use strict";function e(a,b,c){function d(a,b,c,d){a=""+a,c=c||" ";for(var e=a.length;e<b;)d?a+=c:a=c+a,e++;return a}function e(a,c,d){var f=a;if(b.isString(f)){if(a.length>c)if(d){var g=a.length;f=a.substring(g-c,g)}else f=a.substring(0,c)}else f=e(""+f,c);return f}function f(a,c,d){if(!b.isArray(a)||"function"!=typeof c)throw new TypeError;for(var e=Object(a),f=e.length>>>0,g=0;g<f;g++)if(g in e&&!c.call(d,e[g],g,e))return!1;return!0}function g(a,b){return z.difference(new Date(a.getFullYear(),0,1,a.getHours()),a,null,b)+1}function h(a,b,c){b=b||0;var d=a[c?"getUTCFullYear":"getFullYear"](),e=new Date(d,0,1).getDay(),f=(e-b+7)%7,h=n((g(a)+f-1)/7);return e===b&&h++,h}function i(a){var b=a.toString(),c="",d=b.indexOf("(");return d>-1&&(c=b.substring(++d,b.indexOf(")"))),c}function j(a,b){return a.replace(/([a-z])\1*/gi,function(a){var c,d=a.charAt(0),e=a.length;if("y"===d)c="\\d{2,4}";else if("M"===d)c=e>2?"\\S+?":"1[0-2]|0?[1-9]";else if("D"===d)c="[12][0-9][0-9]|3[0-5][0-9]|36[0-6]|0{0,2}[1-9][0-9]|0?[1-9]";else if("d"===d)c="3[01]|[12]\\d|0?[1-9]";else if("w"===d)c="[1-4][0-9]|5[0-3]|0?[1-9]";else if("E"===d)c="\\S+";else if("h"===d)c="1[0-2]|0?[1-9]";else if("K"===d)c="1[01]|0?\\d";else if("H"===d)c="1\\d|2[0-3]|0?\\d";else if("k"===d)c="1\\d|2[0-4]|0?[1-9]";else if("m"===d||"s"===d)c="[0-5]\\d";else if("S"===d)c="\\d{"+e+"}";else if("a"===d){var f="AM",g="PM";c=f+"|"+g,f!==f.toLowerCase()&&(c+="|"+f.toLowerCase()),g!==g.toLowerCase()&&(c+="|"+g.toLowerCase()),c=c.replace(/\./g,"\\.")}else c="v"===d||"z"===d||"Z"===d||"G"===d||"q"===d||"Q"===d?".*":" "===d?"\\s*":d+"*";return b&&b.push(a),"("+c+")"}).replace(/[\xa0 ]/g,"[\\s\\xa0]")}for(var k=function(){function a(a,b,c){return a=a.replace(/s$/,""),e.hasOwnProperty(a)?e[a](b,c):[c,"UTC"+a.charAt(0).toUpperCase()+a.substring(1)+"s",!1]}function b(a,b,c,e){return a=a.replace(/s$/,""),d(f[a](b,c,e))}var c=Math.floor,d=Math.round,e={day:function(a,b){return[b,"Date",!1]},weekday:function(a,b){var c,d,e=b%5,f=a.getDay(),g=0;e?(c=e,d=parseInt(b/5,10)):(c=b>0?5:-5,d=b>0?(b-5)/5:(b+5)/5),6===f&&b>0?g=1:0===f&&b<0&&(g=-1);var h=f+c;return 0!==h&&6!==h||(g=b>0?2:-2),[7*d+c+g,"Date",!1]},year:function(a,b){return[b,"FullYear",!0]},week:function(a,b){return[7*b,"Date",!1]},quarter:function(a,b){return[3*b,"Month",!0]},month:function(a,b){return[b,"Month",!0]}},f={quarter:function(a,b,d){var e=b.getFullYear()-a.getFullYear(),f=a[d?"getUTCMonth":"getMonth"](),g=b[d?"getUTCMonth":"getMonth"](),h=c(f/3)+1,i=c(g/3)+1;return(i+=4*e)-h},weekday:function(a,c,d){var e,f=b("day",a,c,d),g=f%7;if(0===g)f=5*b("week",a,c,d);else{var h=0,i=a[d?"getUTCDay":"getDay"](),j=c[d?"getUTCDay":"getDay"]();e=parseInt(f/7,10);var k=new Date(+a);k.setDate(k[d?"getUTCDate":"getDate"]()+7*e);var l=k[d?"getUTCDay":"getDay"]();f>0?6===i||6===j?h=-1:0===i?h=0:(0===j||l+g>5)&&(h=-2):f<0&&(6===i?h=0:0===i||0===j?h=1:(6===j||l+g<0)&&(h=2)),f+=h,f-=2*e}return f},year:function(a,b){return b.getFullYear()-a.getFullYear()},month:function(a,b,c){var d=a[c?"getUTCMonth":"getMonth"]();return b[c?"getUTCMonth":"getMonth"]()-d+12*(b.getFullYear()-a.getFullYear())},week:function(a,c,e){return d(b("day",a,c,e)/7)},day:function(a,b){return 1.1574074074074074e-8*(b.getTime()-a.getTime())},hour:function(a,b){return 2.7777777777777776e-7*(b.getTime()-a.getTime())},minute:function(a,b){return 16666666666666667e-21*(b.getTime()-a.getTime())},second:function(a,b){return.001*(b.getTime()-a.getTime())},millisecond:function(a,b){return b.getTime()-a.getTime()}};return{addTransform:a,differenceTransform:b}}(),l=k.addTransform,m=k.differenceTransform,n=Math.floor,o=Math.round,p=Math.min,q=Math.pow,r=Math.ceil,s=Math.abs,t=["January","February","March","April","May","June","July","August","September","October","November","December"],u=["Jan.","Feb.","Mar.","Apr.","May.","Jun.","Jul.","Aug.","Sep.","Oct.","Nov.","Dec."],v=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],w=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],x=["Before Christ","Anno Domini"],y=["BC","AD"],z={getDaysInMonth:function(a){var b=a.getMonth(),c=[31,28,31,30,31,30,31,31,30,31,30,31];return 1===b&&z.isLeapYear(a)?29:c[b]},isLeapYear:function(a,b){var c=a[b?"getUTCFullYear":"getFullYear"]();return c%400==0||c%4==0&&c%100!=0},isWeekend:function(a,b){var c=(a||new Date)[b?"getUTCDay":"getDay"]();return 0===c||6===c},getTimezoneName:i,compare:function(a,b,c){return a=new Date(+a),b=new Date(+(b||new Date)),"date"===c?(a.setHours(0,0,0,0),b.setHours(0,0,0,0)):"time"===c&&(a.setFullYear(0,0,0),b.setFullYear(0,0,0)),a>b?1:a<b?-1:0},add:function(a,b,c){var d=l(b,a,c||0);c=d[0];var e=d[1],f=new Date(+a),g=d[2];return e&&f["set"+e](f["get"+e]()+c),g&&f.getDate()<a.getDate()&&f.setDate(0),f},difference:function(a,b,c,d){return b=b||new Date,c=c||"day",m(c,a,b,d)},format:function(a,b,c){c=c||!1;var f,j,k,l,m,p,z,A;return c?(f=a.getUTCFullYear(),j=a.getUTCMonth(),k=a.getUTCDay(),l=a.getUTCDate(),m=a.getUTCHours(),p=a.getUTCMinutes(),z=a.getUTCSeconds(),A=a.getUTCMilliseconds()):(f=a.getFullYear(),j=a.getMonth(),l=a.getDate(),k=a.getDay(),m=a.getHours(),p=a.getMinutes(),z=a.getSeconds(),A=a.getMilliseconds()),b.replace(/([A-Za-z])\1*/g,function(b){var B,C,D=b.charAt(0),E=b.length;if("d"===D)B=""+l,C=!0;else if("H"!==D||B)if("m"!==D||B)if("s"===D)B||(B=""+z),C=!0;else if("G"===D)B=(E<4?y:x)[f<0?0:1];else if("y"===D)B=f,E>1&&(2===E?B=e(""+B,2,!0):C=!0);else if("Q"===D.toUpperCase())B=r((j+1)/3),C=!0;else if("M"===D)E<3?(B=j+1,C=!0):B=(3===E?u:t)[j];else if("w"===D)B=h(a,0,c),C=!0;else if("D"===D)B=g(a,c),C=!0;else if("E"===D)E<3?(B=k+1,C=!0):B=(-3===E?w:v)[k];else if("a"===D)B=m<12?"AM":"PM";else if("h"===D)B=m%12||12,C=!0;else if("K"===D)B=m%12,C=!0;else if("k"===D)B=m||24,C=!0;else if("S"===D)B=o(A*q(10,E-3)),C=!0;else if("z"===D||"v"===D||"Z"===D){if(B=i(a),"z"!==D&&"v"!==D||B||(E=4),!B||"Z"===D){var F=a.getTimezoneOffset(),G=[F>=0?"-":"+",d(n(s(F)/60),2,"0"),d(s(F)%60,2,"0")];4===E&&(G.splice(0,0,"GMT"),G.splice(3,0,":")),B=G.join("")}}else B=b;else B=""+p,C=!0;else B=""+m,C=!0;return C&&(B=d(B,E,"0")),B})}},A={},B=["year","month","day","hour","minute","second"],C=0,D=B.length;C<D;C++)!function(a){A[a+"sFromNow"]=function(b){return z.add(new Date,a,b)},A[a+"sAgo"]=function(b){return z.add(new Date,a,-b)}}(B[C]);var E={parseDate:function(a,b){if(!b)throw new Error("format required when calling dateExtender.parse");var d=[],e=j(b,d),g=new RegExp("^"+e+"$","i"),h=g.exec(a);if(!h)return null;var i=[1970,0,1,0,0,0,0],k="";if(f(h,function(a,b){if(b){var e=d[b-1],f=e.length,g=e.charAt(0);if("y"===g)if(a<100){a=parseInt(a,10);var h=""+(new Date).getFullYear(),j=100*h.substring(0,2),l=p(h.substring(2,4)+20,99);i[0]=a<l?j+a:j-100+a}else i[0]=a;else if("M"===g){if(f>2){var m,n,o=t;3===f&&(o=u),a=a.replace(".","").toLowerCase();var q=!1;for(m=0,n=o.length;m<n&&!q;m++){var r=o[m].replace(".","").toLocaleLowerCase();r===a&&(a=m,q=!0)}if(!q)return!1}else a--;i[1]=a}else if("E"===g||"e"===g){var s=v;3===f&&(s=w),a=a.toLowerCase(),s=c.map(s,function(a){return a.toLowerCase()});var x=c.indexOf(s,a);if(-1===x){if(a=parseInt(a,10),isNaN(a)||a>s.length)return!1}else a=x}else if("D"===g||"d"===g)"D"===g&&(i[1]=0),i[2]=a;else if("a"===g){var y=/\./g;a=a.replace(y,"").toLowerCase(),k="pm"===a?"p":"am"===a?"a":""}else"k"===g||"h"===g||"H"===g||"K"===g?("k"===g&&24==+a&&(a=0),i[3]=a):"m"===g?i[4]=a:"s"===g?i[5]=a:"S"===g&&(i[6]=a)}return!0})){var l=+i[3];"p"===k&&l<12?i[3]=l+12:"a"===k&&12===l&&(i[3]=0);var m=new Date(i[0],i[1],i[2],i[3],i[4],i[5],i[6]),n=-1!==c.indexOf(d,"d"),o=-1!==c.indexOf(d,"M"),q=i[1],r=i[2],s=m.getMonth(),x=m.getDate();return o&&s>q||n&&x>r?null:m}return null}},F=a.define(b.isDate,z).define(b.isString,E).define(b.isNumber,A);for(C in z)z.hasOwnProperty(C)&&(F[C]=z[C]);for(C in E)E.hasOwnProperty(C)&&(F[C]=E[C]);for(C in A)A.hasOwnProperty(C)&&(F[C]=A[C]);return F}void 0!==d?void 0!==c&&c.exports&&(c.exports=e(b("extended"),b("is-extended"),b("array-extended"))):"function"==typeof a&&a.amd?a(["extended","is-extended","array-extended"],function(a,b,c){return e(a,b,c)}):this.dateExtended=e(this.extended,this.isExtended,this.arrayExtended)}).call(this)},{"array-extended":91,extended:121,"is-extended":139}],118:[function(b,c,d){!function(){function b(){function a(a,b){return b=b||0,x.call(a,b)}function b(a){return"[object Array]"===Object.prototype.toString.call(a)}function c(a){return null!==a&&void 0!==a&&"object"==typeof a}function d(a){return c(a)&&a.constructor===Object}function e(a,b){if(a&&a.length)for(var c=0,d=a.length;c<d;c++)if(a[c]===b)return c;return-1}function f(a,b,c){var d,f;for(d in b)b.hasOwnProperty(d)&&-1===e(c,d)&&(f=b[d],d in a&&a[d]===f||(a[d]=f));return a}function g(a,c){var d=this.__meta,e=d.supers,f=e.length,g=d.superMeta,h=g.pos;if(f>h){a=a?B(a)||b(a)?a:[a]:[];var i,j=g.name,k=g.f;do{if("function"==typeof(i=e[h][j])&&(i=i._f||i)!==k)return g.pos=1+h,i.apply(this,a)}while(f>++h)}return null}function h(){var a=this.__meta,b=a.supers,c=b.length,d=a.superMeta,e=d.pos;if(c>e){var f,g=d.name,h=d.f;do{if("function"==typeof(f=b[e][g])&&(f=f._f||f)!==h)return d.pos=1+e,f.bind(this)}while(c>++e)}return null}function i(a){var b=this.__getters__;return b.hasOwnProperty(a)?b[a].apply(this):this[a]}function j(b,c){var e=this.__setters__;if(!d(b))return e.hasOwnProperty(b)?e[b].apply(this,a(arguments,1)):this[b]=c;for(var f in b){var g=b[f];e.hasOwnProperty(f)?e[b].call(this,g):this[f]=g}}function k(){var a=this.__meta||{},b=a.supers,c=b.length,d=a.superMeta,e=d.pos;if(c>e){var f,g=d.name,h=d.f;do{if("function"==typeof(f=b[e][g])&&(f=f._f||f)!==h)return d.pos=1+e,f.apply(this,arguments)}while(c>++e)}return null}function l(a,b){if(a.toString().match(A)){var c=function(){var c,d=this.__meta||{},e=d.superMeta;switch(d.superMeta={f:a,pos:0,name:b},arguments.length){case 0:c=a.call(this);break;case 1:c=a.call(this,arguments[0]);break;case 2:c=a.call(this,arguments[0],arguments[1]);break;case 3:c=a.call(this,arguments[0],arguments[1],arguments[2]);break;default:c=a.apply(this,arguments)}return d.superMeta=e,c};return c._f=a,c}return a._f=a,a}function m(a,b){var c=b.setters||{},d=a.__setters__,e=a.__getters__;for(var f in c)d.hasOwnProperty(f)||(d[f]=c[f]);c=b.getters||{};for(f in c)e.hasOwnProperty(f)||(e[f]=c[f]);for(var g in b)if("getters"!==g&&"setters"!==g){var h=b[g];"function"==typeof h?a.hasOwnProperty(g)||(a[g]=l(k,g)):a[g]=h}}function n(){for(var b=a(arguments),c=b.length,d=this.prototype,e=d.__meta,f=this.__meta,g=d.__meta.bases,h=g.slice(),i=f.supers||[],j=e.supers||[],k=0;k<c;k++){var l=b[k],n=l.prototype,p=n.__meta,q=l.__meta;!p&&(p=n.__meta={proto:n||{}}),!q&&(q=l.__meta={proto:l.__proto__||{}}),m(d,p.proto||{}),m(this,q.proto||{}),o(l.prototype,j,g),o(l,i,h)}return this}function o(a,b,c){var d=a.__meta;!d&&(d=a.__meta={});var f=a.__meta.unique;if(!f&&(d.unique="declare"+ ++y),-1===e(c,f)){c.push(f);for(var g=a.__meta.supers||[],h=g.length-1||0;h>=0;)o(g[h--],b,c);b.unshift(a)}}function p(a,b){var c=b.setters,d=a.__setters__,e=a.__getters__;if(c)for(var f in c)d[f]=c[f];if(c=b.getters||{})for(f in c)e[f]=c[f];for(f in b)if("getters"!=f&&"setters"!=f){var g=b[f];if("function"==typeof g){var h=g.__meta||{};a[f]=h.isConstructor?g:l(g,f)}else a[f]=g}}function q(a,b){return a&&b?a[b]=this:a.exports=a=this,this}function r(a){return u(this,a)}function s(a){z.prototype=a.prototype;var b=new z;return z.prototype=null,b}function t(a,c,e){var i={},j=[],m="declare"+ ++y,q=[],r=[],t=[],u=[],v={supers:t,unique:m,bases:q,superMeta:{f:null,pos:0,name:null}},x={supers:u,unique:m,bases:r,isConstructor:!0,superMeta:{f:null,pos:0,name:null}};if(d(c)&&!e&&(e=c,c=w),"function"==typeof c||b(c)?(j=b(c)?c:[c],c=j.shift(),a.__meta=x,i=s(c),i.__meta=v,i.__getters__=f({},i.__getters__||{}),i.__setters__=f({},i.__setters__||{}),a.__getters__=f({},a.__getters__||{}),a.__setters__=f({},a.__setters__||{}),o(c.prototype,t,q),o(c,u,r)):(a.__meta=x,i.__meta=v,i.__getters__=i.__getters__||{},i.__setters__=i.__setters__||{},a.__getters__=a.__getters__||{},a.__setters__=a.__setters__||{}),a.prototype=i,e){var z=v.proto=e.instance||{},A=x.proto=e.static||{};A.init=A.init||k,p(i,z),p(a,A),z.hasOwnProperty("constructor")?i.constructor=l(z.constructor,"constructor"):i.constructor=z.constructor=l(k,"constructor")}else v.proto={},x.proto={},a.init=l(k,"init"),i.constructor=l(k,"constructor");j.length&&n.apply(a,j),c&&f(a,f(f({},c),a)),i._super=a._super=g,i._getSuper=a._getSuper=h,i._static=a}function u(a,b){function c(){switch(arguments.length){case 0:this.constructor.call(this);break;case 1:this.constructor.call(this,arguments[0]);break;case 2:this.constructor.call(this,arguments[0],arguments[1]);break;case 3:this.constructor.call(this,arguments[0],arguments[1],arguments[2]);break;default:this.constructor.apply(this,arguments)}}return t(c,a,b),c.init()||c}function v(a,b){function c(){return d||(this.constructor.apply(this,arguments),d=this),d}var d;return t(c,a,b),c.init()||c}var w,x=Array.prototype.slice,y=0,z=new Function,A=/(super)/g,B=function(a){return"[object Arguments]"===Object.prototype.toString.call(a)};return B(arguments)||(B=function(a){return!(!a||!a.hasOwnProperty("callee"))}),w=u({instance:{get:i,set:j},static:{get:i,set:j,mixin:n,extend:r,as:q}}),u.singleton=v,u}void 0!==d?void 0!==c&&c.exports&&(c.exports=b()):"function"==typeof a&&a.amd?a(b):this.declare=b()}()},{}],119:[function(a,b,c){b.exports=a("./declare.js")},{"./declare.js":118}],120:[function(b,c,d){(function(d,e){(function(){"use strict";function f(a){return"function"==typeof a||"object"==typeof a&&null!==a}function g(a){return"function"==typeof a}function h(a){return"object"==typeof a&&null!==a}function i(a){Q=a}function j(a){U=a}function k(){return function(){P(m)}}function l(){return function(){setTimeout(m,1)}}function m(){for(var a=0;a<T;a+=2){(0,$[a])($[a+1]),$[a]=void 0,$[a+1]=void 0}T=0}function n(){}function o(){return new TypeError("You cannot resolve a promise with itself")}function p(){return new TypeError("A promises callback cannot return that same promise.")}function q(a){try{return a.then}catch(a){return ca.error=a,ca}}function r(a,b,c,d){try{a.call(b,c,d)}catch(a){return a}}function s(a,b,c){U(function(a){var d=!1,e=r(c,b,function(c){d||(d=!0,b!==c?v(a,c):x(a,c))},function(b){d||(d=!0,y(a,b))},"Settle: "+(a._label||" unknown promise"));!d&&e&&(d=!0,y(a,e))},a)}function t(a,b){b._state===aa?x(a,b._result):b._state===ba?y(a,b._result):z(b,void 0,function(b){v(a,b)},function(b){y(a,b)})}function u(a,b){
/src/dist/exceljs.min.js:10:if(b.constructor===a.constructor)t(a,b);else{var c=q(b);c===ca?y(a,ca.error):void 0===c?x(a,b):g(c)?s(a,b,c):x(a,b)}}function v(a,b){a===b?y(a,o()):f(b)?u(a,b):x(a,b)}function w(a){a._onerror&&a._onerror(a._result),A(a)}function x(a,b){a._state===_&&(a._result=b,a._state=aa,0!==a._subscribers.length&&U(A,a))}function y(a,b){a._state===_&&(a._state=ba,a._result=b,U(w,a))}function z(a,b,c,d){var e=a._subscribers,f=e.length;a._onerror=null,e[f]=b,e[f+aa]=c,e[f+ba]=d,0===f&&a._state&&U(A,a)}function A(a){var b=a._subscribers,c=a._state;if(0!==b.length){for(var d,e,f=a._result,g=0;g<b.length;g+=3)d=b[g],e=b[g+c],d?D(c,d,e,f):e(f);a._subscribers.length=0}}function B(){this.error=null}function C(a,b){try{return a(b)}catch(a){return da.error=a,da}}function D(a,b,c,d){var e,f,h,i,j=g(c);if(j){if(e=C(c,d),e===da?(i=!0,f=e.error,e=null):h=!0,b===e)return void y(b,p())}else e=d,h=!0;b._state!==_||(j&&h?v(b,e):i?y(b,f):a===aa?x(b,e):a===ba&&y(b,e))}function E(a,b){try{b(function(b){v(a,b)},function(b){y(a,b)})}catch(b){y(a,b)}}function F(a,b){var c=this;c._instanceConstructor=a,c.promise=new a(n),c._validateInput(b)?(c._input=b,c.length=b.length,c._remaining=b.length,c._init(),0===c.length?x(c.promise,c._result):(c.length=c.length||0,c._enumerate(),0===c._remaining&&x(c.promise,c._result))):y(c.promise,c._validationError())}function G(a){return new ea(this,a).promise}function H(a){function b(a){v(e,a)}function c(a){y(e,a)}var d=this,e=new d(n);if(!S(a))return y(e,new TypeError("You must pass an array to race.")),e;for(var f=a.length,g=0;e._state===_&&g<f;g++)z(d.resolve(a[g]),void 0,b,c);return e}function I(a){var b=this;if(a&&"object"==typeof a&&a.constructor===b)return a;var c=new b(n);return v(c,a),c}function J(a){var b=this,c=new b(n);return y(c,a),c}function K(){throw new TypeError("You must pass a resolver function as the first argument to the promise constructor")}function L(){throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.")}function M(a){this._id=ja++,this._state=void 0,this._result=void 0,this._subscribers=[],n!==a&&(g(a)||K(),this instanceof M||L(),E(this,a))}function N(){var a;if(void 0!==e)a=e;else if("undefined"!=typeof self)a=self;else try{a=Function("return this")()}catch(a){throw new Error("polyfill failed because global object is unavailable in this environment")}var b=a.Promise;b&&"[object Promise]"===Object.prototype.toString.call(b.resolve())&&!b.cast||(a.Promise=ka)}var O;O=Array.isArray?Array.isArray:function(a){return"[object Array]"===Object.prototype.toString.call(a)};var P,Q,R,S=O,T=0,U=function(a,b){$[T]=a,$[T+1]=b,2===(T+=2)&&(Q?Q(m):R())},V="undefined"!=typeof window?window:void 0,W=V||{},X=W.MutationObserver||W.WebKitMutationObserver,Y=void 0!==d&&"[object process]"==={}.toString.call(d),Z="undefined"!=typeof Uint8ClampedArray&&"undefined"!=typeof importScripts&&"undefined"!=typeof MessageChannel,$=new Array(1e3);R=Y?function(){return function(){d.nextTick(m)}}():X?function(){var a=0,b=new X(m),c=document.createTextNode("");return b.observe(c,{characterData:!0}),function(){c.data=a=++a%2}}():Z?function(){var a=new MessageChannel;return a.port1.onmessage=m,function(){a.port2.postMessage(0)}}():void 0===V&&"function"==typeof b?function(){try{var a=b,c=a("vertx");return P=c.runOnLoop||c.runOnContext,k()}catch(a){return l()}}():l();var _=void 0,aa=1,ba=2,ca=new B,da=new B;F.prototype._validateInput=function(a){return S(a)},F.prototype._validationError=function(){return new Error("Array Methods must be provided an Array")},F.prototype._init=function(){this._result=new Array(this.length)};var ea=F;F.prototype._enumerate=function(){for(var a=this,b=a.length,c=a.promise,d=a._input,e=0;c._state===_&&e<b;e++)a._eachEntry(d[e],e)},F.prototype._eachEntry=function(a,b){var c=this,d=c._instanceConstructor;h(a)?a.constructor===d&&a._state!==_?(a._onerror=null,c._settledAt(a._state,b,a._result)):c._willSettleAt(d.resolve(a),b):(c._remaining--,c._result[b]=a)},F.prototype._settledAt=function(a,b,c){var d=this,e=d.promise;e._state===_&&(d._remaining--,a===ba?y(e,c):d._result[b]=c),0===d._remaining&&x(e,d._result)},F.prototype._willSettleAt=function(a,b){var c=this;z(a,void 0,function(a){c._settledAt(aa,b,a)},function(a){c._settledAt(ba,b,a)})};var fa=G,ga=H,ha=I,ia=J,ja=0,ka=M;M.all=fa,M.race=ga,M.resolve=ha,M.reject=ia,M._setScheduler=i,M._setAsap=j,M._asap=U,M.prototype={constructor:M,then:function(a,b){var c=this,d=c._state;if(d===aa&&!a||d===ba&&!b)return this;var e=new this.constructor(n),f=c._result;if(d){var g=arguments[d-1];U(function(){D(d,e,g,f)})}else z(c,e,a,b);return e},catch:function(a){return this.then(null,a)}};var la=N,ma={Promise:ka,polyfill:la};"function"==typeof a&&a.amd?a(function(){return ma}):void 0!==c&&c.exports?c.exports=ma:void 0!==this&&(this.ES6Promise=ma),la()}).call(this)}).call(this,b("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{_process:197}],121:[function(b,c,d){(function(){"use strict";function e(a){function b(){var b=a.define();return b.expose({register:function(a,c){c||(c=a,a=null);var d=typeof c;if(a)b[a]=c;else if(c&&"function"===d)b.extend(c);else{if("object"!==d)throw new TypeError("extended.register must be called with an extender function");b.expose(c)}return b},define:function(){return a.define.apply(a,arguments)}}),b}function c(){return b()}!function(){function a(a,b){var c,d;for(c in b)b.hasOwnProperty(c)&&(d=b[c],c in a&&a[c]===d||(a[c]=d));return a}}();return c.define=function(){return a.define.apply(a,arguments)},c}void 0!==d?void 0!==c&&c.exports&&(c.exports=e(b("extender"))):"function"==typeof a&&a.amd?a(["extender"],function(a){return e(a)}):this.extended=e(this.extender)}).call(this)},{extender:123}],122:[function(b,c,d){(function(){function e(a){function b(a,b){if(a&&a.length)for(var c=0,d=a.length;c<d;c++)if(a[c]===b)return c;return-1}function c(a){return"[object Array]"===Object.prototype.toString.call(a)}function d(b){function c(a,b,c){if("function"!=typeof c)throw new TypeError("when extending type you must provide a function");var d;d="constructor"===b?function(){this._super(arguments),c.apply(this,arguments)}:function(){var a=f.call(arguments);a.unshift(this._value);var b=c.apply(this,a);return b!==e?this.__extender__(b):this},a[b]=d}function d(a,b,c){if("function"!=typeof c)throw new TypeError("when extending type you must provide a function");var d;d="constructor"===b?function(){this._super(arguments),c.apply(this,arguments)}:function(){var a=f.call(arguments);return a.unshift(this._value),c.apply(this,a)},a[b]=d}function h(a,b,e){for(var f in b)b.hasOwnProperty(f)&&("getters"!==f&&"setters"!==f?"noWrap"===f?h(a,b[f],!0):e?d(a,f,b[f]):c(a,f,b[f]):a[f]=b[f])}function i(a){var b,c,d=a;if(!(a instanceof m)){var e=m;for(b=0,c=n.length;b<c;b++){var f=n[b];f[0](a)&&(e=e.extend({instance:f[1]}))}d=new e(a),d.__extender__=i}return d}function j(){return!0}function k(a,b){if(arguments.length){"object"==typeof a&&(b=a,a=j),b=b||{};var d={};h(d,b),d.hasOwnProperty("constructor")||(b.hasOwnProperty("constructor")?c(d,"constructor",b.constructor):d.constructor=function(){this._super(arguments)}),n.push([a,d])}return i}function l(a){return a&&a.hasOwnProperty("__defined__")&&(i.__defined__=n=n.concat(a.__defined__)),g(i,a,["define","extend","expose","__defined__"]),i}b=b||[];var m=a({instance:{constructor:function(a){this._value=a},value:function(){return this._value},eq:function(a){return this.__extender__(this._value===a)},neq:function(a){return this.__extender__(this._value!==a)},print:function(){return console.log(this._value),this}}}),n=[];return i.define=k,i.extend=l,i.expose=function(){for(var a,b=0,c=arguments.length;b<c;b++)"object"==typeof(a=arguments[b])&&g(i,a,["define","extend","expose","__defined__"]);return i},i.__defined__=n,i}var e,f=Array.prototype.slice,g=function(){function a(a,c,d){var e,f;for(e in c)c.hasOwnProperty(e)&&-1===b(d,e)&&(f=c[e],e in a&&a[e]===f||(a[e]=f));return a}return function(b){b||(b={});var d=arguments.length,e=arguments[arguments.length-1];c(e)?d--:e=[];for(var f=1;f<d;f++)a(b,arguments[f],e);return b}}();return{define:function(){return d().define.apply(d,arguments)},extend:function(a){return d().define().extend(a)}}}void 0!==d?void 0!==c&&c.exports&&(c.exports=e(b("declare.js"))):"function"==typeof a&&a.amd?a(["declare"],function(a){return e(a)}):this.extender=e(this.declare)}).call(this)},{"declare.js":119}],123:[function(a,b,c){b.exports=a("./extender.js")},{"./extender.js":122}],124:[function(a,b,c){b.exports=a("./lib")},{"./lib":129}],125:[function(a,b,c){var d=a("is-extended"),e=Object.prototype.hasOwnProperty;b.exports=a("extended")().register(d).register(a("object-extended")).register(a("string-extended")).register("LINE_BREAK",a("os").EOL).register("asyncEach",function(a,b,c){!function c(d,e,f,g){++d<e?b(f[d],function(a){a?g(a):d%100==0?setImmediate(function(){c(d,e,f,g)}):c(d,e,f,g)}):g(null,a)}(-1,a.length,a,c)}).register("spreadArgs",function(a,b,c){var d;switch((b||[]).length){case 0:d=a.call(c);break;case 1:d=a.call(c,b[0]);break;case 2:d=a.call(c,b[0],b[1]);break;case 3:d=a.call(c,b[0],b[1],b[2]);break;default:d=a.apply(c,b)}return d}).register("keys",function(a){var b=[];for(var c in a)e.call(a,c)&&b.push(c);return b})},{extended:121,"is-extended":139,"object-extended":178,os:179,"string-extended":216}],126:[function(a,b,c){(function(b){function d(a,b,c){return p(b)?p(c)?function(a,d){return d?c:b}:s(c)?function(a,d){return d?c[a]:b}:function(d,e){return e?c[a.headers[d]]:b}:s(b)?p(c)?function(a,d){return d?c:b[a]}:function(a,d){return d?c[a]:b[a]}:p(c)?function(d,e){return e?c:b[a.headers[d]]}:function(d,e){return e?c[a.headers[d]]:b[a.headers[d]]}}function e(a,b){function c(a,b,c){var d;return a=a.replace(/\0/g,""),(d=-1!==a.indexOf(g))?(a=a.replace(i,h+g),d=!0):d=-1!==a.search(f),d=d||l(b,c),a=d?[g+a+g]:[a],a.join("")}a=a||{};var e=a.delimiter||",",f=new RegExp("["+e+r(a.rowDelimiter||u)+"']"),g=a.quote||'"',h=a.escape||'"',i=new RegExp(g,"g"),j=!!o(a,"quoteColumns")&&a.quoteColumns,k=o(a,"quoteHeaders")?a.quoteHeaders:j,l=d(b,j,k);return function(a,b){for(var d,f=-1,g=a.length,h=[];++f<g;)d=a[f],d=(q(d)?"":d)+"",h.push(c(d,f,b));return h.join(e)}}function f(a,b){return b(null,a)}function g(a){return s(a)&&s(a[0])&&2===a[0].length}function h(a){var b,c,d;if(g(a))for(c=-1,d=a.length,b=[];++c<d;)b[c]=a[c][0];else b=s(a)?a:t(a);return b}function i(a,c){var d,e=!0;return a.parsedHeaders||(a.parsedHeaders=!0,d=a.headers=h(c),a.headersLength=d.length),a.hasWrittenHeaders||(a.totalCount++,a.push(new b(a.formatter(a.headers,!0),"utf8")),a.hasWrittenHeaders=!0,e=g(c)||!s(c)),e}function j(a,b){var c=[],d=[],e=a.headers,f=-1,g=a.headersLength;for(a.totalCount++&&d.push(a.rowDelimiter);++f<g;)c[f]=b[e[f]];return d.push(a.formatter(c)),d.join("")}function k(a,b,c){var d=[];return a.totalCount++&&d.push(a.rowDelimiter),d.push(a.formatter(b)),d.join("")}function l(a,b){var c=[],d=[],e=-1,f=a.headersLength;for(a.totalCount++&&d.push(a.rowDelimiter);++e<f;)c[e]=b[e][1];return d.push(a.formatter(c)),d.join("")}function m(a,b){return s(b)?g(b)?l(a,b):k(a,b):j(a,b)}var n=(a("fs"),a("../extended")),o=n.has,p=n.isBoolean,q=n.isUndefinedOrNull,r=n.escape,s=n.isArray,t=n.keys,u=(a("stream"),n.LINE_BREAK);c.createFormatter=e,c.transformItem=m,c.checkHeaders=i,c.defaultTransform=f}).call(this,a("buffer").Buffer)},{"../extended":125,buffer:94,fs:133,stream:215}],127:[function(a,b,c){(function(c){function d(a){a=a||{},a.objectMode=!0,h(a,"transform")&&(a.consumerTransform=a.transform,delete a.transform),j.call(this,a),this.formatter=l(a,this),this.rowDelimiter=a.rowDelimiter||"\n";var b=h(a,"headers")?!!a.headers:null,c=b&&g(a.headers)?a.headers:null;this.hasHeaders=b,this.headers=c,b&&(c?(this.parsedHeaders=!0,this.headersLength=c.length):this.parsedHeaders=!1),this.hasWrittenHeaders=!b,this.includeEndRowDelimiter=!!a.includeEndRowDelimiter,h(a,"consumerTransform")&&this.transform(a.consumerTransform)}var e=(a("fs"),a("util")),f=a("../extended"),g=(f.escape,f.isArray),h=f.has,i=a("stream"),j=i.Transform,k=(f.LINE_BREAK,a("./formatter")),l=k.createFormatter,m=k.checkHeaders,n=k.transformItem,o=k.defaultTransform;e.inherits(d,j),f(d).extend({headers:null,headersLength:0,totalCount:0,_transform:function(a,b,d){var e=this;this.__transform(a,function(a,b){a?d(a):(m(e,b)&&e.push(new c(n(e,b),"utf8")),d())})},__transform:o,transform:function(a){return f.isFunction(a)||this.emit("error",new TypeError("fast-csv.FormatterStream#transform requires a function")),2===a.length?this.__transform=a:this.__transform=function(b,c){c(null,a(b))},this},_flush:function(a){this.includeEndRowDelimiter&&this.push(this.rowDelimiter),a()}}),b.exports=d}).call(this,a("buffer").Buffer)},{"../extended":125,"./formatter":126,buffer:94,fs:133,stream:215,util:221}],128:[function(a,b,c){(function(c){function d(a){return new m(a)}function e(a,b,c){var e=d(b);a.length;return k.asyncEach(a,function(a,b){e.write(a,null,b)},function(a){a?e.emit("error",a):e.end()}),e}function f(a,b,c){return e(b,c).pipe(a)}function g(a,b,c){k.isFunction(b)&&(c=b,b={});var d=new l.Writable,f=[];d._write=function(a,b,c){f.push(a+""),c()},d.on("error",c).on("finish",function(){c(null,f.join(""))}),e(a,b).pipe(d)}function h(a,b,d){k.isFunction(b)&&(d=b,b={});var f=new l.Writable,g=[],h=0;f._write=function(a,b,c){g.push(a),h++,c()},f.on("error",d).on("finish",function(){d(null,c.concat(g))}),e(a,b).pipe(f)}function i(a,b,c){var d=j.createWriteStream(a,{encoding:"utf8"});return e(b,c).pipe(d)}var j=a("fs"),k=a("../extended"),l=(k.escape,a("stream")),m=(k.LINE_BREAK,a("./formatter_stream"));d.writeToBuffer=h,d.write=e,d.createWriteStream=d,d.writeToString=g,d.writeToPath=i,d.writeToStream=f,b.exports=d}).call(this,a("buffer").Buffer)},{"../extended":125,"./formatter_stream":127,buffer:94,fs:133,stream:215}],129:[function(a,b,c){function d(){return e.apply(void 0,arguments)}var e=(a("fs"),a("./parser")),f=a("./formatter");d.parse=d,d.fromString=e.fromString,d.fromPath=e.fromPath,d.fromStream=e.fromStream,d.format=f,d.write=f.write,d.writeToStream=f.writeToStream,d.writeToString=f.writeToString,d.writeToBuffer=f.writeToBuffer,d.writeToPath=f.writeToPath,d.createWriteStream=f.createWriteStream,d.createReadStream=f.createWriteStream,b.exports=d},{"./formatter":128,"./parser":130,fs:133}],130:[function(a,b,c){(function(c){function d(a){return new j(a)}function e(a,b){return a.pipe(new j(b))}function f(a,b){return i.createReadStream(a).pipe(new j(b))}function g(a,b){var c=new h.Readable;return c.push(a),c.push(null),c.pipe(new j(b))}var h=(a("../extended"),c.stdout,a("stream")),i=a("fs"),j=a("./parser_stream");d.fromStream=e,d.fromPath=f,d.fromString=g,b.exports=d}).call(this,a("_process"))},{"../extended":125,"./parser_stream":132,_process:197,fs:133,stream:215}],131:[function(a,b,c){function d(a){function b(a){return q?a=h(a):o?a=i(a):p&&(a=j(a)),a}function c(a,c,d,e){var f,g=0,h=[],i=!1,j=0,l=a.length,m=u===r;if(l)for(;d<l&&(f=a.charAt(d));){if(f===r)if(i)if(m&&a.charAt(d+1)===r)d++,h[j++]=f;else if(m||h[j-1]!==u){if(!--g){++d;break}}else h[j-1]=f;else g++,i=!0;else h[j++]=f;++d}h=h.join("");var o=k(a,d),p=o.token;if(p&&0===p.search(n))e&&o.cursor+1>=l?d=null:d++;else if(g&&!p){if(!e)throw new Error("Parse Error: expected: '"+r+"' got: '"+p+"'. at '"+a.substr(d).replace(/[r\n]/g,"\\n'"));d=null}else{if(!g&&p&&-1===p.search(t))throw new Error("Parse Error: expected: '"+r+"' got: '"+p+"'. at '"+a.substr(d,10).replace(/[\r\n]/g,"\\n'"));!e||p&&w.test(p)||(d=null)}return null!==d&&c.push(b(h)),d}function d(a,b,c){var d=a.substr(b).search(w);return d=-1===d?c?null:a.length+1:b+d+1}function e(c,d,e,f){var g=c.substr(e),h=g.search(t);if(-1===h){if(!s.test(g))throw new Error("Parse Error: delimiter '"+n+"' not found at '"+g.replace(/\n/g,"\\n'"));h=g.length}var i=g.charAt(h);if(-1!==i.search(n))if(f&&e+(h+1)>=c.length)e=null;else{d.push(b(g.substr(0,h))),e+=h+1;var j=c.charAt(e);!a.strictColumnHandling&&(w.test(j)||e>=c.length)&&d.push(""),a.strictColumnHandling||!x.test(j)||f||d.push(j)}else w.test(i)?(d.push(b(g.substr(0,h))),e+=h):f?e=null:(d.push(b(g.substr(0,h))),e+=h+1);return e}function k(a,b){var c,d,e,f=a.substr(b);return-1!==(e=f.search(v))&&(d=f.match(v)[1].length,c=a.substr(b+e,d),b+=e+d-1),{token:c,cursor:b}}a=a||{};var l,m,n=a.delimiter||",",o=a.ltrim||!1,p=a.rtrim||!1,q=a.trim||!1,r=f(a,"quote")?a.quote:'"',s=new RegExp("([^"+n+"'\"\\s\\\\]*(?:\\s+[^"+n+"'\"\\s\\\\]+)*)"),t=new RegExp("(?:\\n|\\r|"+n+")"),u=a.escape||'"',v=new RegExp("([^\\s]|\\r\\n|\\n|\\r|"+n+")"),w=/(\r\n|\n|\r)/,x=new RegExp("(?!"+n+") ");return f(a,"comment")&&(l=a.comment,m=!0),function(a,b){for(var f,h,i,j=0,n=a.length,o=[],p=[],q=0;j<n;){if(h=k(a,j),f=h.token,g(f)){j=q,i=null;break}if(w.test(f)){if(!((j=h.cursor+1)<n)){"\r"===f&&b&&(j=q,i=null);break}o.push(p),p=[],q=j}else if(m&&f===l){if(null===(i=d(a,j,b))){j=q;break}if(!(i<n)){j=i,i=null;break}q=j=i}else{if(null===(i=f===r?c(a,p,h.cursor,b):e(a,p,j,b))){j=q;break}j=i}}return null!==i&&o.push(p),{line:a.substr(j),rows:o}}}var e=a("./../extended"),f=e.has,g=e.isUndefinedOrNull,h=e.trim,i=e.trimLeft,j=e.trimRight;b.exports=d},{"./../extended":125}],132:[function(a,b,c){(function(c){function d(a){a=a||{},a.objectMode=!e.has(a,"objectMode")||a.objectMode,i.Transform.call(this,a),this.lines="",this.decoder=new m,this._parsedHeaders=!1,this._rowCount=-1,this._emitData=!1;var b;if(e.has(a,"delimiter")){if(b=a.delimiter,b.length>1)throw new Error("delimiter option must be one character long");b=e.escape(b)}else b=k;return a.delimiter=b,this.parser=l(a),this._headers=a.headers,this._renameHeaders=a.renameHeaders,this._ignoreEmpty=a.ignoreEmpty,this._discardUnmappedColumns=a.discardUnmappedColumns,this._strictColumnHandling=a.strictColumnHandling,this.__objectMode=a.objectMode,this.__buffered=[],this}var e=a("../extended"),f=e.isUndefined,g=e.spreadArgs,h=a("util"),i=(c.stdout,a("stream")),j=/^\s*(?:''|"")?\s*(?:,\s*(?:''|"")?\s*)*$/,k=",",l=a("./parser"),m=(a("fs"),a("string_decoder").StringDecoder),n=!!i.Transform.prototype.isPaused;h.inherits(d,i.Transform);var o=d.prototype.on,p=d.prototype.emit;e(d).extend({__pausedDone:null,__endEmitted:!1,__emittedData:!1,__handleLine:function(a,b,c,d){var f=this._ignoreEmpty,g=this;return e.isBoolean(f)&&f&&(!a||j.test(a.join("")))?d(null,null):c?d(null,a):void this.__transform(a,function(a,c){a?d(a):g.__validate(c,function(a,e,f){a?d(a):e?d(null,c):(g.emit("data-invalid",c,b,f),d(null,null))})})},__processRows:function(a,b,c){var d,f=this;e.asyncEach(a,function(a,b){a&&f.__handleLine(a,d=++f._rowCount,!1,function(a,c){a?b(a):(c?f.isStreamPaused()?f.__buffered.push([c,d]):f.__emitRecord(c,d):d=--f._rowCount,b())})},function(a){a?c(a):c(null,b.line)})},__processHeaders:function(a,b){function c(a,c){if(a)b(a);else if(e.isArray(c)){var d=c.length,g=j.__transform;j.__transform=function(a,b){var e,k={},l=-1;if(a.length>d){if(!h)return i?(j.emit("data-invalid",a),g(null,b)):(j.emit("error",new Error("Unexpected Error: column header mismatch expected: "+d+" columns got: "+a.length)),g(null,b));a.splice(d)}else if(i&&a.length<d)return j.emit("data-invalid",a),g(null,b);for(;++l<d;)f(c[l])||(e=a[l],k[c[l]]=f(e)?"":e);return g(k,b)}}j._parsedHeaders=!0,b(null)}var d=this._headers,g=this._renameHeaders,h=this._discardUnmappedColumns,i=this._strictColumnHandling,j=this;g?Array.isArray(d)?(a.shift(),c(null,d)):j.emit("error",new Error("Error renaming headers: new headers must be provided in an array")):e.isBoolean(d)&&d?this.__handleLine(a.shift(),0,!0,c):c(null,d)},_parse:function(a,b,c){var d,e=this;try{a=this.parser(a,b),d=a.rows,d.length?this._parsedHeaders?this.__processRows(d,a,c):this.__processHeaders(d,function(b){b?c(b):e.__processRows(d,a,c)}):c(null,a.line)}catch(a){c(a)}},__emitRecord:function(a,b){this._emitData&&this.push(this.__objectMode?a:JSON.stringify(a))},__removeBOM:function(a){return a&&"string"==typeof a&&"0xFEFF"==a.charCodeAt(0)?a.slice(1):a},_transform:function(a,b,c){var d=this.lines,e=d+this.decoder.write(a),f=this;e.length>1?(e=this.__removeBOM(e),this._parse(e,!0,function(a,b){a?c(a):(f.lines=b,f.isStreamPaused()?f.__pausedDone=c:c())})):(this.lines=e,this.isStreamPaused()?this.__pausedDone=c:c())},__doFlush:function(a){try{a()}catch(b){a(b)}},_flush:function(a){var b=this;this.lines?this._parse(this.lines,!1,function(c){c?a(c):b.isStreamPaused()?b.__pausedDone=function(){b.__doFlush(a)}:b.__doFlush(a)}):this.isStreamPaused()?this.__pausedDone=function(){b.__doFlush(a)}:this.__doFlush(a)},__validate:function(a,b){return b(null,!0)},__transform:function(a,b){return b(null,a)},__flushPausedBuffer:function(){var a=this.__buffered;if(a.length){for(var b;a.length;)if(b=a.shift(),this.__emitRecord(b[0],b[1]),this.isStreamPaused())return;a.length=0}if(this.__pausedDone){var c=this.__pausedDone;this.__pausedDone=null,c()}},isStreamPaused:function(){return this.__paused},emit:function(a){"end"===a?this.__endEmitted||(this.__endEmitted=!0,g(p,["end",++this._rowCount],this)):(n||("pause"===a?this.__paused=!0:"resume"===a&&(this.__paused=!1,this.__flushPausedBuffer())),g(p,arguments,this))},on:function(a){return"data"!==a&&"readable"!==a||(this._emitData=!0),g(o,arguments,this),this},validate:function(a){return e.isFunction(a)||this.emit("error",new TypeError("fast-csv.Parser#validate requires a function")),2===a.length?this.__validate=a:this.__validate=function(b,c){return c(null,a(b))},this},transform:function(a){return e.isFunction(a)||this.emit("error",new TypeError("fast-csv.Parser#transform requires a function")),2===a.length?this.__transform=a:this.__transform=function(b,c){return c(null,a(b))},this}}),b.exports=d}).call(this,a("_process"))},{"../extended":125,"./parser":131,_process:197,fs:133,stream:215,string_decoder:217,util:221}],133:[function(a,b,c){arguments[4][93][0].apply(c,arguments)},{dup:93}],134:[function(a,b,c){function d(){this._events&&Object.prototype.hasOwnProperty.call(this,"_events")||(this._events=u(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0}function e(a){return void 0===a._maxListeners?d.defaultMaxListeners:a._maxListeners}function f(a,b,c){if(b)a.call(c);else for(var d=a.length,e=p(a,d),f=0;f<d;++f)e[f].call(c)}function g(a,b,c,d){if(b)a.call(c,d);else for(var e=a.length,f=p(a,e),g=0;g<e;++g)f[g].call(c,d)}function h(a,b,c,d,e){if(b)a.call(c,d,e);else for(var f=a.length,g=p(a,f),h=0;h<f;++h)g[h].call(c,d,e)}function i(a,b,c,d,e,f){if(b)a.call(c,d,e,f);else for(var g=a.length,h=p(a,g),i=0;i<g;++i)h[i].call(c,d,e,f)}function j(a,b,c,d){if(b)a.apply(c,d);else for(var e=a.length,f=p(a,e),g=0;g<e;++g)f[g].apply(c,d)}function k(a,b,c,d){var f,g,h;if("function"!=typeof c)throw new TypeError('"listener" argument must be a function');if(g=a._events,g?(g.newListener&&(a.emit("newListener",b,c.listener?c.listener:c),g=a._events),h=g[b]):(g=a._events=u(null),a._eventsCount=0),h){if("function"==typeof h?h=g[b]=d?[c,h]:[h,c]:d?h.unshift(c):h.push(c),!h.warned&&(f=e(a))&&f>0&&h.length>f){h.warned=!0;var i=new Error("Possible EventEmitter memory leak detected. "+h.length+' "'+String(b)+'" listeners added. Use emitter.setMaxListeners() to increase limit.');i.name="MaxListenersExceededWarning",i.emitter=a,i.type=b,i.count=h.length,"object"==typeof console&&console.warn&&console.warn("%s: %s",i.name,i.message)}}else h=g[b]=c,++a._eventsCount;return a}function l(){if(!this.fired)switch(this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length){case 0:return this.listener.call(this.target);case 1:return this.listener.call(this.target,arguments[0]);case 2:return this.listener.call(this.target,arguments[0],arguments[1]);case 3:return this.listener.call(this.target,arguments[0],arguments[1],arguments[2]);default:for(var a=new Array(arguments.length),b=0;b<a.length;++b)a[b]=arguments[b];this.listener.apply(this.target,a)}}function m(a,b,c){var d={fired:!1,wrapFn:void 0,target:a,type:b,listener:c},e=w.call(l,d);return e.listener=c,d.wrapFn=e,e}function n(a){var b=this._events;if(b){var c=b[a];if("function"==typeof c)return 1;if(c)return c.length}return 0}function o(a,b){for(var c=b,d=c+1,e=a.length;d<e;c+=1,d+=1)a[c]=a[d];a.pop()}function p(a,b){for(var c=new Array(b),d=0;d<b;++d)c[d]=a[d];return c}function q(a){for(var b=new Array(a.length),c=0;c<b.length;++c)b[c]=a[c].listener||a[c];return b}function r(a){var b=function(){};return b.prototype=a,new b}function s(a){var b=[];for(var c in a)Object.prototype.hasOwnProperty.call(a,c)&&b.push(c);return c}function t(a){var b=this;return function(){return b.apply(a,arguments)}}var u=Object.create||r,v=Object.keys||s,w=Function.prototype.bind||t;b.exports=d,d.EventEmitter=d,d.prototype._events=void 0,d.prototype._maxListeners=void 0;var x,y=10;try{var z={};Object.defineProperty&&Object.defineProperty(z,"x",{value:0}),x=0===z.x}catch(a){x=!1}x?Object.defineProperty(d,"defaultMaxListeners",{enumerable:!0,get:function(){return y},set:function(a){if("number"!=typeof a||a<0||a!==a)throw new TypeError('"defaultMaxListeners" must be a positive number');y=a}}):d.defaultMaxListeners=y,d.prototype.setMaxListeners=function(a){if("number"!=typeof a||a<0||isNaN(a))throw new TypeError('"n" argument must be a positive number');return this._maxListeners=a,this},d.prototype.getMaxListeners=function(){return e(this)},d.prototype.emit=function(a){var b,c,d,e,k,l,m="error"===a;if(l=this._events)m=m&&null==l.error;else if(!m)return!1;if(m){if(arguments.length>1&&(b=arguments[1]),b instanceof Error)throw b;var n=new Error('Unhandled "error" event. ('+b+")");throw n.context=b,n}if(!(c=l[a]))return!1;var o="function"==typeof c;switch(d=arguments.length){case 1:f(c,o,this);break;case 2:g(c,o,this,arguments[1]);break;case 3:h(c,o,this,arguments[1],arguments[2]);break;case 4:i(c,o,this,arguments[1],arguments[2],arguments[3]);break;default:for(e=new Array(d-1),k=1;k<d;k++)e[k-1]=arguments[k];j(c,o,this,e)}return!0},d.prototype.addListener=function(a,b){return k(this,a,b,!1)},d.prototype.on=d.prototype.addListener,d.prototype.prependListener=function(a,b){return k(this,a,b,!0)},d.prototype.once=function(a,b){if("function"!=typeof b)throw new TypeError('"listener" argument must be a function');return this.on(a,m(this,a,b)),this},d.prototype.prependOnceListener=function(a,b){if("function"!=typeof b)throw new TypeError('"listener" argument must be a function');return this.prependListener(a,m(this,a,b)),this},d.prototype.removeListener=function(a,b){var c,d,e,f,g;if("function"!=typeof b)throw new TypeError('"listener" argument must be a function');if(!(d=this._events))return this;if(!(c=d[a]))return this;if(c===b||c.listener===b)0==--this._eventsCount?this._events=u(null):(delete d[a],d.removeListener&&this.emit("removeListener",a,c.listener||b));else if("function"!=typeof c){for(e=-1,f=c.length-1;f>=0;f--)if(c[f]===b||c[f].listener===b){g=c[f].listener,e=f;break}if(e<0)return this;0===e?c.shift():o(c,e),1===c.length&&(d[a]=c[0]),d.removeListener&&this.emit("removeListener",a,g||b)}return this},d.prototype.removeAllListeners=function(a){var b,c,d;if(!(c=this._events))return this;if(!c.removeListener)return 0===arguments.length?(this._events=u(null),this._eventsCount=0):c[a]&&(0==--this._eventsCount?this._events=u(null):delete c[a]),this;if(0===arguments.length){var e,f=v(c);for(d=0;d<f.length;++d)"removeListener"!==(e=f[d])&&this.removeAllListeners(e);return this.removeAllListeners("removeListener"),this._events=u(null),this._eventsCount=0,this}if("function"==typeof(b=c[a]))this.removeListener(a,b);else if(b)for(d=b.length-1;d>=0;d--)this.removeListener(a,b[d]);return this},d.prototype.listeners=function(a){var b,c,d=this._events;return d?(b=d[a],c=b?"function"==typeof b?[b.listener||b]:q(b):[]):c=[],c},d.listenerCount=function(a,b){return"function"==typeof a.listenerCount?a.listenerCount(b):n.call(a,b)},d.prototype.listenerCount=n,d.prototype.eventNames=function(){return this._eventsCount>0?Reflect.ownKeys(this._events):[]}},{}],135:[function(a,b,c){c.read=function(a,b,c,d,e){var f,g,h=8*e-d-1,i=(1<<h)-1,j=i>>1,k=-7,l=c?e-1:0,m=c?-1:1,n=a[b+l];for(l+=m,f=n&(1<<-k)-1,n>>=-k,k+=h;k>0;f=256*f+a[b+l],l+=m,k-=8);for(g=f&(1<<-k)-1,f>>=-k,k+=d;k>0;g=256*g+a[b+l],l+=m,k-=8);if(0===f)f=1-j;else{if(f===i)return g?NaN:1/0*(n?-1:1);g+=Math.pow(2,d),f-=j}return(n?-1:1)*g*Math.pow(2,f-d)},c.write=function(a,b,c,d,e,f){var g,h,i,j=8*f-e-1,k=(1<<j)-1,l=k>>1,m=23===e?Math.pow(2,-24)-Math.pow(2,-77):0,n=d?0:f-1,o=d?1:-1,p=b<0||0===b&&1/b<0?1:0;for(b=Math.abs(b),isNaN(b)||b===1/0?(h=isNaN(b)?1:0,g=k):(g=Math.floor(Math.log(b)/Math.LN2),b*(i=Math.pow(2,-g))<1&&(g--,i*=2),b+=g+l>=1?m/i:m*Math.pow(2,1-l),b*i>=2&&(g++,i/=2),g+l>=k?(h=0,g=k):g+l>=1?(h=(b*i-1)*Math.pow(2,e),g+=l):(h=b*Math.pow(2,l-1)*Math.pow(2,e),g=0));e>=8;a[c+n]=255&h,n+=o,h/=256,e-=8);for(g=g<<e|h,j+=e;j>0;a[c+n]=255&g,n+=o,g/=256,j-=8);a[c+n-o]|=128*p}},{}],136:[function(a,b,c){(function(a){"use strict";function c(){k=!0;for(var a,b,c=l.length;c;){for(b=l,l=[],a=-1;++a<c;)b[a]();c=l.length}k=!1}function d(a){1!==l.push(a)||k||e()}var e,f=a.MutationObserver||a.WebKitMutationObserver;if(f){var g=0,h=new f(c),i=a.document.createTextNode("");h.observe(i,{characterData:!0}),e=function(){i.data=g=++g%2}}else if(a.setImmediate||void 0===a.MessageChannel)e="document"in a&&"onreadystatechange"in a.document.createElement("script")?function(){var b=a.document.createElement("script");b.onreadystatechange=function(){c(),b.onreadystatechange=null,b.parentNode.removeChild(b),b=null},a.document.documentElement.appendChild(b)}:function(){setTimeout(c,0)};else{var j=new a.MessageChannel;j.port1.onmessage=c,e=function(){j.port2.postMessage(0)}}var k,l=[];b.exports=d}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],137:[function(a,b,c){"function"==typeof Object.create?b.exports=function(a,b){a.super_=b,a.prototype=Object.create(b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}})}:b.exports=function(a,b){a.super_=b;var c=function(){};c.prototype=b.prototype,a.prototype=new c,a.prototype.constructor=a}},{}],138:[function(a,b,c){function d(a){return!!a.constructor&&"function"==typeof a.constructor.isBuffer&&a.constructor.isBuffer(a)}function e(a){return"function"==typeof a.readFloatLE&&"function"==typeof a.slice&&d(a.slice(0,0))}b.exports=function(a){return null!=a&&(d(a)||e(a)||!!a._isBuffer)}},{}],139:[function(b,c,d){(function(e){(function(){"use strict";function f(a){function b(a,b){var c=-1,d=0,e=a.length,f=[];for(b=b||0,c+=b;++c<e;)f[d++]=a[c];return f}function c(a){var b=[];for(var c in a)R.call(a,c)&&b.push(c);return b}function d(a,b){if(a===b)return!0;if(void 0!==e&&e.isBuffer(a)&&e.isBuffer(b)){if(a.length!==b.length)return!1;for(var c=0;c<a.length;c++)if(a[c]!==b[c])return!1;return!0}return q(a)&&q(b)?a.getTime()===b.getTime():p(a)&&p(b)?a.source===b.source&&a.global===b.global&&a.multiline===b.multiline&&a.lastIndex===b.lastIndex&&a.ignoreCase===b.ignoreCase:(!r(a)||!r(b)||a===b)&&("object"!=typeof a&&"object"!=typeof b?a===b:f(a,b))}function f(a,b){var e;if(m(a)||m(b))return!1;if(a.prototype!==b.prototype)return!1;if(U(a))return!!U(b)&&(a=Q.call(a),b=Q.call(b),d(a,b));try{var f,g=c(a),h=c(b);if(g.length!==h.length)return!1;for(g.sort(),h.sort(),f=g.length-1;f>=0;f--)if(g[f]!==h[f])return!1;for(f=g.length-1;f>=0;f--)if(e=g[f],!d(a[e],b[e]))return!1}catch(a){return!1}return!0}function g(a){return null!==a&&"object"==typeof a}function h(a){return g(a)&&a.constructor===Object&&!a.nodeType&&!a.setInterval}function i(a){return U(a)?0===a.length:g(a)?0===c(a).length:!r(a)&&!V(a)||0===a.length}function j(a){return!0===a||!1===a||"[object Boolean]"===S.call(a)}function k(a){return void 0===a}function l(a){return!k(a)}function m(a){return k(a)||n(a)}function n(a){return null===a}function o(a,b){return!!T(b)&&a instanceof b}function p(a){
/src/dist/exceljs.min.js:11:return"[object RegExp]"===S.call(a)}function q(a){return"[object Date]"===S.call(a)}function r(a){return"[object String]"===S.call(a)}function s(a){return"[object Number]"===S.call(a)}function t(a){return!0===a}function u(a){return!1===a}function v(a){return!n(a)}function w(a,b){return a==b}function x(a,b){return a!=b}function y(a,b){return a===b}function z(a,b){return a!==b}function A(a,b){if(V(b)&&Array.prototype.indexOf||r(b))return b.indexOf(a)>-1;if(V(b))for(var c=0,d=b.length;c<d;c++)if(w(a,b[c]))return!0;return!1}function B(a,b){return!A(a,b)}function C(a,b){return a<b}function D(a,b){return a<=b}function E(a,b){return a>b}function F(a,b){return a>=b}function G(a,b){return r(b)?null!==(""+a).match(b):!!p(b)&&b.test(a)}function H(a,b){return!G(a,b)}function I(a,b){return A(b,a)}function J(a,b){return!A(b,a)}function K(a,b,c){return!!(V(a)&&a.length>c)&&w(a[c],b)}function L(a,b,c){return!!V(a)&&!w(a[c],b)}function M(a,b){return R.call(a,b)}function N(a,b){return!M(a,b)}function O(a,b){return!!M(a,"length")&&a.length===b}function P(a,b){return!!M(a,"length")&&a.length!==b}var Q=Array.prototype.slice,R=Object.prototype.hasOwnProperty,S=Object.prototype.toString,T=function(a){return"[object Function]"===S.call(a)};"undefined"==typeof window||T(window.alert)||function(a){T=function(b){return"[object Function]"===S.call(b)||b===a}}(window.alert);var U=function(a){return"[object Arguments]"===S.call(a)};U(arguments)||(U=function(a){return!(!a||!R.call(a,"callee"))});var V=Array.isArray||function(a){return"[object Array]"===S.call(a)},W={isFunction:T,isObject:g,isEmpty:i,isHash:h,isNumber:s,isString:r,isDate:q,isArray:V,isBoolean:j,isUndefined:k,isDefined:l,isUndefinedOrNull:m,isNull:n,isArguments:U,instanceOf:o,isRegExp:p,deepEqual:d,isTrue:t,isFalse:u,isNotNull:v,isEq:w,isNeq:x,isSeq:y,isSneq:z,isIn:A,isNotIn:B,isLt:C,isLte:D,isGt:E,isGte:F,isLike:G,isNotLike:H,contains:I,notContains:J,has:M,notHas:N,isLength:O,isNotLength:P,containsAt:K,notContainsAt:L},X={constructor:function(){this._testers=[]},noWrap:{tester:function(){var a=this._testers;return function(b){for(var c=!1,d=0,e=a.length;d<e&&!c;d++)c=a[d](b);return c}}}},Y={constructor:function(){this._cases=[],this.__default=null},def:function(a,b){this.__default=b},noWrap:{switcher:function(){var a=this._cases,c=this.__default;return function(){for(var d,e=b(arguments),f=0,g=a.length;f<g;f++)if(d=a[f](e),d.length>1&&(d[1]||d[0]))return d[1];if(c)return c.apply(this,e)}}}};for(var Z in W)R.call(W,Z)&&(function(a){Y[a]=function(){var c,d=b(arguments,1),e=W[a],f=!0;if(d.length<=e.length-1)throw new TypeError("A handler must be defined when calling using switch");if(c=d.pop(),j(c)&&(f=c,c=d.pop()),!T(c))throw new TypeError("handler must be defined");this._cases.push(function(a){return e.apply(W,a.concat(d))?[f,c.apply(this,a)]:[!1]})}}(Z),function(a){X[a]=function(){this._testers.push(W[a])}}(Z));var $=a.define(W).expose(W);return $.tester=a.define(X),$.switcher=a.define(Y),$}void 0!==d?void 0!==c&&c.exports&&(c.exports=f(b("extended"))):"function"==typeof a&&a.amd?a(["extended"],function(a){return f(a)}):this.isExtended=f(this.extended)}).call(this)}).call(this,b("buffer").Buffer)},{buffer:94,extended:121}],140:[function(a,b,c){var d={}.toString;b.exports=Array.isArray||function(a){return"[object Array]"==d.call(a)}},{}],141:[function(a,b,c){"use strict";var d=a("./utils"),e=a("./support"),f="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";c.encode=function(a){for(var b,c,e,g,h,i,j,k=[],l=0,m=a.length,n=m,o="string"!==d.getTypeOf(a);l<a.length;)n=m-l,o?(b=a[l++],c=l<m?a[l++]:0,e=l<m?a[l++]:0):(b=a.charCodeAt(l++),c=l<m?a.charCodeAt(l++):0,e=l<m?a.charCodeAt(l++):0),g=b>>2,h=(3&b)<<4|c>>4,i=n>1?(15&c)<<2|e>>6:64,j=n>2?63&e:64,k.push(f.charAt(g)+f.charAt(h)+f.charAt(i)+f.charAt(j));return k.join("")},c.decode=function(a){var b,c,d,g,h,i,j,k=0,l=0;if("data:"===a.substr(0,"data:".length))throw new Error("Invalid base64 input, it looks like a data url.");a=a.replace(/[^A-Za-z0-9\+\/\=]/g,"");var m=3*a.length/4;if(a.charAt(a.length-1)===f.charAt(64)&&m--,a.charAt(a.length-2)===f.charAt(64)&&m--,m%1!=0)throw new Error("Invalid base64 input, bad content length.");var n;for(n=e.uint8array?new Uint8Array(0|m):new Array(0|m);k<a.length;)g=f.indexOf(a.charAt(k++)),h=f.indexOf(a.charAt(k++)),i=f.indexOf(a.charAt(k++)),j=f.indexOf(a.charAt(k++)),b=g<<2|h>>4,c=(15&h)<<4|i>>2,d=(3&i)<<6|j,n[l++]=b,64!==i&&(n[l++]=c),64!==j&&(n[l++]=d);return n}},{"./support":170,"./utils":172}],142:[function(a,b,c){"use strict";function d(a,b,c,d,e){this.compressedSize=a,this.uncompressedSize=b,this.crc32=c,this.compression=d,this.compressedContent=e}var e=a("./external"),f=a("./stream/DataWorker"),g=a("./stream/DataLengthProbe"),h=a("./stream/Crc32Probe"),g=a("./stream/DataLengthProbe");d.prototype={getContentWorker:function(){var a=new f(e.Promise.resolve(this.compressedContent)).pipe(this.compression.uncompressWorker()).pipe(new g("data_length")),b=this;return a.on("end",function(){if(this.streamInfo.data_length!==b.uncompressedSize)throw new Error("Bug : uncompressed data size mismatch")}),a},getCompressedWorker:function(){return new f(e.Promise.resolve(this.compressedContent)).withStreamInfo("compressedSize",this.compressedSize).withStreamInfo("uncompressedSize",this.uncompressedSize).withStreamInfo("crc32",this.crc32).withStreamInfo("compression",this.compression)}},d.createWorkerFrom=function(a,b,c){return a.pipe(new h).pipe(new g("uncompressedSize")).pipe(b.compressWorker(c)).pipe(new g("compressedSize")).withStreamInfo("compression",b)},b.exports=d},{"./external":146,"./stream/Crc32Probe":165,"./stream/DataLengthProbe":166,"./stream/DataWorker":167}],143:[function(a,b,c){"use strict";var d=a("./stream/GenericWorker");c.STORE={magic:"\0\0",compressWorker:function(a){return new d("STORE compression")},uncompressWorker:function(){return new d("STORE decompression")}},c.DEFLATE=a("./flate")},{"./flate":147,"./stream/GenericWorker":168}],144:[function(a,b,c){"use strict";function d(a,b,c,d){var e=g,f=d+c;a^=-1;for(var h=d;h<f;h++)a=a>>>8^e[255&(a^b[h])];return-1^a}function e(a,b,c,d){var e=g,f=d+c;a^=-1;for(var h=d;h<f;h++)a=a>>>8^e[255&(a^b.charCodeAt(h))];return-1^a}var f=a("./utils"),g=function(){for(var a,b=[],c=0;c<256;c++){a=c;for(var d=0;d<8;d++)a=1&a?3988292384^a>>>1:a>>>1;b[c]=a}return b}();b.exports=function(a,b){return void 0!==a&&a.length?"string"!==f.getTypeOf(a)?d(0|b,a,a.length,0):e(0|b,a,a.length,0):0}},{"./utils":172}],145:[function(a,b,c){"use strict";c.base64=!1,c.binary=!1,c.dir=!1,c.createFolders=!0,c.date=null,c.compression=null,c.compressionOptions=null,c.comment=null,c.unixPermissions=null,c.dosPermissions=null},{}],146:[function(a,b,c){"use strict";var d=null;d="undefined"!=typeof Promise?Promise:a("lie"),b.exports={Promise:d}},{lie:176}],147:[function(a,b,c){"use strict";function d(a,b){h.call(this,"FlateWorker/"+a),this._pako=new f[a]({raw:!0,level:b.level||-1}),this.meta={};var c=this;this._pako.onData=function(a){c.push({data:a,meta:c.meta})}}var e="undefined"!=typeof Uint8Array&&"undefined"!=typeof Uint16Array&&"undefined"!=typeof Uint32Array,f=a("pako"),g=a("./utils"),h=a("./stream/GenericWorker"),i=e?"uint8array":"array";c.magic="\b\0",g.inherits(d,h),d.prototype.processChunk=function(a){this.meta=a.meta,this._pako.push(g.transformTo(i,a.data),!1)},d.prototype.flush=function(){h.prototype.flush.call(this),this._pako.push([],!0)},d.prototype.cleanUp=function(){h.prototype.cleanUp.call(this),this._pako=null},c.compressWorker=function(a){return new d("Deflate",a)},c.uncompressWorker=function(){return new d("Inflate",{})}},{"./stream/GenericWorker":168,"./utils":172,pako:180}],148:[function(a,b,c){"use strict";function d(a,b,c,d){f.call(this,"ZipFileWorker"),this.bytesWritten=0,this.zipComment=b,this.zipPlatform=c,this.encodeFileName=d,this.streamFiles=a,this.accumulate=!1,this.contentBuffer=[],this.dirRecords=[],this.currentSourceOffset=0,this.entriesCount=0,this.currentFile=null,this._sources=[]}var e=a("../utils"),f=a("../stream/GenericWorker"),g=a("../utf8"),h=a("../crc32"),i=a("../signature"),j=function(a,b){var c,d="";for(c=0;c<b;c++)d+=String.fromCharCode(255&a),a>>>=8;return d},k=function(a,b){var c=a;return a||(c=b?16893:33204),(65535&c)<<16},l=function(a,b){return 63&(a||0)},m=function(a,b,c,d,f,m){var n,o,p=a.file,q=a.compression,r=m!==g.utf8encode,s=e.transformTo("string",m(p.name)),t=e.transformTo("string",g.utf8encode(p.name)),u=p.comment,v=e.transformTo("string",m(u)),w=e.transformTo("string",g.utf8encode(u)),x=t.length!==p.name.length,y=w.length!==u.length,z="",A="",B="",C=p.dir,D=p.date,E={crc32:0,compressedSize:0,uncompressedSize:0};b&&!c||(E.crc32=a.crc32,E.compressedSize=a.compressedSize,E.uncompressedSize=a.uncompressedSize);var F=0;b&&(F|=8),r||!x&&!y||(F|=2048);var G=0,H=0;C&&(G|=16),"UNIX"===f?(H=798,G|=k(p.unixPermissions,C)):(H=20,G|=l(p.dosPermissions)),n=D.getUTCHours(),n<<=6,n|=D.getUTCMinutes(),n<<=5,n|=D.getUTCSeconds()/2,o=D.getUTCFullYear()-1980,o<<=4,o|=D.getUTCMonth()+1,o<<=5,o|=D.getUTCDate(),x&&(A=j(1,1)+j(h(s),4)+t,z+="up"+j(A.length,2)+A),y&&(B=j(1,1)+j(h(v),4)+w,z+="uc"+j(B.length,2)+B);var I="";return I+="\n\0",I+=j(F,2),I+=q.magic,I+=j(n,2),I+=j(o,2),I+=j(E.crc32,4),I+=j(E.compressedSize,4),I+=j(E.uncompressedSize,4),I+=j(s.length,2),I+=j(z.length,2),{fileRecord:i.LOCAL_FILE_HEADER+I+s+z,dirRecord:i.CENTRAL_FILE_HEADER+j(H,2)+I+j(v.length,2)+"\0\0\0\0"+j(G,4)+j(d,4)+s+z+v}},n=function(a,b,c,d,f){var g=e.transformTo("string",f(d));return i.CENTRAL_DIRECTORY_END+"\0\0\0\0"+j(a,2)+j(a,2)+j(b,4)+j(c,4)+j(g.length,2)+g},o=function(a){return i.DATA_DESCRIPTOR+j(a.crc32,4)+j(a.compressedSize,4)+j(a.uncompressedSize,4)};e.inherits(d,f),d.prototype.push=function(a){var b=a.meta.percent||0,c=this.entriesCount,d=this._sources.length;this.accumulate?this.contentBuffer.push(a):(this.bytesWritten+=a.data.length,f.prototype.push.call(this,{data:a.data,meta:{currentFile:this.currentFile,percent:c?(b+100*(c-d-1))/c:100}}))},d.prototype.openedSource=function(a){this.currentSourceOffset=this.bytesWritten,this.currentFile=a.file.name;var b=this.streamFiles&&!a.file.dir;if(b){var c=m(a,b,!1,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);this.push({data:c.fileRecord,meta:{percent:0}})}else this.accumulate=!0},d.prototype.closedSource=function(a){this.accumulate=!1;var b=this.streamFiles&&!a.file.dir,c=m(a,b,!0,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);if(this.dirRecords.push(c.dirRecord),b)this.push({data:o(a),meta:{percent:100}});else for(this.push({data:c.fileRecord,meta:{percent:0}});this.contentBuffer.length;)this.push(this.contentBuffer.shift());this.currentFile=null},d.prototype.flush=function(){for(var a=this.bytesWritten,b=0;b<this.dirRecords.length;b++)this.push({data:this.dirRecords[b],meta:{percent:100}});var c=this.bytesWritten-a,d=n(this.dirRecords.length,c,a,this.zipComment,this.encodeFileName);this.push({data:d,meta:{percent:100}})},d.prototype.prepareNextSource=function(){this.previous=this._sources.shift(),this.openedSource(this.previous.streamInfo),this.isPaused?this.previous.pause():this.previous.resume()},d.prototype.registerPrevious=function(a){this._sources.push(a);var b=this;return a.on("data",function(a){b.processChunk(a)}),a.on("end",function(){b.closedSource(b.previous.streamInfo),b._sources.length?b.prepareNextSource():b.end()}),a.on("error",function(a){b.error(a)}),this},d.prototype.resume=function(){return!!f.prototype.resume.call(this)&&(!this.previous&&this._sources.length?(this.prepareNextSource(),!0):this.previous||this._sources.length||this.generatedError?void 0:(this.end(),!0))},d.prototype.error=function(a){var b=this._sources;if(!f.prototype.error.call(this,a))return!1;for(var c=0;c<b.length;c++)try{b[c].error(a)}catch(a){}return!0},d.prototype.lock=function(){f.prototype.lock.call(this);for(var a=this._sources,b=0;b<a.length;b++)a[b].lock()},b.exports=d},{"../crc32":144,"../signature":163,"../stream/GenericWorker":168,"../utf8":171,"../utils":172}],149:[function(a,b,c){"use strict";var d=a("../compressions"),e=a("./ZipFileWorker"),f=function(a,b){var c=a||b,e=d[c];if(!e)throw new Error(c+" is not a valid compression method !");return e};c.generateWorker=function(a,b,c){var d=new e(b.streamFiles,c,b.platform,b.encodeFileName),g=0;try{a.forEach(function(a,c){g++;var e=f(c.options.compression,b.compression),h=c.options.compressionOptions||b.compressionOptions||{},i=c.dir,j=c.date;c._compressWorker(e,h).withStreamInfo("file",{name:a,dir:i,date:j,comment:c.comment||"",unixPermissions:c.unixPermissions,dosPermissions:c.dosPermissions}).pipe(d)}),d.entriesCount=g}catch(a){d.error(a)}return d}},{"../compressions":143,"./ZipFileWorker":148}],150:[function(a,b,c){"use strict";function d(){if(!(this instanceof d))return new d;if(arguments.length)throw new Error("The constructor with parameters has been removed in JSZip 3.0, please check the upgrade guide.");this.files={},this.comment=null,this.root="",this.clone=function(){var a=new d;for(var b in this)"function"!=typeof this[b]&&(a[b]=this[b]);return a}}d.prototype=a("./object"),d.prototype.loadAsync=a("./load"),d.support=a("./support"),d.defaults=a("./defaults"),d.version="3.1.3",d.loadAsync=function(a,b){return(new d).loadAsync(a,b)},d.external=a("./external"),b.exports=d},{"./defaults":145,"./external":146,"./load":151,"./object":155,"./support":170}],151:[function(a,b,c){"use strict";function d(a){return new f.Promise(function(b,c){var d=a.decompressed.getContentWorker().pipe(new i);d.on("error",function(a){c(a)}).on("end",function(){d.streamInfo.crc32!==a.decompressed.crc32?c(new Error("Corrupted zip : CRC32 mismatch")):b()}).resume()})}var e=a("./utils"),f=a("./external"),g=a("./utf8"),e=a("./utils"),h=a("./zipEntries"),i=a("./stream/Crc32Probe"),j=a("./nodejsUtils");b.exports=function(a,b){var c=this;return b=e.extend(b||{},{base64:!1,checkCRC32:!1,optimizedBinaryString:!1,createFolders:!1,decodeFileName:g.utf8decode}),j.isNode&&j.isStream(a)?f.Promise.reject(new Error("JSZip can't accept a stream when loading a zip file.")):e.prepareContent("the loaded zip file",a,!0,b.optimizedBinaryString,b.base64).then(function(a){var c=new h(b);return c.load(a),c}).then(function(a){var c=[f.Promise.resolve(a)],e=a.files;if(b.checkCRC32)for(var g=0;g<e.length;g++)c.push(d(e[g]));return f.Promise.all(c)}).then(function(a){for(var d=a.shift(),e=d.files,f=0;f<e.length;f++){var g=e[f];c.file(g.fileNameStr,g.decompressed,{binary:!0,optimizedBinaryString:!0,date:g.date,dir:g.dir,comment:g.fileCommentStr.length?g.fileCommentStr:null,unixPermissions:g.unixPermissions,dosPermissions:g.dosPermissions,createFolders:b.createFolders})}return d.zipComment.length&&(c.comment=d.zipComment),c})}},{"./external":146,"./nodejsUtils":154,"./stream/Crc32Probe":165,"./utf8":171,"./utils":172,"./zipEntries":173}],152:[function(a,b,c){"use strict";function d(a,b){f.call(this,"Nodejs stream input adapter for "+a),this._upstreamEnded=!1,this._bindStream(b)}var e=a("../utils"),f=a("../stream/GenericWorker");e.inherits(d,f),d.prototype._bindStream=function(a){var b=this;this._stream=a,a.pause(),a.on("data",function(a){b.push({data:a,meta:{percent:0}})}).on("error",function(a){b.isPaused?this.generatedError=a:b.error(a)}).on("end",function(){b.isPaused?b._upstreamEnded=!0:b.end()})},d.prototype.pause=function(){return!!f.prototype.pause.call(this)&&(this._stream.pause(),!0)},d.prototype.resume=function(){return!!f.prototype.resume.call(this)&&(this._upstreamEnded?this.end():this._stream.resume(),!0)},b.exports=d},{"../stream/GenericWorker":168,"../utils":172}],153:[function(a,b,c){"use strict";function d(a,b,c){e.call(this,b),this._helper=a;var d=this;a.on("data",function(a,b){d.push(a)||d._helper.pause(),c&&c(b)}).on("error",function(a){d.emit("error",a)}).on("end",function(){d.push(null)})}var e=a("readable-stream").Readable;a("util").inherits(d,e),d.prototype._read=function(){this._helper.resume()},b.exports=d},{"readable-stream":156,util:221}],154:[function(a,b,c){(function(a){"use strict";b.exports={isNode:void 0!==a,newBuffer:function(b,c){return new a(b,c)},isBuffer:function(b){return a.isBuffer(b)},isStream:function(a){return a&&"function"==typeof a.on&&"function"==typeof a.pause&&"function"==typeof a.resume}}}).call(this,a("buffer").Buffer)},{buffer:94}],155:[function(a,b,c){"use strict";function d(a){return"[object RegExp]"===Object.prototype.toString.call(a)}var e=a("./utf8"),f=a("./utils"),g=a("./stream/GenericWorker"),h=a("./stream/StreamHelper"),i=a("./defaults"),j=a("./compressedObject"),k=a("./zipObject"),l=a("./generate"),m=a("./nodejsUtils"),n=a("./nodejs/NodejsStreamInputAdapter"),o=function(a,b,c){var d,e=f.getTypeOf(b),h=f.extend(c||{},i);h.date=h.date||new Date,null!==h.compression&&(h.compression=h.compression.toUpperCase()),"string"==typeof h.unixPermissions&&(h.unixPermissions=parseInt(h.unixPermissions,8)),h.unixPermissions&&16384&h.unixPermissions&&(h.dir=!0),h.dosPermissions&&16&h.dosPermissions&&(h.dir=!0),h.dir&&(a=q(a)),h.createFolders&&(d=p(a))&&r.call(this,d,!0);var l="string"===e&&!1===h.binary&&!1===h.base64;c&&void 0!==c.binary||(h.binary=!l),(b instanceof j&&0===b.uncompressedSize||h.dir||!b||0===b.length)&&(h.base64=!1,h.binary=!0,b="",h.compression="STORE",e="string");var o=null;o=b instanceof j||b instanceof g?b:m.isNode&&m.isStream(b)?new n(a,b):f.prepareContent(a,b,h.binary,h.optimizedBinaryString,h.base64);var s=new k(a,o,h);this.files[a]=s},p=function(a){"/"===a.slice(-1)&&(a=a.substring(0,a.length-1));var b=a.lastIndexOf("/");return b>0?a.substring(0,b):""},q=function(a){return"/"!==a.slice(-1)&&(a+="/"),a},r=function(a,b){return b=void 0!==b?b:i.createFolders,a=q(a),this.files[a]||o.call(this,a,null,{dir:!0,createFolders:b}),this.files[a]},s={load:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},forEach:function(a){var b,c,d;for(b in this.files)this.files.hasOwnProperty(b)&&(d=this.files[b],(c=b.slice(this.root.length,b.length))&&b.slice(0,this.root.length)===this.root&&a(c,d))},filter:function(a){var b=[];return this.forEach(function(c,d){a(c,d)&&b.push(d)}),b},file:function(a,b,c){if(1===arguments.length){if(d(a)){var e=a;return this.filter(function(a,b){return!b.dir&&e.test(a)})}var f=this.files[this.root+a];return f&&!f.dir?f:null}return a=this.root+a,o.call(this,a,b,c),this},folder:function(a){if(!a)return this;if(d(a))return this.filter(function(b,c){return c.dir&&a.test(b)});var b=this.root+a,c=r.call(this,b),e=this.clone();return e.root=c.name,e},remove:function(a){a=this.root+a;var b=this.files[a];if(b||("/"!==a.slice(-1)&&(a+="/"),b=this.files[a]),b&&!b.dir)delete this.files[a];else for(var c=this.filter(function(b,c){return c.name.slice(0,a.length)===a}),d=0;d<c.length;d++)delete this.files[c[d].name];return this},generate:function(a){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},generateInternalStream:function(a){var b,c={};try{if(c=f.extend(a||{},{streamFiles:!1,compression:"STORE",compressionOptions:null,type:"",platform:"DOS",comment:null,mimeType:"application/zip",encodeFileName:e.utf8encode}),c.type=c.type.toLowerCase(),c.compression=c.compression.toUpperCase(),"binarystring"===c.type&&(c.type="string"),!c.type)throw new Error("No output type specified.");f.checkSupport(c.type),"darwin"!==c.platform&&"freebsd"!==c.platform&&"linux"!==c.platform&&"sunos"!==c.platform||(c.platform="UNIX"),"win32"===c.platform&&(c.platform="DOS");var d=c.comment||this.comment||"";b=l.generateWorker(this,c,d)}catch(a){b=new g("error"),b.error(a)}return new h(b,c.type||"string",c.mimeType)},generateAsync:function(a,b){return this.generateInternalStream(a).accumulate(b)},generateNodeStream:function(a,b){return a=a||{},a.type||(a.type="nodebuffer"),this.generateInternalStream(a).toNodejsStream(b)}};b.exports=s},{"./compressedObject":142,"./defaults":145,"./generate":149,"./nodejs/NodejsStreamInputAdapter":152,"./nodejsUtils":154,"./stream/GenericWorker":168,"./stream/StreamHelper":169,"./utf8":171,"./utils":172,"./zipObject":175}],156:[function(a,b,c){b.exports=a("stream")},{stream:215}],157:[function(a,b,c){"use strict";function d(a){e.call(this,a);for(var b=0;b<this.data.length;b++)a[b]=255&a[b]}var e=a("./DataReader");a("../utils").inherits(d,e),d.prototype.byteAt=function(a){return this.data[this.zero+a]},d.prototype.lastIndexOfSignature=function(a){for(var b=a.charCodeAt(0),c=a.charCodeAt(1),d=a.charCodeAt(2),e=a.charCodeAt(3),f=this.length-4;f>=0;--f)if(this.data[f]===b&&this.data[f+1]===c&&this.data[f+2]===d&&this.data[f+3]===e)return f-this.zero;return-1},d.prototype.readAndCheckSignature=function(a){var b=a.charCodeAt(0),c=a.charCodeAt(1),d=a.charCodeAt(2),e=a.charCodeAt(3),f=this.readData(4);return b===f[0]&&c===f[1]&&d===f[2]&&e===f[3]},d.prototype.readData=function(a){if(this.checkOffset(a),0===a)return[];var b=this.data.slice(this.zero+this.index,this.zero+this.index+a);return this.index+=a,b},b.exports=d},{"../utils":172,"./DataReader":158}],158:[function(a,b,c){"use strict";function d(a){this.data=a,this.length=a.length,this.index=0,this.zero=0}var e=a("../utils");d.prototype={checkOffset:function(a){this.checkIndex(this.index+a)},checkIndex:function(a){if(this.length<this.zero+a||a<0)throw new Error("End of data reached (data length = "+this.length+", asked index = "+a+"). Corrupted zip ?")},setIndex:function(a){this.checkIndex(a),this.index=a},skip:function(a){this.setIndex(this.index+a)},byteAt:function(a){},readInt:function(a){var b,c=0;for(this.checkOffset(a),b=this.index+a-1;b>=this.index;b--)c=(c<<8)+this.byteAt(b);return this.index+=a,c},readString:function(a){return e.transformTo("string",this.readData(a))},readData:function(a){},lastIndexOfSignature:function(a){},readAndCheckSignature:function(a){},readDate:function(){var a=this.readInt(4);return new Date(Date.UTC(1980+(a>>25&127),(a>>21&15)-1,a>>16&31,a>>11&31,a>>5&63,(31&a)<<1))}},b.exports=d},{"../utils":172}],159:[function(a,b,c){"use strict";function d(a){e.call(this,a)}var e=a("./Uint8ArrayReader");a("../utils").inherits(d,e),d.prototype.readData=function(a){this.checkOffset(a);var b=this.data.slice(this.zero+this.index,this.zero+this.index+a);return this.index+=a,b},b.exports=d},{"../utils":172,"./Uint8ArrayReader":161}],160:[function(a,b,c){"use strict";function d(a){e.call(this,a)}var e=a("./DataReader");a("../utils").inherits(d,e),d.prototype.byteAt=function(a){return this.data.charCodeAt(this.zero+a)},d.prototype.lastIndexOfSignature=function(a){return this.data.lastIndexOf(a)-this.zero},d.prototype.readAndCheckSignature=function(a){return a===this.readData(4)},d.prototype.readData=function(a){this.checkOffset(a);var b=this.data.slice(this.zero+this.index,this.zero+this.index+a);return this.index+=a,b},b.exports=d},{"../utils":172,"./DataReader":158}],161:[function(a,b,c){"use strict";function d(a){e.call(this,a)}var e=a("./ArrayReader");a("../utils").inherits(d,e),d.prototype.readData=function(a){if(this.checkOffset(a),0===a)return new Uint8Array(0);var b=this.data.subarray(this.zero+this.index,this.zero+this.index+a);return this.index+=a,b},b.exports=d},{"../utils":172,"./ArrayReader":157}],162:[function(a,b,c){"use strict";var d=a("../utils"),e=a("../support"),f=a("./ArrayReader"),g=a("./StringReader"),h=a("./NodeBufferReader"),i=a("./Uint8ArrayReader");b.exports=function(a){var b=d.getTypeOf(a);return d.checkSupport(b),"string"!==b||e.uint8array?"nodebuffer"===b?new h(a):e.uint8array?new i(d.transformTo("uint8array",a)):new f(d.transformTo("array",a)):new g(a)}},{"../support":170,"../utils":172,"./ArrayReader":157,"./NodeBufferReader":159,"./StringReader":160,"./Uint8ArrayReader":161}],163:[function(a,b,c){"use strict";c.LOCAL_FILE_HEADER="PK",c.CENTRAL_FILE_HEADER="PK",c.CENTRAL_DIRECTORY_END="PK",c.ZIP64_CENTRAL_DIRECTORY_LOCATOR="PK",c.ZIP64_CENTRAL_DIRECTORY_END="PK",c.DATA_DESCRIPTOR="PK\b"},{}],164:[function(a,b,c){"use strict";function d(a){e.call(this,"ConvertWorker to "+a),this.destType=a}var e=a("./GenericWorker"),f=a("../utils");f.inherits(d,e),d.prototype.processChunk=function(a){this.push({data:f.transformTo(this.destType,a.data),meta:a.meta})},b.exports=d},{"../utils":172,"./GenericWorker":168}],165:[function(a,b,c){"use strict";function d(){e.call(this,"Crc32Probe"),this.withStreamInfo("crc32",0)}var e=a("./GenericWorker"),f=a("../crc32");a("../utils").inherits(d,e),d.prototype.processChunk=function(a){this.streamInfo.crc32=f(a.data,this.streamInfo.crc32||0),this.push(a)},b.exports=d},{"../crc32":144,"../utils":172,"./GenericWorker":168}],166:[function(a,b,c){"use strict";function d(a){f.call(this,"DataLengthProbe for "+a),this.propName=a,this.withStreamInfo(a,0)}var e=a("../utils"),f=a("./GenericWorker");e.inherits(d,f),d.prototype.processChunk=function(a){if(a){var b=this.streamInfo[this.propName]||0;this.streamInfo[this.propName]=b+a.data.length}f.prototype.processChunk.call(this,a)},b.exports=d},{"../utils":172,"./GenericWorker":168}],167:[function(a,b,c){"use strict";function d(a){f.call(this,"DataWorker");var b=this;this.dataIsReady=!1,this.index=0,this.max=0,this.data=null,this.type="",this._tickScheduled=!1,a.then(function(a){b.dataIsReady=!0,b.data=a,b.max=a&&a.length||0,b.type=e.getTypeOf(a),b.isPaused||b._tickAndRepeat()},function(a){b.error(a)})}var e=a("../utils"),f=a("./GenericWorker");e.inherits(d,f),d.prototype.cleanUp=function(){f.prototype.cleanUp.call(this),this.data=null},d.prototype.resume=function(){return!!f.prototype.resume.call(this)&&(!this._tickScheduled&&this.dataIsReady&&(this._tickScheduled=!0,e.delay(this._tickAndRepeat,[],this)),!0)},d.prototype._tickAndRepeat=function(){this._tickScheduled=!1,this.isPaused||this.isFinished||(this._tick(),this.isFinished||(e.delay(this._tickAndRepeat,[],this),this._tickScheduled=!0))},d.prototype._tick=function(){if(this.isPaused||this.isFinished)return!1;var a=null,b=Math.min(this.max,this.index+16384);if(this.index>=this.max)return this.end();switch(this.type){case"string":a=this.data.substring(this.index,b);break;case"uint8array":a=this.data.subarray(this.index,b);break;case"array":case"nodebuffer":a=this.data.slice(this.index,b)}return this.index=b,this.push({data:a,meta:{percent:this.max?this.index/this.max*100:0}})},b.exports=d},{"../utils":172,"./GenericWorker":168}],168:[function(a,b,c){"use strict";function d(a){this.name=a||"default",this.streamInfo={},this.generatedError=null,this.extraStreamInfo={},this.isPaused=!0,this.isFinished=!1,this.isLocked=!1,this._listeners={data:[],end:[],error:[]},this.previous=null}d.prototype={push:function(a){this.emit("data",a)},end:function(){if(this.isFinished)return!1;this.flush();try{this.emit("end"),this.cleanUp(),this.isFinished=!0}catch(a){this.emit("error",a)}return!0},error:function(a){return!this.isFinished&&(this.isPaused?this.generatedError=a:(this.isFinished=!0,this.emit("error",a),this.previous&&this.previous.error(a),this.cleanUp()),!0)},on:function(a,b){return this._listeners[a].push(b),this},cleanUp:function(){this.streamInfo=this.generatedError=this.extraStreamInfo=null,this._listeners=[]},emit:function(a,b){if(this._listeners[a])for(var c=0;c<this._listeners[a].length;c++)this._listeners[a][c].call(this,b)},pipe:function(a){return a.registerPrevious(this)},registerPrevious:function(a){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.streamInfo=a.streamInfo,this.mergeStreamInfo(),this.previous=a;var b=this;return a.on("data",function(a){b.processChunk(a)}),a.on("end",function(){b.end()}),a.on("error",function(a){b.error(a)}),this},pause:function(){return!this.isPaused&&!this.isFinished&&(this.isPaused=!0,this.previous&&this.previous.pause(),!0)},resume:function(){if(!this.isPaused||this.isFinished)return!1;this.isPaused=!1;var a=!1;return this.generatedError&&(this.error(this.generatedError),a=!0),this.previous&&this.previous.resume(),!a},flush:function(){},processChunk:function(a){this.push(a)},withStreamInfo:function(a,b){return this.extraStreamInfo[a]=b,this.mergeStreamInfo(),this},mergeStreamInfo:function(){for(var a in this.extraStreamInfo)this.extraStreamInfo.hasOwnProperty(a)&&(this.streamInfo[a]=this.extraStreamInfo[a])},lock:function(){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.isLocked=!0,this.previous&&this.previous.lock()},toString:function(){var a="Worker "+this.name;return this.previous?this.previous+" -> "+a:a}},b.exports=d},{}],169:[function(a,b,c){(function(c){"use strict";function d(a,b,c,d){var f=null;switch(a){case"blob":return h.newBlob(c,d);case"base64":return f=e(b,c),k.encode(f);default:return f=e(b,c),h.transformTo(a,f)}}function e(a,b){var d,e=0,f=null,g=0;for(d=0;d<b.length;d++)g+=b[d].length;switch(a){case"string":return b.join("");case"array":return Array.prototype.concat.apply([],b);case"uint8array":for(f=new Uint8Array(g),d=0;d<b.length;d++)f.set(b[d],e),e+=b[d].length;return f;case"nodebuffer":return c.concat(b);default:throw new Error("concat : unsupported type '"+a+"'")}}function f(a,b){return new m.Promise(function(c,e){var f=[],g=a._internalType,h=a._outputType,i=a._mimeType;a.on("data",function(a,c){f.push(a),b&&b(c)}).on("error",function(a){f=[],e(a)}).on("end",function(){try{var a=d(h,g,f,i);c(a)}catch(a){e(a)}f=[]}).resume()})}function g(a,b,c){var d=b;switch(b){case"blob":d="arraybuffer";break;case"arraybuffer":d="uint8array";break;case"base64":d="string"}try{this._internalType=d,this._outputType=b,this._mimeType=c,h.checkSupport(d),this._worker=a.pipe(new i(d)),a.lock()}catch(a){this._worker=new j("error"),this._worker.error(a)}}var h=a("../utils"),i=a("./ConvertWorker"),j=a("./GenericWorker"),k=a("../base64"),l=a("../support"),m=a("../external"),n=null;if(l.nodestream)try{n=a("../nodejs/NodejsStreamOutputAdapter")}catch(a){}g.prototype={accumulate:function(a){return f(this,a)},on:function(a,b){var c=this;return"data"===a?this._worker.on(a,function(a){b.call(c,a.data,a.meta)}):this._worker.on(a,function(){h.delay(b,arguments,c)}),this},resume:function(){return h.delay(this._worker.resume,[],this._worker),this},pause:function(){return this._worker.pause(),this},toNodejsStream:function(a){if(h.checkSupport("nodestream"),"nodebuffer"!==this._outputType)throw new Error(this._outputType+" is not supported by this method");return new n(this,{objectMode:"nodebuffer"!==this._outputType},a)}},b.exports=g}).call(this,a("buffer").Buffer)},{"../base64":141,"../external":146,"../nodejs/NodejsStreamOutputAdapter":153,"../support":170,"../utils":172,"./ConvertWorker":164,"./GenericWorker":168,buffer:94}],170:[function(a,b,c){(function(b){"use strict";if(c.base64=!0,c.array=!0,c.string=!0,c.arraybuffer="undefined"!=typeof ArrayBuffer&&"undefined"!=typeof Uint8Array,c.nodebuffer=void 0!==b,c.uint8array="undefined"!=typeof Uint8Array,"undefined"==typeof ArrayBuffer)c.blob=!1;else{var d=new ArrayBuffer(0);try{c.blob=0===new Blob([d],{type:"application/zip"}).size}catch(a){try{var e=window.BlobBuilder||window.WebKitBlobBuilder||window.MozBlobBuilder||window.MSBlobBuilder,f=new e;f.append(d),c.blob=0===f.getBlob("application/zip").size}catch(a){c.blob=!1}}}try{c.nodestream=!!a("readable-stream").Readable}catch(a){c.nodestream=!1}}).call(this,a("buffer").Buffer)},{buffer:94,"readable-stream":156}],171:[function(a,b,c){"use strict";function d(){i.call(this,"utf-8 decode"),this.leftOver=null}function e(){i.call(this,"utf-8 encode")}for(var f=a("./utils"),g=a("./support"),h=a("./nodejsUtils"),i=a("./stream/GenericWorker"),j=new Array(256),k=0;k<256;k++)j[k]=k>=252?6:k>=248?5:k>=240?4:k>=224?3:k>=192?2:1;j[254]=j[254]=1;var l=function(a){var b,c,d,e,f,h=a.length,i=0;for(e=0;e<h;e++)c=a.charCodeAt(e),55296==(64512&c)&&e+1<h&&56320==(64512&(d=a.charCodeAt(e+1)))&&(c=65536+(c-55296<<10)+(d-56320),e++),i+=c<128?1:c<2048?2:c<65536?3:4;for(b=g.uint8array?new Uint8Array(i):new Array(i),f=0,e=0;f<i;e++)c=a.charCodeAt(e),
/src/dist/exceljs.min.js-12-55296==(64512&c)&&e+1<h&&56320==(64512&(d=a.charCodeAt(e+1)))&&(c=65536+(c-55296<<10)+(d-56320),e++),c<128?b[f++]=c:c<2048?(b[f++]=192|c>>>6,b[f++]=128|63&c):c<65536?(b[f++]=224|c>>>12,b[f++]=128|c>>>6&63,b[f++]=128|63&c):(b[f++]=240|c>>>18,b[f++]=128|c>>>12&63,b[f++]=128|c>>>6&63,b[f++]=128|63&c);return b},m=function(a,b){var c;for(b=b||a.length,b>a.length&&(b=a.length),c=b-1;c>=0&&128==(192&a[c]);)c--;return c<0?b:0===c?b:c+j[a[c]]>b?c:b},n=function(a){var b,c,d,e,g=a.length,h=new Array(2*g);for(c=0,b=0;b<g;)if((d=a[b++])<128)h[c++]=d;else if((e=j[d])>4)h[c++]=65533,b+=e-1;else{for(d&=2===e?31:3===e?15:7;e>1&&b<g;)d=d<<6|63&a[b++],e--;e>1?h[c++]=65533:d<65536?h[c++]=d:(d-=65536,h[c++]=55296|d>>10&1023,h[c++]=56320|1023&d)}return h.length!==c&&(h.subarray?h=h.subarray(0,c):h.length=c),f.applyFromCharCode(h)};c.utf8encode=function(a){return g.nodebuffer?h.newBuffer(a,"utf-8"):l(a)},c.utf8decode=function(a){return g.nodebuffer?f.transformTo("nodebuffer",a).toString("utf-8"):(a=f.transformTo(g.uint8array?"uint8array":"array",a),n(a))},f.inherits(d,i),d.prototype.processChunk=function(a){var b=f.transformTo(g.uint8array?"uint8array":"array",a.data);if(this.leftOver&&this.leftOver.length){if(g.uint8array){var d=b;b=new Uint8Array(d.length+this.leftOver.length),b.set(this.leftOver,0),b.set(d,this.leftOver.length)}else b=this.leftOver.concat(b);this.leftOver=null}var e=m(b),h=b;e!==b.length&&(g.uint8array?(h=b.subarray(0,e),this.leftOver=b.subarray(e,b.length)):(h=b.slice(0,e),this.leftOver=b.slice(e,b.length))),this.push({data:c.utf8decode(h),meta:a.meta})},d.prototype.flush=function(){this.leftOver&&this.leftOver.length&&(this.push({data:c.utf8decode(this.leftOver),meta:{}}),this.leftOver=null)},c.Utf8DecodeWorker=d,f.inherits(e,i),e.prototype.processChunk=function(a){this.push({data:c.utf8encode(a.data),meta:a.meta})},c.Utf8EncodeWorker=e},{"./nodejsUtils":154,"./stream/GenericWorker":168,"./support":170,"./utils":172}],172:[function(a,b,c){"use strict";function d(a){var b=null;return b=i.uint8array?new Uint8Array(a.length):new Array(a.length),f(a,b)}function e(a){return a}function f(a,b){for(var c=0;c<a.length;++c)b[c]=255&a.charCodeAt(c);return b}function g(a){var b=65536,d=c.getTypeOf(a),e=!0;if("uint8array"===d?e=n.applyCanBeUsed.uint8array:"nodebuffer"===d&&(e=n.applyCanBeUsed.nodebuffer),e)for(;b>1;)try{return n.stringifyByChunk(a,d,b)}catch(a){b=Math.floor(b/2)}return n.stringifyByChar(a)}function h(a,b){for(var c=0;c<a.length;c++)b[c]=a[c];return b}var i=a("./support"),j=a("./base64"),k=a("./nodejsUtils"),l=a("core-js/library/fn/set-immediate"),m=a("./external");c.newBlob=function(a,b){c.checkSupport("blob");try{return new Blob(a,{type:b})}catch(c){try{for(var d=window.BlobBuilder||window.WebKitBlobBuilder||window.MozBlobBuilder||window.MSBlobBuilder,e=new d,f=0;f<a.length;f++)e.append(a[f]);return e.getBlob(b)}catch(a){throw new Error("Bug : can't construct the Blob.")}}};var n={stringifyByChunk:function(a,b,c){var d=[],e=0,f=a.length;if(f<=c)return String.fromCharCode.apply(null,a);for(;e<f;)"array"===b||"nodebuffer"===b?d.push(String.fromCharCode.apply(null,a.slice(e,Math.min(e+c,f)))):d.push(String.fromCharCode.apply(null,a.subarray(e,Math.min(e+c,f)))),e+=c;return d.join("")},stringifyByChar:function(a){for(var b="",c=0;c<a.length;c++)b+=String.fromCharCode(a[c]);return b},applyCanBeUsed:{uint8array:function(){try{return i.uint8array&&1===String.fromCharCode.apply(null,new Uint8Array(1)).length}catch(a){return!1}}(),nodebuffer:function(){try{return i.nodebuffer&&1===String.fromCharCode.apply(null,k.newBuffer(1)).length}catch(a){return!1}}()}};c.applyFromCharCode=g;var o={};o.string={string:e,array:function(a){return f(a,new Array(a.length))},arraybuffer:function(a){return o.string.uint8array(a).buffer},uint8array:function(a){return f(a,new Uint8Array(a.length))},nodebuffer:function(a){return f(a,k.newBuffer(a.length))}},o.array={string:g,array:e,arraybuffer:function(a){return new Uint8Array(a).buffer},uint8array:function(a){return new Uint8Array(a)},nodebuffer:function(a){return k.newBuffer(a)}},o.arraybuffer={string:function(a){return g(new Uint8Array(a))},array:function(a){return h(new Uint8Array(a),new Array(a.byteLength))},arraybuffer:e,uint8array:function(a){return new Uint8Array(a)},nodebuffer:function(a){return k.newBuffer(new Uint8Array(a))}},o.uint8array={string:g,array:function(a){return h(a,new Array(a.length))},arraybuffer:function(a){var b=new Uint8Array(a.length);return a.length&&b.set(a,0),b.buffer},uint8array:e,nodebuffer:function(a){return k.newBuffer(a)}},o.nodebuffer={string:g,array:function(a){return h(a,new Array(a.length))},arraybuffer:function(a){return o.nodebuffer.uint8array(a).buffer},uint8array:function(a){return h(a,new Uint8Array(a.length))},nodebuffer:e},c.transformTo=function(a,b){if(b||(b=""),!a)return b;c.checkSupport(a);var d=c.getTypeOf(b);return o[d][a](b)},c.getTypeOf=function(a){return"string"==typeof a?"string":"[object Array]"===Object.prototype.toString.call(a)?"array":i.nodebuffer&&k.isBuffer(a)?"nodebuffer":i.uint8array&&a instanceof Uint8Array?"uint8array":i.arraybuffer&&a instanceof ArrayBuffer?"arraybuffer":void 0},c.checkSupport=function(a){if(!i[a.toLowerCase()])throw new Error(a+" is not supported by this platform")},c.MAX_VALUE_16BITS=65535,c.MAX_VALUE_32BITS=-1,c.pretty=function(a){var b,c,d="";for(c=0;c<(a||"").length;c++)b=a.charCodeAt(c),d+="\\x"+(b<16?"0":"")+b.toString(16).toUpperCase();return d},c.delay=function(a,b,c){l(function(){a.apply(c||null,b||[])})},c.inherits=function(a,b){var c=function(){};c.prototype=b.prototype,a.prototype=new c},c.extend=function(){var a,b,c={};for(a=0;a<arguments.length;a++)for(b in arguments[a])arguments[a].hasOwnProperty(b)&&void 0===c[b]&&(c[b]=arguments[a][b]);return c},c.prepareContent=function(a,b,e,f,g){return m.Promise.resolve(b).then(function(a){return i.blob&&(a instanceof Blob||-1!==["[object File]","[object Blob]"].indexOf(Object.prototype.toString.call(a)))&&"undefined"!=typeof FileReader?new m.Promise(function(b,c){var d=new FileReader;d.onload=function(a){b(a.target.result)},d.onerror=function(a){c(a.target.error)},d.readAsArrayBuffer(a)}):a}).then(function(b){var h=c.getTypeOf(b);return h?("arraybuffer"===h?b=c.transformTo("uint8array",b):"string"===h&&(g?b=j.decode(b):e&&!0!==f&&(b=d(b))),b):m.Promise.reject(new Error("The data of '"+a+"' is in an unsupported format !"))})}},{"./base64":141,"./external":146,"./nodejsUtils":154,"./support":170,"core-js/library/fn/set-immediate":95}],173:[function(a,b,c){"use strict";function d(a){this.files=[],this.loadOptions=a}var e=a("./reader/readerFor"),f=a("./utils"),g=a("./signature"),h=a("./zipEntry"),i=(a("./utf8"),a("./support"));d.prototype={checkSignature:function(a){if(!this.reader.readAndCheckSignature(a)){this.reader.index-=4;var b=this.reader.readString(4);throw new Error("Corrupted zip or bug : unexpected signature ("+f.pretty(b)+", expected "+f.pretty(a)+")")}},isSignature:function(a,b){var c=this.reader.index;this.reader.setIndex(a);var d=this.reader.readString(4),e=d===b;return this.reader.setIndex(c),e},readBlockEndOfCentral:function(){this.diskNumber=this.reader.readInt(2),this.diskWithCentralDirStart=this.reader.readInt(2),this.centralDirRecordsOnThisDisk=this.reader.readInt(2),this.centralDirRecords=this.reader.readInt(2),this.centralDirSize=this.reader.readInt(4),this.centralDirOffset=this.reader.readInt(4),this.zipCommentLength=this.reader.readInt(2);var a=this.reader.readData(this.zipCommentLength),b=i.uint8array?"uint8array":"array",c=f.transformTo(b,a);this.zipComment=this.loadOptions.decodeFileName(c)},readBlockZip64EndOfCentral:function(){this.zip64EndOfCentralSize=this.reader.readInt(8),this.reader.skip(4),this.diskNumber=this.reader.readInt(4),this.diskWithCentralDirStart=this.reader.readInt(4),this.centralDirRecordsOnThisDisk=this.reader.readInt(8),this.centralDirRecords=this.reader.readInt(8),this.centralDirSize=this.reader.readInt(8),this.centralDirOffset=this.reader.readInt(8),this.zip64ExtensibleData={};for(var a,b,c,d=this.zip64EndOfCentralSize-44;0<d;)a=this.reader.readInt(2),b=this.reader.readInt(4),c=this.reader.readData(b),this.zip64ExtensibleData[a]={id:a,length:b,value:c}},readBlockZip64EndOfCentralLocator:function(){if(this.diskWithZip64CentralDirStart=this.reader.readInt(4),this.relativeOffsetEndOfZip64CentralDir=this.reader.readInt(8),this.disksCount=this.reader.readInt(4),this.disksCount>1)throw new Error("Multi-volumes zip are not supported")},readLocalFiles:function(){var a,b;for(a=0;a<this.files.length;a++)b=this.files[a],this.reader.setIndex(b.localHeaderOffset),this.checkSignature(g.LOCAL_FILE_HEADER),b.readLocalPart(this.reader),b.handleUTF8(),b.processAttributes()},readCentralDir:function(){var a;for(this.reader.setIndex(this.centralDirOffset);this.reader.readAndCheckSignature(g.CENTRAL_FILE_HEADER);)a=new h({zip64:this.zip64},this.loadOptions),a.readCentralPart(this.reader),this.files.push(a);if(this.centralDirRecords!==this.files.length&&0!==this.centralDirRecords&&0===this.files.length)throw new Error("Corrupted zip or bug: expected "+this.centralDirRecords+" records in central dir, got "+this.files.length)},readEndOfCentral:function(){var a=this.reader.lastIndexOfSignature(g.CENTRAL_DIRECTORY_END);if(a<0){throw!this.isSignature(0,g.LOCAL_FILE_HEADER)?new Error("Can't find end of central directory : is this a zip file ? If it is, see http://stuk.github.io/jszip/documentation/howto/read_zip.html"):new Error("Corrupted zip : can't find end of central directory")}this.reader.setIndex(a);var b=a;if(this.checkSignature(g.CENTRAL_DIRECTORY_END),this.readBlockEndOfCentral(),this.diskNumber===f.MAX_VALUE_16BITS||this.diskWithCentralDirStart===f.MAX_VALUE_16BITS||this.centralDirRecordsOnThisDisk===f.MAX_VALUE_16BITS||this.centralDirRecords===f.MAX_VALUE_16BITS||this.centralDirSize===f.MAX_VALUE_32BITS||this.centralDirOffset===f.MAX_VALUE_32BITS){if(this.zip64=!0,(a=this.reader.lastIndexOfSignature(g.ZIP64_CENTRAL_DIRECTORY_LOCATOR))<0)throw new Error("Corrupted zip : can't find the ZIP64 end of central directory locator");if(this.reader.setIndex(a),this.checkSignature(g.ZIP64_CENTRAL_DIRECTORY_LOCATOR),this.readBlockZip64EndOfCentralLocator(),!this.isSignature(this.relativeOffsetEndOfZip64CentralDir,g.ZIP64_CENTRAL_DIRECTORY_END)&&(this.relativeOffsetEndOfZip64CentralDir=this.reader.lastIndexOfSignature(g.ZIP64_CENTRAL_DIRECTORY_END),this.relativeOffsetEndOfZip64CentralDir<0))throw new Error("Corrupted zip : can't find the ZIP64 end of central directory");this.reader.setIndex(this.relativeOffsetEndOfZip64CentralDir),this.checkSignature(g.ZIP64_CENTRAL_DIRECTORY_END),this.readBlockZip64EndOfCentral()}var c=this.centralDirOffset+this.centralDirSize;this.zip64&&(c+=20,c+=12+this.zip64EndOfCentralSize);var d=b-c;if(d>0)this.isSignature(b,g.CENTRAL_FILE_HEADER)||(this.reader.zero=d);else if(d<0)throw new Error("Corrupted zip: missing "+Math.abs(d)+" bytes.")},prepareReader:function(a){this.reader=e(a)},load:function(a){this.prepareReader(a),this.readEndOfCentral(),this.readCentralDir(),this.readLocalFiles()}},b.exports=d},{"./reader/readerFor":162,"./signature":163,"./support":170,"./utf8":171,"./utils":172,"./zipEntry":174}],174:[function(a,b,c){"use strict";function d(a,b){this.options=a,this.loadOptions=b}var e=a("./reader/readerFor"),f=a("./utils"),g=a("./compressedObject"),h=a("./crc32"),i=a("./utf8"),j=a("./compressions"),k=a("./support"),l=function(a){for(var b in j)if(j.hasOwnProperty(b)&&j[b].magic===a)return j[b];return null};d.prototype={isEncrypted:function(){return 1==(1&this.bitFlag)},useUTF8:function(){return 2048==(2048&this.bitFlag)},readLocalPart:function(a){var b,c;if(a.skip(22),this.fileNameLength=a.readInt(2),c=a.readInt(2),this.fileName=a.readData(this.fileNameLength),a.skip(c),-1===this.compressedSize||-1===this.uncompressedSize)throw new Error("Bug or corrupted zip : didn't get enough informations from the central directory (compressedSize === -1 || uncompressedSize === -1)");if(null===(b=l(this.compressionMethod)))throw new Error("Corrupted zip : compression "+f.pretty(this.compressionMethod)+" unknown (inner file : "+f.transformTo("string",this.fileName)+")");this.decompressed=new g(this.compressedSize,this.uncompressedSize,this.crc32,b,a.readData(this.compressedSize))},readCentralPart:function(a){this.versionMadeBy=a.readInt(2),a.skip(2),this.bitFlag=a.readInt(2),this.compressionMethod=a.readString(2),this.date=a.readDate(),this.crc32=a.readInt(4),this.compressedSize=a.readInt(4),this.uncompressedSize=a.readInt(4);var b=a.readInt(2);if(this.extraFieldsLength=a.readInt(2),this.fileCommentLength=a.readInt(2),this.diskNumberStart=a.readInt(2),this.internalFileAttributes=a.readInt(2),this.externalFileAttributes=a.readInt(4),this.localHeaderOffset=a.readInt(4),this.isEncrypted())throw new Error("Encrypted zip are not supported");a.skip(b),this.readExtraFields(a),this.parseZIP64ExtraField(a),this.fileComment=a.readData(this.fileCommentLength)},processAttributes:function(){this.unixPermissions=null,this.dosPermissions=null;var a=this.versionMadeBy>>8;this.dir=!!(16&this.externalFileAttributes),0===a&&(this.dosPermissions=63&this.externalFileAttributes),3===a&&(this.unixPermissions=this.externalFileAttributes>>16&65535),this.dir||"/"!==this.fileNameStr.slice(-1)||(this.dir=!0)},parseZIP64ExtraField:function(a){if(this.extraFields[1]){var b=e(this.extraFields[1].value);this.uncompressedSize===f.MAX_VALUE_32BITS&&(this.uncompressedSize=b.readInt(8)),this.compressedSize===f.MAX_VALUE_32BITS&&(this.compressedSize=b.readInt(8)),this.localHeaderOffset===f.MAX_VALUE_32BITS&&(this.localHeaderOffset=b.readInt(8)),this.diskNumberStart===f.MAX_VALUE_32BITS&&(this.diskNumberStart=b.readInt(4))}},readExtraFields:function(a){var b,c,d,e=a.index+this.extraFieldsLength;for(this.extraFields||(this.extraFields={});a.index<e;)b=a.readInt(2),c=a.readInt(2),d=a.readData(c),this.extraFields[b]={id:b,length:c,value:d}},handleUTF8:function(){var a=k.uint8array?"uint8array":"array";if(this.useUTF8())this.fileNameStr=i.utf8decode(this.fileName),this.fileCommentStr=i.utf8decode(this.fileComment);else{var b=this.findExtraFieldUnicodePath();if(null!==b)this.fileNameStr=b;else{var c=f.transformTo(a,this.fileName);this.fileNameStr=this.loadOptions.decodeFileName(c)}var d=this.findExtraFieldUnicodeComment();if(null!==d)this.fileCommentStr=d;else{var e=f.transformTo(a,this.fileComment);this.fileCommentStr=this.loadOptions.decodeFileName(e)}}},findExtraFieldUnicodePath:function(){var a=this.extraFields[28789];if(a){var b=e(a.value);return 1!==b.readInt(1)?null:h(this.fileName)!==b.readInt(4)?null:i.utf8decode(b.readData(a.length-5))}return null},findExtraFieldUnicodeComment:function(){var a=this.extraFields[25461];if(a){var b=e(a.value);return 1!==b.readInt(1)?null:h(this.fileComment)!==b.readInt(4)?null:i.utf8decode(b.readData(a.length-5))}return null}},b.exports=d},{"./compressedObject":142,"./compressions":143,"./crc32":144,"./reader/readerFor":162,"./support":170,"./utf8":171,"./utils":172}],175:[function(a,b,c){"use strict";var d=a("./stream/StreamHelper"),e=a("./stream/DataWorker"),f=a("./utf8"),g=a("./compressedObject"),h=a("./stream/GenericWorker"),i=function(a,b,c){this.name=a,this.dir=c.dir,this.date=c.date,this.comment=c.comment,this.unixPermissions=c.unixPermissions,this.dosPermissions=c.dosPermissions,this._data=b,this._dataBinary=c.binary,this.options={compression:c.compression,compressionOptions:c.compressionOptions}};i.prototype={internalStream:function(a){var b=a.toLowerCase(),c="string"===b||"text"===b;"binarystring"!==b&&"text"!==b||(b="string");var e=this._decompressWorker(),g=!this._dataBinary;return g&&!c&&(e=e.pipe(new f.Utf8EncodeWorker)),!g&&c&&(e=e.pipe(new f.Utf8DecodeWorker)),new d(e,b,"")},async:function(a,b){return this.internalStream(a).accumulate(b)},nodeStream:function(a,b){return this.internalStream(a||"nodebuffer").toNodejsStream(b)},_compressWorker:function(a,b){if(this._data instanceof g&&this._data.compression.magic===a.magic)return this._data.getCompressedWorker();var c=this._decompressWorker();return this._dataBinary||(c=c.pipe(new f.Utf8EncodeWorker)),g.createWorkerFrom(c,a,b)},_decompressWorker:function(){return this._data instanceof g?this._data.getContentWorker():this._data instanceof h?this._data:new e(this._data)}};for(var j=["asText","asBinary","asNodeBuffer","asUint8Array","asArrayBuffer"],k=function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},l=0;l<j.length;l++)i.prototype[j[l]]=k;b.exports=i},{"./compressedObject":142,"./stream/DataWorker":167,"./stream/GenericWorker":168,"./stream/StreamHelper":169,"./utf8":171}],176:[function(a,b,c){"use strict";function d(){}function e(a){if("function"!=typeof a)throw new TypeError("resolver must be a function");this.state=s,this.queue=[],this.outcome=void 0,a!==d&&i(this,a)}function f(a,b,c){this.promise=a,"function"==typeof b&&(this.onFulfilled=b,this.callFulfilled=this.otherCallFulfilled),"function"==typeof c&&(this.onRejected=c,this.callRejected=this.otherCallRejected)}function g(a,b,c){o(function(){var d;try{d=b(c)}catch(b){return p.reject(a,b)}d===a?p.reject(a,new TypeError("Cannot resolve promise with itself")):p.resolve(a,d)})}function h(a){var b=a&&a.then;if(a&&("object"==typeof a||"function"==typeof a)&&"function"==typeof b)return function(){b.apply(a,arguments)}}function i(a,b){function c(b){f||(f=!0,p.reject(a,b))}function d(b){f||(f=!0,p.resolve(a,b))}function e(){b(d,c)}var f=!1,g=j(e);"error"===g.status&&c(g.value)}function j(a,b){var c={};try{c.value=a(b),c.status="success"}catch(a){c.status="error",c.value=a}return c}function k(a){return a instanceof this?a:p.resolve(new this(d),a)}function l(a){var b=new this(d);return p.reject(b,a)}function m(a){var b=this;if("[object Array]"!==Object.prototype.toString.call(a))return this.reject(new TypeError("must be an array"));var c=a.length,e=!1;if(!c)return this.resolve([]);for(var f=new Array(c),g=0,h=-1,i=new this(d);++h<c;)!function(a,d){function h(a){f[d]=a,++g!==c||e||(e=!0,p.resolve(i,f))}b.resolve(a).then(h,function(a){e||(e=!0,p.reject(i,a))})}(a[h],h);return i}function n(a){var b=this;if("[object Array]"!==Object.prototype.toString.call(a))return this.reject(new TypeError("must be an array"));var c=a.length,e=!1;if(!c)return this.resolve([]);for(var f=-1,g=new this(d);++f<c;)!function(a){b.resolve(a).then(function(a){e||(e=!0,p.resolve(g,a))},function(a){e||(e=!0,p.reject(g,a))})}(a[f]);return g}var o=a("immediate"),p={},q=["REJECTED"],r=["FULFILLED"],s=["PENDING"];b.exports=e,e.prototype.catch=function(a){return this.then(null,a)},e.prototype.then=function(a,b){if("function"!=typeof a&&this.state===r||"function"!=typeof b&&this.state===q)return this;var c=new this.constructor(d);if(this.state!==s){g(c,this.state===r?a:b,this.outcome)}else this.queue.push(new f(c,a,b));return c},f.prototype.callFulfilled=function(a){p.resolve(this.promise,a)},f.prototype.otherCallFulfilled=function(a){g(this.promise,this.onFulfilled,a)},f.prototype.callRejected=function(a){p.reject(this.promise,a)},f.prototype.otherCallRejected=function(a){g(this.promise,this.onRejected,a)},p.resolve=function(a,b){var c=j(h,b);if("error"===c.status)return p.reject(a,c.value);var d=c.value;if(d)i(a,d);else{a.state=r,a.outcome=b;for(var e=-1,f=a.queue.length;++e<f;)a.queue[e].callFulfilled(b)}return a},p.reject=function(a,b){a.state=q,a.outcome=b;for(var c=-1,d=a.queue.length;++c<d;)a.queue[c].callRejected(b);return a},e.resolve=k,e.reject=l,e.all=m,e.race=n},{immediate:136}],177:[function(b,c,d){!function(b,e){"object"==typeof d&&void 0!==c?c.exports=e():"function"==typeof a&&a.amd?a(e):b.moment=e()}(this,function(){"use strict";function a(){return Bd.apply(null,arguments)}function d(a){return a instanceof Array||"[object Array]"===Object.prototype.toString.call(a)}function e(a){return null!=a&&"[object Object]"===Object.prototype.toString.call(a)}function f(a){if(Object.getOwnPropertyNames)return 0===Object.getOwnPropertyNames(a).length;var b;for(b in a)if(a.hasOwnProperty(b))return!1;return!0}function g(a){return void 0===a}function h(a){return"number"==typeof a||"[object Number]"===Object.prototype.toString.call(a)}function i(a){return a instanceof Date||"[object Date]"===Object.prototype.toString.call(a)}function j(a,b){var c,d=[];for(c=0;c<a.length;++c)d.push(b(a[c],c));return d}function k(a,b){return Object.prototype.hasOwnProperty.call(a,b)}function l(a,b){for(var c in b)k(b,c)&&(a[c]=b[c]);return k(b,"toString")&&(a.toString=b.toString),k(b,"valueOf")&&(a.valueOf=b.valueOf),a}function m(a,b,c,d){return zb(a,b,c,d,!0).utc()}function n(){return{empty:!1,unusedTokens:[],unusedInput:[],overflow:-2,charsLeftOver:0,nullInput:!1,invalidMonth:null,invalidFormat:!1,userInvalidated:!1,iso:!1,parsedDateParts:[],meridiem:null,rfc2822:!1,weekdayMismatch:!1}}function o(a){return null==a._pf&&(a._pf=n()),a._pf}function p(a){if(null==a._isValid){var b=o(a),c=Cd.call(b.parsedDateParts,function(a){return null!=a}),d=!isNaN(a._d.getTime())&&b.overflow<0&&!b.empty&&!b.invalidMonth&&!b.invalidWeekday&&!b.weekdayMismatch&&!b.nullInput&&!b.invalidFormat&&!b.userInvalidated&&(!b.meridiem||b.meridiem&&c);if(a._strict&&(d=d&&0===b.charsLeftOver&&0===b.unusedTokens.length&&void 0===b.bigHour),null!=Object.isFrozen&&Object.isFrozen(a))return d;a._isValid=d}return a._isValid}function q(a){var b=m(NaN);return null!=a?l(o(b),a):o(b).userInvalidated=!0,b}function r(a,b){var c,d,e;if(g(b._isAMomentObject)||(a._isAMomentObject=b._isAMomentObject),g(b._i)||(a._i=b._i),g(b._f)||(a._f=b._f),g(b._l)||(a._l=b._l),g(b._strict)||(a._strict=b._strict),g(b._tzm)||(a._tzm=b._tzm),g(b._isUTC)||(a._isUTC=b._isUTC),g(b._offset)||(a._offset=b._offset),g(b._pf)||(a._pf=o(b)),g(b._locale)||(a._locale=b._locale),Dd.length>0)for(c=0;c<Dd.length;c++)d=Dd[c],e=b[d],g(e)||(a[d]=e);return a}function s(b){r(this,b),this._d=new Date(null!=b._d?b._d.getTime():NaN),this.isValid()||(this._d=new Date(NaN)),!1===Ed&&(Ed=!0,a.updateOffset(this),Ed=!1)}function t(a){return a instanceof s||null!=a&&null!=a._isAMomentObject}function u(a){return a<0?Math.ceil(a)||0:Math.floor(a)}function v(a){var b=+a,c=0;return 0!==b&&isFinite(b)&&(c=u(b)),c}function w(a,b,c){var d,e=Math.min(a.length,b.length),f=Math.abs(a.length-b.length),g=0;for(d=0;d<e;d++)(c&&a[d]!==b[d]||!c&&v(a[d])!==v(b[d]))&&g++;return g+f}function x(b){!1===a.suppressDeprecationWarnings&&"undefined"!=typeof console&&console.warn&&console.warn("Deprecation warning: "+b)}function y(b,c){var d=!0;return l(function(){if(null!=a.deprecationHandler&&a.deprecationHandler(null,b),d){for(var e,f=[],g=0;g<arguments.length;g++){if(e="","object"==typeof arguments[g]){e+="\n["+g+"] ";for(var h in arguments[0])e+=h+": "+arguments[0][h]+", ";e=e.slice(0,-2)}else e=arguments[g];f.push(e)}x(b+"\nArguments: "+Array.prototype.slice.call(f).join("")+"\n"+(new Error).stack),d=!1}return c.apply(this,arguments)},c)}function z(b,c){null!=a.deprecationHandler&&a.deprecationHandler(b,c),Fd[b]||(x(c),Fd[b]=!0)}function A(a){return a instanceof Function||"[object Function]"===Object.prototype.toString.call(a)}function B(a){var b,c;for(c in a)b=a[c],A(b)?this[c]=b:this["_"+c]=b;this._config=a,this._dayOfMonthOrdinalParseLenient=new RegExp((this._dayOfMonthOrdinalParse.source||this._ordinalParse.source)+"|"+/\d{1,2}/.source)}function C(a,b){var c,d=l({},a);for(c in b)k(b,c)&&(e(a[c])&&e(b[c])?(d[c]={},l(d[c],a[c]),l(d[c],b[c])):null!=b[c]?d[c]=b[c]:delete d[c]);for(c in a)k(a,c)&&!k(b,c)&&e(a[c])&&(d[c]=l({},d[c]));return d}function D(a){null!=a&&this.set(a)}function E(a,b,c){var d=this._calendar[a]||this._calendar.sameElse;return A(d)?d.call(b,c):d}function F(a){var b=this._longDateFormat[a],c=this._longDateFormat[a.toUpperCase()];return b||!c?b:(this._longDateFormat[a]=c.replace(/MMMM|MM|DD|dddd/g,function(a){return a.slice(1)}),this._longDateFormat[a])}function G(){return this._invalidDate}function H(a){return this._ordinal.replace("%d",a)}function I(a,b,c,d){var e=this._relativeTime[c];return A(e)?e(a,b,c,d):e.replace(/%d/i,a)}function J(a,b){var c=this._relativeTime[a>0?"future":"past"];return A(c)?c(b):c.replace(/%s/i,b)}function K(a,b){var c=a.toLowerCase();Ld[c]=Ld[c+"s"]=Ld[b]=a}function L(a){return"string"==typeof a?Ld[a]||Ld[a.toLowerCase()]:void 0}function M(a){var b,c,d={};for(c in a)k(a,c)&&(b=L(c))&&(d[b]=a[c]);return d}function N(a,b){Md[a]=b}function O(a){var b=[];for(var c in a)b.push({unit:c,priority:Md[c]});return b.sort(function(a,b){return a.priority-b.priority}),b}function P(a,b,c){var d=""+Math.abs(a),e=b-d.length;return(a>=0?c?"+":"":"-")+Math.pow(10,Math.max(0,e)).toString().substr(1)+d}function Q(a,b,c,d){var e=d;"string"==typeof d&&(e=function(){return this[d]()}),a&&(Qd[a]=e),b&&(Qd[b[0]]=function(){return P(e.apply(this,arguments),b[1],b[2])}),c&&(Qd[c]=function(){return this.localeData().ordinal(e.apply(this,arguments),a)})}function R(a){return a.match(/\[[\s\S]/)?a.replace(/^\[|\]$/g,""):a.replace(/\\/g,"")}function S(a){var b,c,d=a.match(Nd);for(b=0,c=d.length;b<c;b++)Qd[d[b]]?d[b]=Qd[d[b]]:d[b]=R(d[b]);return function(b){var e,f="";for(e=0;e<c;e++)f+=A(d[e])?d[e].call(b,a):d[e];return f}}function T(a,b){return a.isValid()?(b=U(b,a.localeData()),Pd[b]=Pd[b]||S(b),Pd[b](a)):a.localeData().invalidDate()}function U(a,b){function c(a){return b.longDateFormat(a)||a}var d=5;for(Od.lastIndex=0;d>=0&&Od.test(a);)a=a.replace(Od,c),Od.lastIndex=0,d-=1;return a}function V(a,b,c){ge[a]=A(b)?b:function(a,d){return a&&c?c:b}}function W(a,b){return k(ge,a)?ge[a](b._strict,b._locale):new RegExp(X(a))}function X(a){return Y(a.replace("\\","").replace(/\\(\[)|\\(\])|\[([^\]\[]*)\]|\\(.)/g,function(a,b,c,d,e){return b||c||d||e}))}function Y(a){return a.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")}function Z(a,b){var c,d=b;for("string"==typeof a&&(a=[a]),h(b)&&(d=function(a,c){c[b]=v(a)}),c=0;c<a.length;c++)he[a[c]]=d}function $(a,b){Z(a,function(a,c,d,e){d._w=d._w||{},b(a,d._w,d,e)})}function _(a,b,c){null!=b&&k(he,a)&&he[a](b,c._a,c,a)}function aa(a){return ba(a)?366:365}function ba(a){return a%4==0&&a%100!=0||a%400==0}function ca(){return ba(this.year())}function da(b,c){return function(d){return null!=d?(fa(this,b,d),a.updateOffset(this,c),this):ea(this,b)}}function ea(a,b){return a.isValid()?a._d["get"+(a._isUTC?"UTC":"")+b]():NaN}function fa(a,b,c){a.isValid()&&!isNaN(c)&&("FullYear"===b&&ba(a.year())&&1===a.month()&&29===a.date()?a._d["set"+(a._isUTC?"UTC":"")+b](c,a.month(),ja(c,a.month())):a._d["set"+(a._isUTC?"UTC":"")+b](c))}function ga(a){return a=L(a),A(this[a])?this[a]():this}function ha(a,b){if("object"==typeof a){a=M(a);for(var c=O(a),d=0;d<c.length;d++)this[c[d].unit](a[c[d].unit])}else if(a=L(a),A(this[a]))return this[a](b);return this}function ia(a,b){return(a%b+b)%b}function ja(a,b){if(isNaN(a)||isNaN(b))return NaN;var c=ia(b,12);return a+=(b-c)/12,1===c?ba(a)?29:28:31-c%7%2}function ka(a,b){return a?d(this._months)?this._months[a.month()]:this._months[(this._months.isFormat||te).test(b)?"format":"standalone"][a.month()]:d(this._months)?this._months:this._months.standalone}function la(a,b){return a?d(this._monthsShort)?this._monthsShort[a.month()]:this._monthsShort[te.test(b)?"format":"standalone"][a.month()]:d(this._monthsShort)?this._monthsShort:this._monthsShort.standalone}function ma(a,b,c){var d,e,f,g=a.toLocaleLowerCase();if(!this._monthsParse)for(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[],d=0;d<12;++d)f=m([2e3,d]),this._shortMonthsParse[d]=this.monthsShort(f,"").toLocaleLowerCase(),this._longMonthsParse[d]=this.months(f,"").toLocaleLowerCase();return c?"MMM"===b?(e=re.call(this._shortMonthsParse,g),-1!==e?e:null):(e=re.call(this._longMonthsParse,g),-1!==e?e:null):"MMM"===b?-1!==(e=re.call(this._shortMonthsParse,g))?e:(e=re.call(this._longMonthsParse,g),-1!==e?e:null):-1!==(e=re.call(this._longMonthsParse,g))?e:(e=re.call(this._shortMonthsParse,g),-1!==e?e:null)}function na(a,b,c){var d,e,f;if(this._monthsParseExact)return ma.call(this,a,b,c);for(this._monthsParse||(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[]),d=0;d<12;d++){if(e=m([2e3,d]),c&&!this._longMonthsParse[d]&&(this._longMonthsParse[d]=new RegExp("^"+this.months(e,"").replace(".","")+"$","i"),this._shortMonthsParse[d]=new RegExp("^"+this.monthsShort(e,"").replace(".","")+"$","i")),c||this._monthsParse[d]||(f="^"+this.months(e,"")+"|^"+this.monthsShort(e,""),this._monthsParse[d]=new RegExp(f.replace(".",""),"i")),c&&"MMMM"===b&&this._longMonthsParse[d].test(a))return d;if(c&&"MMM"===b&&this._shortMonthsParse[d].test(a))return d;if(!c&&this._monthsParse[d].test(a))return d}}function oa(a,b){var c;if(!a.isValid())return a;if("string"==typeof b)if(/^\d+$/.test(b))b=v(b);else if(b=a.localeData().monthsParse(b),!h(b))return a;return c=Math.min(a.date(),ja(a.year(),b)),a._d["set"+(a._isUTC?"UTC":"")+"Month"](b,c),a}function pa(b){return null!=b?(oa(this,b),a.updateOffset(this,!0),this):ea(this,"Month")}function qa(){return ja(this.year(),this.month())}function ra(a){return this._monthsParseExact?(k(this,"_monthsRegex")||ta.call(this),a?this._monthsShortStrictRegex:this._monthsShortRegex):(k(this,"_monthsShortRegex")||(this._monthsShortRegex=we),this._monthsShortStrictRegex&&a?this._monthsShortStrictRegex:this._monthsShortRegex)}function sa(a){return this._monthsParseExact?(k(this,"_monthsRegex")||ta.call(this),a?this._monthsStrictRegex:this._monthsRegex):(k(this,"_monthsRegex")||(this._monthsRegex=xe),this._monthsStrictRegex&&a?this._monthsStrictRegex:this._monthsRegex)}function ta(){function a(a,b){return b.length-a.length}var b,c,d=[],e=[],f=[];for(b=0;b<12;b++)c=m([2e3,b]),d.push(this.monthsShort(c,"")),e.push(this.months(c,"")),f.push(this.months(c,"")),f.push(this.monthsShort(c,""));for(d.sort(a),e.sort(a),f.sort(a),b=0;b<12;b++)d[b]=Y(d[b]),e[b]=Y(e[b]);for(b=0;b<24;b++)f[b]=Y(f[b]);this._monthsRegex=new RegExp("^("+f.join("|")+")","i"),this._monthsShortRegex=this._monthsRegex,this._monthsStrictRegex=new RegExp("^("+e.join("|")+")","i"),this._monthsShortStrictRegex=new RegExp("^("+d.join("|")+")","i")}function ua(a,b,c,d,e,f,g){var h=new Date(a,b,c,d,e,f,g);return a<100&&a>=0&&isFinite(h.getFullYear())&&h.setFullYear(a),h}function va(a){var b=new Date(Date.UTC.apply(null,arguments));return a<100&&a>=0&&isFinite(b.getUTCFullYear())&&b.setUTCFullYear(a),b}function wa(a,b,c){var d=7+b-c;return-(7+va(a,0,d).getUTCDay()-b)%7+d-1}function xa(a,b,c,d,e){var f,g,h=(7+c-d)%7,i=wa(a,d,e),j=1+7*(b-1)+h+i;return j<=0?(f=a-1,g=aa(f)+j):j>aa(a)?(f=a+1,g=j-aa(a)):(f=a,g=j),{year:f,dayOfYear:g}}function ya(a,b,c){var d,e,f=wa(a.year(),b,c),g=Math.floor((a.dayOfYear()-f-1)/7)+1;return g<1?(e=a.year()-1,d=g+za(e,b,c)):g>za(a.year(),b,c)?(d=g-za(a.year(),b,c),e=a.year()+1):(e=a.year(),d=g),{week:d,year:e}}function za(a,b,c){var d=wa(a,b,c),e=wa(a+1,b,c);return(aa(a)-d+e)/7}function Aa(a){return ya(a,this._week.dow,this._week.doy).week}function Ba(){return this._week.dow}function Ca(){return this._week.doy}function Da(a){var b=this.localeData().week(this);return null==a?b:this.add(7*(a-b),"d")}function Ea(a){var b=ya(this,1,4).week;return null==a?b:this.add(7*(a-b),"d")}function Fa(a,b){return"string"!=typeof a?a:isNaN(a)?(a=b.weekdaysParse(a),"number"==typeof a?a:null):parseInt(a,10)}function Ga(a,b){return"string"==typeof a?b.weekdaysParse(a)%7||7:isNaN(a)?null:a}function Ha(a,b){return a?d(this._weekdays)?this._weekdays[a.day()]:this._weekdays[this._weekdays.isFormat.test(b)?"format":"standalone"][a.day()]:d(this._weekdays)?this._weekdays:this._weekdays.standalone}function Ia(a){return a?this._weekdaysShort[a.day()]:this._weekdaysShort}function Ja(a){return a?this._weekdaysMin[a.day()]:this._weekdaysMin}function Ka(a,b,c){var d,e,f,g=a.toLocaleLowerCase();if(!this._weekdaysParse)for(this._weekdaysParse=[],this._shortWeekdaysParse=[],this._minWeekdaysParse=[],d=0;d<7;++d)f=m([2e3,1]).day(d),
##############################################
/src/dist/exceljs.js-231-
/src/dist/exceljs.js:232:  // TODO: lazy evaluation of this._value
/src/dist/exceljs.js-233-  this._value = Value.create(Cell.Types.Null, this);
##############################################
/src/dist/exceljs.js-14421-  , document = require('./_global').document
/src/dist/exceljs.js:14422:  // in old IE typeof document.createElement is 'object'
/src/dist/exceljs.js:14423:  , is = isObject(document) && isObject(document.createElement);
/src/dist/exceljs.js-14424-module.exports = function(it){
/src/dist/exceljs.js:14425:  return is ? document.createElement(it) : {};
/src/dist/exceljs.js-14426-};
##############################################
/src/dist/exceljs.js-16739-      var observer = new lib$es6$promise$asap$$BrowserMutationObserver(lib$es6$promise$asap$$flush);
/src/dist/exceljs.js:16740:      var node = document.createTextNode('');
/src/dist/exceljs.js-16741-      observer.observe(node, { characterData: true });
##############################################
/src/dist/exceljs.js-19968-    var observer = new Mutation(nextTick);
/src/dist/exceljs.js:19969:    var element = global.document.createTextNode('');
/src/dist/exceljs.js-19970-    observer.observe(element, {
##############################################
/src/dist/exceljs.js-19981-    };
/src/dist/exceljs.js:19982:  } else if ('document' in global && 'onreadystatechange' in global.document.createElement('script')) {
/src/dist/exceljs.js-19983-    scheduleDrain = function () {
##############################################
/src/dist/exceljs.js-19986-      // into the document. Do so, thus queuing up the task. Remember to clean up once it's been called.
/src/dist/exceljs.js:19987:      var scriptEl = global.document.createElement('script');
/src/dist/exceljs.js-19988-      scriptEl.onreadystatechange = function () {
##############################################
/src/dist/exceljs.js-20219-        //ie hack
/src/dist/exceljs.js:20220:        if ("undefined" !== typeof window && !isFunction(window.alert)) {
/src/dist/exceljs.js-20221-            (function (alert) {
##############################################
/src/dist/exceljs.js-20224-                };
/src/dist/exceljs.js:20225:            }(window.alert));
/src/dist/exceljs.js-20226-        }
##############################################
/src/dist/exceljs.js-28332-     * Return a human readable representation of a moment that can
/src/dist/exceljs.js:28333:     * also be evaluated to get a new moment which is the same
/src/dist/exceljs.js-28334-     *
##############################################
/src/dist/exceljs.js-31692- * block state.
/src/dist/exceljs.js:31693: * This function does not perform lazy evaluation of matches and inserts
/src/dist/exceljs.js-31694- * new strings in the dictionary only for unmatched strings or for short
##############################################
/src/dist/exceljs.js-31821- * Same as above, but achieves better compression. We use a lazy
/src/dist/exceljs.js:31822: * evaluation for matches: a match is finally adopted only if there is
/src/dist/exceljs.js-31823- * no better match at the next window position.
##############################################
/src/dist/exceljs.js-32254-  /* Length of the best match at previous step. Matches not greater than this
/src/dist/exceljs.js:32255:   * are discarded. This is used in the lazy match evaluation.
/src/dist/exceljs.js-32256-   */
##############################################
/src/dist/exceljs.js-36690-        try {
/src/dist/exceljs.js:36691:            // When we are in I.E. but the script has been evaled so I.E. doesn't trust the global object when called normally
/src/dist/exceljs.js-36692-            return cachedSetTimeout.call(null, fun, 0);
##############################################
/src/dist/exceljs.js-36715-        try {
/src/dist/exceljs.js:36716:            // When we are in I.E. but the script has been evaled so I.E. doesn't  trust the global object when called normally
/src/dist/exceljs.js-36717-            return cachedClearTimeout.call(null, marker);
##############################################
/src/dist/exceljs.js-37865-    // If _read pushed data synchronously, then `reading` will be false,
/src/dist/exceljs.js:37866:    // and we need to re-evaluate how much data we can return to the user.
/src/dist/exceljs.js-37867-    if (!state.reading) n = howMuchToRead(nOrig, state);
##############################################
/src/dist/es5/doc/cell.js.map:1:{"version":3,"sources":["../../../lib/doc/cell.js"],"names":["colCache","require","Enums","slideFormula","Cell","module","exports","row","column","address","Error","_row","_column","validateAddress","_address","_value","Value","create","Types","Null","style","_mergeStyle","_mergeCount","ValueType","prototype","worksheet","workbook","destroy","numFmt","value","font","alignment","border","fill","rowStyle","colStyle","number","col","$col$row","letter","type","effectiveType","toCsvString","addMergeRef","releaseMergeRef","isMerged","Merge","merge","master","release","unmerge","isMergedTo","isHyperlink","Hyperlink","hyperlink","v","getType","text","toString","_upgradeToHyperlink","String","formula","result","formulaType","fullAddress","sheetName","name","names","definedNames","getNamesEx","self","removeAllNames","forEach","addEx","addName","removeName","removeEx","_dataValidations","dataValidations","dataValidation","find","add","model","NullValue","cell","NumberValue","Number","StringValue","replace","RichTextValue","richText","map","t","join","RichText","DateValue","Date","toISOString","HyperlinkValue","undefined","MergeValue","_master","FormulaValue","Formula","sharedFormula","validate","dependencies","ranges","match","cells","_getTranslatedFormula","FormulaType","Master","Shared","None","_translatedFormula","findCell","SharedStringValue","SharedString","BooleanValue","Boolean","ErrorValue","error","JSONValue","JSON","stringify","rawValue","sharedString","types","f","reduce","p","T"],"mappings":"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","file":"cell.js","sourcesContent":["/**\r\n * Copyright (c) 2014-2017 Guyon Roche\r\n * LICENCE: MIT - please refer to LICENCE file included with this module\r\n * or https://github.com/guyonroche/exceljs/blob/master/LICENSE\r\n */\r\n\r\n'use strict';\r\n\r\nvar colCache = require('../utils/col-cache');\r\nvar Enums = require('./enums');\r\nvar { slideFormula } = require('../utils/shared-formula');\r\n\r\n// Cell requirements\r\n//  Operate inside a worksheet\r\n//  Store and retrieve a value with a range of types: text, number, date, hyperlink, reference, formula, etc.\r\n//  Manage/use and manipulate cell format either as local to cell or inherited from column or row.\r\n\r\nvar Cell = module.exports = function(row, column, address) {\r\n  if (!row || !column) {\r\n    throw new Error('A Cell needs a Row');\r\n  }\r\n\r\n  this._row = row;\r\n  this._column = column;\r\n\r\n  colCache.validateAddress(address);\r\n  this._address = address;\r\n\r\n  // TODO: lazy evaluation of this._value\r\n  this._value = Value.create(Cell.Types.Null, this);\r\n\r\n  this.style = this._mergeStyle(row.style, column.style, {});\r\n\r\n  this._mergeCount = 0;\r\n};\r\n\r\nCell.Types = Enums.ValueType;\r\n\r\nCell.prototype = {\r\n\r\n  get worksheet() {\r\n    return this._row.worksheet;\r\n  },\r\n  get workbook() {\r\n    return this._row.worksheet.workbook;\r\n  },\r\n\r\n  // help GC by removing cyclic (and other) references\r\n  destroy: function() {\r\n    delete this.style;\r\n    delete this._value;\r\n    delete this._row;\r\n    delete this._column;\r\n    delete this._address;\r\n  },\r\n\r\n  // =========================================================================\r\n  // Styles stuff\r\n  get numFmt() {\r\n    return this.style.numFmt;\r\n  },\r\n  set numFmt(value) {\r\n    this.style.numFmt = value;\r\n  },\r\n  get font() {\r\n    return this.style.font;\r\n  },\r\n  set font(value) {\r\n    this.style.font = value;\r\n  },\r\n  get alignment() {\r\n    return this.style.alignment;\r\n  },\r\n  set alignment(value) {\r\n    this.style.alignment = value;\r\n  },\r\n  get border() {\r\n    return this.style.border;\r\n  },\r\n  set border(value) {\r\n    this.style.border = value;\r\n  },\r\n  get fill() {\r\n    return this.style.fill;\r\n  },\r\n  set fill(value) {\r\n    this.style.fill = value;\r\n  },\r\n\r\n  _mergeStyle: function(rowStyle, colStyle, style) {\r\n    var numFmt = (rowStyle && rowStyle.numFmt) || (colStyle && colStyle.numFmt);\r\n    if (numFmt) style.numFmt = numFmt;\r\n\r\n    var font = (rowStyle && rowStyle.font) || (colStyle && colStyle.font);\r\n    if (font) style.font = font;\r\n\r\n    var alignment = (rowStyle && rowStyle.alignment) || (colStyle && colStyle.alignment);\r\n    if (alignment) style.alignment = alignment;\r\n\r\n    var border = (rowStyle && rowStyle.border) || (colStyle && colStyle.border);\r\n    if (border) style.border = border;\r\n\r\n    var fill = (rowStyle && rowStyle.fill) || (colStyle && colStyle.fill);\r\n    if (fill) style.fill = fill;\r\n\r\n    return style;\r\n  },\r\n\r\n  // =========================================================================\r\n  // return the address for this cell\r\n  get address() {\r\n    return this._address;\r\n  },\r\n\r\n  get row() {\r\n    return this._row.number;\r\n  },\r\n  get col() {\r\n    return this._column.number;\r\n  },\r\n\r\n  get $col$row() {\r\n    return '$' + this._column.letter + '$' + this.row;\r\n  },\r\n\r\n\r\n  // =========================================================================\r\n  // Value stuff\r\n\r\n  get type() {\r\n    return this._value.type;\r\n  },\r\n\r\n  get effectiveType() {\r\n    return this._value.effectiveType;\r\n  },\r\n\r\n  toCsvString: function() {\r\n    return this._value.toCsvString();\r\n  },\r\n\r\n  // =========================================================================\r\n  // Merge stuff\r\n\r\n  addMergeRef: function() {\r\n    this._mergeCount++;\r\n  },\r\n  releaseMergeRef: function() {\r\n    this._mergeCount--;\r\n  },\r\n  get isMerged() {\r\n    return (this._mergeCount > 0) || (this.type === Cell.Types.Merge);\r\n  },\r\n  merge: function(master) {\r\n    this._value.release();\r\n    this._value = Value.create(Cell.Types.Merge, this, master);\r\n    this.style = master.style;\r\n  },\r\n  unmerge: function() {\r\n    if (this.type === Cell.Types.Merge) {\r\n      this._value.release();\r\n      this._value = Value.create(Cell.Types.Null, this);\r\n      this.style = this._mergeStyle(this._row.style, this._column.style, {});\r\n    }\r\n  },\r\n  isMergedTo: function(master) {\r\n    if (this._value.type !== Cell.Types.Merge) return false;\r\n    return this._value.isMergedTo(master);\r\n  },\r\n  get master() {\r\n    if (this.type === Cell.Types.Merge) {\r\n      return this._value.master;\r\n    }\r\n    return this; // an unmerged cell is its own master\r\n  },\r\n\r\n  get isHyperlink() {\r\n    return this._value.type === Cell.Types.Hyperlink;\r\n  },\r\n  get hyperlink() {\r\n    return this._value.hyperlink;\r\n  },\r\n\r\n  // return the value\r\n  get value() {\r\n    return this._value.value;\r\n  },\r\n  // set the value - can be number, string or raw\r\n  set value(v) {\r\n    // special case - merge cells set their master's value\r\n    if (this.type === Cell.Types.Merge) {\r\n      this._value.master.value = v;\r\n      return;\r\n    }\r\n\r\n    this._value.release();\r\n\r\n    // assign value\r\n    this._value = Value.create(Value.getType(v), this, v);\r\n  },\r\n  get text() {\r\n    return this._value.toString();\r\n  },\r\n  toString: function() {\r\n    return this.text;\r\n  },\r\n\r\n  _upgradeToHyperlink: function(hyperlink) {\r\n    // if this cell is a string, turn it into a Hyperlink\r\n    if (this.type === Cell.Types.String) {\r\n      this._value = Value.create(Cell.Types.Hyperlink, this, {\r\n        text: this._value.value,\r\n        hyperlink: hyperlink\r\n      });\r\n    }\r\n  },\r\n\r\n  // =========================================================================\r\n  // Formula stuff\r\n  get formula() {\r\n    return this._value.formula;\r\n  },\r\n  get result() {\r\n    return this._value.result;\r\n  },\r\n  get formulaType() {\r\n    return this._value.formulaType;\r\n  },\r\n\r\n  // =========================================================================\r\n  // Name stuff\r\n  get fullAddress() {\r\n    var worksheet = this._row.worksheet;\r\n    return {\r\n      sheetName: worksheet.name,\r\n      address: this.address,\r\n      row: this.row,\r\n      col: this.col\r\n    };\r\n  },\r\n  get name() {\r\n    return this.names[0];\r\n  },\r\n  set name(value) {\r\n    this.names = [value];\r\n  },\r\n  get names() {\r\n    return this.workbook.definedNames.getNamesEx(this.fullAddress);\r\n  },\r\n  set names(value) {\r\n    var self = this;\r\n    var definedNames = this.workbook.definedNames;\r\n    this.workbook.definedNames.removeAllNames(self.fullAddress);\r\n    value.forEach(function(name) {\r\n      definedNames.addEx(self.fullAddress, name);\r\n    });\r\n  },\r\n  addName: function(name) {\r\n    this.workbook.definedNames.addEx(this.fullAddress, name);\r\n  },\r\n  removeName: function(name) {\r\n    this.workbook.definedNames.removeEx(this.fullAddress, name);\r\n  },\r\n  removeAllNames: function() {\r\n    this.workbook.definedNames.removeAllNames(this.fullAddress);\r\n  },\r\n\r\n  // =========================================================================\r\n  // Data Validation stuff\r\n  get _dataValidations() {\r\n    return this.worksheet.dataValidations;\r\n  },\r\n\r\n  get dataValidation() {\r\n    return this._dataValidations.find(this.address);\r\n  },\r\n\r\n  set dataValidation(value) {\r\n    this._dataValidations.add(this.address, value);\r\n  },\r\n\r\n  // =========================================================================\r\n  // Model stuff\r\n\r\n  get model() {\r\n    var model = this._value.model;\r\n    model.style = this.style;\r\n    return model;\r\n  },\r\n  set model(value) {\r\n    this._value.release();\r\n    this._value = Value.create(value.type, this);\r\n    this._value.model = value;\r\n    if (value.style) {\r\n      this.style = value.style;\r\n    } else {\r\n      this.style = {};\r\n    }\r\n  }\r\n};\r\n\r\n// =============================================================================\r\n// Internal Value Types\r\n\r\nvar NullValue = function(cell) {\r\n  this.model = {\r\n    address: cell.address,\r\n    type: Cell.Types.Null\r\n  };\r\n};\r\nNullValue.prototype = {\r\n  get value() {\r\n    return null;\r\n  },\r\n  set value(value) {\r\n    // nothing to do\r\n  },\r\n  get type() {\r\n    return Cell.Types.Null;\r\n  },\r\n  get effectiveType() {\r\n    return Cell.Types.Null;\r\n  },\r\n  get address() {\r\n    return this.model.address;\r\n  },\r\n  set address(value) {\r\n    this.model.address = value;\r\n  },\r\n  toCsvString: function() {\r\n    return '';\r\n  },\r\n  release: function() {\r\n  },\r\n  toString: function() {\r\n    return '';\r\n  }\r\n};\r\n\r\nvar NumberValue = function(cell, value) {\r\n  this.model = {\r\n    address: cell.address,\r\n    type: Cell.Types.Number,\r\n    value: value\r\n  };\r\n};\r\nNumberValue.prototype = {\r\n  get value() {\r\n    return this.model.value;\r\n  },\r\n  set value(value) {\r\n    this.model.value = value;\r\n  },\r\n  get type() {\r\n    return Cell.Types.Number;\r\n  },\r\n  get effectiveType() {\r\n    return Cell.Types.Number;\r\n  },\r\n  get address() {\r\n    return this.model.address;\r\n  },\r\n  set address(value) {\r\n    this.model.address = value;\r\n  },\r\n  toCsvString: function() {\r\n    return '' + this.model.value;\r\n  },\r\n  release: function() {\r\n  },\r\n  toString: function() {\r\n    return this.model.value.toString();\r\n  }\r\n};\r\n\r\nvar StringValue = function(cell, value) {\r\n  this.model = {\r\n    address: cell.address,\r\n    type: Cell.Types.String,\r\n    value: value\r\n  };\r\n};\r\nStringValue.prototype = {\r\n  get value() {\r\n    return this.model.value;\r\n  },\r\n  set value(value) {\r\n    this.model.value = value;\r\n  },\r\n  get type() {\r\n    return Cell.Types.String;\r\n  },\r\n  get effectiveType() {\r\n    return Cell.Types.String;\r\n  },\r\n  get address() {\r\n    return this.model.address;\r\n  },\r\n  set address(value) {\r\n    this.model.address = value;\r\n  },\r\n  toCsvString: function() {\r\n    return '\"' + this.model.value.replace(/\"/g, '\"\"') + '\"';\r\n  },\r\n  release: function() {\r\n  },\r\n  toString: function() {\r\n    return this.model.value;\r\n  }\r\n};\r\n\r\nvar RichTextValue = function(cell, value) {\r\n  this.model = {\r\n    address: cell.address,\r\n    type: Cell.Types.String,\r\n    value: value\r\n  };\r\n};\r\nRichTextValue.prototype = {\r\n  get value() {\r\n    return this.model.value;\r\n  },\r\n  set value(value) {\r\n    this.model.value = value;\r\n  },\r\n  toString: function() {\r\n    return this.model.value.richText.map(function(t) {\r\n      return t.text;\r\n    }).join('');\r\n  },\r\n  get type() {\r\n    return Cell.Types.RichText;\r\n  },\r\n  get effectiveType() {\r\n    return Cell.Types.RichText;\r\n  },\r\n  get address() {\r\n    return this.model.address;\r\n  },\r\n  set address(value) {\r\n    this.model.address = value;\r\n  },\r\n  toCsvString: function() {\r\n    return '\"' + this.text.replace(/\"/g, '\"\"') + '\"';\r\n  },\r\n  release: function() {\r\n  }\r\n};\r\n\r\nvar DateValue = function(cell, value) {\r\n  this.model = {\r\n    address: cell.address,\r\n    type: Cell.Types.Date,\r\n    value: value\r\n  };\r\n};\r\nDateValue.prototype = {\r\n  get value() {\r\n    return this.model.value;\r\n  },\r\n  set value(value) {\r\n    this.model.value = value;\r\n  },\r\n  get type() {\r\n    return Cell.Types.Date;\r\n  },\r\n  get effectiveType() {\r\n    return Cell.Types.Date;\r\n  },\r\n  get address() {\r\n    return this.model.address;\r\n  },\r\n  set address(value) {\r\n    this.model.address = value;\r\n  },\r\n  toCsvString: function() {\r\n    return this.model.value.toISOString();\r\n  },\r\n  release: function() {\r\n  },\r\n  toString: function() {\r\n    return this.model.value.toString();\r\n  }\r\n};\r\n\r\nvar HyperlinkValue = function(cell, value) {\r\n  this.model = {\r\n    address: cell.address,\r\n    type: Cell.Types.Hyperlink,\r\n    text: value ? value.text : undefined,\r\n    hyperlink: value ? value.hyperlink : undefined\r\n  };\r\n};\r\nHyperlinkValue.prototype = {\r\n  get value() {\r\n    return {\r\n      text: this.model.text,\r\n      hyperlink: this.model.hyperlink\r\n    };\r\n  },\r\n  set value(value) {\r\n    this.model.text = value.text;\r\n    this.model.hyperlink = value.hyperlink;\r\n  },\r\n\r\n  get text() {\r\n    return this.model.text;\r\n  },\r\n  set text(value) {\r\n    this.model.text = value;\r\n  },\r\n  get hyperlink() {\r\n    return this.model.hyperlink;\r\n  },\r\n  set hyperlink(value) {\r\n    this.model.hyperlink = value;\r\n  },\r\n  get type() {\r\n    return Cell.Types.Hyperlink;\r\n  },\r\n  get effectiveType() {\r\n    return Cell.Types.Hyperlink;\r\n  },\r\n  get address() {\r\n    return this.model.address;\r\n  },\r\n  set address(value) {\r\n    this.model.address = value;\r\n  },\r\n  toCsvString: function() {\r\n    return this.model.hyperlink;\r\n  },\r\n  release: function() {\r\n  },\r\n  toString: function() {\r\n    return this.model.text;\r\n  }\r\n};\r\n\r\nvar MergeValue = function(cell, master) {\r\n  this.model = {\r\n    address: cell.address,\r\n    type: Cell.Types.Merge,\r\n    master: master ? master.address : undefined\r\n  };\r\n  this._master = master;\r\n  if (master) {\r\n    master.addMergeRef();\r\n  }\r\n};\r\nMergeValue.prototype = {\r\n  get value() {\r\n    return this._master.value;\r\n  },\r\n  set value(value) {\r\n    if (value instanceof Cell) {\r\n      if (this._master) {\r\n        this._master.releaseMergeRef();\r\n      }\r\n      value.addMergeRef();\r\n      this._master = value;\r\n    } else {\r\n      this._master.value = value;\r\n    }\r\n  },\r\n\r\n  isMergedTo: function(master) {\r\n    return master === this._master;\r\n  },\r\n  get master() {\r\n    return this._master;\r\n  },\r\n  get type() {\r\n    return Cell.Types.Merge;\r\n  },\r\n  get effectiveType() {\r\n    return this._master.effectiveType;\r\n  },\r\n  get address() {\r\n    return this.model.address;\r\n  },\r\n  set address(value) {\r\n    this.model.address = value;\r\n  },\r\n  toCsvString: function() {\r\n    return '';\r\n  },\r\n  release: function() {\r\n    this._master.releaseMergeRef();\r\n  },\r\n  toString: function() {\r\n    return this.value.toString();\r\n  }\r\n};\r\n\r\nvar FormulaValue = function(cell, value) {\r\n  this.cell = cell;\r\n  this.model = {\r\n    address: cell.address,\r\n    type: Cell.Types.Formula,\r\n    formula: value ? value.formula : undefined,\r\n    sharedFormula: value ? value.sharedFormula : undefined,\r\n    result: value ? value.result : undefined\r\n  };\r\n};\r\nFormulaValue.prototype = {\r\n  get value() {\r\n    return this.model.formula ? {\r\n      formula: this.model.formula,\r\n      result: this.model.result,\r\n    } : {\r\n      sharedFormula: this.model.sharedFormula,\r\n      result: this.model.result,\r\n    };\r\n  },\r\n  set value(value) {\r\n    this.model.formula = value.formula;\r\n    this.model.sharedFormula = value.sharedFormula;\r\n    this.model.result = value.result;\r\n  },\r\n  validate: function(value) {\r\n    switch (Value.getType(value)) {\r\n      case Cell.Types.Null:\r\n      case Cell.Types.String:\r\n      case Cell.Types.Number:\r\n      case Cell.Types.Date:\r\n        break;\r\n      case Cell.Types.Hyperlink:\r\n      case Cell.Types.Formula:\r\n      default:\r\n        throw new Error('Cannot process that type of result value');\r\n    }\r\n  },\r\n  get dependencies() {\r\n    // find all the ranges and cells mentioned in the formula\r\n    var ranges = this.formula.match(/([a-zA-Z0-9]+!)?[A-Z]{1,3}\\d{1,4}:[A-Z]{1,3}\\d{1,4}/g);\r\n    var cells = this.formula.replace(/([a-zA-Z0-9]+!)?[A-Z]{1,3}\\d{1,4}:[A-Z]{1,3}\\d{1,4}/g, '')\r\n      .match(/([a-zA-Z0-9]+!)?[A-Z]{1,3}\\d{1,4}/g);\r\n    return {\r\n      ranges: ranges,\r\n      cells: cells\r\n    };\r\n  },\r\n  get formula() {\r\n    return this.model.formula ||\r\n      this._getTranslatedFormula();\r\n  },\r\n  set formula(value) {\r\n    this.model.formula = value;\r\n  },\r\n  get formulaType() {\r\n    if (this.model.formula) {\r\n      return Enums.FormulaType.Master;\r\n    }\r\n    if (this.model.sharedFormula) {\r\n      return Enums.FormulaType.Shared;\r\n    }\r\n    return Enums.FormulaType.None;\r\n  },\r\n  get result() {\r\n    return this.model.result;\r\n  },\r\n  set result(value) {\r\n    this.model.result = value;\r\n  },\r\n  get type() {\r\n    return Cell.Types.Formula;\r\n  },\r\n  get effectiveType() {\r\n    var v = this.model.result;\r\n    if ((v === null) || (v === undefined)) {\r\n      return Enums.ValueType.Null;\r\n    } else if ((v instanceof String) || (typeof v === 'string')) {\r\n      return Enums.ValueType.String;\r\n    } else if (typeof v === 'number') {\r\n      return Enums.ValueType.Number;\r\n    } else if (v instanceof Date) {\r\n      return Enums.ValueType.Date;\r\n    } else if (v.text && v.hyperlink) {\r\n      return Enums.ValueType.Hyperlink;\r\n    } else if (v.formula) {\r\n      return Enums.ValueType.Formula;\r\n    }\r\n\r\n    return Enums.ValueType.Null;\r\n  },\r\n  get address() {\r\n    return this.model.address;\r\n  },\r\n  set address(value) {\r\n    this.model.address = value;\r\n  },\r\n  _getTranslatedFormula() {\r\n    if (!this._translatedFormula && this.model.sharedFormula) {\r\n      var worksheet = this.cell.worksheet;\r\n      var master = worksheet.findCell(this.model.sharedFormula);\r\n      this._translatedFormula = master &&\r\n        slideFormula(master.formula, master.address, this.model.address);\r\n    }\r\n    return this._translatedFormula;\r\n  },\r\n  toCsvString: function() {\r\n    return '' + (this.model.result || '');\r\n  },\r\n  release: function() {\r\n  },\r\n  toString: function() {\r\n    return this.model.result ? this.model.result.toString() : '';\r\n  }\r\n};\r\n\r\nvar SharedStringValue = function(cell, value) {\r\n  this.model = {\r\n    address: cell.address,\r\n    type: Cell.Types.SharedString,\r\n    value: value\r\n  };\r\n};\r\nSharedStringValue.prototype = {\r\n  get value() {\r\n    return this.model.value;\r\n  },\r\n  set value(value) {\r\n    this.model.value = value;\r\n  },\r\n  get type() {\r\n    return Cell.Types.SharedString;\r\n  },\r\n  get effectiveType() {\r\n    return Cell.Types.SharedString;\r\n  },\r\n  get address() {\r\n    return this.model.address;\r\n  },\r\n  set address(value) {\r\n    this.model.address = value;\r\n  },\r\n  toCsvString: function() {\r\n    return '' + this.model.value;\r\n  },\r\n  release: function() {\r\n  },\r\n  toString: function() {\r\n    return this.model.value.toString();\r\n  }\r\n};\r\n\r\nvar BooleanValue = function(cell, value) {\r\n  this.model = {\r\n    address: cell.address,\r\n    type: Cell.Types.Boolean,\r\n    value: value\r\n  };\r\n};\r\nBooleanValue.prototype = {\r\n  get value() {\r\n    return this.model.value;\r\n  },\r\n  set value(value) {\r\n    this.model.value = value;\r\n  },\r\n  get type() {\r\n    return Cell.Types.Boolean;\r\n  },\r\n  get effectiveType() {\r\n    return Cell.Types.Boolean;\r\n  },\r\n  get address() {\r\n    return this.model.address;\r\n  },\r\n  set address(value) {\r\n    this.model.address = value;\r\n  },\r\n  toCsvString: function() {\r\n    return this.model.value ? 1 : 0;\r\n  },\r\n  release: function() {\r\n  },\r\n  toString: function() {\r\n    return this.model.value.toString();\r\n  }\r\n};\r\n\r\nvar ErrorValue = function(cell, value) {\r\n  this.model = {\r\n    address: cell.address,\r\n    type: Cell.Types.Error,\r\n    value: value\r\n  };\r\n};\r\nErrorValue.prototype = {\r\n  get value() {\r\n    return this.model.value;\r\n  },\r\n  set value(value) {\r\n    this.model.value = value;\r\n  },\r\n  get type() {\r\n    return Cell.Types.Error;\r\n  },\r\n  get effectiveType() {\r\n    return Cell.Types.Error;\r\n  },\r\n  get address() {\r\n    return this.model.address;\r\n  },\r\n  set address(value) {\r\n    this.model.address = value;\r\n  },\r\n  toCsvString: function() {\r\n    return this.toString();\r\n  },\r\n  release: function() {\r\n  },\r\n  toString: function() {\r\n    return this.model.value.error.toString();\r\n  }\r\n};\r\n\r\nvar JSONValue = function(cell, value) {\r\n  this.model = {\r\n    address: cell.address,\r\n    type: Cell.Types.String,\r\n    value: JSON.stringify(value),\r\n    rawValue: value\r\n  };\r\n};\r\nJSONValue.prototype = {\r\n  get value() {\r\n    return this.model.rawValue;\r\n  },\r\n  set value(value) {\r\n    this.model.rawValue = value;\r\n    this.model.value = JSON.stringify(value);\r\n  },\r\n  get type() {\r\n    return Cell.Types.String;\r\n  },\r\n  get effectiveType() {\r\n    return Cell.Types.String;\r\n  },\r\n  get address() {\r\n    return this.model.address;\r\n  },\r\n  set address(value) {\r\n    this.model.address = value;\r\n  },\r\n  toCsvString: function() {\r\n    return this.model.value;\r\n  },\r\n  release: function() {\r\n  },\r\n  toString: function() {\r\n    return this.model.value;\r\n  }\r\n};\r\n\r\n// Value is a place to hold common static Value type functions\r\nvar Value = {\r\n  getType: function(value) {\r\n    if ((value === null) || (value === undefined)) {\r\n      return Cell.Types.Null;\r\n    } else if ((value instanceof String) || (typeof value === 'string')) {\r\n      return Cell.Types.String;\r\n    } else if (typeof value === 'number') {\r\n      return Cell.Types.Number;\r\n    } else if (typeof value === 'boolean') {\r\n      return Cell.Types.Boolean;\r\n    } else if (value instanceof Date) {\r\n      return Cell.Types.Date;\r\n    } else if (value.text && value.hyperlink) {\r\n      return Cell.Types.Hyperlink;\r\n    } else if (value.formula || value.sharedFormula) {\r\n      return Cell.Types.Formula;\r\n    } else if (value.richText) {\r\n      return Cell.Types.RichText;\r\n    } else if (value.sharedString) {\r\n      return Cell.Types.SharedString;\r\n    } else if (value.error) {\r\n      return Cell.Types.Error;\r\n    }\r\n    return Cell.Types.JSON;\r\n  },\r\n\r\n  // map valueType to constructor\r\n  types: [\r\n    {t: Cell.Types.Null, f: NullValue},\r\n    {t: Cell.Types.Number, f: NumberValue},\r\n    {t: Cell.Types.String, f: StringValue},\r\n    {t: Cell.Types.Date, f: DateValue},\r\n    {t: Cell.Types.Hyperlink, f: HyperlinkValue},\r\n    {t: Cell.Types.Formula, f: FormulaValue},\r\n    {t: Cell.Types.Merge, f: MergeValue},\r\n    {t: Cell.Types.JSON, f: JSONValue},\r\n    {t: Cell.Types.SharedString, f: SharedStringValue},\r\n    {t: Cell.Types.RichText, f: RichTextValue},\r\n    {t: Cell.Types.Boolean, f: BooleanValue},\r\n    {t: Cell.Types.Error, f: ErrorValue},\r\n  ].reduce((p, t) => { p[t.t] = t.f; return p; }, []),\r\n\r\n  create: function(type, cell, value) {\r\n    var T = this.types[type];\r\n    if (!T) {\r\n      throw new Error('Could not create Value of type ' + type);\r\n    }\r\n    return new T(cell, value);\r\n  }\r\n};\r\n"]}
##############################################
/src/dist/es5/doc/cell.js-30-
/src/dist/es5/doc/cell.js:31:  // TODO: lazy evaluation of this._value
/src/dist/es5/doc/cell.js-32-  this._value = Value.create(Cell.Types.Null, this);
