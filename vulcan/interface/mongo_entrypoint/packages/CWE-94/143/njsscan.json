{
  "errors": [
    {
      "data": {
        "check_id": "LexicalError",
        "end": {
          "col": 1,
          "line": 202
        },
        "extra": {
          "line": "  limitations under the License.",
          "message": "Lexical error: WIERD end of file in quoted string"
        },
        "path": "/src/LICENSE",
        "start": {
          "col": 1,
          "line": 202
        }
      },
      "message": "SemgrepCoreRuntimeErrors"
    },
    {
      "data": {
        "check_id": "FatalError",
        "end": {
          "col": 1,
          "line": 1
        },
        "extra": {
          "line": "export * from 'pouchdb-browser';",
          "message": "Fatal Error: Ast_js_build.UnhandledConstruct(\"reexporting namespace\", _)"
        },
        "path": "/src/src/pouchdb-browser.js",
        "start": {
          "col": 1,
          "line": 1
        }
      },
      "message": "SemgrepCoreRuntimeErrors"
    },
    {
      "data": {
        "check_id": "FatalError",
        "end": {
          "col": 1,
          "line": 1
        },
        "extra": {
          "line": "export * from 'pouchdb-node';",
          "message": "Fatal Error: Ast_js_build.UnhandledConstruct(\"reexporting namespace\", _)"
        },
        "path": "/src/src/pouchdb.js",
        "start": {
          "col": 1,
          "line": 1
        }
      },
      "message": "SemgrepCoreRuntimeErrors"
    }
  ],
  "nodejs": {
    "eval_nodejs": {
      "files": [
        {
          "file_path": "/src/dist/pouchdb-next.js",
          "match_lines": [
            2602,
            2602
          ],
          "match_position": [
            13,
            50
          ],
          "match_string": "            setTimeout(ping, opts.interval || 200);"
        },
        {
          "file_path": "/src/dist/pouchdb-next.js",
          "match_lines": [
            4820,
            4823
          ],
          "match_position": [
            13,
            23
          ],
          "match_string": "    timer = setTimeout(function () {\n\n      wrappedPromise.reject(new Error('Load timeout for resource: ' +\n\n        options.url));\n\n    }, options.timeout);"
        },
        {
          "file_path": "/src/dist/pouchdb-next.js",
          "match_lines": [
            4927,
            4927
          ],
          "match_position": [
            13,
            51
          ],
          "match_string": "    timer = setTimeout(timeoutReq, options.timeout);"
        },
        {
          "file_path": "/src/dist/pouchdb-next.js",
          "match_lines": [
            4931,
            4931
          ],
          "match_position": [
            17,
            55
          ],
          "match_string": "        timer = setTimeout(timeoutReq, options.timeout);"
        },
        {
          "file_path": "/src/dist/pouchdb-next.js",
          "match_lines": [
            8384,
            8386
          ],
          "match_position": [
            3,
            45
          ],
          "match_string": "  opts.current_back_off = opts.current_back_off || STARTING_BACK_OFF;\n\n  opts.current_back_off = opts.back_off_function(opts.current_back_off);\n\n  setTimeout(callback, opts.current_back_off);"
        },
        {
          "file_path": "/src/dist/pouchdb-next.js",
          "match_lines": [
            8385,
            8386
          ],
          "match_position": [
            3,
            45
          ],
          "match_string": "  opts.current_back_off = opts.back_off_function(opts.current_back_off);\n\n  setTimeout(callback, opts.current_back_off);"
        },
        {
          "file_path": "/src/dist/pouchdb-next.js",
          "match_lines": [
            8386,
            8386
          ],
          "match_position": [
            3,
            45
          ],
          "match_string": "  setTimeout(callback, opts.current_back_off);"
        },
        {
          "file_path": "/src/dist/pouchdb.js",
          "match_lines": [
            9479,
            9482
          ],
          "match_position": [
            13,
            23
          ],
          "match_string": "    timer = setTimeout(function () {\n\n      wrappedPromise.reject(new Error('Load timeout for resource: ' +\n\n        options.url));\n\n    }, options.timeout);"
        },
        {
          "file_path": "/src/dist/pouchdb.js",
          "match_lines": [
            9586,
            9586
          ],
          "match_position": [
            13,
            51
          ],
          "match_string": "    timer = setTimeout(timeoutReq, options.timeout);"
        },
        {
          "file_path": "/src/dist/pouchdb.js",
          "match_lines": [
            9590,
            9590
          ],
          "match_position": [
            17,
            55
          ],
          "match_string": "        timer = setTimeout(timeoutReq, options.timeout);"
        },
        {
          "file_path": "/src/dist/pouchdb.js",
          "match_lines": [
            10036,
            10036
          ],
          "match_position": [
            13,
            50
          ],
          "match_string": "            setTimeout(ping, opts.interval || 200);"
        },
        {
          "file_path": "/src/dist/pouchdb.js",
          "match_lines": [
            12711,
            12713
          ],
          "match_position": [
            3,
            45
          ],
          "match_string": "  opts.current_back_off = opts.current_back_off || STARTING_BACK_OFF;\n\n  opts.current_back_off = opts.back_off_function(opts.current_back_off);\n\n  setTimeout(callback, opts.current_back_off);"
        },
        {
          "file_path": "/src/dist/pouchdb.js",
          "match_lines": [
            12712,
            12713
          ],
          "match_position": [
            3,
            45
          ],
          "match_string": "  opts.current_back_off = opts.back_off_function(opts.current_back_off);\n\n  setTimeout(callback, opts.current_back_off);"
        },
        {
          "file_path": "/src/dist/pouchdb.js",
          "match_lines": [
            12713,
            12713
          ],
          "match_position": [
            3,
            45
          ],
          "match_string": "  setTimeout(callback, opts.current_back_off);"
        },
        {
          "file_path": "/src/lib/index-browser.js",
          "match_lines": [
            6959,
            6962
          ],
          "match_position": [
            13,
            23
          ],
          "match_string": "    timer = setTimeout(function () {\n\n      wrappedPromise.reject(new Error('Load timeout for resource: ' +\n\n        options.url));\n\n    }, options.timeout);"
        },
        {
          "file_path": "/src/lib/index-browser.js",
          "match_lines": [
            7066,
            7066
          ],
          "match_position": [
            13,
            51
          ],
          "match_string": "    timer = setTimeout(timeoutReq, options.timeout);"
        },
        {
          "file_path": "/src/lib/index-browser.js",
          "match_lines": [
            7070,
            7070
          ],
          "match_position": [
            17,
            55
          ],
          "match_string": "        timer = setTimeout(timeoutReq, options.timeout);"
        },
        {
          "file_path": "/src/lib/index-browser.js",
          "match_lines": [
            7516,
            7516
          ],
          "match_position": [
            13,
            50
          ],
          "match_string": "            setTimeout(ping, opts.interval || 200);"
        },
        {
          "file_path": "/src/lib/index-browser.js",
          "match_lines": [
            10191,
            10193
          ],
          "match_position": [
            3,
            45
          ],
          "match_string": "  opts.current_back_off = opts.current_back_off || STARTING_BACK_OFF;\n\n  opts.current_back_off = opts.back_off_function(opts.current_back_off);\n\n  setTimeout(callback, opts.current_back_off);"
        },
        {
          "file_path": "/src/lib/index-browser.js",
          "match_lines": [
            10192,
            10193
          ],
          "match_position": [
            3,
            45
          ],
          "match_string": "  opts.current_back_off = opts.back_off_function(opts.current_back_off);\n\n  setTimeout(callback, opts.current_back_off);"
        },
        {
          "file_path": "/src/lib/index-browser.js",
          "match_lines": [
            10193,
            10193
          ],
          "match_position": [
            3,
            45
          ],
          "match_string": "  setTimeout(callback, opts.current_back_off);"
        },
        {
          "file_path": "/src/lib/index.js",
          "match_lines": [
            5714,
            5714
          ],
          "match_position": [
            13,
            50
          ],
          "match_string": "            setTimeout(ping, opts.interval || 200);"
        },
        {
          "file_path": "/src/lib/index.js",
          "match_lines": [
            8389,
            8391
          ],
          "match_position": [
            3,
            45
          ],
          "match_string": "  opts.current_back_off = opts.current_back_off || STARTING_BACK_OFF;\n\n  opts.current_back_off = opts.back_off_function(opts.current_back_off);\n\n  setTimeout(callback, opts.current_back_off);"
        },
        {
          "file_path": "/src/lib/index.js",
          "match_lines": [
            8390,
            8391
          ],
          "match_position": [
            3,
            45
          ],
          "match_string": "  opts.current_back_off = opts.back_off_function(opts.current_back_off);\n\n  setTimeout(callback, opts.current_back_off);"
        },
        {
          "file_path": "/src/lib/index.js",
          "match_lines": [
            8391,
            8391
          ],
          "match_position": [
            3,
            45
          ],
          "match_string": "  setTimeout(callback, opts.current_back_off);"
        }
      ],
      "metadata": {
        "cwe": "CWE-95: Improper Neutralization of Directives in Dynamically Evaluated Code ('Eval Injection')",
        "description": "User controlled data in eval() or similar functions may result in Server Side Injection or Remote Code Injection",
        "owasp": "A1: Injection",
        "severity": "ERROR"
      }
    },
    "generic_error_disclosure": {
      "files": [
        {
          "file_path": "/src/dist/pouchdb-next.js",
          "match_lines": [
            752,
            752
          ],
          "match_position": [
            9,
            22
          ],
          "match_string": "        console.trace();"
        },
        {
          "file_path": "/src/dist/pouchdb.js",
          "match_lines": [
            758,
            758
          ],
          "match_position": [
            9,
            22
          ],
          "match_string": "        console.trace();"
        }
      ],
      "metadata": {
        "cwe": "CWE-209: Generation of Error Message Containing Sensitive Information",
        "description": "Error messages with stack traces may expose sensitive information about the application.",
        "owasp": "A3: Sensitive Data Exposure",
        "severity": "WARNING"
      }
    },
    "node_insecure_random_generator": {
      "files": [
        {
          "file_path": "/src/dist/pouchdb-next.js",
          "match_lines": [
            9660,
            9660
          ],
          "match_position": [
            15,
            26
          ],
          "match_string": "  var ratio = Math.random();"
        },
        {
          "file_path": "/src/dist/pouchdb-next.js",
          "match_lines": [
            9947,
            9947
          ],
          "match_position": [
            14,
            25
          ],
          "match_string": "  return 0 | Math.random() * radix;"
        },
        {
          "file_path": "/src/dist/pouchdb.js",
          "match_lines": [
            3089,
            3089
          ],
          "match_position": [
            15,
            26
          ],
          "match_string": "  var ratio = Math.random();"
        },
        {
          "file_path": "/src/dist/pouchdb.js",
          "match_lines": [
            3537,
            3537
          ],
          "match_position": [
            14,
            25
          ],
          "match_string": "  return 0 | Math.random() * radix;"
        },
        {
          "file_path": "/src/lib/index-browser.js",
          "match_lines": [
            569,
            569
          ],
          "match_position": [
            15,
            26
          ],
          "match_string": "  var ratio = Math.random();"
        },
        {
          "file_path": "/src/lib/index-browser.js",
          "match_lines": [
            1017,
            1017
          ],
          "match_position": [
            14,
            25
          ],
          "match_string": "  return 0 | Math.random() * radix;"
        },
        {
          "file_path": "/src/lib/index.js",
          "match_lines": [
            546,
            546
          ],
          "match_position": [
            15,
            26
          ],
          "match_string": "  var ratio = Math.random();"
        },
        {
          "file_path": "/src/lib/index.js",
          "match_lines": [
            1014,
            1014
          ],
          "match_position": [
            14,
            25
          ],
          "match_string": "  return 0 | Math.random() * radix;"
        },
        {
          "file_path": "/src/lib/plugins/fruitdown.js",
          "match_lines": [
            1027,
            1027
          ],
          "match_position": [
            14,
            25
          ],
          "match_string": "  return 0 | Math.random() * radix;"
        },
        {
          "file_path": "/src/lib/plugins/localstorage.js",
          "match_lines": [
            1027,
            1027
          ],
          "match_position": [
            14,
            25
          ],
          "match_string": "  return 0 | Math.random() * radix;"
        },
        {
          "file_path": "/src/lib/plugins/memory.js",
          "match_lines": [
            1027,
            1027
          ],
          "match_position": [
            14,
            25
          ],
          "match_string": "  return 0 | Math.random() * radix;"
        }
      ],
      "metadata": {
        "cwe": "CWE-327: Use of a Broken or Risky Cryptographic Algorithm",
        "description": "crypto.pseudoRandomBytes()/Math.random() is a cryptographically weak random number generator.",
        "owasp": "A9: Using Components with Known Vulnerabilities",
        "severity": "WARNING"
      }
    },
    "node_md5": {
      "files": [
        {
          "file_path": "/src/lib/index.js",
          "match_lines": [
            3577,
            3577
          ],
          "match_position": [
            16,
            39
          ],
          "match_string": "  var base64 = crypto.createHash('md5').update(data, 'binary').digest('base64');"
        },
        {
          "file_path": "/src/lib/index.js",
          "match_lines": [
            3582,
            3582
          ],
          "match_position": [
            10,
            33
          ],
          "match_string": "  return crypto.createHash('md5').update(string, 'binary').digest('hex');"
        }
      ],
      "metadata": {
        "cwe": "CWE-327: Use of a Broken or Risky Cryptographic Algorithm",
        "description": "MD5 is a a weak hash which is known to have collision. Use a strong hashing function.",
        "owasp": "A9: Using Components with Known Vulnerabilities",
        "severity": "WARNING"
      }
    },
    "regex_dos": {
      "files": [
        {
          "file_path": "/src/dist/pouchdb-next.js",
          "match_lines": [
            5118,
            5118
          ],
          "match_position": [
            19,
            41
          ],
          "match_string": "  var isBlobUrl = /^blob:/.test(opts.url); // don't append nonces for blob URLs"
        },
        {
          "file_path": "/src/dist/pouchdb-next.js",
          "match_lines": [
            7138,
            7142
          ],
          "match_position": [
            3,
            43
          ],
          "match_string": "  var match = name.match(/([a-z\\-]*):\\/\\/(.*)/);\n\n  if (match) {\n\n    // the http adapter expects the fully qualified name\n\n    name = /http(s?)/.test(match[1]) ? match[1] + '://' + match[2] : match[2];\n\n    return {name: name, adapter: match[1]};"
        },
        {
          "file_path": "/src/dist/pouchdb.js",
          "match_lines": [
            5134,
            5138
          ],
          "match_position": [
            3,
            43
          ],
          "match_string": "  var match = name.match(/([a-z\\-]*):\\/\\/(.*)/);\n\n  if (match) {\n\n    // the http adapter expects the fully qualified name\n\n    name = /http(s?)/.test(match[1]) ? match[1] + '://' + match[2] : match[2];\n\n    return {name: name, adapter: match[1]};"
        },
        {
          "file_path": "/src/dist/pouchdb.js",
          "match_lines": [
            9777,
            9777
          ],
          "match_position": [
            19,
            41
          ],
          "match_string": "  var isBlobUrl = /^blob:/.test(opts.url); // don't append nonces for blob URLs"
        },
        {
          "file_path": "/src/lib/index-browser.js",
          "match_lines": [
            2614,
            2618
          ],
          "match_position": [
            3,
            43
          ],
          "match_string": "  var match = name.match(/([a-z\\-]*):\\/\\/(.*)/);\n\n  if (match) {\n\n    // the http adapter expects the fully qualified name\n\n    name = /http(s?)/.test(match[1]) ? match[1] + '://' + match[2] : match[2];\n\n    return {name: name, adapter: match[1]};"
        },
        {
          "file_path": "/src/lib/index-browser.js",
          "match_lines": [
            7257,
            7257
          ],
          "match_position": [
            19,
            41
          ],
          "match_string": "  var isBlobUrl = /^blob:/.test(opts.url); // don't append nonces for blob URLs"
        },
        {
          "file_path": "/src/lib/index.js",
          "match_lines": [
            2611,
            2615
          ],
          "match_position": [
            3,
            43
          ],
          "match_string": "  var match = name.match(/([a-z\\-]*):\\/\\/(.*)/);\n\n  if (match) {\n\n    // the http adapter expects the fully qualified name\n\n    name = /http(s?)/.test(match[1]) ? match[1] + '://' + match[2] : match[2];\n\n    return {name: name, adapter: match[1]};"
        }
      ],
      "metadata": {
        "cwe": "CWE-185: Incorrect Regular Expression",
        "description": "Ensure that the regex used to compare with user supplied input is safe from regular expression denial of service.",
        "owasp": "A6: Security Misconfiguration",
        "severity": "WARNING"
      }
    }
  },
  "templates": {}
}
