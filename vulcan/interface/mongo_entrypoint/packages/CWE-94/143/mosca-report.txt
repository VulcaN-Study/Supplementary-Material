<report_mosca>
 <Path>/src/tonic-example.js</Path>
 <Module>/app/Mosca/eggs/javascript_common_fail.egg</Module>
 <Title> Possible SQL injection</Title>
 <Description> notification possible SQL injection</Description>
 <Level> High</Level>
 <Reference> https://www.owasp.org/index.php/Testing_for_Stack_Overflow </Reference>
 <Match> query|YQL|WHERE|FROM|SELECT|UPDATE|DELETE|INSERT|UNION|getResults</Match>
 <Result> Line: 36 -  // and query them

</Result>
</report_mosca>

<report_mosca>
 <Path>/src/lib/plugins/fruitdown.js</Path>
 <Module>/app/Mosca/eggs/javascript_common_fail.egg</Module>
 <Title> Possible code injection</Title>
 <Description> Command injection is an attack in which the goal is execution of arbitrary commands on the host operating system via a vulnerable application.</Description>
 <Level> High</Level>
 <Reference> https://www.securecoding.cert.org/confluence/pages/viewpage.action?pageId=2130132 </Reference>
 <Match> eval\s?\(|setTimeout|setInterval</Match>
 <Result> Line: 671 -          setTimeout(function (){

 Line: 1719 -  var setImmediateShim = global.setImmediate || global.setTimeout;

</Result>
</report_mosca>

<report_mosca>
 <Path>/src/lib/plugins/fruitdown.js</Path>
 <Module>/app/Mosca/eggs/javascript_common_fail.egg</Module>
 <Title> Possible SQL injection</Title>
 <Description> notification possible SQL injection</Description>
 <Level> High</Level>
 <Reference> https://www.owasp.org/index.php/Testing_for_Stack_Overflow </Reference>
 <Match> query|YQL|WHERE|FROM|SELECT|UPDATE|DELETE|INSERT|UNION|getResults</Match>
 <Result> Line: 793 -    reason: 'Some query argument is invalid'

 Line: 805 -    reason: 'Some query parameter is invalid'

 Line: 2095 -  var UPDATE_SEQ_KEY = '_local_last_update_seq';

 Line: 2229 -        stores.metaStore.get(UPDATE_SEQ_KEY, function (err, value) {

 Line: 2817 -            key: UPDATE_SEQ_KEY,

</Result>
</report_mosca>

<report_mosca>
 <Path>/src/lib/plugins/memory.js</Path>
 <Module>/app/Mosca/eggs/javascript_common_fail.egg</Module>
 <Title> Possible code injection</Title>
 <Description> Command injection is an attack in which the goal is execution of arbitrary commands on the host operating system via a vulnerable application.</Description>
 <Level> High</Level>
 <Reference> https://www.securecoding.cert.org/confluence/pages/viewpage.action?pageId=2130132 </Reference>
 <Match> eval\s?\(|setTimeout|setInterval</Match>
 <Result> Line: 671 -          setTimeout(function (){

 Line: 1719 -  var setImmediateShim = global.setImmediate || global.setTimeout;

</Result>
</report_mosca>

<report_mosca>
 <Path>/src/lib/plugins/memory.js</Path>
 <Module>/app/Mosca/eggs/javascript_common_fail.egg</Module>
 <Title> Possible SQL injection</Title>
 <Description> notification possible SQL injection</Description>
 <Level> High</Level>
 <Reference> https://www.owasp.org/index.php/Testing_for_Stack_Overflow </Reference>
 <Match> query|YQL|WHERE|FROM|SELECT|UPDATE|DELETE|INSERT|UNION|getResults</Match>
 <Result> Line: 793 -    reason: 'Some query argument is invalid'

 Line: 805 -    reason: 'Some query parameter is invalid'

 Line: 2095 -  var UPDATE_SEQ_KEY = '_local_last_update_seq';

 Line: 2229 -        stores.metaStore.get(UPDATE_SEQ_KEY, function (err, value) {

 Line: 2817 -            key: UPDATE_SEQ_KEY,

</Result>
</report_mosca>

<report_mosca>
 <Path>/src/lib/plugins/localstorage.js</Path>
 <Module>/app/Mosca/eggs/javascript_common_fail.egg</Module>
 <Title> Possible code injection</Title>
 <Description> Command injection is an attack in which the goal is execution of arbitrary commands on the host operating system via a vulnerable application.</Description>
 <Level> High</Level>
 <Reference> https://www.securecoding.cert.org/confluence/pages/viewpage.action?pageId=2130132 </Reference>
 <Match> eval\s?\(|setTimeout|setInterval</Match>
 <Result> Line: 671 -          setTimeout(function (){

 Line: 1719 -  var setImmediateShim = global.setImmediate || global.setTimeout;

</Result>
</report_mosca>

<report_mosca>
 <Path>/src/lib/plugins/localstorage.js</Path>
 <Module>/app/Mosca/eggs/javascript_common_fail.egg</Module>
 <Title> Possible SQL injection</Title>
 <Description> notification possible SQL injection</Description>
 <Level> High</Level>
 <Reference> https://www.owasp.org/index.php/Testing_for_Stack_Overflow </Reference>
 <Match> query|YQL|WHERE|FROM|SELECT|UPDATE|DELETE|INSERT|UNION|getResults</Match>
 <Result> Line: 793 -    reason: 'Some query argument is invalid'

 Line: 805 -    reason: 'Some query parameter is invalid'

 Line: 2095 -  var UPDATE_SEQ_KEY = '_local_last_update_seq';

 Line: 2229 -        stores.metaStore.get(UPDATE_SEQ_KEY, function (err, value) {

 Line: 2817 -            key: UPDATE_SEQ_KEY,

</Result>
</report_mosca>

<report_mosca>
 <Path>/src/lib/index-browser.js</Path>
 <Module>/app/Mosca/eggs/javascript_common_fail.egg</Module>
 <Title> Possible code injection</Title>
 <Description> Command injection is an attack in which the goal is execution of arbitrary commands on the host operating system via a vulnerable application.</Description>
 <Level> High</Level>
 <Reference> https://www.securecoding.cert.org/confluence/pages/viewpage.action?pageId=2130132 </Reference>
 <Match> eval\s?\(|setTimeout|setInterval</Match>
 <Result> Line: 508 -          setTimeout(function (){

 Line: 3099 -  var setImmediateShim = global.setImmediate || global.setTimeout;

 Line: 6958 -      timer = setTimeout(function () {

 Line: 7065 -      timer = setTimeout(timeoutReq, options.timeout);

 Line: 7069 -          timer = setTimeout(timeoutReq, options.timeout);

 Line: 7477 -    setTimeout(function () {

 Line: 7515 -              setTimeout(ping, opts.interval || 200);

 Line: 8172 -          setTimeout(function () { fetch(lastFetchedSeq, fetched); }, 0);

 Line: 10192 -    setTimeout(callback, opts.current_back_off);

</Result>
</report_mosca>

<report_mosca>
 <Path>/src/lib/index-browser.js</Path>
 <Module>/app/Mosca/eggs/javascript_common_fail.egg</Module>
 <Title> Possible SQL injection</Title>
 <Description> notification possible SQL injection</Description>
 <Level> High</Level>
 <Reference> https://www.owasp.org/index.php/Testing_for_Stack_Overflow </Reference>
 <Match> query|YQL|WHERE|FROM|SELECT|UPDATE|DELETE|INSERT|UNION|getResults</Match>
 <Result> Line: 664 -    reason: 'Some query argument is invalid'

 Line: 676 -    reason: 'Some query parameter is invalid'

 Line: 5375 -    return 'SELECT ' + selector + ' FROM ' +

 Line: 5378 -      (where ? (' WHERE ' +

 Line: 5405 -      var sql = 'SELECT DISTINCT digest AS digest FROM ' +

 Line: 5406 -        ATTACH_AND_SEQ_STORE$1 + ' WHERE seq IN ' + qMarks(seqs.length);

 Line: 5418 -        var sql = 'DELETE FROM ' + ATTACH_AND_SEQ_STORE$1 +

 Line: 5419 -          ' WHERE seq IN (' +

 Line: 5424 -          var sql = 'SELECT digest FROM ' + ATTACH_AND_SEQ_STORE$1 +

 Line: 5425 -            ' WHERE digest IN (' +

 Line: 5438 -                'DELETE FROM ' + ATTACH_AND_SEQ_STORE$1 + ' WHERE digest=?',

 Line: 5441 -                'DELETE FROM ' + ATTACH_STORE$1 + ' WHERE digest=?', [digest]);

 Line: 5450 -      var sql = 'SELECT seq FROM ' + BY_SEQ_STORE$1 +

 Line: 5451 -        ' WHERE doc_id=? AND rev=?';

 Line: 5461 -          'DELETE FROM ' + BY_SEQ_STORE$1 + ' WHERE seq=?', [seq], checkDone);

 Line: 5530 -      var sql = 'SELECT count(*) as cnt FROM ' + ATTACH_STORE$1 +

 Line: 5531 -        ' WHERE digest=?';

 Line: 5587 -        var sql = 'INSERT INTO ' + BY_SEQ_STORE$1 +

 Line: 5607 -            var sql = 'INSERT INTO ' + ATTACH_AND_SEQ_STORE$1 +

 Line: 5631 -            var sql = 'UPDATE ' + BY_SEQ_STORE$1 +

 Line: 5632 -              ' SET json=?, deleted=? WHERE doc_id=? AND rev=?;';

 Line: 5705 -        'UPDATE ' + DOC_STORE$1 +

 Line: 5707 -        '(SELECT seq FROM ' + BY_SEQ_STORE$1 +

 Line: 5708 -        ' WHERE doc_id=' + DOC_STORE$1 + '.id AND rev=?) WHERE id=?'

 Line: 5709 -          : 'INSERT INTO ' + DOC_STORE$1 +

 Line: 5750 -        tx.executeSql('SELECT json FROM ' + DOC_STORE$1 +

 Line: 5751 -        ' WHERE id = ?', [id], function (tx, result) {

 Line: 5762 -      var sql = 'SELECT digest FROM ' + ATTACH_STORE$1 + ' WHERE digest=?';

 Line: 5770 -        sql = 'INSERT INTO ' + ATTACH_STORE$1 +

 Line: 5867 -  var BY_SEQ_STORE_DELETED_INDEX_SQL =

 Line: 5886 -  var SELECT_DOCS = BY_SEQ_STORE$1 + '.seq AS seq, ' +

 Line: 5933 -      // index used for the join in the allDocs query

 Line: 5938 -        tx.executeSql(BY_SEQ_STORE_DELETED_INDEX_SQL);

 Line: 5944 -          var sql = 'SELECT ' + DOC_STORE$1 + '.winningseq AS seq, ' + DOC_STORE$1 +

 Line: 5945 -            '.json AS metadata FROM ' + BY_SEQ_STORE$1 + ' JOIN ' + DOC_STORE$1 +

 Line: 5964 -            tx.executeSql('UPDATE ' + DOC_STORE$1 + 'SET local = 1 WHERE id IN ' +

 Line: 5966 -              tx.executeSql('UPDATE ' + BY_SEQ_STORE$1 +

 Line: 5967 -                ' SET deleted = 1 WHERE seq IN ' +

 Line: 5980 -        var sql = 'SELECT ' + DOC_STORE$1 + '.id AS id, ' +

 Line: 5982 -          'FROM ' + BY_SEQ_STORE$1 + ' JOIN ' +

 Line: 5984 -          DOC_STORE$1 + '.winningseq WHERE local = 1';

 Line: 5996 -            tx.executeSql('INSERT INTO ' + LOCAL_STORE$1 +

 Line: 5999 -              tx.executeSql('DELETE FROM ' + DOC_STORE$1 + ' WHERE id=?',

 Line: 6001 -                tx.executeSql('DELETE FROM ' + BY_SEQ_STORE$1 + ' WHERE seq=?',

 Line: 6026 -          var sql = 'UPDATE ' + BY_SEQ_STORE$1 +

 Line: 6027 -            ' SET doc_id=?, rev=? WHERE doc_id_rev=?';

 Line: 6040 -            var sql = 'SELECT hex(doc_id_rev) as hex FROM ' + BY_SEQ_STORE$1;

 Line: 6061 -        var sql = 'SELECT COUNT(*) AS cnt FROM ' + ATTACH_STORE$1;

 Line: 6072 -              SELECT_DOCS + ', ' + DOC_STORE$1 + '.id AS id',

 Line: 6113 -                var sql = 'INSERT INTO ' + ATTACH_AND_SEQ_STORE$1 +

 Line: 6153 -        var sql = 'UPDATE ' + DOC_STORE$1 + ' SET max_seq=(SELECT MAX(seq) FROM ' +

 Line: 6154 -          BY_SEQ_STORE$1 + ' WHERE doc_id=id)';

 Line: 6168 -      tx.executeSql('SELECT HEX("a") AS hex', [], function (tx, res) {

 Line: 6212 -            tx.executeSql(BY_SEQ_STORE_DELETED_INDEX_SQL);

 Line: 6216 -              var initSeq = 'INSERT INTO ' + META_STORE$1 +

 Line: 6232 -            tx.executeSql('UPDATE ' + META_STORE$1 + ' SET db_version = ' +

 Line: 6236 -          var sql = 'SELECT dbid FROM ' + META_STORE$1;

 Line: 6276 -      var sql = 'SELECT sql FROM sqlite_master WHERE tbl_name = ' + META_STORE$1;

 Line: 6290 -          tx.executeSql('SELECT db_version FROM ' + META_STORE$1,

 Line: 6312 -          var sql = 'SELECT MAX(seq) AS seq FROM ' + BY_SEQ_STORE$1;

 Line: 6348 -          SELECT_DOCS,

 Line: 6355 -          SELECT_DOCS,

 Line: 6450 -            SELECT_DOCS,

 Line: 6562 -          // we can just limit in the query

 Line: 6631 -      var sql = 'SELECT escaped, ' +

 Line: 6632 -        'CASE WHEN escaped = 1 THEN body ELSE HEX(body) END AS body FROM ' +

 Line: 6633 -        ATTACH_STORE$1 + ' WHERE digest=?';

 Line: 6653 -        var sql = 'SELECT json AS metadata FROM ' + DOC_STORE$1 + ' WHERE id = ?';

 Line: 6672 -        var sql = 'SELECT json AS metadata FROM ' + DOC_STORE$1 + ' WHERE id = ?';

 Line: 6683 -          var sql = 'UPDATE ' + DOC_STORE$1 + ' SET json = ? WHERE id = ?';

 Line: 6695 -        var sql = 'SELECT json, rev FROM ' + LOCAL_STORE$1 + ' WHERE id=?';

 Line: 6729 -          sql = 'UPDATE ' + LOCAL_STORE$1 + ' SET rev=?, json=? ' +

 Line: 6730 -            'WHERE id=? AND rev=?';

 Line: 6733 -          sql = 'INSERT INTO ' + LOCAL_STORE$1 + ' (id, rev, json) VALUES (?,?,?)';

 Line: 6770 -        var sql = 'DELETE FROM ' + LOCAL_STORE$1 + ' WHERE id=? AND rev=?';

 Line: 7763 -        method: 'DELETE',

 Line: 7799 -        method: 'DELETE',

 Line: 8217 -        method: 'DELETE'

 Line: 9042 -    // Format the list of parameters into a valid URI query string

 Line: 9046 -    // If keys are supplied, issue a POST to circumvent GET query string limits

 Line: 9069 -    // We are referencing a query defined in the design doc

 Line: 9410 -  function queryView(view, opts) {

 Line: 9412 -      return queryViewInQueue(view, opts);

 Line: 9416 -  function queryViewInQueue(view, opts) {

 Line: 9421 -      // equivalent query

 Line: 9508 -    } else { // normal query, no 'keys'

 Line: 9622 -  function queryPromised(db, fun, opts) {

 Line: 9649 -            return queryView(view, opts);

 Line: 9682 -            return queryView(view, opts);

 Line: 9685 -              return queryView(view, opts);

 Line: 9693 -  var query = function (fun, opts, callback) {

 Line: 9706 -      return queryPromised(db, fun, opts);

 Line: 9749 -    query: query,

 Line: 10197 -      result[key] = queryParams[key];

 Line: 10207 -    var queryParams = '';

 Line: 10211 -      queryParams = JSON.stringify(sortObjectPropertiesByKey(opts.query_params));

 Line: 10219 -      var queryData = res[0] + res[1] + filterFun + filterViewName +

 Line: 10220 -        queryParams + docIds;

</Result>
</report_mosca>

<report_mosca>
 <Path>/src/lib/index.js</Path>
 <Module>/app/Mosca/eggs/javascript_common_fail.egg</Module>
 <Title> Possible code injection</Title>
 <Description> Command injection is an attack in which the goal is execution of arbitrary commands on the host operating system via a vulnerable application.</Description>
 <Level> High</Level>
 <Reference> https://www.securecoding.cert.org/confluence/pages/viewpage.action?pageId=2130132 </Reference>
 <Match> eval\s?\(|setTimeout|setInterval</Match>
 <Result> Line: 485 -          setTimeout(function (){

 Line: 5675 -    setTimeout(function () {

 Line: 5713 -              setTimeout(ping, opts.interval || 200);

 Line: 6370 -          setTimeout(function () { fetch(lastFetchedSeq, fetched); }, 0);

 Line: 8390 -    setTimeout(callback, opts.current_back_off);

</Result>
</report_mosca>

<report_mosca>
 <Path>/src/lib/index.js</Path>
 <Module>/app/Mosca/eggs/javascript_common_fail.egg</Module>
 <Title> Possible SQL injection</Title>
 <Description> notification possible SQL injection</Description>
 <Level> High</Level>
 <Reference> https://www.owasp.org/index.php/Testing_for_Stack_Overflow </Reference>
 <Match> query|YQL|WHERE|FROM|SELECT|UPDATE|DELETE|INSERT|UNION|getResults</Match>
 <Result> Line: 638 -    reason: 'Some query argument is invalid'

 Line: 650 -    reason: 'Some query parameter is invalid'

 Line: 3218 -  var UPDATE_SEQ_KEY$1 = '_local_last_update_seq';

 Line: 3314 -        stores.bySeqStore.get(UPDATE_SEQ_KEY$1, function (err, value) {

 Line: 3316 -            // if no UPDATE_SEQ_KEY

 Line: 3320 -              key: UPDATE_SEQ_KEY$1,

 Line: 3327 -              key: UPDATE_SEQ_KEY$1,

 Line: 3890 -  var UPDATE_SEQ_KEY = '_local_last_update_seq';

 Line: 4024 -        stores.metaStore.get(UPDATE_SEQ_KEY, function (err, value) {

 Line: 4612 -            key: UPDATE_SEQ_KEY,

 Line: 5961 -        method: 'DELETE',

 Line: 5997 -        method: 'DELETE',

 Line: 6415 -        method: 'DELETE'

 Line: 7240 -    // Format the list of parameters into a valid URI query string

 Line: 7244 -    // If keys are supplied, issue a POST to circumvent GET query string limits

 Line: 7267 -    // We are referencing a query defined in the design doc

 Line: 7608 -  function queryView(view, opts) {

 Line: 7610 -      return queryViewInQueue(view, opts);

 Line: 7614 -  function queryViewInQueue(view, opts) {

 Line: 7619 -      // equivalent query

 Line: 7706 -    } else { // normal query, no 'keys'

 Line: 7820 -  function queryPromised(db, fun, opts) {

 Line: 7847 -            return queryView(view, opts);

 Line: 7880 -            return queryView(view, opts);

 Line: 7883 -              return queryView(view, opts);

 Line: 7891 -  var query = function (fun, opts, callback) {

 Line: 7904 -      return queryPromised(db, fun, opts);

 Line: 7947 -    query: query,

 Line: 8395 -      result[key] = queryParams[key];

 Line: 8405 -    var queryParams = '';

 Line: 8409 -      queryParams = JSON.stringify(sortObjectPropertiesByKey(opts.query_params));

 Line: 8417 -      var queryData = res[0] + res[1] + filterFun + filterViewName +

 Line: 8418 -        queryParams + docIds;

</Result>
</report_mosca>

<report_mosca>
 <Path>/src/dist/pouchdb.fruitdown.js</Path>
 <Module>/app/Mosca/eggs/javascript_common_fail.egg</Module>
 <Title> Possible code injection</Title>
 <Description> Command injection is an attack in which the goal is execution of arbitrary commands on the host operating system via a vulnerable application.</Description>
 <Level> High</Level>
 <Reference> https://www.securecoding.cert.org/confluence/pages/viewpage.action?pageId=2130132 </Reference>
 <Match> eval\s?\(|setTimeout|setInterval</Match>
 <Result> Line: 5344 -        setTimeout(nextTick, 0);

 Line: 7183 -      throw new Error('setTimeout has not been defined');

 Line: 7190 -          if (typeof setTimeout === 'function') {

 Line: 7191 -              cachedSetTimeout = setTimeout;

 Line: 7209 -      if (cachedSetTimeout === setTimeout) {

 Line: 7211 -          return setTimeout(fun, 0);

 Line: 7213 -      // if setTimeout wasn't available but was latter defined

 Line: 7214 -      if ((cachedSetTimeout === defaultSetTimout || !cachedSetTimeout) && setTimeout) {

 Line: 7215 -          cachedSetTimeout = setTimeout;

 Line: 7216 -          return setTimeout(fun, 0);

 Line: 7219 -          // when when somebody has screwed with setTimeout but no I.E. maddness

 Line: 7244 -          // when when somebody has screwed with setTimeout but no I.E. maddness

 Line: 7252 -              // Some versions of I.E. have different rules for clearTimeout vs setTimeout

 Line: 15279 -          setTimeout(function (){

 Line: 16327 -  var setImmediateShim = global.setImmediate || global.setTimeout;

</Result>
</report_mosca>

<report_mosca>
 <Path>/src/dist/pouchdb.fruitdown.js</Path>
 <Module>/app/Mosca/eggs/javascript_common_fail.egg</Module>
 <Title> Possible SQL injection</Title>
 <Description> notification possible SQL injection</Description>
 <Level> High</Level>
 <Reference> https://www.owasp.org/index.php/Testing_for_Stack_Overflow </Reference>
 <Match> query|YQL|WHERE|FROM|SELECT|UPDATE|DELETE|INSERT|UNION|getResults</Match>
 <Result> Line: 2464 -  // OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE

 Line: 3519 -   * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,

 Line: 4233 -  // OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE

 Line: 7374 -  // OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE

 Line: 7466 -  // OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE

 Line: 7515 -  // OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE

 Line: 8500 -  // OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE

 Line: 8713 -  // OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE

 Line: 9822 -  // OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE

 Line: 11801 -  // OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE

 Line: 13842 -  // OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE

 Line: 15401 -    reason: 'Some query argument is invalid'

 Line: 15413 -    reason: 'Some query parameter is invalid'

 Line: 16703 -  var UPDATE_SEQ_KEY = '_local_last_update_seq';

 Line: 16837 -        stores.metaStore.get(UPDATE_SEQ_KEY, function (err, value) {

 Line: 17425 -            key: UPDATE_SEQ_KEY,

</Result>
</report_mosca>

<report_mosca>
 <Path>/src/dist/pouchdb.fruitdown.min.js</Path>
 <Module>/app/Mosca/eggs/javascript_common_fail.egg</Module>
 <Title> Possible code injection</Title>
 <Description> Command injection is an attack in which the goal is execution of arbitrary commands on the host operating system via a vulnerable application.</Description>
 <Level> High</Level>
 <Reference> https://www.securecoding.cert.org/confluence/pages/viewpage.action?pageId=2130132 </Reference>
 <Match> eval\s?\(|setTimeout|setInterval</Match>
 <Result> Line: 39 -  for(t=l,l=[],e=-1;++e<n;)t[e]();n=l.length}c=!1}function r(e){1!==l.push(e)||c||i()}var i,o=e.MutationObserver||e.WebKitMutationObserver;if(o){var a=0,s=new o(n),u=e.document.createTextNode("");s.observe(u,{characterData:!0}),i=function(){u.data=a=++a%2}}else if(e.setImmediate||"undefined"==typeof e.MessageChannel)i="document"in e&&"onreadystatechange"in e.document.createElement("script")?function(){var t=e.document.createElement("script");t.onreadystatechange=function(){n(),t.onreadystatechange=null,t.parentNode.removeChild(t),t=null},e.document.documentElement.appendChild(t)}:function(){setTimeout(n,0)};else{var f=new e.MessageChannel;f.port1.onmessage=n,i=function(){f.port2.postMessage(0)}}var c,l=[];t.exports=r}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],33:[function(e,t,n){"function"==typeof Object.create?t.exports=function(e,t){e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}})}:t.exports=function(e,t){e.super_=t;var n=function(){};n.prototype=t.prototype,e.prototype=new n,e.prototype.constructor=e}},{}],34:[function(e,t,n){function r(e){return!!e.constructor&&"function"==typeof e.constructor.isBuffer&&e.constructor.isBuffer(e)}function i(e){return"function"==typeof e.readFloatLE&&"function"==typeof e.slice&&r(e.slice(0,0))}t.exports=function(e){return null!=e&&(r(e)||i(e)||!!e._isBuffer)}},{}],35:[function(e,t,n){var r={}.toString;t.exports=Array.isArray||function(e){return"[object Array]"==r.call(e)}},{}],36:[function(e,t,n){(function(e){e("object"==typeof n?n:this)}).call(this,function(e){var t=Array.prototype.slice,n=Array.prototype.forEach,r=function(e){if("object"!=typeof e)throw e+" is not an object";var i=t.call(arguments,1);return n.call(i,function(t){if(t)for(var n in t)"object"==typeof t[n]&&e[n]?r.call(e,e[n],t[n]):e[n]=t[n]}),e};e.extend=r})},{}],37:[function(e,t,n){function r(e){this.opts=e||{},this.encodings=i}var i=e(38);t.exports=r,r.prototype._encoding=function(e){return"string"==typeof e&&(e=i[e]),e||(e=i.id),e},r. Line: 49 -  fer:e(34)})},{34:34}],51:[function(e,t,n){function r(e){if(e=""+e,!(e.length>1e4)){var t=/^((?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|years?|yrs?|y)?$/i.exec(e);if(t){var n=parseFloat(t[1]),r=(t[2]||"ms").toLowerCase();switch(r){case"years":case"year":case"yrs":case"yr":case"y":return n*l;case"days":case"day":case"d":return n*c;case"hours":case"hour":case"hrs":case"hr":case"h":return n*f;case"minutes":case"minute":case"mins":case"min":case"m":return n*u;case"seconds":case"second":case"secs":case"sec":case"s":return n*s;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return n}}}}function i(e){return e>=c?Math.round(e/c)+"d":e>=f?Math.round(e/f)+"h":e>=u?Math.round(e/u)+"m":e>=s?Math.round(e/s)+"s":e+"ms"}function o(e){return a(e,c,"day")||a(e,f,"hour")||a(e,u,"minute")||a(e,s,"second")||e+" ms"}function a(e,t,n){if(!(e<t))return e<1.5*t?Math.floor(e/t)+" "+n:Math.ceil(e/t)+" "+n+"s"}var s=1e3,u=60*s,f=60*u,c=24*f,l=365.25*c;t.exports=function(e,t){return t=t||{},"string"==typeof e?r(e):t.long?o(e):i(e)}},{}],52:[function(e,t,n){(function(e){"use strict";function n(t,n,r,i){if("function"!=typeof t)throw new TypeError('"callback" argument must be a function');var o,a,s=arguments.length;switch(s){case 0:case 1:return e.nextTick(t);case 2:return e.nextTick(function(){t.call(null,n)});case 3:return e.nextTick(function(){t.call(null,n,r)});case 4:return e.nextTick(function(){t.call(null,n,r,i)});default:for(o=new Array(s-1),a=0;a<o.length;)o[a++]=arguments[a];return e.nextTick(function(){t.apply(null,o)})}}!e.version||0===e.version.indexOf("v0.")||0===e.version.indexOf("v1.")&&0!==e.version.indexOf("v1.8.")?t.exports=n:t.exports=e.nextTick}).call(this,e(53))},{53:53}],53:[function(e,t,n){function r(){throw new Error("setTimeout has not been defined")}function i(){throw new Error("clearTimeout has not been defined")}function o(e){if(l===setTimeout)return setTimeout(e,0);if((l===r||!l)&&setTimeout)return l=setTimeout,setTimeout(e,0);try{return l(e,0)}catch(t){try{return l.call(null,e,0)}catch(t){return l.call( Line: 50 -  unction a(e){if(h===clearTimeout)return clearTimeout(e);if((h===i||!h)&&clearTimeout)return h=clearTimeout,clearTimeout(e);try{return h(e)}catch(t){try{return h.call(null,e)}catch(t){return h.call(this,e)}}}function s(){y&&p&&(y=!1,p.length?g=p.concat(g):v=-1,g.length&&u())}function u(){if(!y){var e=o(s);y=!0;for(var t=g.length;t;){for(p=g,g=[];++v<t;)p&&p[v].run();v=-1,t=g.length}p=null,y=!1,a(e)}}function f(e,t){this.fun=e,this.array=t}function c(){}var l,h,d=t.exports={};!function(){try{l="function"==typeof setTimeout?setTimeout:r}catch(e){l=r}try{h="function"==typeof clearTimeout?clearTimeout:i}catch(e){h=i}}();var p,g=[],y=!1,v=-1;d.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];g.push(new f(e,t)),1!==g.length||y||o(u)},f.prototype.run=function(){this.fun.apply(null,this.array)},d.title="browser",d.browser=!0,d.env={},d.argv=[],d.version="",d.versions={},d.on=c,d.addListener=c,d.once=c,d.off=c,d.removeListener=c,d.removeAllListeners=c,d.emit=c,d.binding=function(e){throw new Error("process.binding is not supported")},d.cwd=function(){return"/"},d.chdir=function(e){throw new Error("process.chdir is not supported")},d.umask=function(){return 0}},{}],54:[function(e,t,n){arguments[4][24][0].apply(n,arguments)},{24:24}],55:[function(e,t,n){(function(n){function r(e){return this instanceof r?(u.call(this,e),f.call(this,e),e&&e.readable===!1&&(this.readable=!1),e&&e.writable===!1&&(this.writable=!1),this.allowHalfOpen=!0,e&&e.allowHalfOpen===!1&&(this.allowHalfOpen=!1),void this.once("end",i)):new r(e)}function i(){this.allowHalfOpen||this._writableState.ended||n.nextTick(this.end.bind(this))}function o(e,t){for(var n=0,r=e.length;n<r;n++)t(e[n],n)}t.exports=r;var a=Object.keys||function(e){var t=[];for(var n in e)t.push(n);return t},s=e(9);s.inherits=e(33);var u=e(57),f=e(59);s.inherits(r,u),o(a(f.prototype),function(e){r.prototype[e]||(r.prototype[e]=f.prototype[e])})}).call(this,e(53))},{33:33,53:53,57:57,59:59,9:9}],56:[function(e,t,n){function r(e){return this instanceof r?void i.call(thi Line: 101 -  tring(n+1)]},lowerBound:"\0",upperBound:"ÿ"},tt=new Pe;p.prototype.get=function(e){var t=h(e);return this.store[t]},p.prototype.set=function(e,t){var n=h(e);return this.store[n]=t,!0},p.prototype.has=function(e){var t=h(e);return t in this.store},p.prototype.delete=function(e){var t=h(e),n=t in this.store;return delete this.store[t],n},p.prototype.forEach=function(e){for(var t=Object.keys(this.store),n=0,r=t.length;n<r;n++){var i=t[n],o=this.store[i];i=d(i),e(o,i)}},g.prototype.add=function(e){return this.store.set(e,!0)},g.prototype.has=function(e){return this.store.has(e)};var nt,rt=function(e,n,r){t.nextTick(function(){r()})},it=function(e,n,r){t.nextTick(function(){r()})},ot={toSublevel:rt,localAndMetaStores:it},at="function"==typeof Promise?Promise:Ke,st=Function.prototype.toString,ut=st.call(Object);Ye("pouchdb:api");if(E())nt=!1;else try{localStorage.setItem("_pouch_check_localstorage",1),nt=!!localStorage.getItem("_pouch_check_localstorage")}catch(e){nt=!1}Ie(x,qe.EventEmitter),x.prototype.addListener=function(e,t,n,r){function i(){function e(){a=!1}if(o._listeners[t]){if(a)return void(a="waiting");a=!0;var s=w(r,["style","include_docs","attachments","conflicts","filter","doc_ids","view","since","query_params","binary"]);n.changes(s).on("change",function(e){e.seq>r.since&&!r.cancelled&&(r.since=e.seq,r.onChange(e))}).on("complete",function(){"waiting"===a&&setTimeout(function(){i()},0),a=!1}).on("error",e)}}if(!this._listeners[t]){var o=this,a=!1;this._listeners[t]=i,this.on(e,i)}},x.prototype.removeListener=function(e,t){t in this._listeners&&(qe.EventEmitter.prototype.removeListener.call(this,e,this._listeners[t]),delete this._listeners[t])},x.prototype.notifyLocalWindows=function(e){E()?chrome.storage.local.set({dbName:e}):k()&&(localStorage[e]="a"===localStorage[e]?"b":"a")},x.prototype.notify=function(e){this.emit(e),this.notifyLocalWindows(e)},Ie(R,Error),R.prototype.toString=function(){return JSON.stringify({status:this.status,name:this.name,message:this.message,reason:this.reason})};var ft,ct=(new R({status:401,error:"unauthorized",reason:"Name or password is Line: 104 -  D(["_attachments","_replication_id","_replication_state","_replication_state_time","_replication_state_reason","_replication_stats"]),Bt=function(e){return atob(e)},Rt=function(e){return btoa(e)},At=n.setImmediate||n.setTimeout,jt=32768;Be.prototype.get=function(e,n,r){var i=xe(this,e),o=i.get(n);return o?t.nextTick(function(){r(null,o)}):null===o?t.nextTick(function(){r({name:"NotFoundError"})}):void e.get(n,function(e,t){return e?("NotFoundError"===e.name&&i.set(n,null),r(e)):(i.set(n,t),void r(null,t))})},Be.prototype.batch=function(e){for(var t=0,n=e.length;t<n;t++){var r=e[t],i=xe(this,r.prefix);"put"===r.type?i.set(r.key,r.value):i.set(r.key,null)}this._batch=this._batch.concat(e)},Be.prototype.execute=function(e,t){for(var n=new g,r=[],i=this._batch.length-1;i>=0;i--){var o=this._batch[i],a=o.prefix.prefix()[0]+"ÿ"+o.key;n.has(a)||(n.add(a),r.push(o))}e.batch(r,t)};var Ot="document-store",Mt="by-sequence",Tt="attach-store",Lt="attach-binary-store",Ct="local-store",Dt="meta-store",qt=new p,Nt="_local_last_update_seq",It="_local_doc_count",Pt="_local_uuid",Ut="md5-",Wt={encode:we,decode:_e,buffer:!1,type:"cheap-json"},Ft=new x;Te.valid=function(){return!!n.indexedDB},Te.use_prefix=!0;var zt="undefined"!=typeof PouchDB?PouchDB:e("pouchdb");zt?Le(zt):B("error",'fruitdown adapter plugin error: Cannot find global "PouchDB" object! Did you remember to include pouchdb.js?')}).call(this,e(53),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},e(8).Buffer)},{11:11,21:21,25:25,28:28,33:33,36:36,37:37,4:4,43:43,49:49,50:50,53:53,61:61,62:62,8:8,82:82,87:87,pouchdb:"pouchdb"}]},{},[89]);

</Result>
</report_mosca>

<report_mosca>
 <Path>/src/dist/pouchdb.fruitdown.min.js</Path>
 <Module>/app/Mosca/eggs/javascript_common_fail.egg</Module>
 <Title> Possible SQL injection</Title>
 <Description> notification possible SQL injection</Description>
 <Level> High</Level>
 <Reference> https://www.owasp.org/index.php/Testing_for_Stack_Overflow </Reference>
 <Match> query|YQL|WHERE|FROM|SELECT|UPDATE|DELETE|INSERT|UNION|getResults</Match>
 <Result> Line: 103 -  })),lt=new R({status:409,error:"conflict",reason:"Document update conflict"}),ht=new R({status:400,error:"bad_request",reason:"_id field must contain a string"}),dt=new R({status:412,error:"missing_id",reason:"_id is required for puts"}),pt=new R({status:400,error:"bad_request",reason:"Only reserved document ids may start with underscore."}),gt=new R({status:412,error:"precondition_failed",reason:"Database not open"}),yt=(new R({status:500,error:"unknown_error",reason:"Database encountered an unknown error"}),new R({status:500,error:"badarg",reason:"Some query argument is invalid"})),vt=(new R({status:400,error:"invalid_request",reason:"Request was invalid"}),new R({status:400,error:"query_parse_error",reason:"Some query parameter is invalid"}),new R({status:500,error:"doc_validation",reason:"Bad special document member"})),bt=new R({status:400,error:"bad_request",reason:"Something wrong with the request"}),mt=(new R({status:400,error:"bad_request",reason:"Document must be a JSON object"}),new R({status:404,error:"not_found",reason:"Database not found"}),new R({status:500,error:"indexed_db_went_bad",reason:"unknown"}),new R({status:500,error:"web_sql_went_bad",reason:"unknown"}),new R({status:500,error:"levelDB_went_went_bad",reason:"unknown"}),new R({status:403,error:"forbidden",reason:"Forbidden by design doc validate_doc_update function"}),new R({status:400,error:"bad_request",reason:"Invalid rev format"})),_t=(new R({status:412,error:"file_exists",reason:"The database could not be created, the file already exists."}),new R({status:412,error:"missing_stub"})),wt=(new R({status:413,error:"invalid_url",reason:"Provided URL is invalid"}),M.name);ft=wt?function(e){return e.name}:function(e){return e.toString().match(/^\s*function\s*(\S*)\s*\(/)[1]};var Et=ft,kt="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz".split(""),St=D(["_id","_rev","_attachments","_deleted","_revisions","_revs_info","_conflicts","_deleted_conflicts","_local_seq","_rev_tree","_replication_id","_replication_state","_replication_state_time","_replication_state_reason","_replication_stats","_</Result>
</report_mosca>

<report_mosca>
 <Path>/src/dist/pouchdb.memory.min.js</Path>
 <Module>/app/Mosca/eggs/javascript_common_fail.egg</Module>
 <Title> Possible code injection</Title>
 <Description> Command injection is an attack in which the goal is execution of arbitrary commands on the host operating system via a vulnerable application.</Description>
 <Level> High</Level>
 <Reference> https://www.securecoding.cert.org/confluence/pages/viewpage.action?pageId=2130132 </Reference>
 <Match> eval\s?\(|setTimeout|setInterval</Match>
 <Result> Line: 35 -  .value,r[o+1],i.right,i._count):r[o]=new n(i._color,i.key,i.value,i.left,r[o+1],i._count);return new s(this.tree._compare,r[0])},b.prev=function(){var e=this._stack;if(0!==e.length){var t=e[e.length-1];if(t.left)for(t=t.left;t;)e.push(t),t=t.right;else for(e.pop();e.length>0&&e[e.length-1].left===t;)t=e[e.length-1],e.pop()}},Object.defineProperty(b,"hasPrev",{get:function(){var e=this._stack;if(0===e.length)return!1;if(e[e.length-1].left)return!0;for(var t=e.length-1;t>0;--t)if(e[t-1].right===e[t])return!0;return!1}})},{}],23:[function(e,t,r){r.read=function(e,t,r,n,i){var o,a,s=8*i-n-1,u=(1<<s)-1,f=u>>1,c=-7,l=r?i-1:0,h=r?-1:1,d=e[t+l];for(l+=h,o=d&(1<<-c)-1,d>>=-c,c+=s;c>0;o=256*o+e[t+l],l+=h,c-=8);for(a=o&(1<<-c)-1,o>>=-c,c+=n;c>0;a=256*a+e[t+l],l+=h,c-=8);if(0===o)o=1-f;else{if(o===u)return a?NaN:(d?-1:1)*(1/0);a+=Math.pow(2,n),o-=f}return(d?-1:1)*a*Math.pow(2,o-n)},r.write=function(e,t,r,n,i,o){var a,s,u,f=8*o-i-1,c=(1<<f)-1,l=c>>1,h=23===i?Math.pow(2,-24)-Math.pow(2,-77):0,d=n?0:o-1,p=n?1:-1,g=t<0||0===t&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(s=isNaN(t)?1:0,a=c):(a=Math.floor(Math.log(t)/Math.LN2),t*(u=Math.pow(2,-a))<1&&(a--,u*=2),t+=a+l>=1?h/u:h*Math.pow(2,1-l),t*u>=2&&(a++,u/=2),a+l>=c?(s=0,a=c):a+l>=1?(s=(t*u-1)*Math.pow(2,i),a+=l):(s=t*Math.pow(2,l-1)*Math.pow(2,i),a=0));i>=8;e[r+d]=255&s,d+=p,s/=256,i-=8);for(a=a<<i|s,f+=i;f>0;e[r+d]=255&a,d+=p,a/=256,f-=8);e[r+d-p]|=128*g}},{}],24:[function(e,t,r){(function(e){"use strict";function r(){c=!0;for(var e,t,r=l.length;r;){for(t=l,l=[],e=-1;++e<r;)t[e]();r=l.length}c=!1}function n(e){1!==l.push(e)||c||i()}var i,o=e.MutationObserver||e.WebKitMutationObserver;if(o){var a=0,s=new o(r),u=e.document.createTextNode("");s.observe(u,{characterData:!0}),i=function(){u.data=a=++a%2}}else if(e.setImmediate||"undefined"==typeof e.MessageChannel)i="document"in e&&"onreadystatechange"in e.document.createElement("script")?function(){var t=e.document.createElement("script");t.onreadystatechange=function(){r(),t.onreadystatechange=null,t.parentNode.removeChild(t),t=null},e.document.documentElement.appendChild(t)}:function(){set Line: 52 -  ong?o(e):i(e)}},{}],52:[function(e,t,r){(function(e){"use strict";function r(t,r,n,i){if("function"!=typeof t)throw new TypeError('"callback" argument must be a function');var o,a,s=arguments.length;switch(s){case 0:case 1:return e.nextTick(t);case 2:return e.nextTick(function(){t.call(null,r)});case 3:return e.nextTick(function(){t.call(null,r,n)});case 4:return e.nextTick(function(){t.call(null,r,n,i)});default:for(o=new Array(s-1),a=0;a<o.length;)o[a++]=arguments[a];return e.nextTick(function(){t.apply(null,o)})}}!e.version||0===e.version.indexOf("v0.")||0===e.version.indexOf("v1.")&&0!==e.version.indexOf("v1.8.")?t.exports=r:t.exports=e.nextTick}).call(this,e(53))},{53:53}],53:[function(e,t,r){function n(){throw new Error("setTimeout has not been defined")}function i(){throw new Error("clearTimeout has not been defined")}function o(e){if(l===setTimeout)return setTimeout(e,0);if((l===n||!l)&&setTimeout)return l=setTimeout,setTimeout(e,0);try{return l(e,0)}catch(t){try{return l.call(null,e,0)}catch(t){return l.call(this,e,0)}}}function a(e){if(h===clearTimeout)return clearTimeout(e);if((h===i||!h)&&clearTimeout)return h=clearTimeout,clearTimeout(e);try{return h(e)}catch(t){try{return h.call(null,e)}catch(t){return h.call(this,e)}}}function s(){v&&p&&(v=!1,p.length?g=p.concat(g):y=-1,g.length&&u())}function u(){if(!v){var e=o(s);v=!0;for(var t=g.length;t;){for(p=g,g=[];++y<t;)p&&p[y].run();y=-1,t=g.length}p=null,v=!1,a(e)}}function f(e,t){this.fun=e,this.array=t}function c(){}var l,h,d=t.exports={};!function(){try{l="function"==typeof setTimeout?setTimeout:n}catch(e){l=n}try{h="function"==typeof clearTimeout?clearTimeout:i}catch(e){h=i}}();var p,g=[],v=!1,y=-1;d.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var r=1;r<arguments.length;r++)t[r-1]=arguments[r];g.push(new f(e,t)),1!==g.length||v||o(u)},f.prototype.run=function(){this.fun.apply(null,this.array)},d.title="browser",d.browser=!0,d.env={},d.argv=[],d.version="",d.versions={},d.on=c,d.addListener=c,d.once=c,d.off=c,d.removeListener=c,d.removeAllListeners=c,d.emit=c,d.binding=functio Line: 104 -  ar t=this;e&&t.emit("error",e),t._iterator?t._iterator.end(function(){t._iterator=null,t.emit("close")}):t.emit("close")}},c.prototype.destroy=function(){this._cleanup()};var et={encode:function(e){return"ÿ"+e[0]+"ÿ"+e[1]},decode:function(e){var t=e.toString(),r=t.indexOf("ÿ",1);return[t.substring(1,r),t.substring(r+1)]},lowerBound:"\0",upperBound:"ÿ"},tt=new Ie;p.prototype.get=function(e){var t=h(e);return this.store[t]},p.prototype.set=function(e,t){var r=h(e);return this.store[r]=t,!0},p.prototype.has=function(e){var t=h(e);return t in this.store},p.prototype.delete=function(e){var t=h(e),r=t in this.store;return delete this.store[t],r},p.prototype.forEach=function(e){for(var t=Object.keys(this.store),r=0,n=t.length;r<n;r++){var i=t[r],o=this.store[i];i=d(i),e(o,i)}},g.prototype.add=function(e){return this.store.set(e,!0)},g.prototype.has=function(e){return this.store.has(e)};var rt,nt=function(e,r,n){t.nextTick(function(){n()})},it=function(e,r,n){t.nextTick(function(){n()})},ot={toSublevel:nt,localAndMetaStores:it},at="function"==typeof Promise?Promise:Ke,st=Function.prototype.toString,ut=st.call(Object);Ye("pouchdb:api");if(E())rt=!1;else try{localStorage.setItem("_pouch_check_localstorage",1),rt=!!localStorage.getItem("_pouch_check_localstorage")}catch(e){rt=!1}Ne(x,qe.EventEmitter),x.prototype.addListener=function(e,t,r,n){function i(){function e(){a=!1}if(o._listeners[t]){if(a)return void(a="waiting");a=!0;var s=w(n,["style","include_docs","attachments","conflicts","filter","doc_ids","view","since","query_params","binary"]);r.changes(s).on("change",function(e){e.seq>n.since&&!n.cancelled&&(n.since=e.seq,n.onChange(e))}).on("complete",function(){"waiting"===a&&setTimeout(function(){i()},0),a=!1}).on("error",e)}}if(!this._listeners[t]){var o=this,a=!1;this._listeners[t]=i,this.on(e,i)}},x.prototype.removeListener=function(e,t){t in this._listeners&&(qe.EventEmitter.prototype.removeListener.call(this,e,this._listeners[t]),delete this._listeners[t])},x.prototype.notifyLocalWindows=function(e){E()?chrome.storage.local.set({dbName:e}):k()&&(localStorage[e]="a"===localS Line: 106 -  ction(e){return e.name}:function(e){return e.toString().match(/^\s*function\s*(\S*)\s*\(/)[1]};var Et=ft,kt="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz".split(""),St=D(["_id","_rev","_attachments","_deleted","_revisions","_revs_info","_conflicts","_deleted_conflicts","_local_seq","_rev_tree","_replication_id","_replication_state","_replication_state_time","_replication_state_reason","_replication_stats","_removed"]),xt=D(["_attachments","_replication_id","_replication_state","_replication_state_time","_replication_state_reason","_replication_stats"]),Bt=function(e){return atob(e)},Rt=function(e){return btoa(e)},At=r.setImmediate||r.setTimeout,jt=32768;Be.prototype.get=function(e,r,n){var i=xe(this,e),o=i.get(r);return o?t.nextTick(function(){n(null,o)}):null===o?t.nextTick(function(){n({name:"NotFoundError"})}):void e.get(r,function(e,t){return e?("NotFoundError"===e.name&&i.set(r,null),n(e)):(i.set(r,t),void n(null,t))})},Be.prototype.batch=function(e){for(var t=0,r=e.length;t<r;t++){var n=e[t],i=xe(this,n.prefix);"put"===n.type?i.set(n.key,n.value):i.set(n.key,null)}this._batch=this._batch.concat(e)},Be.prototype.execute=function(e,t){for(var r=new g,n=[],i=this._batch.length-1;i>=0;i--){var o=this._batch[i],a=o.prefix.prefix()[0]+"ÿ"+o.key;r.has(a)||(r.add(a),n.push(o))}e.batch(n,t)};var Ot="document-store",Mt="by-sequence",Tt="attach-store",Lt="attach-binary-store",Ct="local-store",Dt="meta-store",qt=new p,Pt="_local_last_update_seq",Nt="_local_doc_count",It="_local_uuid",Ut="md5-",Wt={encode:we,decode:me,buffer:!1,type:"cheap-json"},Ft=new x;Te.valid=function(){return!0},Te.use_prefix=!1;var zt="undefined"!=typeof PouchDB?PouchDB:e("pouchdb");zt?Le(zt):B("error",'memory adapter plugin error: Cannot find global "PouchDB" object! Did you remember to include pouchdb.js?')}).call(this,e(53),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},e(5).Buffer)},{1:1,17:17,21:21,25:25,28:28,29:29,35:35,41:41,42:42,43:43,5:5,53:53,61:61,62:62,7:7,82:82,86:86,pouchdb:"pouchdb"}]},{},[87]);

</Result>
</report_mosca>

<report_mosca>
 <Path>/src/dist/pouchdb.memory.min.js</Path>
 <Module>/app/Mosca/eggs/javascript_common_fail.egg</Module>
 <Title> Possible SQL injection</Title>
 <Description> notification possible SQL injection</Description>
 <Level> High</Level>
 <Reference> https://www.owasp.org/index.php/Testing_for_Stack_Overflow </Reference>
 <Match> query|YQL|WHERE|FROM|SELECT|UPDATE|DELETE|INSERT|UNION|getResults</Match>
 <Result> Line: 105 -  "a")},x.prototype.notify=function(e){this.emit(e),this.notifyLocalWindows(e)},Ne(R,Error),R.prototype.toString=function(){return JSON.stringify({status:this.status,name:this.name,message:this.message,reason:this.reason})};var ft,ct=(new R({status:401,error:"unauthorized",reason:"Name or password is incorrect."}),new R({status:400,error:"bad_request",reason:"Missing JSON list of 'docs'"}),new R({status:404,error:"not_found",reason:"missing"})),lt=new R({status:409,error:"conflict",reason:"Document update conflict"}),ht=new R({status:400,error:"bad_request",reason:"_id field must contain a string"}),dt=new R({status:412,error:"missing_id",reason:"_id is required for puts"}),pt=new R({status:400,error:"bad_request",reason:"Only reserved document ids may start with underscore."}),gt=new R({status:412,error:"precondition_failed",reason:"Database not open"}),vt=(new R({status:500,error:"unknown_error",reason:"Database encountered an unknown error"}),new R({status:500,error:"badarg",reason:"Some query argument is invalid"})),yt=(new R({status:400,error:"invalid_request",reason:"Request was invalid"}),new R({status:400,error:"query_parse_error",reason:"Some query parameter is invalid"}),new R({status:500,error:"doc_validation",reason:"Bad special document member"})),_t=new R({status:400,error:"bad_request",reason:"Something wrong with the request"}),bt=(new R({status:400,error:"bad_request",reason:"Document must be a JSON object"}),new R({status:404,error:"not_found",reason:"Database not found"}),new R({status:500,error:"indexed_db_went_bad",reason:"unknown"}),new R({status:500,error:"web_sql_went_bad",reason:"unknown"}),new R({status:500,error:"levelDB_went_went_bad",reason:"unknown"}),new R({status:403,error:"forbidden",reason:"Forbidden by design doc validate_doc_update function"}),new R({status:400,error:"bad_request",reason:"Invalid rev format"})),mt=(new R({status:412,error:"file_exists",reason:"The database could not be created, the file already exists."}),new R({status:412,error:"missing_stub"})),wt=(new R({status:413,error:"invalid_url",reason:"Provided URL is invalid"}),M.n</Result>
</report_mosca>

<report_mosca>
 <Path>/src/dist/pouchdb-next.js</Path>
 <Module>/app/Mosca/eggs/javascript_common_fail.egg</Module>
 <Title> Possible code injection</Title>
 <Description> Command injection is an attack in which the goal is execution of arbitrary commands on the host operating system via a vulnerable application.</Description>
 <Level> High</Level>
 <Reference> https://www.securecoding.cert.org/confluence/pages/viewpage.action?pageId=2130132 </Reference>
 <Match> eval\s?\(|setTimeout|setInterval</Match>
 <Result> Line: 952 -        setTimeout(nextTick, 0);

 Line: 1439 -      throw new Error('setTimeout has not been defined');

 Line: 1446 -          if (typeof setTimeout === 'function') {

 Line: 1447 -              cachedSetTimeout = setTimeout;

 Line: 1465 -      if (cachedSetTimeout === setTimeout) {

 Line: 1467 -          return setTimeout(fun, 0);

 Line: 1469 -      // if setTimeout wasn't available but was latter defined

 Line: 1470 -      if ((cachedSetTimeout === defaultSetTimout || !cachedSetTimeout) && setTimeout) {

 Line: 1471 -          cachedSetTimeout = setTimeout;

 Line: 1472 -          return setTimeout(fun, 0);

 Line: 1475 -          // when when somebody has screwed with setTimeout but no I.E. maddness

 Line: 1500 -          // when when somebody has screwed with setTimeout but no I.E. maddness

 Line: 1508 -              // Some versions of I.E. have different rules for clearTimeout vs setTimeout

 Line: 2563 -    setTimeout(function () {

 Line: 2601 -              setTimeout(ping, opts.interval || 200);

 Line: 3258 -          setTimeout(function () { fetch(lastFetchedSeq, fetched); }, 0);

 Line: 4285 -    // TODO: this setTimeout seems nasty, if its needed lets

 Line: 4287 -    setTimeout(function () {

 Line: 4819 -      timer = setTimeout(function () {

 Line: 4926 -      timer = setTimeout(timeoutReq, options.timeout);

 Line: 4930 -          timer = setTimeout(timeoutReq, options.timeout);

 Line: 7664 -  var setImmediateShim = global.setImmediate || global.setTimeout;

 Line: 8385 -    setTimeout(callback, opts.current_back_off);

 Line: 9599 -          setTimeout(function (){

</Result>
</report_mosca>

<report_mosca>
 <Path>/src/dist/pouchdb-next.js</Path>
 <Module>/app/Mosca/eggs/javascript_common_fail.egg</Module>
 <Title> Possible SQL injection</Title>
 <Description> notification possible SQL injection</Description>
 <Level> High</Level>
 <Reference> https://www.owasp.org/index.php/Testing_for_Stack_Overflow </Reference>
 <Match> query|YQL|WHERE|FROM|SELECT|UPDATE|DELETE|INSERT|UNION|getResults</Match>
 <Result> Line: 626 -  // OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE

 Line: 2849 -        method: 'DELETE',

 Line: 2885 -        method: 'DELETE',

 Line: 3303 -        method: 'DELETE'

 Line: 7446 -    reason: 'Some query argument is invalid'

 Line: 7458 -    reason: 'Some query parameter is invalid'

 Line: 7616 -      result[key] = queryParams[key];

 Line: 7626 -    var queryParams = '';

 Line: 7630 -      queryParams = JSON.stringify(sortObjectPropertiesByKey(opts.query_params));

 Line: 7638 -      var queryData = res[0] + res[1] + filterFun + filterViewName +

 Line: 7639 -        queryParams + docIds;

</Result>
</report_mosca>

<report_mosca>
 <Path>/src/dist/pouchdb.js</Path>
 <Module>/app/Mosca/eggs/javascript_common_fail.egg</Module>
 <Title> Possible code injection</Title>
 <Description> Command injection is an attack in which the goal is execution of arbitrary commands on the host operating system via a vulnerable application.</Description>
 <Level> High</Level>
 <Reference> https://www.securecoding.cert.org/confluence/pages/viewpage.action?pageId=2130132 </Reference>
 <Match> eval\s?\(|setTimeout|setInterval</Match>
 <Result> Line: 958 -        setTimeout(nextTick, 0);

 Line: 1445 -      throw new Error('setTimeout has not been defined');

 Line: 1452 -          if (typeof setTimeout === 'function') {

 Line: 1453 -              cachedSetTimeout = setTimeout;

 Line: 1471 -      if (cachedSetTimeout === setTimeout) {

 Line: 1473 -          return setTimeout(fun, 0);

 Line: 1475 -      // if setTimeout wasn't available but was latter defined

 Line: 1476 -      if ((cachedSetTimeout === defaultSetTimout || !cachedSetTimeout) && setTimeout) {

 Line: 1477 -          cachedSetTimeout = setTimeout;

 Line: 1478 -          return setTimeout(fun, 0);

 Line: 1481 -          // when when somebody has screwed with setTimeout but no I.E. maddness

 Line: 1506 -          // when when somebody has screwed with setTimeout but no I.E. maddness

 Line: 1514 -              // Some versions of I.E. have different rules for clearTimeout vs setTimeout

 Line: 3028 -          setTimeout(function (){

 Line: 5619 -  var setImmediateShim = global.setImmediate || global.setTimeout;

 Line: 9478 -      timer = setTimeout(function () {

 Line: 9585 -      timer = setTimeout(timeoutReq, options.timeout);

 Line: 9589 -          timer = setTimeout(timeoutReq, options.timeout);

 Line: 9997 -    setTimeout(function () {

 Line: 10035 -              setTimeout(ping, opts.interval || 200);

 Line: 10692 -          setTimeout(function () { fetch(lastFetchedSeq, fetched); }, 0);

 Line: 12712 -    setTimeout(callback, opts.current_back_off);

</Result>
</report_mosca>

<report_mosca>
 <Path>/src/dist/pouchdb.js</Path>
 <Module>/app/Mosca/eggs/javascript_common_fail.egg</Module>
 <Title> Possible SQL injection</Title>
 <Description> notification possible SQL injection</Description>
 <Level> High</Level>
 <Reference> https://www.owasp.org/index.php/Testing_for_Stack_Overflow </Reference>
 <Match> query|YQL|WHERE|FROM|SELECT|UPDATE|DELETE|INSERT|UNION|getResults</Match>
 <Result> Line: 632 -  // OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE

 Line: 3184 -    reason: 'Some query argument is invalid'

 Line: 3196 -    reason: 'Some query parameter is invalid'

 Line: 7895 -    return 'SELECT ' + selector + ' FROM ' +

 Line: 7898 -      (where ? (' WHERE ' +

 Line: 7925 -      var sql = 'SELECT DISTINCT digest AS digest FROM ' +

 Line: 7926 -        ATTACH_AND_SEQ_STORE$1 + ' WHERE seq IN ' + qMarks(seqs.length);

 Line: 7938 -        var sql = 'DELETE FROM ' + ATTACH_AND_SEQ_STORE$1 +

 Line: 7939 -          ' WHERE seq IN (' +

 Line: 7944 -          var sql = 'SELECT digest FROM ' + ATTACH_AND_SEQ_STORE$1 +

 Line: 7945 -            ' WHERE digest IN (' +

 Line: 7958 -                'DELETE FROM ' + ATTACH_AND_SEQ_STORE$1 + ' WHERE digest=?',

 Line: 7961 -                'DELETE FROM ' + ATTACH_STORE$1 + ' WHERE digest=?', [digest]);

 Line: 7970 -      var sql = 'SELECT seq FROM ' + BY_SEQ_STORE$1 +

 Line: 7971 -        ' WHERE doc_id=? AND rev=?';

 Line: 7981 -          'DELETE FROM ' + BY_SEQ_STORE$1 + ' WHERE seq=?', [seq], checkDone);

 Line: 8050 -      var sql = 'SELECT count(*) as cnt FROM ' + ATTACH_STORE$1 +

 Line: 8051 -        ' WHERE digest=?';

 Line: 8107 -        var sql = 'INSERT INTO ' + BY_SEQ_STORE$1 +

 Line: 8127 -            var sql = 'INSERT INTO ' + ATTACH_AND_SEQ_STORE$1 +

 Line: 8151 -            var sql = 'UPDATE ' + BY_SEQ_STORE$1 +

 Line: 8152 -              ' SET json=?, deleted=? WHERE doc_id=? AND rev=?;';

 Line: 8225 -        'UPDATE ' + DOC_STORE$1 +

 Line: 8227 -        '(SELECT seq FROM ' + BY_SEQ_STORE$1 +

 Line: 8228 -        ' WHERE doc_id=' + DOC_STORE$1 + '.id AND rev=?) WHERE id=?'

 Line: 8229 -          : 'INSERT INTO ' + DOC_STORE$1 +

 Line: 8270 -        tx.executeSql('SELECT json FROM ' + DOC_STORE$1 +

 Line: 8271 -        ' WHERE id = ?', [id], function (tx, result) {

 Line: 8282 -      var sql = 'SELECT digest FROM ' + ATTACH_STORE$1 + ' WHERE digest=?';

 Line: 8290 -        sql = 'INSERT INTO ' + ATTACH_STORE$1 +

 Line: 8387 -  var BY_SEQ_STORE_DELETED_INDEX_SQL =

 Line: 8406 -  var SELECT_DOCS = BY_SEQ_STORE$1 + '.seq AS seq, ' +

 Line: 8453 -      // index used for the join in the allDocs query

 Line: 8458 -        tx.executeSql(BY_SEQ_STORE_DELETED_INDEX_SQL);

 Line: 8464 -          var sql = 'SELECT ' + DOC_STORE$1 + '.winningseq AS seq, ' + DOC_STORE$1 +

 Line: 8465 -            '.json AS metadata FROM ' + BY_SEQ_STORE$1 + ' JOIN ' + DOC_STORE$1 +

 Line: 8484 -            tx.executeSql('UPDATE ' + DOC_STORE$1 + 'SET local = 1 WHERE id IN ' +

 Line: 8486 -              tx.executeSql('UPDATE ' + BY_SEQ_STORE$1 +

 Line: 8487 -                ' SET deleted = 1 WHERE seq IN ' +

 Line: 8500 -        var sql = 'SELECT ' + DOC_STORE$1 + '.id AS id, ' +

 Line: 8502 -          'FROM ' + BY_SEQ_STORE$1 + ' JOIN ' +

 Line: 8504 -          DOC_STORE$1 + '.winningseq WHERE local = 1';

 Line: 8516 -            tx.executeSql('INSERT INTO ' + LOCAL_STORE$1 +

 Line: 8519 -              tx.executeSql('DELETE FROM ' + DOC_STORE$1 + ' WHERE id=?',

 Line: 8521 -                tx.executeSql('DELETE FROM ' + BY_SEQ_STORE$1 + ' WHERE seq=?',

 Line: 8546 -          var sql = 'UPDATE ' + BY_SEQ_STORE$1 +

 Line: 8547 -            ' SET doc_id=?, rev=? WHERE doc_id_rev=?';

 Line: 8560 -            var sql = 'SELECT hex(doc_id_rev) as hex FROM ' + BY_SEQ_STORE$1;

 Line: 8581 -        var sql = 'SELECT COUNT(*) AS cnt FROM ' + ATTACH_STORE$1;

 Line: 8592 -              SELECT_DOCS + ', ' + DOC_STORE$1 + '.id AS id',

 Line: 8633 -                var sql = 'INSERT INTO ' + ATTACH_AND_SEQ_STORE$1 +

 Line: 8673 -        var sql = 'UPDATE ' + DOC_STORE$1 + ' SET max_seq=(SELECT MAX(seq) FROM ' +

 Line: 8674 -          BY_SEQ_STORE$1 + ' WHERE doc_id=id)';

 Line: 8688 -      tx.executeSql('SELECT HEX("a") AS hex', [], function (tx, res) {

 Line: 8732 -            tx.executeSql(BY_SEQ_STORE_DELETED_INDEX_SQL);

 Line: 8736 -              var initSeq = 'INSERT INTO ' + META_STORE$1 +

 Line: 8752 -            tx.executeSql('UPDATE ' + META_STORE$1 + ' SET db_version = ' +

 Line: 8756 -          var sql = 'SELECT dbid FROM ' + META_STORE$1;

 Line: 8796 -      var sql = 'SELECT sql FROM sqlite_master WHERE tbl_name = ' + META_STORE$1;

 Line: 8810 -          tx.executeSql('SELECT db_version FROM ' + META_STORE$1,

 Line: 8832 -          var sql = 'SELECT MAX(seq) AS seq FROM ' + BY_SEQ_STORE$1;

 Line: 8868 -          SELECT_DOCS,

 Line: 8875 -          SELECT_DOCS,

 Line: 8970 -            SELECT_DOCS,

 Line: 9082 -          // we can just limit in the query

 Line: 9151 -      var sql = 'SELECT escaped, ' +

 Line: 9152 -        'CASE WHEN escaped = 1 THEN body ELSE HEX(body) END AS body FROM ' +

 Line: 9153 -        ATTACH_STORE$1 + ' WHERE digest=?';

 Line: 9173 -        var sql = 'SELECT json AS metadata FROM ' + DOC_STORE$1 + ' WHERE id = ?';

 Line: 9192 -        var sql = 'SELECT json AS metadata FROM ' + DOC_STORE$1 + ' WHERE id = ?';

 Line: 9203 -          var sql = 'UPDATE ' + DOC_STORE$1 + ' SET json = ? WHERE id = ?';

 Line: 9215 -        var sql = 'SELECT json, rev FROM ' + LOCAL_STORE$1 + ' WHERE id=?';

 Line: 9249 -          sql = 'UPDATE ' + LOCAL_STORE$1 + ' SET rev=?, json=? ' +

 Line: 9250 -            'WHERE id=? AND rev=?';

 Line: 9253 -          sql = 'INSERT INTO ' + LOCAL_STORE$1 + ' (id, rev, json) VALUES (?,?,?)';

 Line: 9290 -        var sql = 'DELETE FROM ' + LOCAL_STORE$1 + ' WHERE id=? AND rev=?';

 Line: 10283 -        method: 'DELETE',

 Line: 10319 -        method: 'DELETE',

 Line: 10737 -        method: 'DELETE'

 Line: 11562 -    // Format the list of parameters into a valid URI query string

 Line: 11566 -    // If keys are supplied, issue a POST to circumvent GET query string limits

 Line: 11589 -    // We are referencing a query defined in the design doc

 Line: 11930 -  function queryView(view, opts) {

 Line: 11932 -      return queryViewInQueue(view, opts);

 Line: 11936 -  function queryViewInQueue(view, opts) {

 Line: 11941 -      // equivalent query

 Line: 12028 -    } else { // normal query, no 'keys'

 Line: 12142 -  function queryPromised(db, fun, opts) {

 Line: 12169 -            return queryView(view, opts);

 Line: 12202 -            return queryView(view, opts);

 Line: 12205 -              return queryView(view, opts);

 Line: 12213 -  var query = function (fun, opts, callback) {

 Line: 12226 -      return queryPromised(db, fun, opts);

 Line: 12269 -    query: query,

 Line: 12717 -      result[key] = queryParams[key];

 Line: 12727 -    var queryParams = '';

 Line: 12731 -      queryParams = JSON.stringify(sortObjectPropertiesByKey(opts.query_params));

 Line: 12739 -      var queryData = res[0] + res[1] + filterFun + filterViewName +

 Line: 12740 -        queryParams + docIds;

</Result>
</report_mosca>

<report_mosca>
 <Path>/src/dist/pouchdb.memory.js</Path>
 <Module>/app/Mosca/eggs/javascript_common_fail.egg</Module>
 <Title> Possible code injection</Title>
 <Description> Command injection is an attack in which the goal is execution of arbitrary commands on the host operating system via a vulnerable application.</Description>
 <Level> High</Level>
 <Reference> https://www.securecoding.cert.org/confluence/pages/viewpage.action?pageId=2130132 </Reference>
 <Match> eval\s?\(|setTimeout|setInterval</Match>
 <Result> Line: 5217 -        setTimeout(nextTick, 0);

 Line: 7776 -      throw new Error('setTimeout has not been defined');

 Line: 7783 -          if (typeof setTimeout === 'function') {

 Line: 7784 -              cachedSetTimeout = setTimeout;

 Line: 7802 -      if (cachedSetTimeout === setTimeout) {

 Line: 7804 -          return setTimeout(fun, 0);

 Line: 7806 -      // if setTimeout wasn't available but was latter defined

 Line: 7807 -      if ((cachedSetTimeout === defaultSetTimout || !cachedSetTimeout) && setTimeout) {

 Line: 7808 -          cachedSetTimeout = setTimeout;

 Line: 7809 -          return setTimeout(fun, 0);

 Line: 7812 -          // when when somebody has screwed with setTimeout but no I.E. maddness

 Line: 7837 -          // when when somebody has screwed with setTimeout but no I.E. maddness

 Line: 7845 -              // Some versions of I.E. have different rules for clearTimeout vs setTimeout

 Line: 15803 -          setTimeout(function (){

 Line: 16851 -  var setImmediateShim = global.setImmediate || global.setTimeout;

</Result>
</report_mosca>

<report_mosca>
 <Path>/src/dist/pouchdb.memory.js</Path>
 <Module>/app/Mosca/eggs/javascript_common_fail.egg</Module>
 <Title> Possible SQL injection</Title>
 <Description> notification possible SQL injection</Description>
 <Level> High</Level>
 <Reference> https://www.owasp.org/index.php/Testing_for_Stack_Overflow </Reference>
 <Match> query|YQL|WHERE|FROM|SELECT|UPDATE|DELETE|INSERT|UNION|getResults</Match>
 <Result> Line: 2065 -  // OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE

 Line: 3094 -   * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,

 Line: 3808 -  // OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE

 Line: 7967 -  // OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE

 Line: 8059 -  // OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE

 Line: 8108 -  // OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE

 Line: 9093 -  // OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE

 Line: 9306 -  // OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE

 Line: 10415 -  // OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE

 Line: 12394 -  // OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE

 Line: 14385 -  // OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE

 Line: 15925 -    reason: 'Some query argument is invalid'

 Line: 15937 -    reason: 'Some query parameter is invalid'

 Line: 17227 -  var UPDATE_SEQ_KEY = '_local_last_update_seq';

 Line: 17361 -        stores.metaStore.get(UPDATE_SEQ_KEY, function (err, value) {

 Line: 17949 -            key: UPDATE_SEQ_KEY,

</Result>
</report_mosca>

<report_mosca>
 <Path>/src/dist/pouchdb.localstorage.js</Path>
 <Module>/app/Mosca/eggs/javascript_common_fail.egg</Module>
 <Title> Possible code injection</Title>
 <Description> Command injection is an attack in which the goal is execution of arbitrary commands on the host operating system via a vulnerable application.</Description>
 <Level> High</Level>
 <Reference> https://www.securecoding.cert.org/confluence/pages/viewpage.action?pageId=2130132 </Reference>
 <Match> eval\s?\(|setTimeout|setInterval</Match>
 <Result> Line: 4770 -        setTimeout(nextTick, 0);

 Line: 7285 -      throw new Error('setTimeout has not been defined');

 Line: 7292 -          if (typeof setTimeout === 'function') {

 Line: 7293 -              cachedSetTimeout = setTimeout;

 Line: 7311 -      if (cachedSetTimeout === setTimeout) {

 Line: 7313 -          return setTimeout(fun, 0);

 Line: 7315 -      // if setTimeout wasn't available but was latter defined

 Line: 7316 -      if ((cachedSetTimeout === defaultSetTimout || !cachedSetTimeout) && setTimeout) {

 Line: 7317 -          cachedSetTimeout = setTimeout;

 Line: 7318 -          return setTimeout(fun, 0);

 Line: 7321 -          // when when somebody has screwed with setTimeout but no I.E. maddness

 Line: 7346 -          // when when somebody has screwed with setTimeout but no I.E. maddness

 Line: 7354 -              // Some versions of I.E. have different rules for clearTimeout vs setTimeout

 Line: 15381 -          setTimeout(function (){

 Line: 16429 -  var setImmediateShim = global.setImmediate || global.setTimeout;

</Result>
</report_mosca>

<report_mosca>
 <Path>/src/dist/pouchdb.localstorage.js</Path>
 <Module>/app/Mosca/eggs/javascript_common_fail.egg</Module>
 <Title> Possible SQL injection</Title>
 <Description> notification possible SQL injection</Description>
 <Level> High</Level>
 <Reference> https://www.owasp.org/index.php/Testing_for_Stack_Overflow </Reference>
 <Match> query|YQL|WHERE|FROM|SELECT|UPDATE|DELETE|INSERT|UNION|getResults</Match>
 <Result> Line: 2464 -  // OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE

 Line: 3519 -   * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,

 Line: 4233 -  // OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE

 Line: 7476 -  // OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE

 Line: 7568 -  // OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE

 Line: 7617 -  // OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE

 Line: 8602 -  // OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE

 Line: 8815 -  // OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE

 Line: 9924 -  // OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE

 Line: 11903 -  // OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE

 Line: 13944 -  // OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE

 Line: 15503 -    reason: 'Some query argument is invalid'

 Line: 15515 -    reason: 'Some query parameter is invalid'

 Line: 16805 -  var UPDATE_SEQ_KEY = '_local_last_update_seq';

 Line: 16939 -        stores.metaStore.get(UPDATE_SEQ_KEY, function (err, value) {

 Line: 17527 -            key: UPDATE_SEQ_KEY,

</Result>
</report_mosca>

<report_mosca>
 <Path>/src/dist/pouchdb.min.js</Path>
 <Module>/app/Mosca/eggs/javascript_common_fail.egg</Module>
 <Title> Possible code injection</Title>
 <Description> Command injection is an attack in which the goal is execution of arbitrary commands on the host operating system via a vulnerable application.</Description>
 <Level> High</Level>
 <Reference> https://www.securecoding.cert.org/confluence/pages/viewpage.action?pageId=2130132 </Reference>
 <Match> eval\s?\(|setTimeout|setInterval</Match>
 <Result> Line: 11 -  ript")?function(){var t=e.document.createElement("script");t.onreadystatechange=function(){n(),t.onreadystatechange=null,t.parentNode.removeChild(t),t=null},e.document.documentElement.appendChild(t)}:function(){setTimeout(n,0)};else{var c=new e.MessageChannel;c.port1.onmessage=n,o=function(){c.port2.postMessage(0)}}var f,l=[];t.exports=r}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],7:[function(e,t,n){"function"==typeof Object.create?t.exports=function(e,t){e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}})}:t.exports=function(e,t){e.super_=t;var n=function(){};n.prototype=t.prototype,e.prototype=new n,e.prototype.constructor=e}},{}],8:[function(e,t,n){(function(e){e("object"==typeof n?n:this)}).call(this,function(e){var t=Array.prototype.slice,n=Array.prototype.forEach,r=function(e){if("object"!=typeof e)throw e+" is not an object";var o=t.call(arguments,1);return n.call(o,function(t){if(t)for(var n in t)"object"==typeof t[n]&&e[n]?r.call(e,e[n],t[n]):e[n]=t[n]}),e};e.extend=r})},{}],9:[function(e,t,n){"use strict";function r(){}function o(e){if("function"!=typeof e)throw new TypeError("resolver must be a function");this.state=m,this.queue=[],this.outcome=void 0,e!==r&&u(this,e)}function i(e,t,n){this.promise=e,"function"==typeof t&&(this.onFulfilled=t,this.callFulfilled=this.otherCallFulfilled),"function"==typeof n&&(this.onRejected=n,this.callRejected=this.otherCallRejected)}function s(e,t,n){p(function(){var r;try{r=t(n)}catch(t){return v.reject(e,t)}r===e?v.reject(e,new TypeError("Cannot resolve promise with itself")):v.resolve(e,r)})}function a(e){var t=e&&e.then;if(e&&"object"==typeof e&&"function"==typeof t)return function(){t.apply(e,arguments)}}function u(e,t){function n(t){i||(i=!0,v.reject(e,t))}function r(t){i||(i=!0,v.resolve(e,t))}function o(){t(r,n)}var i=!1,s=c(o);"error"===s.status&&n(s.value)}function c(e,t){var n={};try{n.value=e(t),n.status="success"}catch(e){n.status="error",n.value=e}return n}function f(e){return e ins Line: 13 -  {case"years":case"year":case"yrs":case"yr":case"y":return n*l;case"days":case"day":case"d":return n*f;case"hours":case"hour":case"hrs":case"hr":case"h":return n*c;case"minutes":case"minute":case"mins":case"min":case"m":return n*u;case"seconds":case"second":case"secs":case"sec":case"s":return n*a;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return n}}}}function o(e){return e>=f?Math.round(e/f)+"d":e>=c?Math.round(e/c)+"h":e>=u?Math.round(e/u)+"m":e>=a?Math.round(e/a)+"s":e+"ms"}function i(e){return s(e,f,"day")||s(e,c,"hour")||s(e,u,"minute")||s(e,a,"second")||e+" ms"}function s(e,t,n){if(!(e<t))return e<1.5*t?Math.floor(e/t)+" "+n:Math.ceil(e/t)+" "+n+"s"}var a=1e3,u=60*a,c=60*u,f=24*c,l=365.25*f;t.exports=function(e,t){return t=t||{},"string"==typeof e?r(e):t.long?i(e):o(e)}},{}],11:[function(e,t,n){function r(){throw new Error("setTimeout has not been defined")}function o(){throw new Error("clearTimeout has not been defined")}function i(e){if(l===setTimeout)return setTimeout(e,0);if((l===r||!l)&&setTimeout)return l=setTimeout,setTimeout(e,0);try{return l(e,0)}catch(t){try{return l.call(null,e,0)}catch(t){return l.call(this,e,0)}}}function s(e){if(d===clearTimeout)return clearTimeout(e);if((d===o||!d)&&clearTimeout)return d=clearTimeout,clearTimeout(e);try{return d(e)}catch(t){try{return d.call(null,e)}catch(t){return d.call(this,e)}}}function a(){y&&p&&(y=!1,p.length?v=p.concat(v):_=-1,v.length&&u())}function u(){if(!y){var e=i(a);y=!0;for(var t=v.length;t;){for(p=v,v=[];++_<t;)p&&p[_].run();_=-1,t=v.length}p=null,y=!1,s(e)}}function c(e,t){this.fun=e,this.array=t}function f(){}var l,d,h=t.exports={};!function(){try{l="function"==typeof setTimeout?setTimeout:r}catch(e){l=r}try{d="function"==typeof clearTimeout?clearTimeout:o}catch(e){d=o}}();var p,v=[],y=!1,_=-1;h.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];v.push(new c(e,t)),1!==v.length||y||i(u)},c.prototype.run=function(){this.fun.apply(null,this.array)},h.title="browser",h.browser=!0,h.env={},h.argv=[],h.vers Line: 46 -  on(r,Pt(n),function(){a&&n(null,a)})},m._removeLocal=function(e,t,n){function r(r){var i="DELETE FROM "+Xo+" WHERE id=? AND rev=?",s=[e._id,e._rev];r.executeSql(i,s,function(r,i){return i.rowsAffected?(o={ok:!0,id:e._id,rev:"0-0"},void(t.ctx&&n(null,o))):n(j(eo))})}"function"==typeof t&&(n=t,t={});var o;t.ctx?r(t.ctx):q.transaction(r,Pt(n),function(){o&&n(null,o)})},m._destroy=function(e,t){$o.removeAllListeners(m._name),q.transaction(function(e){var t=[Jo,Ko,zo,Go,Xo,Vo];t.forEach(function(t){e.executeSql("DROP TABLE IF EXISTS "+t,[])})},Pt(t),function(){E()&&(delete window.localStorage["_pouch__websqldb_"+m._name],delete window.localStorage[m._name]),t(null,{ok:!0})})}}function Xt(){try{return openDatabase("_pouch_validate_websql",1,"",1),!0}catch(e){return!1}}function Gt(){if("undefined"==typeof indexedDB||null===indexedDB||!/iP(hone|od|ad)/.test(navigator.userAgent))return!0;var e=E(),t="_pouch__websqldb_valid_"+navigator.userAgent;if(e&&localStorage[t])return"1"===localStorage[t];var n=Xt();return e&&(localStorage[t]=n?"1":"0"),n}function Vt(){return"function"==typeof openDatabase&&Gt()}function Qt(e,t,n,r){return openDatabase(e,t,n,r)}function $t(e,t){var n=Br.extend({websql:Qt},e);zt.call(this,n,t)}function Yt(e){e.adapter("websql",$t,!0)}function Zt(){for(var e={},t=new Xr(function(t,n){e.resolve=t,e.reject=n}),n=new Array(arguments.length),r=0;r<n.length;r++)n[r]=arguments[r];return e.promise=t,Xr.resolve().then(function(){return fetch.apply(null,n)}).then(function(t){e.resolve(t)}).catch(function(t){e.reject(t)}),e}function en(e,t){var n,r,o,i=new Headers,s={method:e.method,credentials:"include",headers:i};return e.json&&(i.set("Accept","application/json"),i.set("Content-Type",e.headers["Content-Type"]||"application/json")),e.body&&e.body instanceof Blob?He(e.body,function(e){s.body=e}):e.body&&e.processData&&"string"!=typeof e.body?s.body=JSON.stringify(e.body):"body"in e?s.body=e.body:s.body=null,Object.keys(e.headers).forEach(function(t){e.headers.hasOwnProperty(t)&&i.set(t,e.headers[t])}),n=Zt(e.url,s),e.timeout>0&&(r=setTimeout(function(){n.reject(new Error("Loa Line: 47 -   resource: "+e.url))},e.timeout)),n.promise.then(function(t){return o={statusCode:t.status},e.timeout>0&&clearTimeout(r),o.statusCode>=200&&o.statusCode<300?e.binary?t.blob():t.text():t.json()}).then(function(e){o.statusCode>=200&&o.statusCode<300?t(null,o,e):t(e,o)}).catch(function(e){t(e,o)}),{abort:n.reject}}function tn(e,t){var n,r,o=!1,i=function(){n.abort(),u()},s=function(){o=!0,n.abort(),u()},a={abort:i},u=function(){clearTimeout(r),a.abort=function(){},n&&(n.onprogress=void 0,n.upload&&(n.upload.onprogress=void 0),n.onreadystatechange=void 0,n=void 0)};n=e.xhr?new e.xhr:new XMLHttpRequest;try{n.open(e.method,e.url)}catch(e){return t(new Error(e.name||"Url is invalid"))}n.withCredentials=!("withCredentials"in e)||e.withCredentials,"GET"===e.method?delete e.headers["Content-Type"]:e.json&&(e.headers.Accept="application/json",e.headers["Content-Type"]=e.headers["Content-Type"]||"application/json",e.body&&e.processData&&"string"!=typeof e.body&&(e.body=JSON.stringify(e.body))),e.binary&&(n.responseType="arraybuffer"),"body"in e||(e.body=null);for(var c in e.headers)e.headers.hasOwnProperty(c)&&n.setRequestHeader(c,e.headers[c]);return e.timeout>0&&(r=setTimeout(s,e.timeout),n.onprogress=function(){clearTimeout(r),4!==n.readyState&&(r=setTimeout(s,e.timeout))},"undefined"!=typeof n.upload&&(n.upload.onprogress=n.onprogress)),n.onreadystatechange=function(){if(4===n.readyState){var r={statusCode:n.status};if(n.status>=200&&n.status<300){var i;i=e.binary?Re([n.response||""],{type:n.getResponseHeader("Content-Type")}):n.responseText,t(null,r,i)}else{var s={};if(o)s=new Error("ETIMEDOUT"),s.code="ETIMEDOUT";else if("string"==typeof n.response)try{s=JSON.parse(n.response)}catch(e){}s.status=n.status,t(s)}u()}},e.body&&e.body instanceof Blob?He(e.body,function(e){n.send(e)}):n.send(e.body),a}function nn(){try{return new XMLHttpRequest,!0}catch(e){return!1}}function rn(e,t){return si||e.xhr?tn(e,t):en(e,t)}function on(){return""}function sn(e,t){function n(t,n,r){if(!e.binary&&e.json&&"string"==typeof t)try{t=JSON.parse(t)}catch(e){return r(e)}Array.isArray(t)&&(t=t.map(function( Line: 49 -  e.protocol+"://"+e.host+(e.port?":"+e.port:"")+"/"+e.path+n+t}function vn(e){return"?"+Object.keys(e).map(function(t){return t+"="+encodeURIComponent(e[t])}).join("&")}function yn(e,t){function n(e,t,n){var r=e.ajax||{},o=Br.extend(h(f),r,t);return li(o.method+" "+o.url),a._ajax(o,n)}function r(e,t){return new Xr(function(r,o){n(e,t,function(e,t){return e?o(e):void r(t)})})}function o(e,t){return y(e,Hr(function(e){i().then(function(){return t.apply(this,e)}).catch(function(t){var n=e.pop();n(t)})}))}function i(){if(e.skipSetup||e.skip_setup)return Xr.resolve();if(v)return v;var t={method:"GET",url:c};return v=r({},t).catch(function(e){return e&&e.status&&404===e.status?(T(404,"PouchDB is just detecting if the remote exists."),r({},{method:"PUT",url:c})):Xr.reject(e)}).catch(function(e){return!(!e||!e.status||412!==e.status)||Xr.reject(e)}),v.catch(function(){v=null}),v}function s(e){return e.split("/").map(encodeURIComponent).join("/")}var a=this,u=dn(e.name,e),c=hn(u,"");e=h(e);var f=e.ajax||{};if(e.auth||u.auth){var l=e.auth||u.auth,d=l.username+":"+l.password,p=To(unescape(encodeURIComponent(d)));f.headers=f.headers||{},f.headers.Authorization="Basic "+p}a._ajax=an;var v;setTimeout(function(){t(null,a)}),a.type=function(){return"http"},a.id=o("id",function(e){n({},{method:"GET",url:pn(u,"")},function(t,n){var r=n&&n.uuid?n.uuid+u.db:hn(u,"");e(null,r)})}),a.request=o("request",function(e,t){e.url=hn(u,e.url),n({},e,t)}),a.compact=o("compact",function(e,t){"function"==typeof e&&(t=e,e={}),e=h(e),n(e,{url:hn(u,"_compact"),method:"POST"},function(){function n(){a.info(function(r,o){o&&!o.compact_running?t(null,{ok:!0}):setTimeout(n,e.interval||200)})}n()})}),a.bulkGet=y("bulkGet",function(e,t){function r(t){var r={};e.revs&&(r.revs=!0),e.attachments&&(r.attachments=!0),n({},{url:hn(u,"_bulk_get"+vn(r)),method:"POST",body:{docs:e.docs}},t)}function o(){function n(e){return function(n,r){a[e]=r.results,++s===o&&t(null,{results:R(a)})}}for(var r=ci,o=Math.ceil(e.docs.length/r),s=0,a=new Array(o),u=0;u<o;u++){var c=_(e,["revs","attachments"]);c.ajax=f,c.docs=e.docs.slice(u*r,Math Line: 52 -  "string"==typeof e.view&&(o.filter="_view",o.view=e.view),e.query_params&&"object"==typeof e.query_params)for(var c in e.query_params)e.query_params.hasOwnProperty(c)&&(o[c]=e.query_params[c]);var l,d="GET";e.doc_ids&&(o.filter="_doc_ids",d="POST",l={doc_ids:e.doc_ids});var p,v,y=function(r,c){if(!e.aborted){o.since=r,"object"==typeof o.since&&(o.since=JSON.stringify(o.since)),e.descending?s&&(o.limit=a):o.limit=!s||a>t?t:a;var f={method:d,url:hn(u,"_changes"+vn(o)),timeout:e.timeout,body:l};v=r,e.aborted||i().then(function(){p=n(e,f,c)}).catch(c)}},_={results:[]},m=function(n,o){if(!e.aborted){var i=0;if(o&&o.results){i=o.results.length,_.last_seq=o.last_seq;var u={};u.query=e.query_params,o.results=o.results.filter(function(t){a--;var n=I(e)(t);return n&&(e.include_docs&&e.attachments&&e.binary&&un(t),r&&_.results.push(t),e.onChange(t)),n})}else if(n)return e.aborted=!0,void e.complete(n);o&&o.last_seq&&(v=o.last_seq);var c=s&&a<=0||o&&i<t||e.descending;(!e.continuous||s&&a<=0)&&c?e.complete(null,_):setTimeout(function(){y(v,m)},0)}};return y(e.since||0,m),{cancel:function(){e.aborted=!0,p&&p.abort()}}},a.revsDiff=o("revsDiff",function(e,t,r){"function"==typeof t&&(r=t,t={}),n(t,{method:"POST",url:hn(u,"_revs_diff"),body:e},r)}),a._close=function(e){e()},a._destroy=function(e,t){n(e,{url:hn(u,""),method:"DELETE"},function(e,n){return e&&e.status&&404!==e.status?t(e):void t(null,n)})}}function _n(e){e.adapter("http",yn,!1),e.adapter("https",yn,!1)}function mn(e,t,n){for(var r="",o=n-e.length;r.length<o;)r+=t;return r}function gn(e,t,n){var r=mn(e,t,n);return r+e}function bn(e,t){if(e===t)return 0;e=wn(e),t=wn(t);var n=jn(e),r=jn(t);if(n-r!==0)return n-r;if(null===e)return 0;switch(typeof e){case"number":return e-t;case"boolean":return e===t?0:e<t?-1:1;case"string":return Tn(e,t)}return Array.isArray(e)?An(e,t):On(e,t)}function wn(e){switch(typeof e){case"undefined":return null;case"number":return e===1/0||e===-(1/0)||isNaN(e)?null:e;case"object":var t=e;if(Array.isArray(e)){var n=e.length;e=new Array(n);for(var r=0;r<n;r++)e[r]=wn(t[r])}else{if(e instanceof Date)return e.toJS Line: 61 -  throw new Error("cancelled");e.rows.forEach(function(e){!e.deleted&&e.doc&&vr(e.value.rev)&&!i(e.doc)&&(c.push(e.doc),delete n[e.id])})})}function a(){var e=Object.keys(n).filter(function(e){var t=n[e].missing;return 1===t.length&&vr(t[0])});if(e.length>0)return s(e)}function u(){return{ok:f,docs:c}}n=h(n);var c=[],f=!0;return Xr.resolve().then(a).then(o).then(u)}function wr(e,t,n,r,o){return e.get(t).catch(function(n){if(404===n.status)return"http"===e.type()&&T(404,"PouchDB is just checking if a remote checkpoint exists."),{session_id:r,_id:t,history:[],replicator:Oi,version:Ti};throw n}).then(function(i){if(!o.cancelled&&i.last_seq!==n)return i.history=(i.history||[]).filter(function(e){return e.session_id!==r}),i.history.unshift({last_seq:n,session_id:r}),i.history=i.history.slice(0,ji),i.version=Ti,i.replicator=Oi,i.session_id=r,i.last_seq=n,e.put(i).catch(function(i){if(409===i.status)return wr(e,t,n,r,o);throw i})})}function Er(e,t,n,r){this.src=e,this.target=t,this.id=n,this.returnValue=r}function kr(e,t){return e.session_id===t.session_id?{last_seq:e.last_seq,history:e.history}:Sr(e.history,t.history)}function Sr(e,t){var n=e[0],r=e.slice(1),o=t[0],i=t.slice(1);if(!n||0===t.length)return{last_seq:Ci,history:[]};var s=n.session_id;if(qr(s,t))return{last_seq:n.last_seq,history:e};var a=o.session_id;return qr(a,r)?{last_seq:o.last_seq,history:i}:Sr(r,i)}function qr(e,t){var n=t[0],r=t.slice(1);return!(!e||0===t.length)&&(e===n.session_id||qr(e,r))}function xr(e){return"number"==typeof e.status&&4===Math.floor(e.status/100)}function Ar(e,t,n,r){if(e.retry===!1)return t.emit("error",n),void t.removeAllListeners();if("function"!=typeof e.back_off_function&&(e.back_off_function=A),t.emit("requestError",n),"active"===t.state||"pending"===t.state){t.emit("paused",n),t.state="stopped";var o=function(){e.current_back_off=Ii},i=function(){t.removeListener("active",o)};t.once("paused",i),t.once("active",o)}e.current_back_off=e.current_back_off||Ii,e.current_back_off=e.back_off_function(e.current_back_off),setTimeout(r,e.current_back_off)}function Tr(e){return Object.keys(e).sort(b Line: 66 -  [o];o=s(o),e(i,o)}},u.prototype.add=function(e){return this.store.set(e,!0)},u.prototype.has=function(e){return this.store.has(e)};var Gr,Vr=Function.prototype.toString,Qr=Vr.call(Object),$r=Fr("pouchdb:api"),Yr=6;if(w())Gr=!1;else try{localStorage.setItem("_pouch_check_localstorage",1),Gr=!!localStorage.getItem("_pouch_check_localstorage")}catch(e){Gr=!1}Pr(S,Mr.EventEmitter),S.prototype.addListener=function(e,t,n,r){function o(){function e(){s=!1}if(i._listeners[t]){if(s)return void(s="waiting");s=!0;var a=_(r,["style","include_docs","attachments","conflicts","filter","doc_ids","view","since","query_params","binary"]);n.changes(a).on("change",function(e){e.seq>r.since&&!r.cancelled&&(r.since=e.seq,r.onChange(e))}).on("complete",function(){"waiting"===s&&setTimeout(function(){o()},0),s=!1}).on("error",e)}}if(!this._listeners[t]){var i=this,s=!1;this._listeners[t]=o,this.on(e,o)}},S.prototype.removeListener=function(e,t){t in this._listeners&&(Mr.EventEmitter.prototype.removeListener.call(this,e,this._listeners[t]),delete this._listeners[t])},S.prototype.notifyLocalWindows=function(e){w()?chrome.storage.local.set({dbName:e}):E()&&(localStorage[e]="a"===localStorage[e]?"b":"a")},S.prototype.notify=function(e){this.emit(e),this.notifyLocalWindows(e)},Pr(O,Error),O.prototype.toString=function(){return JSON.stringify({status:this.status,name:this.name,message:this.message,reason:this.reason})};var Zr=(new O({status:401,error:"unauthorized",reason:"Name or password is incorrect."}),new O({status:400,error:"bad_request",reason:"Missing JSON list of 'docs'"})),eo=new O({status:404,error:"not_found",reason:"missing"}),to=new O({status:409,error:"conflict",reason:"Document update conflict"}),no=new O({status:400,error:"bad_request",reason:"_id field must contain a string"}),ro=new O({status:412,error:"missing_id",reason:"_id is required for puts"}),oo=new O({status:400,error:"bad_request",reason:"Only reserved document ids may start with underscore."}),io=new O({status:412,error:"precondition_failed",reason:"Database not open"}),so=new O({status:500,error:"unknown_error",reason:"Databa Line: 74 -  n(e){return btoa(e)},Oo=r.setImmediate||r.setTimeout,jo=32768,Co=5,Lo="document-store",Io="by-sequence",Ro="attach-store",Do="attach-seq-store",No="meta-store",Bo="local-store",Fo="detect-blob-support",Po={running:!1,queue:[]},Uo=new a,Mo=new S,Ho=new a;Et.valid=function(){var e="undefined"!=typeof openDatabase&&/(Safari|iPhone|iPad|iPod)/.test(navigator.userAgent)&&!/Chrome/.test(navigator.userAgent)&&!/BlackBerry/.test(navigator.platform);return!e&&"undefined"!=typeof indexedDB&&"undefined"!=typeof IDBKeyRange};var Wo=7,Jo=Ct("document-store"),Ko=Ct("by-sequence"),zo=Ct("attach-store"),Xo=Ct("local-store"),Go=Ct("metadata-store"),Vo=Ct("attach-seq-store"),Qo=new a,$o=new S,Yo=1,Zo="CREATE INDEX IF NOT EXISTS 'by-seq-deleted-idx' ON "+Ko+" (seq, deleted)",ei="CREATE UNIQUE INDEX IF NOT EXISTS 'by-seq-doc-id-rev' ON "+Ko+" (doc_id, rev)",ti="CREATE INDEX IF NOT EXISTS 'doc-winningseq-idx' ON "+Jo+" (winningseq)",ni="CREATE INDEX IF NOT EXISTS 'attach-seq-seq-idx' ON "+Vo+" (seq)",ri="CREATE UNIQUE INDEX IF NOT EXISTS 'attach-seq-digest-idx' ON "+Vo+" (digest, seq)",oi=Ko+".seq = "+Jo+".winningseq",ii=Ko+".seq AS seq, "+Ko+".deleted AS deleted, "+Ko+".json AS data, "+Ko+".rev AS rev, "+Jo+".json AS metadata";$t.valid=Vt,$t.use_prefix=!0;var si=nn(),ai=function(){},ui=25,ci=50,fi={},li=Fr("pouchdb:http");yn.valid=function(){return!0};var di=-324,hi=3,pi="";Ln.prototype.add=function(e){return this.promise=this.promise.catch(function(){}).then(function(){return e()}),this.promise},Ln.prototype.finish=function(){return this.promise};var vi=function(e,t){return t&&e.then(function(e){n.nextTick(function(){t(null,e)})},function(e){n.nextTick(function(){t(e)})}),e},yi=function(e){return Hr(function(t){var n=t.pop(),r=e.apply(this,t);return"function"==typeof n&&vi(r,n),r})},_i=function(e,t){return e.then(function(e){return t().then(function(){return e})},function(e){return t().then(function(){throw e})})},mi=function(e,t){return function(){var n=arguments,r=this;return e.add(function(){return t.apply(r,n)})}},gi=function(e){for(var t={},n=0,r=e.length;n<r;n++)t["$"+e[n]]=!0;var o=Object</Result>
</report_mosca>

<report_mosca>
 <Path>/src/dist/pouchdb.min.js</Path>
 <Module>/app/Mosca/eggs/javascript_common_fail.egg</Module>
 <Title> Possible SQL injection</Title>
 <Description> notification possible SQL injection</Description>
 <Level> High</Level>
 <Reference> https://www.owasp.org/index.php/Testing_for_Stack_Overflow </Reference>
 <Match> query|YQL|WHERE|FROM|SELECT|UPDATE|DELETE|INSERT|UNION|getResults</Match>
 <Result> Line: 38 -  var e="Failed to open indexedDB, are you in private browsing mode?";q("error",e),r(j(ho,e))}}function St(e,t){try{return indexedDB.open(e,{version:Co,storage:t})}catch(t){return indexedDB.open(e,Co)}}function qt(e){e.adapter("idb",Et,!0)}function xt(e){return decodeURIComponent(escape(e))}function At(e){return e<65?e-48:e-55}function Tt(e,t,n){for(var r="";t<n;)r+=String.fromCharCode(At(e.charCodeAt(t++))<<4|At(e.charCodeAt(t++)));return r}function Ot(e,t,n){for(var r="";t<n;)r+=String.fromCharCode(At(e.charCodeAt(t+2))<<12|At(e.charCodeAt(t+3))<<8|At(e.charCodeAt(t))<<4|At(e.charCodeAt(t+1))),t+=4;return r}function jt(e,t){return"UTF-8"===t?xt(Tt(e,0,e.length)):Ot(e,0,e.length)}function Ct(e){return"'"+e+"'"}function Lt(e){return e.replace(/\u0002/g,"").replace(/\u0001/g,"").replace(/\u0000/g,"")}function It(e){return e.replace(/\u0001\u0001/g,"\0").replace(/\u0001\u0002/g,"").replace(/\u0002\u0002/g,"")}function Rt(e){return delete e._id,delete e._rev,JSON.stringify(e)}function Dt(e,t,n){return e=JSON.parse(e),e._id=t,e._rev=n,e}function Nt(e){for(var t="(";e--;)t+="?",e&&(t+=",");return t+")"}function Bt(e,t,n,r,o){return"SELECT "+e+" FROM "+("string"==typeof t?t:t.join(" JOIN "))+(n?" ON "+n:"")+(r?" WHERE "+("string"==typeof r?r:r.join(" AND ")):"")+(o?" ORDER BY "+o:"")}function Ft(e,t,n){function r(){++i===e.length&&o()}function o(){if(s.length){var e="SELECT DISTINCT digest AS digest FROM "+Vo+" WHERE seq IN "+Nt(s.length);n.executeSql(e,s,function(e,t){for(var n=[],r=0;r<t.rows.length;r++)n.push(t.rows.item(r).digest);if(n.length){var o="DELETE FROM "+Vo+" WHERE seq IN ("+s.map(function(){return"?"}).join(",")+")";e.executeSql(o,s,function(e){var t="SELECT digest FROM "+Vo+" WHERE digest IN ("+n.map(function(){return"?"}).join(",")+")";e.executeSql(t,n,function(e,t){for(var r=new u,o=0;o<t.rows.length;o++)r.add(t.rows.item(o).digest);n.forEach(function(t){r.has(t)||(e.executeSql("DELETE FROM "+Vo+" WHERE digest=?",[t]),e.executeSql("DELETE FROM "+zo+" WHERE digest=?",[t]))})})})}})}}if(e.length){var i=0,s=[];e.forEach(function(e){var o="SELECT seq FROM "+Ko+"  Line: 39 -  ? AND rev=?";n.executeSql(o,[t,e],function(e,t){if(!t.rows.length)return r();var n=t.rows.item(0).seq;s.push(n),e.executeSql("DELETE FROM "+Ko+" WHERE seq=?",[n],r)})})}}function Pt(e){return function(t){q("error","WebSQL threw an error",t);var n=t&&t.constructor.toString().match(/function ([^\(]+)/),r=n&&n[1]||t.type,o=t.target||t.message;e(j(po,o,r))}}function Ut(e){if("size"in e)return 1e6*e.size;var t="undefined"!=typeof navigator&&/Android/.test(navigator.userAgent);return t?5e6:1}function Mt(e,t,n,r,o,i,s){function u(){return b?s(b):(i.notify(r._name),r._docCount=-1,void s(null,w))}function c(e,t){var n="SELECT count(*) as cnt FROM "+zo+" WHERE digest=?";g.executeSql(n,[e],function(n,r){if(0===r.rows.item(0).cnt){var o=j(yo,"unknown stub attachment with digest "+e);t(o)}else t()})}function f(e){function t(){++o===n.length&&e(r)}var n=[];if(_.forEach(function(e){e.data&&e.data._attachments&&Object.keys(e.data._attachments).forEach(function(t){var r=e.data._attachments[t];r.stub&&n.push(r.digest)})}),!n.length)return e();var r,o=0;n.forEach(function(e){c(e,function(e){e&&!r&&(r=e),t()})})}function l(e,t,n,o,i,s,a,u){function c(){function t(e,t){function r(){return++i===s.length&&t(),!1}function o(t){var o="INSERT INTO "+Vo+" (digest, seq) VALUES (?,?)",i=[n._attachments[t].digest,e];g.executeSql(o,i,r,r)}var i=0,s=Object.keys(n._attachments||{});if(!s.length)return t();for(var a=0;a<s.length;a++)o(s[a])}var n=e.data,r=o?1:0,i=n._id,s=n._rev,a=Rt(n),u="INSERT INTO "+Ko+" (doc_id, rev, json, deleted) VALUES (?, ?, ?, ?);",c=[i,s,a,r];g.executeSql(u,c,function(e,n){var r=n.insertId;t(r,function(){d(e,r)})},function(){var e=Bt("seq",Ko,null,"doc_id=? AND rev=?");return g.executeSql(e,[i,s],function(e,n){var o=n.rows.item(0).seq,u="UPDATE "+Ko+" SET json=?, deleted=? WHERE doc_id=? AND rev=?;",c=[a,r,i,s];e.executeSql(u,c,function(e){t(o,function(){d(e,o)})})}),!1})}function f(e){h||(e?(h=e,u(h)):v===y.length&&c())}function l(e){v++,f(e)}function d(n,o){var s=e.metadata.id,c=e.stemmedRevs||[];i&&r.auto_compaction&&(c=V(e.metadata).concat(c)),c.length&&Ft(c,s,n),e.metadata.seq=o Line: 40 -  adata.rev;var f=i?"UPDATE "+Jo+" SET json=?, max_seq=?, winningseq=(SELECT seq FROM "+Ko+" WHERE doc_id="+Jo+".id AND rev=?) WHERE id=?":"INSERT INTO "+Jo+" (id, winningseq, max_seq, json) VALUES (?,?,?,?);",l=it(e.metadata),d=i?[l,o,t,s]:[s,o,o,l];n.executeSql(f,d,function(){w[a]={ok:!0,id:e.metadata.id,rev:t},E.set(s,e.metadata),u()})}var h=null,v=0;e.data._id=e.metadata.id,e.data._rev=e.metadata.rev;var y=Object.keys(e.data._attachments||{});o&&(e.data._deleted=!0),y.forEach(function(n){var r=e.data._attachments[n];if(r.stub)v++,f();else{var o=r.data;delete r.data,r.revpos=parseInt(t,10);var i=r.digest;p(i,o,l)}}),y.length||c()}function d(){nt(e.revs_limit,_,r,E,g,w,l,n)}function h(e){function t(){++n===_.length&&e()}if(!_.length)return e();var n=0;_.forEach(function(e){if(e._id&&ce(e._id))return t();var n=e.metadata.id;g.executeSql("SELECT json FROM "+Jo+" WHERE id = ?",[n],function(e,r){if(r.rows.length){var o=ot(r.rows.item(0).json);E.set(n,o)}t()})})}function p(e,t,n){var r="SELECT digest FROM "+zo+" WHERE digest=?";g.executeSql(r,[e],function(o,i){return i.rows.length?n():(r="INSERT INTO "+zo+" (digest, body, escaped) VALUES (?,?,1)",void o.executeSql(r,[e,Lt(t)],function(){n()},function(){return n(),!1}))})}var v=n.new_edits,y=t.docs,_=y.map(function(e){if(e._id&&ce(e._id))return e;var t=Ie(e,v);return t}),m=_.filter(function(e){return e.error});if(m.length)return s(m[0]);var g,b,w=new Array(_.length),E=new a;Ze(_,"binary",function(e){return e?s(e):void o.transaction(function(e){g=e,f(function(e){e?b=e:h(d)})},Pt(s),u)})}function Ht(e){return e.websql(e.name,e.version,e.description,e.size)}function Wt(e){try{return{db:Ht(e)}}catch(e){return{error:e}}}function Jt(e){var t=Qo.get(e.name);return t||(t=Wt(e),Qo.set(e.name,t)),t}function Kt(e,t,n,r,o){function i(){++u===a.length&&o&&o()}function s(e,o){var s=e._attachments[o],a={binary:t.binary,ctx:r};n._getAttachment(e._id,o,s,a,function(t,n){e._attachments[o]=Br.extend(_(s,["digest","content_type"]),{data:n}),i()})}var a=Object.keys(e._attachments||{});if(!a.length)return o&&o();var u=0;a.forEach(function(n){t.attachment Line: 41 -  docs?s(e,n):(e._attachments[n].stub=!0,i())})}function zt(e,t){function n(){E()&&(window.localStorage["_pouch__websqldb_"+m._name]=!0),t(null,m)}function r(e,t){e.executeSql(ti),e.executeSql("ALTER TABLE "+Ko+" ADD COLUMN deleted TINYINT(1) DEFAULT 0",[],function(){e.executeSql(Zo),e.executeSql("ALTER TABLE "+Jo+" ADD COLUMN local TINYINT(1) DEFAULT 0",[],function(){e.executeSql("CREATE INDEX IF NOT EXISTS 'doc-store-local-idx' ON "+Jo+" (local, id)");var n="SELECT "+Jo+".winningseq AS seq, "+Jo+".json AS metadata FROM "+Ko+" JOIN "+Jo+" ON "+Ko+".seq = "+Jo+".winningseq";e.executeSql(n,[],function(e,n){for(var r=[],o=[],i=0;i<n.rows.length;i++){var s=n.rows.item(i),a=s.seq,u=JSON.parse(s.metadata);ue(u)&&r.push(a),ce(u.id)&&o.push(u.id)}e.executeSql("UPDATE "+Jo+"SET local = 1 WHERE id IN "+Nt(o.length),o,function(){e.executeSql("UPDATE "+Ko+" SET deleted = 1 WHERE seq IN "+Nt(r.length),r,t)})})})})}function o(e,t){var n="CREATE TABLE IF NOT EXISTS "+Xo+" (id UNIQUE, rev, json)";e.executeSql(n,[],function(){var n="SELECT "+Jo+".id AS id, "+Ko+".json AS data FROM "+Ko+" JOIN "+Jo+" ON "+Ko+".seq = "+Jo+".winningseq WHERE local = 1";e.executeSql(n,[],function(e,n){function r(){if(!o.length)return t(e);var n=o.shift(),i=JSON.parse(n.data)._rev;e.executeSql("INSERT INTO "+Xo+" (id, rev, json) VALUES (?,?,?)",[n.id,i,n.data],function(e){e.executeSql("DELETE FROM "+Jo+" WHERE id=?",[n.id],function(e){e.executeSql("DELETE FROM "+Ko+" WHERE seq=?",[n.seq],function(){r()})})})}for(var o=[],i=0;i<n.rows.length;i++)o.push(n.rows.item(i));r()})})}function i(e,t){function n(n){function r(){if(!n.length)return t(e);var o=n.shift(),i=jt(o.hex,_),s=i.lastIndexOf("::"),a=i.substring(0,s),u=i.substring(s+2),c="UPDATE "+Ko+" SET doc_id=?, rev=? WHERE doc_id_rev=?";e.executeSql(c,[a,u,i],function(){r()})}r()}var r="ALTER TABLE "+Ko+" ADD COLUMN doc_id";e.executeSql(r,[],function(e){var t="ALTER TABLE "+Ko+" ADD COLUMN rev";e.executeSql(t,[],function(e){e.executeSql(ei,[],function(e){var t="SELECT hex(doc_id_rev) as hex FROM "+Ko;e.executeSql(t,[],function(e,t){for(var r=[],o=0;o<t.rows.length;o+ Line: 42 -  ws.item(o));n(r)})})})})}function s(e,t){function n(e){var n="SELECT COUNT(*) AS cnt FROM "+zo;e.executeSql(n,[],function(e,n){function r(){var n=Bt(ii+", "+Jo+".id AS id",[Jo,Ko],oi,null,Jo+".id ");n+=" LIMIT "+s+" OFFSET "+i,i+=s,e.executeSql(n,[],function(e,n){function o(e,t){var n=i[e]=i[e]||[];n.indexOf(t)===-1&&n.push(t)}if(!n.rows.length)return t(e);for(var i={},s=0;s<n.rows.length;s++)for(var a=n.rows.item(s),u=Dt(a.data,a.id,a.rev),c=Object.keys(u._attachments||{}),f=0;f<c.length;f++){var l=u._attachments[c[f]];o(l.digest,a.seq)}var d=[];if(Object.keys(i).forEach(function(e){var t=i[e];t.forEach(function(t){d.push([e,t])})}),!d.length)return r();var h=0;d.forEach(function(t){var n="INSERT INTO "+Vo+" (digest, seq) VALUES (?,?)";e.executeSql(n,t,function(){++h===d.length&&r()})})})}var o=n.rows.item(0).cnt;if(!o)return t(e);var i=0,s=10;r()})}var r="CREATE TABLE IF NOT EXISTS "+Vo+" (digest, seq INTEGER)";e.executeSql(r,[],function(e){e.executeSql(ri,[],function(e){e.executeSql(ni,[],n)})})}function a(e,t){var n="ALTER TABLE "+zo+" ADD COLUMN escaped TINYINT(1) DEFAULT 0";e.executeSql(n,[],t)}function u(e,t){var n="ALTER TABLE "+Jo+" ADD COLUMN max_seq INTEGER";e.executeSql(n,[],function(e){var n="UPDATE "+Jo+" SET max_seq=(SELECT MAX(seq) FROM "+Ko+" WHERE doc_id=id)";e.executeSql(n,[],function(e){var n="CREATE UNIQUE INDEX IF NOT EXISTS 'doc-max-seq-idx' ON "+Jo+" (max_seq)";e.executeSql(n,[],t)})})}function c(e,t){e.executeSql('SELECT HEX("a") AS hex',[],function(e,n){var r=n.rows.item(0).hex;_=2===r.length?"UTF-8":"UTF-16",t()})}function f(){for(;w.length>0;){var e=w.pop();e(null,g)}}function l(e,t){if(0===t){var n="CREATE TABLE IF NOT EXISTS "+Go+" (dbid, db_version INTEGER)",c="CREATE TABLE IF NOT EXISTS "+zo+" (digest UNIQUE, escaped TINYINT(1), body BLOB)",l="CREATE TABLE IF NOT EXISTS "+Vo+" (digest, seq INTEGER)",d="CREATE TABLE IF NOT EXISTS "+Jo+" (id unique, json, winningseq, max_seq INTEGER UNIQUE)",h="CREATE TABLE IF NOT EXISTS "+Ko+" (seq INTEGER NOT NULL PRIMARY KEY AUTOINCREMENT, json, deleted TINYINT(1), doc_id, rev)",p="CREATE TABLE IF NOT EXISTS "+ Line: 43 -  UE, rev, json)";e.executeSql(c),e.executeSql(p),e.executeSql(l,[],function(){e.executeSql(ni),e.executeSql(ri)}),e.executeSql(d,[],function(){e.executeSql(ti),e.executeSql(h,[],function(){e.executeSql(Zo),e.executeSql(ei),e.executeSql(n,[],function(){var t="INSERT INTO "+Go+" (db_version, dbid) VALUES (?,?)";g=W();var n=[Wo,g];e.executeSql(t,n,function(){f()})})})})}else{var v=function(){var n=t<Wo;n&&e.executeSql("UPDATE "+Go+" SET db_version = "+Wo);var r="SELECT dbid FROM "+Go;e.executeSql(r,[],function(e,t){g=t.rows.item(0).dbid,f()})},y=[r,o,i,s,a,u,v],_=t,m=function(e){y[_-1](e,m),_++};m(e)}}function d(){q.transaction(function(e){c(e,function(){p(e)})},Pt(t),n)}function p(e){var t="SELECT sql FROM sqlite_master WHERE tbl_name = "+Go;e.executeSql(t,[],function(e,t){t.rows.length?/db_version/.test(t.rows.item(0).sql)?e.executeSql("SELECT db_version FROM "+Go,[],function(e,t){var n=t.rows.item(0).db_version;l(e,n)}):e.executeSql("ALTER TABLE "+Go+" ADD COLUMN db_version INTEGER",[],function(){l(e,1)}):l(e,0)})}function y(e,t){if(m._docCount!==-1)return t(m._docCount);var n=Bt("COUNT("+Jo+".id) AS 'num'",[Jo,Ko],oi,Ko+".deleted=0");e.executeSql(n,[],function(e,n){m._docCount=n.rows.item(0).num,t(m._docCount)})}var _,m=this,g=null,b=Ut(e),w=[];m._docCount=-1,m._name=e.name;var k=Br.extend({},e,{version:Yo,description:e.name,size:b}),S=Jt(k);if(S.error)return Pt(t)(S.error);var q=S.db;"function"!=typeof q.readTransaction&&(q.readTransaction=q.transaction),d(),m.type=function(){return"websql"},m._id=v(function(e){e(null,g)}),m._info=function(e){q.readTransaction(function(t){y(t,function(n){var r="SELECT MAX(seq) AS seq FROM "+Ko;t.executeSql(r,[],function(t,r){var o=r.rows.item(0).seq||0;e(null,{doc_count:n,update_seq:o,websql_encoding:_})})})},Pt(e))},m._bulkDocs=function(t,n,r){Mt(e,t,n,m,q,$o,r)},m._get=function(e,t,n){function r(){n(s,{doc:o,metadata:i,ctx:a})}var o,i,s,a=t.ctx;if(!a)return q.readTransaction(function(r){m._get(e,Br.extend({ctx:r},t),n)});var u,c;t.rev?(u=Bt(ii,[Jo,Ko],Jo+".id="+Ko+".doc_id",[Ko+".doc_id=?",Ko+".rev=?"]),c=[e,t.rev]):(u=Bt(ii,[Jo,Ko],oi,Jo+" Line: 45 -  t(e.complete),function(){e.continuous||e.complete(null,{results:s,last_seq:p})})}if(e=h(e),e.continuous){var n=m._name+":"+W();return $o.addListener(m._name,n,m,e),$o.notify(m._name),{cancel:function(){$o.removeListener(m._name,n)}}}var r=e.descending;e.since=e.since&&!r?e.since:0;var o="limit"in e?e.limit:-1;0===o&&(o=1);var i;i="return_docs"in e?e.return_docs:!("returnDocs"in e)||e.returnDocs;var s=[],a=0;t()},m._close=function(e){e()},m._getAttachment=function(e,t,n,r,o){var i,s=r.ctx,a=n.digest,u=n.content_type,c="SELECT escaped, CASE WHEN escaped = 1 THEN body ELSE HEX(body) END AS body FROM "+zo+" WHERE digest=?";s.executeSql(c,[a],function(e,t){var n=t.rows.item(0),s=n.escaped?It(n.body):jt(n.body,_);i=r.binary?Ne(s,u):To(s),o(null,i)})},m._getRevisionTree=function(e,t){q.readTransaction(function(n){var r="SELECT json AS metadata FROM "+Jo+" WHERE id = ?";n.executeSql(r,[e],function(e,n){if(n.rows.length){var r=ot(n.rows.item(0).metadata);t(null,r.rev_tree)}else t(j(eo))})})},m._doCompaction=function(e,t,n){return t.length?void q.transaction(function(n){var r="SELECT json AS metadata FROM "+Jo+" WHERE id = ?";n.executeSql(r,[e],function(n,r){var o=ot(r.rows.item(0).metadata);K(o.rev_tree,function(e,n,r,o,i){var s=n+"-"+r;t.indexOf(s)!==-1&&(i.status="missing")});var i="UPDATE "+Jo+" SET json = ? WHERE id = ?";n.executeSql(i,[it(o),e])}),Ft(t,e,n)},Pt(n),function(){n()}):n()},m._getLocal=function(e,t){q.readTransaction(function(n){var r="SELECT json, rev FROM "+Xo+" WHERE id=?";n.executeSql(r,[e],function(n,r){if(r.rows.length){var o=r.rows.item(0),i=Dt(o.json,e,o.rev);t(null,i)}else t(j(eo))})})},m._putLocal=function(e,t,n){function r(e){var r,c;i?(r="UPDATE "+Xo+" SET rev=?, json=? WHERE id=? AND rev=?",c=[o,u,s,i]):(r="INSERT INTO "+Xo+" (id, rev, json) VALUES (?,?,?)",c=[s,o,u]),e.executeSql(r,c,function(e,r){r.rowsAffected?(a={ok:!0,id:s,rev:o},t.ctx&&n(null,a)):n(j(to))},function(){return n(j(to)),!1})}"function"==typeof t&&(n=t,t={}),delete e._revisions;var o,i=e._rev,s=e._id;o=i?e._rev="0-"+(parseInt(i.split("-")[1],10)+1):e._rev="0-1";var a,u=Rt(e);t.ctx?r(t.ctx Line: 46 -  on(r,Pt(n),function(){a&&n(null,a)})},m._removeLocal=function(e,t,n){function r(r){var i="DELETE FROM "+Xo+" WHERE id=? AND rev=?",s=[e._id,e._rev];r.executeSql(i,s,function(r,i){return i.rowsAffected?(o={ok:!0,id:e._id,rev:"0-0"},void(t.ctx&&n(null,o))):n(j(eo))})}"function"==typeof t&&(n=t,t={});var o;t.ctx?r(t.ctx):q.transaction(r,Pt(n),function(){o&&n(null,o)})},m._destroy=function(e,t){$o.removeAllListeners(m._name),q.transaction(function(e){var t=[Jo,Ko,zo,Go,Xo,Vo];t.forEach(function(t){e.executeSql("DROP TABLE IF EXISTS "+t,[])})},Pt(t),function(){E()&&(delete window.localStorage["_pouch__websqldb_"+m._name],delete window.localStorage[m._name]),t(null,{ok:!0})})}}function Xt(){try{return openDatabase("_pouch_validate_websql",1,"",1),!0}catch(e){return!1}}function Gt(){if("undefined"==typeof indexedDB||null===indexedDB||!/iP(hone|od|ad)/.test(navigator.userAgent))return!0;var e=E(),t="_pouch__websqldb_valid_"+navigator.userAgent;if(e&&localStorage[t])return"1"===localStorage[t];var n=Xt();return e&&(localStorage[t]=n?"1":"0"),n}function Vt(){return"function"==typeof openDatabase&&Gt()}function Qt(e,t,n,r){return openDatabase(e,t,n,r)}function $t(e,t){var n=Br.extend({websql:Qt},e);zt.call(this,n,t)}function Yt(e){e.adapter("websql",$t,!0)}function Zt(){for(var e={},t=new Xr(function(t,n){e.resolve=t,e.reject=n}),n=new Array(arguments.length),r=0;r<n.length;r++)n[r]=arguments[r];return e.promise=t,Xr.resolve().then(function(){return fetch.apply(null,n)}).then(function(t){e.resolve(t)}).catch(function(t){e.reject(t)}),e}function en(e,t){var n,r,o,i=new Headers,s={method:e.method,credentials:"include",headers:i};return e.json&&(i.set("Accept","application/json"),i.set("Content-Type",e.headers["Content-Type"]||"application/json")),e.body&&e.body instanceof Blob?He(e.body,function(e){s.body=e}):e.body&&e.processData&&"string"!=typeof e.body?s.body=JSON.stringify(e.body):"body"in e?s.body=e.body:s.body=null,Object.keys(e.headers).forEach(function(t){e.headers.hasOwnProperty(t)&&i.set(t,e.headers[t])}),n=Zt(e.url,s),e.timeout>0&&(r=setTimeout(function(){n.reject(new Error("Loa Line: 50 -  ength,(u+1)*r)),b(i,c,n(u))}}var i=this,s=pn(u,""),a=fi[s];"boolean"!=typeof a?r(function(e,n){if(e){var r=Math.floor(e.status/100);4===r||5===r?(fi[s]=!1,T(e.status,"PouchDB is just detecting if the remote supports the _bulk_get API."),o()):t(e)}else fi[s]=!0,t(null,n)}):a?r(t):o()}),a._info=function(e){i().then(function(){n({},{method:"GET",url:hn(u,"")},function(t,n){return t?e(t):(n.host=hn(u,""),void e(null,n))})}).catch(e)},a.get=o("get",function(e,t,n){function o(e){function n(){if(!i.length)return null;var n=i.pop(),a=o[n],c=cn(e._id)+"/"+s(n)+"?rev="+e._rev;return r(t,{method:"GET",url:hn(u,c),binary:!0}).then(function(e){return t.binary?e:new Xr(function(t){Me(e,t)})}).then(function(e){delete a.stub,delete a.length,a.data=e})}var o=e._attachments,i=o&&Object.keys(o);if(o&&i.length)return new zr(n,5,{promise:Xr}).start()}function i(e){return Array.isArray(e)?Xr.all(e.map(function(e){if(e.ok)return o(e.ok)})):o(e)}"function"==typeof t&&(n=t,t={}),t=h(t);var a={};t.revs&&(a.revs=!0),t.revs_info&&(a.revs_info=!0),t.open_revs&&("all"!==t.open_revs&&(t.open_revs=JSON.stringify(t.open_revs)),a.open_revs=t.open_revs),t.rev&&(a.rev=t.rev),t.conflicts&&(a.conflicts=t.conflicts),e=cn(e);var c={method:"GET",url:hn(u,e+vn(a))};r(t,c).then(function(e){return Xr.resolve().then(function(){if(t.attachments)return i(e)}).then(function(){n(null,e)})}).catch(n)}),a.remove=o("remove",function(e,t,r,o){var i;"string"==typeof t?(i={_id:e,_rev:t},"function"==typeof r&&(o=r,r={})):(i=e,"function"==typeof t?(o=t,r={}):(o=r,r=t));var s=i._rev||r.rev;n(r,{method:"DELETE",url:hn(u,cn(i._id))+"?rev="+s},o)}),a.getAttachment=o("getAttachment",function(e,t,r,o){"function"==typeof r&&(o=r,r={});var i=r.rev?"?rev="+r.rev:"",a=hn(u,cn(e))+"/"+s(t)+i;n(r,{method:"GET",url:a,binary:!0},o)}),a.removeAttachment=o("removeAttachment",function(e,t,r,o){var i=hn(u,cn(e)+"/"+s(t))+"?rev="+r;n({},{method:"DELETE",url:i},o)}),a.putAttachment=o("putAttachment",function(e,t,r,o,i,a){"function"==typeof i&&(a=i,i=o,o=r,r=null);var c=cn(e)+"/"+s(t),l=hn(u,c);if(r&&(l+="?rev="+r),"string"==typeof o){var d;try{d=Ao(o)} Line: 52 -  "string"==typeof e.view&&(o.filter="_view",o.view=e.view),e.query_params&&"object"==typeof e.query_params)for(var c in e.query_params)e.query_params.hasOwnProperty(c)&&(o[c]=e.query_params[c]);var l,d="GET";e.doc_ids&&(o.filter="_doc_ids",d="POST",l={doc_ids:e.doc_ids});var p,v,y=function(r,c){if(!e.aborted){o.since=r,"object"==typeof o.since&&(o.since=JSON.stringify(o.since)),e.descending?s&&(o.limit=a):o.limit=!s||a>t?t:a;var f={method:d,url:hn(u,"_changes"+vn(o)),timeout:e.timeout,body:l};v=r,e.aborted||i().then(function(){p=n(e,f,c)}).catch(c)}},_={results:[]},m=function(n,o){if(!e.aborted){var i=0;if(o&&o.results){i=o.results.length,_.last_seq=o.last_seq;var u={};u.query=e.query_params,o.results=o.results.filter(function(t){a--;var n=I(e)(t);return n&&(e.include_docs&&e.attachments&&e.binary&&un(t),r&&_.results.push(t),e.onChange(t)),n})}else if(n)return e.aborted=!0,void e.complete(n);o&&o.last_seq&&(v=o.last_seq);var c=s&&a<=0||o&&i<t||e.descending;(!e.continuous||s&&a<=0)&&c?e.complete(null,_):setTimeout(function(){y(v,m)},0)}};return y(e.since||0,m),{cancel:function(){e.aborted=!0,p&&p.abort()}}},a.revsDiff=o("revsDiff",function(e,t,r){"function"==typeof t&&(r=t,t={}),n(t,{method:"POST",url:hn(u,"_revs_diff"),body:e},r)}),a._close=function(e){e()},a._destroy=function(e,t){n(e,{url:hn(u,""),method:"DELETE"},function(e,n){return e&&e.status&&404!==e.status?t(e):void t(null,n)})}}function _n(e){e.adapter("http",yn,!1),e.adapter("https",yn,!1)}function mn(e,t,n){for(var r="",o=n-e.length;r.length<o;)r+=t;return r}function gn(e,t,n){var r=mn(e,t,n);return r+e}function bn(e,t){if(e===t)return 0;e=wn(e),t=wn(t);var n=jn(e),r=jn(t);if(n-r!==0)return n-r;if(null===e)return 0;switch(typeof e){case"number":return e-t;case"boolean":return e===t?0:e<t?-1:1;case"string":return Tn(e,t)}return Array.isArray(e)?An(e,t):On(e,t)}function wn(e){switch(typeof e){case"undefined":return null;case"number":return e===1/0||e===-(1/0)||isNaN(e)?null:e;case"object":var t=e;if(Array.isArray(e)){var n=e.length;e=new Array(n);for(var r=0;r<n;r++)e[r]=wn(t[r])}else{if(e instanceof Date)return e.toJS Line: 67 -  d an unknown error"}),ao=new O({status:500,error:"badarg",reason:"Some query argument is invalid"}),uo=(new O({status:400,error:"invalid_request",reason:"Request was invalid"}),new O({status:400,error:"query_parse_error",reason:"Some query parameter is invalid"})),co=new O({status:500,error:"doc_validation",reason:"Bad special document member"}),fo=new O({status:400,error:"bad_request",reason:"Something wrong with the request"}),lo=new O({status:400,error:"bad_request",reason:"Document must be a JSON object"}),ho=(new O({status:404,error:"not_found",reason:"Database not found"}),new O({status:500,error:"indexed_db_went_bad",reason:"unknown"})),po=new O({status:500,error:"web_sql_went_bad",reason:"unknown"}),vo=(new O({status:500,error:"levelDB_went_went_bad",reason:"unknown"}),new O({status:403,error:"forbidden",reason:"Forbidden by design doc validate_doc_update function"}),new O({status:400,error:"bad_request",reason:"Invalid rev format"})),yo=(new O({status:412,error:"file_exists",reason:"The database could not be created, the file already exists."}),new O({status:412,error:"missing_stub"})),_o=(new O({status:413,error:"invalid_url",reason:"Provided URL is invalid"}),["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"]),mo="queryKey",go=/(?:^|&)([^&=]*)=?([^&]*)/g,bo=/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,wo="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz".split("");Pr(he,Mr.EventEmitter),he.prototype.cancel=function(){this.isCancelled=!0,this.db.taskqueue.isReady&&this.emit("cancel")},he.prototype.doChanges=function(e){var t=this,n=e.complete;if(e=h(e),"live"in e&&!("continuous"in e)&&(e.continuous=e.live),e.processChange=pe,"latest"===e.since&&(e.since="now"),e.since||(e.since=0),"now"===e.since)return void this.db.info().then(function(r){return t.isCancelled?void n(null,{status:"cancelled"}):(e.since=r.update_seq,void t.doCha</Result>
</report_mosca>

<report_mosca>
 <Path>/src/dist/pouchdb.localstorage.min.js</Path>
 <Module>/app/Mosca/eggs/javascript_common_fail.egg</Module>
 <Title> Possible code injection</Title>
 <Description> Command injection is an attack in which the goal is execution of arbitrary commands on the host operating system via a vulnerable application.</Description>
 <Level> High</Level>
 <Reference> https://www.securecoding.cert.org/confluence/pages/viewpage.action?pageId=2130132 </Reference>
 <Match> eval\s?\(|setTimeout|setInterval</Match>
 <Result> Line: 35 -  i="document"in e&&"onreadystatechange"in e.document.createElement("script")?function(){var t=e.document.createElement("script");t.onreadystatechange=function(){n(),t.onreadystatechange=null,t.parentNode.removeChild(t),t=null},e.document.documentElement.appendChild(t)}:function(){setTimeout(n,0)};else{var c=new e.MessageChannel;c.port1.onmessage=n,i=function(){c.port2.postMessage(0)}}var f,l=[];t.exports=r}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],31:[function(e,t,n){"function"==typeof Object.create?t.exports=function(e,t){e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}})}:t.exports=function(e,t){e.super_=t;var n=function(){};n.prototype=t.prototype,e.prototype=new n,e.prototype.constructor=e}},{}],32:[function(e,t,n){function r(e){return!!e.constructor&&"function"==typeof e.constructor.isBuffer&&e.constructor.isBuffer(e)}function i(e){return"function"==typeof e.readFloatLE&&"function"==typeof e.slice&&r(e.slice(0,0))}t.exports=function(e){return null!=e&&(r(e)||i(e)||!!e._isBuffer)}},{}],33:[function(e,t,n){var r={}.toString;t.exports=Array.isArray||function(e){return"[object Array]"==r.call(e)}},{}],34:[function(e,t,n){(function(e){e("object"==typeof n?n:this)}).call(this,function(e){var t=Array.prototype.slice,n=Array.prototype.forEach,r=function(e){if("object"!=typeof e)throw e+" is not an object";var i=t.call(arguments,1);return n.call(i,function(t){if(t)for(var n in t)"object"==typeof t[n]&&e[n]?r.call(e,e[n],t[n]):e[n]=t[n]}),e};e.extend=r})},{}],35:[function(e,t,n){function r(e){this.opts=e||{},this.encodings=i}var i=e(36);t.exports=r,r.prototype._encoding=function(e){return"string"==typeof e&&(e=i[e]),e||(e=i.id),e},r.prototype._keyEncoding=function(e,t){return this._encoding(t&&t.keyEncoding||e&&e.keyEncoding||this.opts.keyEncoding)},r.prototype._valueEncoding=function(e,t){return this._encoding(t&&(t.valueEncoding||t.encoding)||e&&(e.valueEncoding||e.encoding)||this.opts.valueEncoding||this.opts.encoding)},r.prototype.encodeKe Line: 50 -  (function(){t.call(null,n,r)});case 4:return e.nextTick(function(){t.call(null,n,r,i)});default:for(o=new Array(s-1),a=0;a<o.length;)o[a++]=arguments[a];return e.nextTick(function(){t.apply(null,o)})}}!e.version||0===e.version.indexOf("v0.")||0===e.version.indexOf("v1.")&&0!==e.version.indexOf("v1.8.")?t.exports=n:t.exports=e.nextTick}).call(this,e(57))},{57:57}],57:[function(e,t,n){function r(){throw new Error("setTimeout has not been defined")}function i(){throw new Error("clearTimeout has not been defined")}function o(e){if(l===setTimeout)return setTimeout(e,0);if((l===r||!l)&&setTimeout)return l=setTimeout,setTimeout(e,0);try{return l(e,0)}catch(t){try{return l.call(null,e,0)}catch(t){return l.call(this,e,0)}}}function a(e){if(h===clearTimeout)return clearTimeout(e);if((h===i||!h)&&clearTimeout)return h=clearTimeout,clearTimeout(e);try{return h(e)}catch(t){try{return h.call(null,e)}catch(t){return h.call(this,e)}}}function s(){y&&p&&(y=!1,p.length?g=p.concat(g):v=-1,g.length&&u())}function u(){if(!y){var e=o(s);y=!0;for(var t=g.length;t;){for(p=g,g=[];++v<t;)p&&p[v].run();v=-1,t=g.length}p=null,y=!1,a(e)}}function c(e,t){this.fun=e,this.array=t}function f(){}var l,h,d=t.exports={};!function(){try{l="function"==typeof setTimeout?setTimeout:r}catch(e){l=r}try{h="function"==typeof clearTimeout?clearTimeout:i}catch(e){h=i}}();var p,g=[],y=!1,v=-1;d.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];g.push(new c(e,t)),1!==g.length||y||o(u)},c.prototype.run=function(){this.fun.apply(null,this.array)},d.title="browser",d.browser=!0,d.env={},d.argv=[],d.version="",d.versions={},d.on=f,d.addListener=f,d.once=f,d.off=f,d.removeListener=f,d.removeAllListeners=f,d.emit=f,d.binding=function(e){throw new Error("process.binding is not supported")},d.cwd=function(){return"/"},d.chdir=function(e){throw new Error("process.chdir is not supported")},d.umask=function(){return 0}},{}],58:[function(e,t,n){arguments[4][24][0].apply(n,arguments)},{24:24}],59:[function(e,t,n){(function(n){function r(e){return this in Line: 102 -  on("complete",function(){"waiting"===a&&setTimeout(function(){i()},0),a=!1}).on("error",e)}}if(!this._listeners[t]){

 Line: 104 -  alidate_doc_update function"}),new R({status:400,error:"bad_request",reason:"Invalid rev format"})),_t=(new R({status:412,error:"file_exists",reason:"The database could not be created, the file already exists."}),new R({status:412,error:"missing_stub"})),wt=(new R({status:413,error:"invalid_url",reason:"Provided URL is invalid"}),T.name);ct=wt?function(e){return e.name}:function(e){return e.toString().match(/^\s*function\s*(\S*)\s*\(/)[1]};var Et=ct,kt="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz".split(""),St=I(["_id","_rev","_attachments","_deleted","_revisions","_revs_info","_conflicts","_deleted_conflicts","_local_seq","_rev_tree","_replication_id","_replication_state","_replication_state_time","_replication_state_reason","_replication_stats","_removed"]),xt=I(["_attachments","_replication_id","_replication_state","_replication_state_time","_replication_state_reason","_replication_stats"]),Bt=function(e){return atob(e)},Rt=function(e){return btoa(e)},At=n.setImmediate||n.setTimeout,jt=32768;Be.prototype.get=function(e,n,r){var i=xe(this,e),o=i.get(n);return o?t.nextTick(function(){r(null,o)}):null===o?t.nextTick(function(){r({name:"NotFoundError"})}):void e.get(n,function(e,t){return e?("NotFoundError"===e.name&&i.set(n,null),r(e)):(i.set(n,t),void r(null,t))})},Be.prototype.batch=function(e){for(var t=0,n=e.length;t<n;t++){var r=e[t],i=xe(this,r.prefix);"put"===r.type?i.set(r.key,r.value):i.set(r.key,null)}this._batch=this._batch.concat(e)},Be.prototype.execute=function(e,t){for(var n=new g,r=[],i=this._batch.length-1;i>=0;i--){var o=this._batch[i],a=o.prefix.prefix()[0]+"ÿ"+o.key;n.has(a)||(n.add(a),r.push(o))}e.batch(r,t)};var Ot="document-store",Tt="by-sequence",Mt="attach-store",Lt="attach-binary-store",Ct="local-store",It="meta-store",Dt=new p,qt="_local_last_update_seq",Nt="_local_doc_count",Pt="_local_uuid",Ut="md5-",Wt={encode:we,decode:_e,buffer:!1,type:"cheap-json"},Ft=new x;Me.valid=function(){return"undefined"!=typeof localStorage},Me.use_prefix=!0;var zt="undefined"!=typeof PouchDB?PouchDB:e("pouchdb");zt?Le(zt):B("error",'localstorage ad</Result>
</report_mosca>

<report_mosca>
 <Path>/src/dist/pouchdb.localstorage.min.js</Path>
 <Module>/app/Mosca/eggs/javascript_common_fail.egg</Module>
 <Title> Possible SQL injection</Title>
 <Description> notification possible SQL injection</Description>
 <Level> High</Level>
 <Reference> https://www.owasp.org/index.php/Testing_for_Stack_Overflow </Reference>
 <Match> query|YQL|WHERE|FROM|SELECT|UPDATE|DELETE|INSERT|UNION|getResults</Match>
 <Result> Line: 103 -  var o=this,a=!1;this._listeners[t]=i,this.on(e,i)}},x.prototype.removeListener=function(e,t){t in this._listeners&&(De.EventEmitter.prototype.removeListener.call(this,e,this._listeners[t]),delete this._listeners[t])},x.prototype.notifyLocalWindows=function(e){E()?chrome.storage.local.set({dbName:e}):k()&&(localStorage[e]="a"===localStorage[e]?"b":"a")},x.prototype.notify=function(e){this.emit(e),this.notifyLocalWindows(e)},Ne(R,Error),R.prototype.toString=function(){return JSON.stringify({status:this.status,name:this.name,message:this.message,reason:this.reason})};var ct,ft=(new R({status:401,error:"unauthorized",reason:"Name or password is incorrect."}),new R({status:400,error:"bad_request",reason:"Missing JSON list of 'docs'"}),new R({status:404,error:"not_found",reason:"missing"})),lt=new R({status:409,error:"conflict",reason:"Document update conflict"}),ht=new R({status:400,error:"bad_request",reason:"_id field must contain a string"}),dt=new R({status:412,error:"missing_id",reason:"_id is required for puts"}),pt=new R({status:400,error:"bad_request",reason:"Only reserved document ids may start with underscore."}),gt=new R({status:412,error:"precondition_failed",reason:"Database not open"}),yt=(new R({status:500,error:"unknown_error",reason:"Database encountered an unknown error"}),new R({status:500,error:"badarg",reason:"Some query argument is invalid"})),vt=(new R({status:400,error:"invalid_request",reason:"Request was invalid"}),new R({status:400,error:"query_parse_error",reason:"Some query parameter is invalid"}),new R({status:500,error:"doc_validation",reason:"Bad special document member"})),bt=new R({status:400,error:"bad_request",reason:"Something wrong with the request"}),mt=(new R({status:400,error:"bad_request",reason:"Document must be a JSON object"}),new R({status:404,error:"not_found",reason:"Database not found"}),new R({status:500,error:"indexed_db_went_bad",reason:"unknown"}),new R({status:500,error:"web_sql_went_bad",reason:"unknown"}),new R({status:500,error:"levelDB_went_went_bad",reason:"unknown"}),new R({status:403,error:"forbidden",reason:"Forbidden b</Result>
</report_mosca>

