<report_mosca>
 <Path>/src/server/markdown.js</Path>
 <Module>/app/Mosca/eggs/javascript_common_fail.egg</Module>
 <Title> Possible SQL injection</Title>
 <Description> notification possible SQL injection</Description>
 <Level> High</Level>
 <Reference> https://www.owasp.org/index.php/Testing_for_Stack_Overflow </Reference>
 <Match> query|YQL|WHERE|FROM|SELECT|UPDATE|DELETE|INSERT|UNION|getResults</Match>
 <Result> Line: 15 -      const query = ponse.getQuery(request);

</Result>
</report_mosca>

<report_mosca>
 <Path>/src/cloudcmd.js</Path>
 <Module>/app/Mosca/eggs/javascript_common_fail.egg</Module>
 <Title> Possible code injection</Title>
 <Description> Command injection is an attack in which the goal is execution of arbitrary commands on the host operating system via a vulnerable application.</Description>
 <Level> High</Level>
 <Reference> https://www.securecoding.cert.org/confluence/pages/viewpage.action?pageId=2130132 </Reference>
 <Match> eval\s?\(|setTimeout|setInterval</Match>
 <Result> Line: 63 -  SON) {\n    let path;\n    const regExp = new RegExp(FILES_HTML_ROOT);\n    const isRoot = regExp.test(name);\n    \n    if (isHTML) {\n        if (isRoot)\n            path = DIR_HTML + name.replace('-tmpl', '');\n        else\n            path = DIR_HTML_FS  + name;\n        \n        path += '.hbs';\n    } else if (isJSON) {\n        path = DIR_JSON  + name + '.json';\n    }\n    \n    return path;\n}\n\nfunction showError(name) {\n    const str = 'Wrong file name: ' + name;\n    const error = new Error(str);\n    \n    throw(error);\n}\n\nfunction getSystemFile(file, callback) {\n    const prefix = CloudCmd.PREFIX;\n    \n    if (!Promises[file])\n        Promises[file] = new Promise((success, error) => {\n            const url = prefix + file;\n            \n            load.ajax({\n                url,\n                success,\n                error\n            });\n        });\n    \n    Promises[file].then((data) => {\n        callback(null, data);\n    }, (error) => {\n        Promises[file] = null;\n        callback(error);\n    });\n}\n\nfunction getConfig(callback) {\n    let is;\n    \n    if (!Promises.config)\n        Promises.config = new Promise((resolve, reject) => {\n            is = true;\n            RESTful.Config.read((error, data) => {\n                if (error)\n                    return reject(error);\n                \n                resolve(data);\n            });\n        });\n    \n    Promises.config.then(function(data) {\n        is = false;\n        Storage.setAllowed(data.localStorage);\n        \n        callback(null, data);\n        \n        timeout(() => {\n            if (!is)\n                Promises.config = null;\n        });\n    }, function() {\n        if (!is)\n            Promises.config = null;\n    });\n}\n\nfunction getTimeoutOnce(time) {\n    let is;\n    \n    return (callback) => {\n        if (is)\n            return;\n        \n        is = true;\n        \n        setTimeout(() => {\n            is = false;\n            callback();\n        }, time);\n    };\n}\n\n\n\n//# sourceURL=file://cloudcmd/client/dom/files. Line: 146 -            });\n        },\n        \n        render  : function(data, callback) {\n            sendRequest({\n                method      : 'PUT',\n                url         : '/markdown',\n                data        : data,\n                callback    : callback,\n                imgPosition : { top: true },\n                notLog      : true\n            });\n        }\n    };\n    \n    function sendRequest(params) {\n        const p = params;\n        const prefixUrl = CloudCmd.PREFIX_URL;\n        \n        p.url = prefixUrl + p.url;\n        p.url = encodeURI(p.url);\n        \n        /*\n         * if we send ajax request -\n         * no need in hash so we escape #\n         */\n        p.url = p.url.replace('#', '%23');\n        \n        load.ajax({\n            method      : p.method,\n            url         : p.url,\n            data        : p.data,\n            dataType    : p.dataType,\n            error       : (jqXHR) => {\n                const response = jqXHR.responseText;\n                const statusText = jqXHR.statusText;\n                const status = jqXHR.status;\n                const text = status === 404 ? response : statusText;\n                \n                Images.show.error(text);\n                setTimeout(() => {\n                    DOM.Dialog.alert(CloudCmd.TITLE, text);\n                }, 100);\n                \n                p.callback(Error(text));\n            },\n            success: (data) => {\n                Images.hide();\n                \n                if (!p.notLog)\n                    CloudCmd.log(data);\n                \n                p.callback(null, data);\n            }\n        });\n    }\n}\n\n\n//# sourceURL=file://cloudcmd/client/dom/rest.js");

 Line: 270 -  eval("\n\nvar Emitify = __webpack_require__(/*! emitify/legacy */ \"./node_modules/emitify/legacy/index.js\");\n\nmodule.exports = function (entry) {\n    var emitter = Emitify();\n\n    setTimeout(function () {\n        FindIt(emitter, entry);\n    }, 0);\n\n    return emitter;\n};\n\nfunction FindIt(emitter, entry) {\n    if (!(this instanceof FindIt)) return new FindIt(emitter, entry);\n\n    this._dirs = 0;\n    this._first = true;\n\n    this._find(emitter, entry);\n}\n\nFindIt.prototype._find = function (emitter, entry) {\n    var _this = this;\n\n    if (entry.isFile) {\n        emitter.emit('file', entry.fullPath, entry);\n\n        if (this._first) emitter.emit('end');\n\n        return;\n    }\n\n    if (this._first) this._first = false;\n\n    emitter.emit('directory', entry.fullPath, entry);\n\n    ++this._dirs;\n\n    entry.createReader().readEntries(function (entries) {\n        [].forEach.call(entries, function (entry) {\n            _this._find(emitter, entry);\n        });\n\n        --_this._dirs;\n\n        if (!_this._dirs) emitter.emit('end');\n    });\n};\n\n//# sourceURL=file://cloudcmd/node_modules/domfs-findit/legacy/findit.js");

 Line: 572 -  ypeof t&&(t=t.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&")),t},t.exports.getRegExp=function(t){var e="^"+(t=t||"*").replace(".","\\.").replace("*",".*").replace("?",".?")+"$";return RegExp(e)},t.exports.exec=n,t.exports.getExt=function(t){if(!("string"==typeof t))return"";var e=t.lastIndexOf(".");return~e?t.substr(e):""},t.exports.findObjByNameInArr=function(t,e){var r=void 0;if(!Array.isArray(t))throw Error("array should be array!");if("string"!=typeof e)throw Error("name should be string!");return t.some(function(t){var n=t.name===e,o=Array.isArray(t);return n?(r=t,n):o?t.some(function(t){var n=t.name===e;return n&&(r=t.data),n}):n}),r},t.exports.time=function(t){n.ifExist(console,"time",[t])},t.exports.timeEnd=function(t){n.ifExist(console,"timeEnd",[t])}},function(t,e,r){"use strict";var n,o,i=r(4),a=r(2),u=r(0),s=r(17),c=r(3),l=r(10),f={},h="config|modules",d="file|path|link|pathLink|media",p="view/media-tmpl|config-tmpl|upload",v="/tmpl/",g=v+"fs/",m="/json/",y=(n=2e3,o=void 0,function(t){o||(o=!0,setTimeout(function(){o=!1,t()},n))}),b=a(function(t,e){var r=i(t),n=void 0;switch(function(t,e){if(!t)throw Error("name could not be empty!");if("function"!=typeof e)throw Error("callback should be a function")}(t,e),r){case"string":!function(t,e){var r=new RegExp(d+"|"+p),n=new RegExp(h),o=r.test(t),i=n.test(t);o||i?"config"===t?function(t){var e=void 0;f.config||(f.config=new Promise(function(t,r){e=!0,l.Config.read(function(e,n){if(e)return r(e);t(n)})}));f.config.then(function(r){e=!1,s.setAllowed(r.localStorage),t(null,r),y(function(){e||(f.config=null)})},function(){e||(f.config=null)})}(e):function(t,e){var r=CloudCmd.PREFIX;f[t]||(f[t]=new Promise(function(e,n){var o=r+t;c.ajax({url:o,success:e,error:n})}));f[t].then(function(t){e(null,t)},function(r){f[t]=null,e(r)})}(function(t,e,r){var n=void 0,o=new RegExp(p).test(t);e?(n=o?v+t.replace("-tmpl",""):g+t,n+=".hbs"):r&&(n=m+t+".json");return n}(t,o,i),e):function(t){throw new Error("Wrong file name: "+t)}(t)}(t,e);break;case"array":n=C(t,b),u.parallel(n,e)}}),C=function(t,e){return t.map(function(t){return e(t)})};t.exp Line: 579 -  ,e.element=r,e.ext=s.getExt(l),e.files=[].concat(o(i.children)),e.filesPassive=[].concat(o(c)),e.first=i.firstChild,e.getData=n.getCurrentData,e.last=i.lastChild,e.link=n.getCurrentLink(r),e.mode=n.getCurrentMode(r),e.name=l,e.path=n.getCurrentPath(r),e.panel=a,e.panelPassive=u,e.size=n.getCurrentSize(r),e.isDir=n.isCurrentIsDir(),e.isSelected=n.isSelected(r),e.panelPosition=n.getPanel().dataset.name.replace("js-",""),e.isOnePanel=e.panel.getAttribute("data-name")===e.panelPassive.getAttribute("data-name")}});t.exports=d;var p=r(1),v=r(3),g=r(7),m=r(10),y=r(17);d.Images=p,d.load=v,d.Files=g,d.RESTful=m,d.Storage=y,d.uploadDirectory=r(66),d.Buffer=r(20),d.Events=r(8);var b=r(60),C=r(59)},function(t,e,r){"use strict";var n=r(4),o=r(5).FS;t.exports=new function(){function t(t){var e=t,r=CloudCmd.PREFIX_URL;e.url=r+e.url,e.url=encodeURI(e.url),e.url=e.url.replace("#","%23"),a.ajax({method:e.method,url:e.url,data:e.data,dataType:e.dataType,error:function(t){var r=t.responseText,n=t.statusText,o=t.status,a=404===o?r:n;i.show.error(a),setTimeout(function(){DOM.Dialog.alert(CloudCmd.TITLE,a)},100),e.callback(Error(a))},success:function(t){i.hide(),e.notLog||CloudCmd.log(t),e.callback(null,t)}})}this.delete=function(e,r,i){var a=n.function(r);!i&&a&&(i=r,r=null),t({method:"DELETE",url:o+e,data:r,callback:i,imgPosition:{top:!!r}})},this.patch=function(e,r,i){var a=n.function(r);!i&&a&&(i=r,r=null);t({method:"PATCH",url:o+e,data:r,callback:i,imgPosition:{top:!0}})},this.write=function(e,r,i){var a=n.function(r);!i&&a&&(i=r,r=null),t({method:"PUT",url:o+e,data:r,callback:i,imgPosition:{top:!0}})},this.read=function(e,r,i){var a=/\?/.test(e),u=/\?beautify$/.test(e),s=/\?minify$/.test(e),c=!a||u||s,l=n.function(r);!i&&l&&(i=r,r="text"),t({method:"GET",url:o+e,callback:i,notLog:c,dataType:r})},this.cp=function(e,r){t({method:"PUT",url:"/cp",data:e,callback:r,imgPosition:{top:!0}})},this.pack=function(e,r){t({method:"PUT",url:"/pack",data:e,callback:r})},this.extract=function(e,r){t({method:"PUT",url:"/extract",data:e,callback:r})},this.mv=function(e,r){t({method:"PUT",url:"/mv",data:e,callb Line: 585 -  ype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}})}:t.exports=function(t,e){t.super_=e;var r=function(){};r.prototype=e.prototype,t.prototype=new r,t.prototype.constructor=t}},function(t,e,r){"use strict";t.exports=function(t,e,r){!function(t,e,r){if(!Array.isArray(t))throw Error("array should be an array!");if("function"!=typeof e)throw Error("iterator should be a function!");if("function"!=typeof r)throw Error("done should be a function!")}(t,e,r);var n=-1,o=t.length,i=function(a){if(++n,a||n===o)return r(a);e(t[n],i)};i()}},function(t,e,r){t.exports=r(62)},function(t,e,r){"use strict";var n=r(14);function o(t,e){if(!(this instanceof o))return new o(t,e);this._dirs=0,this._first=!0,this._find(t,e)}t.exports=function(t){var e=n();return setTimeout(function(){o(e,t)},0),e},o.prototype._find=function(t,e){var r=this;if(e.isFile)return t.emit("file",e.fullPath,e),void(this._first&&t.emit("end"));this._first&&(this._first=!1),t.emit("directory",e.fullPath,e),++this._dirs,e.createReader().readEntries(function(e){[].forEach.call(e,function(e){r._find(t,e)}),--r._dirs,r._dirs||t.emit("end")})}},function(t,e,r){"use strict";var n=r(64),o=r(14),i=r(63),a=r(61);function u(t,e){var r=this;if(!(this instanceof u))return new u(t,e);if("function"!=typeof e)throw Error("processingFn should be function!");o.call(this);var n=Array.isArray(t)?t:[t];this._i=0,this._n=0,this._processingFn=e,this._pause=!1,this._prev=0,this._find(n,function(t,e){r._files=t,r._dirs=e,r._n=t.length+e.length,r._data={},r._getFiles(t,r._data,function(){r._process()})})}t.exports=u,a(u,o),u.prototype._process=function(){var t=this,e=this._processingFn.length,r=void 0,n=this._dirs.shift(),o="directory";if(!n){o="file";var i=this._files.shift();i&&(n=i.fullPath,r=this._data[n])}if(!n)return this.emit("end");var a=void 0;if(!this._pause){switch(e){default:a=[o,n,r];break;case 6:a=[o,n,r,this._i,this._n]}a.push(function(e){++t._i,e&&(t.emit("error",e),t.pause()),t._process(),t._progress()}),this._processingFn.apply(this,function(t){if(Array.isArray(t)){for(var e=0,r=Array(t.length);e<t.length;e++)r[e] Line: 588 -  tion t(e){for(var r=arguments.length,n=Array(r>1?r-1:0),o=1;o<r;o++)n[o-1]=arguments[o];if(function(t){if("function"!=typeof t)throw Error("fn should be function!")}(e),n.length>=e.length)return e.apply(void 0,n);var i=function(){return t.apply(void 0,[e].concat(n,Array.prototype.slice.call(arguments)))},a=e.length-n.length-1;return function(t){return[function(e){return t.apply(void 0,arguments)},function(e,r){return t.apply(void 0,arguments)},function(e,r,n){return t.apply(void 0,arguments)},function(e,r,n,o){return t.apply(void 0,arguments)},function(e,r,n,o,i){return t.apply(void 0,arguments)}]}(i)[a]||i}},function(t,e){var r,n,o=t.exports={};function i(){throw new Error("setTimeout has not been defined")}function a(){throw new Error("clearTimeout has not been defined")}function u(t){if(r===setTimeout)return setTimeout(t,0);if((r===i||!r)&&setTimeout)return r=setTimeout,setTimeout(t,0);try{return r(t,0)}catch(e){try{return r.call(null,t,0)}catch(e){return r.call(this,t,0)}}}!function(){try{r="function"==typeof setTimeout?setTimeout:i}catch(t){r=i}try{n="function"==typeof clearTimeout?clearTimeout:a}catch(t){n=a}}();var s,c=[],l=!1,f=-1;function h(){l&&s&&(l=!1,s.length?c=s.concat(c):f=-1,c.length&&d())}function d(){if(!l){var t=u(h);l=!0;for(var e=c.length;e;){for(s=c,c=[];++f<e;)s&&s[f].run();f=-1,e=c.length}s=null,l=!1,function(t){if(n===clearTimeout)return clearTimeout(t);if((n===a||!n)&&clearTimeout)return n=clearTimeout,clearTimeout(t);try{n(t)}catch(e){try{return n.call(null,t)}catch(e){return n.call(this,t)}}}(t)}}function p(t,e){this.fun=t,this.array=e}function v(){}o.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var r=1;r<arguments.length;r++)e[r-1]=arguments[r];c.push(new p(t,e)),1!==c.length||l||u(d)},p.prototype.run=function(){this.fun.apply(null,this.array)},o.title="browser",o.browser=!0,o.env={},o.argv=[],o.version="",o.versions={},o.on=v,o.addListener=v,o.once=v,o.off=v,o.removeListener=v,o.removeAllListeners=v,o.emit=v,o.prependListener=v,o.prependOnceListener=v,o.listeners=function(t){return[]},o.binding=function(t){th Line: 589 -  "process.binding is not supported")},o.cwd=function(){return"/"},o.chdir=function(t){throw new Error("process.chdir is not supported")},o.umask=function(){return 0}},function(t,e,r){(function(e,r){var n;n=function(){"use strict";function t(t){return"function"==typeof t}var n=Array.isArray?Array.isArray:function(t){return"[object Array]"===Object.prototype.toString.call(t)},o=0,i=void 0,a=void 0,u=function(t,e){p[o]=t,p[o+1]=e,2===(o+=2)&&(a?a(v):C())};var s="undefined"!=typeof window?window:void 0,c=s||{},l=c.MutationObserver||c.WebKitMutationObserver,f="undefined"==typeof self&&void 0!==e&&"[object process]"==={}.toString.call(e),h="undefined"!=typeof Uint8ClampedArray&&"undefined"!=typeof importScripts&&"undefined"!=typeof MessageChannel;function d(){var t=setTimeout;return function(){return t(v,1)}}var p=new Array(1e3);function v(){for(var t=0;t<o;t+=2){(0,p[t])(p[t+1]),p[t]=void 0,p[t+1]=void 0}o=0}var g,m,y,b,C=void 0;function w(t,e){var r=this,n=new this.constructor(A);void 0===n[E]&&M(n);var o=r._state;if(o){var i=arguments[o-1];u(function(){return B(o,n,i,r._result)})}else I(r,n,t,e);return n}function x(t){if(t&&"object"==typeof t&&t.constructor===this)return t;var e=new this(A);return k(e,t),e}f?C=function(){return e.nextTick(v)}:l?(m=0,y=new l(v),b=document.createTextNode(""),y.observe(b,{characterData:!0}),C=function(){b.data=m=++m%2}):h?((g=new MessageChannel).port1.onmessage=v,C=function(){return g.port2.postMessage(0)}):C=void 0===s?function(){try{var t=Function("return this")().require("vertx");return void 0!==(i=t.runOnLoop||t.runOnContext)?function(){i(v)}:d()}catch(t){return d()}}():d();var E=Math.random().toString(36).substring(2);function A(){}var _=void 0,P=1,F=2,S={error:null};function D(t){try{return t.then}catch(t){return S.error=t,S}}function j(e,r,n){r.constructor===e.constructor&&n===w&&r.constructor.resolve===x?function(t,e){e._state===P?N(t,e._result):e._state===F?O(t,e._result):I(e,void 0,function(e){return k(t,e)},function(e){return O(t,e)})}(e,r):n===S?(O(e,S.error),S.error=null):void 0===n?N(e,r):t(n)?function(t,e,r){u(function(t){var n=!1,o=f Line: 597 -  =function(t){return"string"==typeof t&&(t=t.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&")),t},t.exports.getRegExp=function(t){var e="^"+(t=t||"*").replace(".","\\.").replace("*",".*").replace("?",".?")+"$";return RegExp(e)},t.exports.exec=n,t.exports.getExt=function(t){if(!("string"==typeof t))return"";var e=t.lastIndexOf(".");return~e?t.substr(e):""},t.exports.findObjByNameInArr=function(t,e){var r=void 0;if(!Array.isArray(t))throw Error("array should be array!");if("string"!=typeof e)throw Error("name should be string!");return t.some(function(t){var n=t.name===e,o=Array.isArray(t);return n?(r=t,n):o?t.some(function(t){var n=t.name===e;return n&&(r=t.data),n}):n}),r},t.exports.time=function(t){n.ifExist(console,"time",[t])},t.exports.timeEnd=function(t){n.ifExist(console,"timeEnd",[t])}},function(t,e,r){"use strict";var n,o,i=r(4),a=r(2),u=r(0),s=r(17),c=r(3),l=r(10),f={},h="config|modules",d="file|path|link|pathLink|media",p="view/media-tmpl|config-tmpl|upload",v="/tmpl/",g=v+"fs/",m="/json/",y=(n=2e3,o=void 0,function(t){o||(o=!0,setTimeout(function(){o=!1,t()},n))}),b=a(function(t,e){var r=i(t),n=void 0;switch(function(t,e){if(!t)throw Error("name could not be empty!");if("function"!=typeof e)throw Error("callback should be a function")}(t,e),r){case"string":!function(t,e){var r=new RegExp(d+"|"+p),n=new RegExp(h),o=r.test(t),i=n.test(t);o||i?"config"===t?function(t){var e=void 0;f.config||(f.config=new Promise(function(t,r){e=!0,l.Config.read(function(e,n){if(e)return r(e);t(n)})}));f.config.then(function(r){e=!1,s.setAllowed(r.localStorage),t(null,r),y(function(){e||(f.config=null)})},function(){e||(f.config=null)})}(e):function(t,e){var r=CloudCmd.PREFIX;f[t]||(f[t]=new Promise(function(e,n){var o=r+t;c.ajax({url:o,success:e,error:n})}));f[t].then(function(t){e(null,t)},function(r){f[t]=null,e(r)})}(function(t,e,r){var n=void 0,o=new RegExp(p).test(t);e?(n=o?v+t.replace("-tmpl",""):g+t,n+=".hbs"):r&&(n=m+t+".json");return n}(t,o,i),e):function(t){throw new Error("Wrong file name: "+t)}(t)}(t,e);break;case"array":n=C(t,b),u.parallel(n,e)}}),C=function(t,e){return t.map(fu Line: 604 -  ntDirPath=n.getParentDirPath(),e.element=r,e.ext=s.getExt(l),e.files=[].concat(o(i.children)),e.filesPassive=[].concat(o(c)),e.first=i.firstChild,e.getData=n.getCurrentData,e.last=i.lastChild,e.link=n.getCurrentLink(r),e.mode=n.getCurrentMode(r),e.name=l,e.path=n.getCurrentPath(r),e.panel=a,e.panelPassive=u,e.size=n.getCurrentSize(r),e.isDir=n.isCurrentIsDir(),e.isSelected=n.isSelected(r),e.panelPosition=n.getPanel().dataset.name.replace("js-",""),e.isOnePanel=e.panel.getAttribute("data-name")===e.panelPassive.getAttribute("data-name")}});t.exports=d;var p=r(1),v=r(3),g=r(7),m=r(10),y=r(17);d.Images=p,d.load=v,d.Files=g,d.RESTful=m,d.Storage=y,d.uploadDirectory=r(66),d.Buffer=r(20),d.Events=r(8);var b=r(60),C=r(59)},function(t,e,r){"use strict";var n=r(4),o=r(5).FS;t.exports=new function(){function t(t){var e=t,r=CloudCmd.PREFIX_URL;e.url=r+e.url,e.url=encodeURI(e.url),e.url=e.url.replace("#","%23"),a.ajax({method:e.method,url:e.url,data:e.data,dataType:e.dataType,error:function(t){var r=t.responseText,n=t.statusText,o=t.status,a=404===o?r:n;i.show.error(a),setTimeout(function(){DOM.Dialog.alert(CloudCmd.TITLE,a)},100),e.callback(Error(a))},success:function(t){i.hide(),e.notLog||CloudCmd.log(t),e.callback(null,t)}})}this.delete=function(e,r,i){var a=n.function(r);!i&&a&&(i=r,r=null),t({method:"DELETE",url:o+e,data:r,callback:i,imgPosition:{top:!!r}})},this.patch=function(e,r,i){var a=n.function(r);!i&&a&&(i=r,r=null);t({method:"PATCH",url:o+e,data:r,callback:i,imgPosition:{top:!0}})},this.write=function(e,r,i){var a=n.function(r);!i&&a&&(i=r,r=null),t({method:"PUT",url:o+e,data:r,callback:i,imgPosition:{top:!0}})},this.read=function(e,r,i){var a=/\?/.test(e),u=/\?beautify$/.test(e),s=/\?minify$/.test(e),c=!a||u||s,l=n.function(r);!i&&l&&(i=r,r="text"),t({method:"GET",url:o+e,callback:i,notLog:c,dataType:r})},this.cp=function(e,r){t({method:"PUT",url:"/cp",data:e,callback:r,imgPosition:{top:!0}})},this.pack=function(e,r){t({method:"PUT",url:"/pack",data:e,callback:r})},this.extract=function(e,r){t({method:"PUT",url:"/extract",data:e,callback:r})},this.mv=function(e,r){t({metho Line: 610 -  ototype=Object.create(e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}})}:t.exports=function(t,e){t.super_=e;var r=function(){};r.prototype=e.prototype,t.prototype=new r,t.prototype.constructor=t}},function(t,e,r){"use strict";t.exports=function(t,e,r){!function(t,e,r){if(!Array.isArray(t))throw Error("array should be an array!");if("function"!=typeof e)throw Error("iterator should be a function!");if("function"!=typeof r)throw Error("done should be a function!")}(t,e,r);var n=-1,o=t.length,i=function(a){if(++n,a||n===o)return r(a);e(t[n],i)};i()}},function(t,e,r){t.exports=r(62)},function(t,e,r){"use strict";var n=r(14);function o(t,e){if(!(this instanceof o))return new o(t,e);this._dirs=0,this._first=!0,this._find(t,e)}t.exports=function(t){var e=n();return setTimeout(function(){o(e,t)},0),e},o.prototype._find=function(t,e){var r=this;if(e.isFile)return t.emit("file",e.fullPath,e),void(this._first&&t.emit("end"));this._first&&(this._first=!1),t.emit("directory",e.fullPath,e),++this._dirs,e.createReader().readEntries(function(e){[].forEach.call(e,function(e){r._find(t,e)}),--r._dirs,r._dirs||t.emit("end")})}},function(t,e,r){"use strict";var n=r(64),o=r(14),i=r(63),a=r(61);function u(t,e){var r=this;if(!(this instanceof u))return new u(t,e);if("function"!=typeof e)throw Error("processingFn should be function!");o.call(this);var n=Array.isArray(t)?t:[t];this._i=0,this._n=0,this._processingFn=e,this._pause=!1,this._prev=0,this._find(n,function(t,e){r._files=t,r._dirs=e,r._n=t.length+e.length,r._data={},r._getFiles(t,r._data,function(){r._process()})})}t.exports=u,a(u,o),u.prototype._process=function(){var t=this,e=this._processingFn.length,r=void 0,n=this._dirs.shift(),o="directory";if(!n){o="file";var i=this._files.shift();i&&(n=i.fullPath,r=this._data[n])}if(!n)return this.emit("end");var a=void 0;if(!this._pause){switch(e){default:a=[o,n,r];break;case 6:a=[o,n,r,this._i,this._n]}a.push(function(e){++t._i,e&&(t.emit("error",e),t.pause()),t._process(),t._progress()}),this._processingFn.apply(this,function(t){if(Array.isArray(t)){for(var e=0,r=Array Line: 613 -  r){"use strict";t.exports=function t(e){for(var r=arguments.length,n=Array(r>1?r-1:0),o=1;o<r;o++)n[o-1]=arguments[o];if(function(t){if("function"!=typeof t)throw Error("fn should be function!")}(e),n.length>=e.length)return e.apply(void 0,n);var i=function(){return t.apply(void 0,[e].concat(n,Array.prototype.slice.call(arguments)))},a=e.length-n.length-1;return function(t){return[function(e){return t.apply(void 0,arguments)},function(e,r){return t.apply(void 0,arguments)},function(e,r,n){return t.apply(void 0,arguments)},function(e,r,n,o){return t.apply(void 0,arguments)},function(e,r,n,o,i){return t.apply(void 0,arguments)}]}(i)[a]||i}},function(t,e){var r,n,o=t.exports={};function i(){throw new Error("setTimeout has not been defined")}function a(){throw new Error("clearTimeout has not been defined")}function u(t){if(r===setTimeout)return setTimeout(t,0);if((r===i||!r)&&setTimeout)return r=setTimeout,setTimeout(t,0);try{return r(t,0)}catch(e){try{return r.call(null,t,0)}catch(e){return r.call(this,t,0)}}}!function(){try{r="function"==typeof setTimeout?setTimeout:i}catch(t){r=i}try{n="function"==typeof clearTimeout?clearTimeout:a}catch(t){n=a}}();var s,c=[],l=!1,f=-1;function h(){l&&s&&(l=!1,s.length?c=s.concat(c):f=-1,c.length&&d())}function d(){if(!l){var t=u(h);l=!0;for(var e=c.length;e;){for(s=c,c=[];++f<e;)s&&s[f].run();f=-1,e=c.length}s=null,l=!1,function(t){if(n===clearTimeout)return clearTimeout(t);if((n===a||!n)&&clearTimeout)return n=clearTimeout,clearTimeout(t);try{n(t)}catch(e){try{return n.call(null,t)}catch(e){return n.call(this,t)}}}(t)}}function p(t,e){this.fun=t,this.array=e}function v(){}o.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var r=1;r<arguments.length;r++)e[r-1]=arguments[r];c.push(new p(t,e)),1!==c.length||l||u(d)},p.prototype.run=function(){this.fun.apply(null,this.array)},o.title="browser",o.browser=!0,o.env={},o.argv=[],o.version="",o.versions={},o.on=v,o.addListener=v,o.once=v,o.off=v,o.removeListener=v,o.removeAllListeners=v,o.emit=v,o.prependListener=v,o.prependOnceListener=v,o.listeners=function(t){retu Line: 614 -  g=function(t){throw new Error("process.binding is not supported")},o.cwd=function(){return"/"},o.chdir=function(t){throw new Error("process.chdir is not supported")},o.umask=function(){return 0}},function(t,e,r){(function(e,r){var n;n=function(){"use strict";function t(t){return"function"==typeof t}var n=Array.isArray?Array.isArray:function(t){return"[object Array]"===Object.prototype.toString.call(t)},o=0,i=void 0,a=void 0,u=function(t,e){p[o]=t,p[o+1]=e,2===(o+=2)&&(a?a(v):C())};var s="undefined"!=typeof window?window:void 0,c=s||{},l=c.MutationObserver||c.WebKitMutationObserver,f="undefined"==typeof self&&void 0!==e&&"[object process]"==={}.toString.call(e),h="undefined"!=typeof Uint8ClampedArray&&"undefined"!=typeof importScripts&&"undefined"!=typeof MessageChannel;function d(){var t=setTimeout;return function(){return t(v,1)}}var p=new Array(1e3);function v(){for(var t=0;t<o;t+=2){(0,p[t])(p[t+1]),p[t]=void 0,p[t+1]=void 0}o=0}var g,m,y,b,C=void 0;function w(t,e){var r=this,n=new this.constructor(A);void 0===n[E]&&M(n);var o=r._state;if(o){var i=arguments[o-1];u(function(){return B(o,n,i,r._result)})}else I(r,n,t,e);return n}function x(t){if(t&&"object"==typeof t&&t.constructor===this)return t;var e=new this(A);return k(e,t),e}f?C=function(){return e.nextTick(v)}:l?(m=0,y=new l(v),b=document.createTextNode(""),y.observe(b,{characterData:!0}),C=function(){b.data=m=++m%2}):h?((g=new MessageChannel).port1.onmessage=v,C=function(){return g.port2.postMessage(0)}):C=void 0===s?function(){try{var t=Function("return this")().require("vertx");return void 0!==(i=t.runOnLoop||t.runOnContext)?function(){i(v)}:d()}catch(t){return d()}}():d();var E=Math.random().toString(36).substring(2);function A(){}var _=void 0,P=1,F=2,S={error:null};function D(t){try{return t.then}catch(t){return S.error=t,S}}function j(e,r,n){r.constructor===e.constructor&&n===w&&r.constructor.resolve===x?function(t,e){e._state===P?N(t,e._result):e._state===F?O(t,e._result):I(e,void 0,function(e){return k(t,e)},function(e){return O(t,e)})}(e,r):n===S?(O(e,S.error),S.error=null):void 0===n?N(e,r):t(n)?function(t,e</Result>
</report_mosca>

<report_mosca>
 <Path>/src/cloudcmd.js</Path>
 <Module>/app/Mosca/eggs/javascript_common_fail.egg</Module>
 <Title> Possible SQL injection</Title>
 <Description> notification possible SQL injection</Description>
 <Level> High</Level>
 <Reference> https://www.owasp.org/index.php/Testing_for_Stack_Overflow </Reference>
 <Match> query|YQL|WHERE|FROM|SELECT|UPDATE|DELETE|INSERT|UNION|getResults</Match>
 <Result> Line: 88 -  eval("/* global CloudCmd */\n\n\n\nconst itype = __webpack_require__(/*! itype/legacy */ \"./node_modules/itype/legacy/index.js\");\nconst exec = __webpack_require__(/*! execon */ \"./node_modules/execon/lib/exec.js\");\nconst jonny = __webpack_require__(/*! jonny/legacy */ \"./node_modules/jonny/legacy/index.js\");\nconst Util = __webpack_require__(/*! ../../common/util */ \"./common/util.js\");\n\nconst {\n    getTitle,\n    FS,\n    Entity,\n} = __webpack_require__(/*! ../../common/cloudfunc */ \"./common/cloudfunc.js\");\n\nconst DOMTree = __webpack_require__(/*! ./dom-tree */ \"./client/dom/dom-tree.js\");\n\nconst DOM = Object.assign({}, DOMTree, new CmdProto());\n\nmodule.exports = DOM;\n\nconst Images = __webpack_require__(/*! ./images */ \"./client/dom/images.js\");\nconst load = __webpack_require__(/*! ./load */ \"./client/dom/load.js\");\nconst Files = __webpack_require__(/*! ./files */ \"./client/dom/files.js\");\nconst RESTful = __webpack_require__(/*! ./rest */ \"./client/dom/rest.js\");\nconst Storage = __webpack_require__(/*! ./storage */ \"./client/dom/storage.js\");\n\nDOM.Images = Images;\nDOM.load = load;\nDOM.Files = Files;\nDOM.RESTful = RESTful;\nDOM.Storage = Storage;\n\nDOM.uploadDirectory = __webpack_require__(/*! ./directory */ \"./client/dom/directory.js\");\nDOM.Buffer = __webpack_require__(/*! ./buffer */ \"./client/dom/buffer.js\");\nDOM.Events = __webpack_require__(/*! ./events */ \"./client/dom/events.js\");\n\nconst loadRemote = __webpack_require__(/*! ./load-remote */ \"./client/dom/load-remote.js\");\nconst selectByPattern = __webpack_require__(/*! ./select-by-pattern */ \"./client/dom/select-by-pattern.js\");\n\nfunction CmdProto() {\n    let Title;\n    let CurrentInfo = {};\n    \n    const Cmd = this;\n    const CURRENT_FILE = 'current-file';\n    const SELECTED_FILE = 'selected-file';\n    const TITLE = 'Cloud Commander';\n    const TabPanel = {\n        'js-left'        : null,\n        'js-right'       : null\n    };\n    \n    this.loadRemote = (name, options, callback) => {\n        loadRemote(name, options, callback);\n        retu Line: 90 -  rent direcotory name\n     */\n    this.getCurrentDirName = () => {\n        const href = DOM.getCurrentDirPath()\n            .replace(/\\/$/, '');\n        \n        const substr  = href.substr(href, href.lastIndexOf('/'));\n        const ret     = href.replace(substr + '/', '') || '/';\n        \n        return ret;\n    };\n    \n    /**\n     * get current direcotory path\n     */\n    this.getCurrentDirPath = (panel = DOM.getPanel()) => {\n        const path =  DOM.getByDataName('js-path', panel);\n        const ret = path && path.textContent;\n        \n        return ret;\n    };\n    \n    /**\n     * get current direcotory path\n     */\n    this.getParentDirPath = (panel) => {\n        const path = DOM.getCurrentDirPath(panel);\n        const dirName = DOM.getCurrentDirName() + '/';\n        \n        if (path !== '/')\n            return path.replace(RegExp(dirName + '$'), '');\n        \n        return path;\n    };\n    \n    /**\n     * get not current direcotory path\n     */\n    this.getNotCurrentDirPath = () => {\n        const panel = DOM.getPanel({active: false});\n        const path = DOM.getCurrentDirPath(panel);\n        \n        return path;\n    };\n    \n    /**\n     * unified way to get current file\n     *\n     * @currentFile\n     */\n    this.getCurrentFile = () => {\n        return DOM.getByClass(CURRENT_FILE);\n    };\n    \n    /**\n     * get current file by name\n     */\n    this.getCurrentByName = (name, panel = CurrentInfo.panel) => {\n        const dataName = 'js-file-' + name;\n        const element = DOM.getByDataName(dataName, panel);\n        \n        return element;\n    };\n    \n    /**\n     * unified way to get current file\n     *\n     * @currentFile\n     */\n    this.getSelectedFiles = () => {\n        const panel = DOM.getPanel();\n        const selected = DOM.getByClassAll(SELECTED_FILE, panel);\n        \n        return [...selected];\n    };\n    \n    /*\n     * unselect all files\n     */\n    this.unselectFiles = (files) => {\n        files = files || DOM.getSelectedFiles();\n        \n        [...files].forEach(D Line: 91 -  ctedFile);\n    };\n    \n    /**\n     * get all selected files or current when none selected\n     *\n     * @currentFile\n     */\n    this.getActiveFiles = () => {\n        const current = DOM.getCurrentFile();\n        const files = DOM.getSelectedFiles();\n        const name = DOM.getCurrentName(current);\n        \n        if (!files.length && name !== '..')\n            return [current];\n        \n        return files;\n    };\n    \n    this.getCurrentDate = (currentFile) => {\n        const current = currentFile || Cmd.getCurrentFile();\n        const date = DOM\n            .getByDataName('js-date', current)\n            .textContent;\n        \n        return date;\n    };\n    \n    /**\n     * get size\n     * @currentFile\n     */\n    this.getCurrentSize = (currentFile) => {\n        const current = currentFile || Cmd.getCurrentFile();\n        /* если это папка - возвращаем слово dir вместо размера*/\n        const size = DOM.getByDataName('js-size', current)\n            .textContent\n            .replace(/^<|>$/g, '');\n        \n        return size;\n    };\n    \n    /**\n     * get size\n     * @currentFile\n     */\n    this.loadCurrentSize = (callback, currentFile) => {\n        const current = currentFile || DOM.getCurrentFile();\n        const query = '?size';\n        const link = DOM.getCurrentPath(current);\n        \n        Images.show.load();\n        \n        if (name === '..')\n            return;\n        \n        RESTful.read(link + query, (error, size) => {\n            if (error)\n                return;\n                \n            DOM.setCurrentSize(size, current);\n            exec(callback, current);\n            Images.hide();\n        });\n    };\n    \n    /**\n     * load hash\n     * @callback\n     * @currentFile\n     */\n    this.loadCurrentHash = (callback, currentFile) => {\n        const current = currentFile || DOM.getCurrentFile();\n        const query = '?hash';\n        const link = DOM.getCurrentPath(current);\n        \n        RESTful.read(link + query, callback);\n    };\n Line: 92 -  \n     * load current modification time of file\n     * @callback\n     * @currentFile\n     */\n    this.loadCurrentTime = (callback, currentFile) => {\n        const current = currentFile || DOM.getCurrentFile();\n        const query = '?time';\n        const link = DOM.getCurrentPath(current);\n        \n        RESTful.read(link + query, callback);\n    };\n    \n    /**\n     * set size\n     * @currentFile\n     */\n    this.setCurrentSize = (size, currentFile) => {\n        const current = currentFile || DOM.getCurrentFile();\n        const sizeElement = DOM.getByDataName('js-size', current);\n        \n        sizeElement.textContent = size;\n    };\n    \n    /**\n     * @currentFile\n     */\n    this.getCurrentMode = (currentFile) => {\n        const current = currentFile || DOM.getCurrentFile();\n        const mode = DOM.getByDataName('js-mode', current);\n        \n        return mode.textContent;\n    };\n    \n    /**\n     * @currentFile\n     */\n    this.getCurrentOwner = (currentFile) => {\n        const current = currentFile || DOM.getCurrentFile();\n        const owner = DOM.getByDataName('js-owner', current);\n        \n        return owner.textContent;\n    };\n    \n    /**\n     * unified way to get current file content\n     *\n     * @param callback\n     * @param currentFile\n     */\n    this.getCurrentData = (callback, currentFile) => {\n        let hash;\n        const Dialog = DOM.Dialog;\n        const Info = DOM.CurrentInfo;\n        const current = currentFile || DOM.getCurrentFile();\n        const path = DOM.getCurrentPath(current);\n        const isDir = DOM.isCurrentIsDir(current);\n        \n        const func = (error, data) => {\n            const ONE_MEGABYTE = 1024 * 1024 * 1024;\n            \n            if (!error) {\n                if (itype.object(data))\n                    data = jonny.stringify(data);\n                \n                const length  = data.length;\n                \n                if (hash && length < ONE_MEGABYTE)\n                    DOM.saveDataToStorage(path, data, hash);\n            }\n            \n  Line: 93 -  llback(error, data);\n        };\n        \n        if (Info.name === '..') {\n            Dialog.alert.noFiles(TITLE);\n            return callback(Error('No files selected!'));\n        }\n        \n        if (isDir)\n            return RESTful.read(path, func);\n        \n        DOM.checkStorageHash(path, (error, equal, hashNew) => {\n            if (error)\n                return callback(error);\n            \n            if (equal)\n                return DOM.getDataFromStorage(path, callback);\n            \n            hash = hashNew;\n            RESTful.read(path, func);\n        });\n    };\n    \n    /**\n     * unified way to save current file content\n     *\n     * @callback - function({data, name}) {}\n     * @currentFile\n     */\n    this.saveCurrentData = (url, data, callback, query = '') => {\n        DOM.RESTful.write(url + query, data, (error) => {\n            !error && DOM.saveDataToStorage(url, data);\n        });\n    };\n    \n    /**\n     * unified way to get RefreshButton\n     */\n    this.getRefreshButton = (panel) => {\n        const currentPanel = panel || DOM.getPanel();\n        const refresh = DOM.getByDataName('js-refresh', currentPanel);\n        \n        return refresh;\n    };\n    \n    this.setCurrentByName = (name) => {\n        const current = DOM.getCurrentByName(name);\n        return DOM.setCurrentFile(current);\n    };\n    \n    /**\n     * private function thet unset currentfile\n     *\n     * @currentFile\n     */\n    function unsetCurrentFile(currentFile) {\n        const is = DOM.isCurrentFile(currentFile);\n        \n        if (!is)\n            return;\n        \n        currentFile.classList.remove(CURRENT_FILE);\n    }\n    \n    /**\n     * unified way to set current file\n     */\n    this.setCurrentFile = (currentFile, options) => {\n        const o = options;\n        const CENTER = true;\n        const currentFileWas = DOM.getCurrentFile();\n        \n        if (!currentFile)\n            return DOM;\n        \n        let pathWas = '';\n        \n        if (currentFileWas) {\n            pathWas = DOM.getC Line: 94 -  ();\n            unsetCurrentFile(currentFileWas);\n        }\n        \n        currentFile.classList.add(CURRENT_FILE);\n        \n        let path = DOM.getCurrentDirPath();\n        \n        const name = CloudCmd.config('name');\n        if (path !== pathWas) {\n            DOM.setTitle(getTitle({\n                name,\n                path,\n            }));\n            \n            /* history could be present\n             * but it should be false\n             * to prevent default behavior\n             */\n            if (!o || o.history !== false) {\n                if (path !== '/')\n                    path = FS + path;\n                \n                DOM.setHistory(path, null, path);\n            }\n        }\n        \n        /* scrolling to current file */\n        DOM.scrollIntoViewIfNeeded(currentFile, CENTER);\n        \n        Cmd.updateCurrentInfo(currentFile);\n        \n        return DOM;\n    };\n    \n    /*\n      * set current file by position\n      *\n      * @param layer    - element\n      * @param          - position {x, y}\n      */\n    this.getCurrentByPosition = ({x, y}) => {\n        const element = document.elementFromPoint(x, y);\n        \n        const getEl = (el) => {\n            const {tagName} = el;\n            const isChild = /A|SPAN|LI/.test(tagName);\n            \n            if (!isChild)\n                return null;\n            \n            if (tagName === 'A')\n                return el.parentElement.parentElement;\n            \n            if (tagName === 'SPAN')\n                return el.parentElement;\n            \n            return el;\n        };\n        \n        const el = getEl(element);\n        \n        if (el && el.tagName !== 'LI')\n            return null;\n        \n        return el;\n    };\n    \n    /**\n     * select current file\n     * @param currentFile\n     */\n    this.selectFile = (currentFile) => {\n        const current = currentFile || DOM.getCurrentFile();\n        \n        current.classList.add(SELECTED_FILE);\n        \n        return Cmd;\n    };\n    \n    this.unselectFil Line: 95 -  ile) => {\n        const current = currentFile || DOM.getCurrentFile();\n        \n        current.classList.remove(SELECTED_FILE);\n        \n        return Cmd;\n    };\n    \n    this.toggleSelectedFile = (currentFile) => {\n        const current = currentFile || DOM.getCurrentFile();\n        const name = DOM.getCurrentName(current);\n        \n        if (name === '..')\n            return Cmd;\n        \n        current.classList.toggle(SELECTED_FILE);\n        \n        return Cmd;\n    };\n    \n    this.toggleAllSelectedFiles = () => {\n        DOM.getAllFiles().map(DOM.toggleSelectedFile);\n        \n        return Cmd;\n    };\n    \n    this.selectAllFiles = () => {\n        DOM.getAllFiles().map(DOM.selectFile);\n        \n        return Cmd;\n    };\n    \n    this.getAllFiles = () => {\n        const panel = DOM.getPanel();\n        const files = DOM.getFiles(panel);\n        const name = DOM.getCurrentName(files[0]);\n        \n        const from = (a) => a === '..' ? 1 : 0;\n        const i = from(name);\n        \n        return [...files].slice(i);\n    };\n    \n    /**\n     * open dialog with expand selection\n     */\n    this.expandSelection = () => {\n        const msg = 'expand';\n        const files = CurrentInfo.files;\n        \n        selectByPattern(msg, files);\n    };\n    \n    /**\n     * open dialog with shrink selection\n     */\n    this.shrinkSelection = () => {\n        const msg = 'shrink';\n        const files = CurrentInfo.files;\n       \n        selectByPattern(msg, files);\n    };\n    \n    /**\n     * setting history wrapper\n     */\n    this.setHistory = (data, title, url) => {\n        const ret = window.history;\n        \n        url = CloudCmd.PREFIX + url;\n        \n        if (ret)\n            history.pushState(data, title, url);\n        \n        return ret;\n    };\n    \n    /**\n     * set title or create title element\n     *\n     * @param name\n     */\n    \n    this.setTitle = (name) => {\n        if (!Title)\n            Title = DOM.getByTag('title')[0] ||\n                    DOM.load({\n                    Line: 96 -          : 'title',\n                        innerHTML       : name,\n                        parentElement   : document.head\n                    });\n        \n        Title.textContent = name;\n        \n        return DOM;\n    };\n    \n    /**\n     * current file check\n     *\n     * @param currentFile\n     */\n    this.isCurrentFile = (currentFile) => {\n        if (!currentFile)\n            return false;\n        \n        return DOM.isContainClass(currentFile, CURRENT_FILE);\n    };\n    \n    /**\n     * selected file check\n     *\n     * @param currentFile\n     */\n    this.isSelected = (selected) => {\n        if (!selected)\n            return false;\n        \n        return DOM.isContainClass(selected, SELECTED_FILE);\n    };\n    \n    /**\n     * check is current file is a directory\n     *\n     * @param currentFile\n     */\n    this.isCurrentIsDir = (currentFile) => {\n        const current = currentFile || this.getCurrentFile();\n        const fileType = DOM.getByDataName('js-type', current);\n        const ret = DOM.isContainClass(fileType, 'directory');\n        \n        return ret;\n    };\n    \n    /**\n     * get link from current (or param) file\n     *\n     * @param currentFile - current file by default\n     */\n    this.getCurrentLink = (currentFile) => {\n        const current = currentFile || this.getCurrentFile();\n        const link = DOM.getByTag('a', current);\n        \n        return link[0];\n    };\n    \n    /**\n     * get link from current (or param) file\n     *\n     * @param currentFile - current file by default\n     */\n    this.getCurrentPath = (currentFile) => {\n        const current = currentFile || DOM.getCurrentFile();\n        const element = DOM.getByTag('a', current)[0];\n        const prefix = CloudCmd.PREFIX;\n        const path = element.getAttribute('href')\n            .replace(RegExp('^' + prefix + FS), '');\n        \n        return path;\n    };\n    \n    /**\n     * get name from current (or param) file\n     *\n     * @param currentFile\n     */\n    this.getCurrentName = (currentFile) => {\n        co Line: 144 -  eval("\n\n/* global CloudCmd, DOM */\n\nconst itype = __webpack_require__(/*! itype/legacy */ \"./node_modules/itype/legacy/index.js\");\n\nconst {FS} = __webpack_require__(/*! ../../common/cloudfunc */ \"./common/cloudfunc.js\");\n\nmodule.exports = new RESTful();\n\nconst Images = __webpack_require__(/*! ./images */ \"./client/dom/images.js\");\nconst load = __webpack_require__(/*! ./load */ \"./client/dom/load.js\");\n\nfunction RESTful() {\n    this.delete = (url, data, callback) => {\n        const isFunc = itype.function(data);\n        \n        if (!callback && isFunc) {\n            callback = data;\n            data = null;\n        }\n        \n        sendRequest({\n            method      : 'DELETE',\n            url         : FS + url,\n            data,\n            callback,\n            imgPosition : { top: !!data }\n        });\n    };\n    \n    this.patch = (url, data, callback) => {\n        const isFunc = itype.function(data);\n        \n        if (!callback && isFunc) {\n            callback = data;\n            data = null;\n        }\n        \n        const imgPosition = {\n            top: true\n        };\n        \n        sendRequest({\n            method: 'PATCH',\n            url: FS + url,\n            data,\n            callback,\n            imgPosition,\n        });\n    };\n    \n    this.write = (url, data, callback) => {\n        const isFunc = itype.function(data);\n        \n        if (!callback && isFunc) {\n            callback    = data;\n            data        = null;\n        }\n        \n        sendRequest({\n            method: 'PUT',\n            url: FS + url,\n            data,\n            callback,\n            imgPosition : { top: true }\n        });\n    };\n    \n    this.read = (url, dataType, callback) => {\n        const isQuery = /\\?/.test(url);\n        const isBeautify = /\\?beautify$/.test(url);\n        const isMinify = /\\?minify$/.test(url);\n        const notLog = !isQuery || isBeautify || isMinify;\n        const isFunc = itype.function(dataType);\n        \n        if (!callback && isFunc) {\n           Line: 579 -  ,e.element=r,e.ext=s.getExt(l),e.files=[].concat(o(i.children)),e.filesPassive=[].concat(o(c)),e.first=i.firstChild,e.getData=n.getCurrentData,e.last=i.lastChild,e.link=n.getCurrentLink(r),e.mode=n.getCurrentMode(r),e.name=l,e.path=n.getCurrentPath(r),e.panel=a,e.panelPassive=u,e.size=n.getCurrentSize(r),e.isDir=n.isCurrentIsDir(),e.isSelected=n.isSelected(r),e.panelPosition=n.getPanel().dataset.name.replace("js-",""),e.isOnePanel=e.panel.getAttribute("data-name")===e.panelPassive.getAttribute("data-name")}});t.exports=d;var p=r(1),v=r(3),g=r(7),m=r(10),y=r(17);d.Images=p,d.load=v,d.Files=g,d.RESTful=m,d.Storage=y,d.uploadDirectory=r(66),d.Buffer=r(20),d.Events=r(8);var b=r(60),C=r(59)},function(t,e,r){"use strict";var n=r(4),o=r(5).FS;t.exports=new function(){function t(t){var e=t,r=CloudCmd.PREFIX_URL;e.url=r+e.url,e.url=encodeURI(e.url),e.url=e.url.replace("#","%23"),a.ajax({method:e.method,url:e.url,data:e.data,dataType:e.dataType,error:function(t){var r=t.responseText,n=t.statusText,o=t.status,a=404===o?r:n;i.show.error(a),setTimeout(function(){DOM.Dialog.alert(CloudCmd.TITLE,a)},100),e.callback(Error(a))},success:function(t){i.hide(),e.notLog||CloudCmd.log(t),e.callback(null,t)}})}this.delete=function(e,r,i){var a=n.function(r);!i&&a&&(i=r,r=null),t({method:"DELETE",url:o+e,data:r,callback:i,imgPosition:{top:!!r}})},this.patch=function(e,r,i){var a=n.function(r);!i&&a&&(i=r,r=null);t({method:"PATCH",url:o+e,data:r,callback:i,imgPosition:{top:!0}})},this.write=function(e,r,i){var a=n.function(r);!i&&a&&(i=r,r=null),t({method:"PUT",url:o+e,data:r,callback:i,imgPosition:{top:!0}})},this.read=function(e,r,i){var a=/\?/.test(e),u=/\?beautify$/.test(e),s=/\?minify$/.test(e),c=!a||u||s,l=n.function(r);!i&&l&&(i=r,r="text"),t({method:"GET",url:o+e,callback:i,notLog:c,dataType:r})},this.cp=function(e,r){t({method:"PUT",url:"/cp",data:e,callback:r,imgPosition:{top:!0}})},this.pack=function(e,r){t({method:"PUT",url:"/pack",data:e,callback:r})},this.extract=function(e,r){t({method:"PUT",url:"/extract",data:e,callback:r})},this.mv=function(e,r){t({method:"PUT",url:"/mv",data:e,callb Line: 604 -  ntDirPath=n.getParentDirPath(),e.element=r,e.ext=s.getExt(l),e.files=[].concat(o(i.children)),e.filesPassive=[].concat(o(c)),e.first=i.firstChild,e.getData=n.getCurrentData,e.last=i.lastChild,e.link=n.getCurrentLink(r),e.mode=n.getCurrentMode(r),e.name=l,e.path=n.getCurrentPath(r),e.panel=a,e.panelPassive=u,e.size=n.getCurrentSize(r),e.isDir=n.isCurrentIsDir(),e.isSelected=n.isSelected(r),e.panelPosition=n.getPanel().dataset.name.replace("js-",""),e.isOnePanel=e.panel.getAttribute("data-name")===e.panelPassive.getAttribute("data-name")}});t.exports=d;var p=r(1),v=r(3),g=r(7),m=r(10),y=r(17);d.Images=p,d.load=v,d.Files=g,d.RESTful=m,d.Storage=y,d.uploadDirectory=r(66),d.Buffer=r(20),d.Events=r(8);var b=r(60),C=r(59)},function(t,e,r){"use strict";var n=r(4),o=r(5).FS;t.exports=new function(){function t(t){var e=t,r=CloudCmd.PREFIX_URL;e.url=r+e.url,e.url=encodeURI(e.url),e.url=e.url.replace("#","%23"),a.ajax({method:e.method,url:e.url,data:e.data,dataType:e.dataType,error:function(t){var r=t.responseText,n=t.statusText,o=t.status,a=404===o?r:n;i.show.error(a),setTimeout(function(){DOM.Dialog.alert(CloudCmd.TITLE,a)},100),e.callback(Error(a))},success:function(t){i.hide(),e.notLog||CloudCmd.log(t),e.callback(null,t)}})}this.delete=function(e,r,i){var a=n.function(r);!i&&a&&(i=r,r=null),t({method:"DELETE",url:o+e,data:r,callback:i,imgPosition:{top:!!r}})},this.patch=function(e,r,i){var a=n.function(r);!i&&a&&(i=r,r=null);t({method:"PATCH",url:o+e,data:r,callback:i,imgPosition:{top:!0}})},this.write=function(e,r,i){var a=n.function(r);!i&&a&&(i=r,r=null),t({method:"PUT",url:o+e,data:r,callback:i,imgPosition:{top:!0}})},this.read=function(e,r,i){var a=/\?/.test(e),u=/\?beautify$/.test(e),s=/\?minify$/.test(e),c=!a||u||s,l=n.function(r);!i&&l&&(i=r,r="text"),t({method:"GET",url:o+e,callback:i,notLog:c,dataType:r})},this.cp=function(e,r){t({method:"PUT",url:"/cp",data:e,callback:r,imgPosition:{top:!0}})},this.pack=function(e,r){t({method:"PUT",url:"/pack",data:e,callback:r})},this.extract=function(e,r){t({method:"PUT",url:"/extract",data:e,callback:r})},this.mv=function(e,r){t({metho</Result>
</report_mosca>

<report_mosca>
 <Path>/src/modules/jquery/dist/jquery.slim.min.js</Path>
 <Module>/app/Mosca/eggs/javascript_common_fail.egg</Module>
 <Title> Possible code injection</Title>
 <Description> Command injection is an attack in which the goal is execution of arbitrary commands on the host operating system via a vulnerable application.</Description>
 <Level> High</Level>
 <Reference> https://www.securecoding.cert.org/confluence/pages/viewpage.action?pageId=2130132 </Reference>
 <Match> eval\s?\(|setTimeout|setInterval</Match>
 <Result> Line: 15 -  n,M,i),a(o,n,B,n.notifyWith))):(r!==B&&(u=void 0,s=[e]),(i||n.resolveWith)(u,s))}},c=i?l:function(){try{l()}catch(e){w.Deferred.exceptionHook&&w.Deferred.exceptionHook(e,c.stackTrace),t+1>=o&&(r!==M&&(u=void 0,s=[e]),n.rejectWith(u,s))}};t?c():(w.Deferred.getStackHook&&(c.stackTrace=w.Deferred.getStackHook()),e.setTimeout(c))}}return w.Deferred(function(e){n[0][3].add(a(0,e,g(i)?i:B,e.notifyWith)),n[1][3].add(a(0,e,g(t)?t:B)),n[2][3].add(a(0,e,g(r)?r:M))}).promise()},promise:function(e){return null!=e?w.extend(e,i):i}},o={};return w.each(n,function(e,t){var a=t[2],u=t[5];i[t[1]]=a.add,u&&a.add(function(){r=u},n[3-e][2].disable,n[3-e][3].disable,n[0][2].lock,n[0][3].lock),a.add(t[3].fire),o[t[0]]=function(){return o[t[0]+"With"](this===o?void 0:this,arguments),this},o[t[0]+"With"]=a.fireWith}),i.promise(o),t&&t.call(o,o),o},when:function(e){var t=arguments.length,n=t,r=Array(n),i=o.call(arguments),a=w.Deferred(),u=function(e){return function(n){r[e]=this,i[e]=arguments.length>1?o.call(arguments):n,--t||a.resolveWith(r,i)}};if(t<=1&&(W(e,a.done(u(n)).resolve,a.reject,!t),"pending"===a.state()||g(i[n]&&i[n].then)))return a.then();while(n--)W(i[n],u(n),a.reject);return a.promise()}});var $=/^(Eval|Internal|Range|Reference|Syntax|Type|URI)Error$/;w.Deferred.exceptionHook=function(t,n){e.console&&e.console.warn&&t&&$.test(t.name)&&e.console.warn("jQuery.Deferred exception: "+t.message,t.stack,n)},w.readyException=function(t){e.setTimeout(function(){throw t})};var F=w.Deferred();w.fn.ready=function(e){return F.then(e)["catch"](function(e){w.readyException(e)}),this},w.extend({isReady:!1,readyWait:1,ready:function(e){(!0===e?--w.readyWait:w.isReady)||(w.isReady=!0,!0!==e&&--w.readyWait>0||F.resolveWith(r,[w]))}}),w.ready.then=F.then;function z(){r.removeEventListener("DOMContentLoaded",z),e.removeEventListener("load",z),w.ready()}"complete"===r.readyState||"loading"!==r.readyState&&!r.documentElement.doScroll?e.setTimeout(w.ready):(r.addEventListener("DOMContentLoaded",z),e.addEventListener("load",z));var _=function(e,t,n,r,i,o,a){var u=0,s=e.length,l=null==n;if("object"===b(n)){i=!0; Line: 27 -  [0];return i}},"margin"!==e&&(w.cssHooks[e+t].set=Je)}),w.fn.extend({css:function(e,t){return _(this,function(e,t,n){var r,i,o={},a=0;if(Array.isArray(t)){for(r=We(e),i=t.length;a<i;a++)o[t[a]]=w.css(e,t[a],!1,r);return o}return void 0!==n?w.style(e,t,n):w.css(e,t)},e,t,arguments.length>1)}}),w.fn.delay=function(t,n){return t=w.fx?w.fx.speeds[t]||t:t,n=n||"fx",this.queue(n,function(n,r){var i=e.setTimeout(n,t);r.stop=function(){e.clearTimeout(i)}})},function(){var e=r.createElement("input"),t=r.createElement("select").appendChild(r.createElement("option"));e.type="checkbox",h.checkOn=""!==e.value,h.optSelected=t.selected,(e=r.createElement("input")).value="t",e.type="radio",h.radioValue="t"===e.value}();var tt,nt=w.expr.attrHandle;w.fn.extend({attr:function(e,t){return _(this,w.attr,e,t,arguments.length>1)},removeAttr:function(e){return this.each(function(){w.removeAttr(this,e)})}}),w.extend({attr:function(e,t,n){var r,i,o=e.nodeType;if(3!==o&&8!==o&&2!==o)return"undefined"==typeof e.getAttribute?w.prop(e,t,n):(1===o&&w.isXMLDoc(e)||(i=w.attrHooks[t.toLowerCase()]||(w.expr.match.bool.test(t)?tt:void 0)),void 0!==n?null===n?void w.removeAttr(e,t):i&&"set"in i&&void 0!==(r=i.set(e,n,t))?r:(e.setAttribute(t,n+""),n):i&&"get"in i&&null!==(r=i.get(e,t))?r:null==(r=w.find.attr(e,t))?void 0:r)},attrHooks:{type:{set:function(e,t){if(!h.radioValue&&"radio"===t&&D(e,"input")){var n=e.value;return e.setAttribute("type",t),n&&(e.value=n),t}}}},removeAttr:function(e,t){var n,r=0,i=t&&t.match(I);if(i&&1===e.nodeType)while(n=i[r++])e.removeAttribute(n)}}),tt={set:function(e,t,n){return!1===t?w.removeAttr(e,n):e.setAttribute(n,n),n}},w.each(w.expr.match.bool.source.match(/\w+/g),function(e,t){var n=nt[t]||w.find.attr;nt[t]=function(e,t,r){var i,o,a=t.toLowerCase();return r||(o=nt[a],nt[a]=i,i=null!=n(e,t,r)?a:null,nt[a]=o),i}});var rt=/^(?:input|select|textarea|button)$/i,it=/^(?:a|area)$/i;w.fn.extend({prop:function(e,t){return _(this,w.prop,e,t,arguments.length>1)},removeProp:function(e){return this.each(function(){delete this[w.propFix[e]||e]})}}),w.extend({prop:function(e,t,n){var r,i,o=e</Result>
</report_mosca>

<report_mosca>
 <Path>/src/modules/jquery/dist/jquery.slim.js</Path>
 <Module>/app/Mosca/eggs/javascript_common_fail.egg</Module>
 <Title> Possible code injection</Title>
 <Description> Command injection is an attack in which the goal is execution of arbitrary commands on the host operating system via a vulnerable application.</Description>
 <Level> High</Level>
 <Reference> https://www.securecoding.cert.org/confluence/pages/viewpage.action?pageId=2130132 </Reference>
 <Match> eval\s?\(|setTimeout|setInterval</Match>
 <Result> Line: 3639 -  								window.setTimeout( process );

 Line: 3825 -  	window.setTimeout( function() {

 Line: 3898 -  	window.setTimeout( jQuery.ready );

 Line: 6688 -  		var timeout = window.setTimeout( next, time );

</Result>
</report_mosca>

<report_mosca>
 <Path>/src/modules/jquery/dist/jquery.slim.js</Path>
 <Module>/app/Mosca/eggs/javascript_common_fail.egg</Module>
 <Title> Possible SQL injection</Title>
 <Description> notification possible SQL injection</Description>
 <Level> High</Level>
 <Reference> https://www.owasp.org/index.php/Testing_for_Stack_Overflow </Reference>
 <Match> query|YQL|WHERE|FROM|SELECT|UPDATE|DELETE|INSERT|UNION|getResults</Match>
 <Result> Line: 791 -  			// Take advantage of querySelectorAll

 Line: 6454 -  		// want to query the value if it is a CSS custom property

 Line: 7633 -  // key/values into a query string

</Result>
</report_mosca>

<report_mosca>
 <Path>/src/modules/jquery/dist/jquery.js</Path>
 <Module>/app/Mosca/eggs/javascript_common_fail.egg</Module>
 <Title> Possible code injection</Title>
 <Description> Command injection is an attack in which the goal is execution of arbitrary commands on the host operating system via a vulnerable application.</Description>
 <Level> High</Level>
 <Reference> https://www.securecoding.cert.org/confluence/pages/viewpage.action?pageId=2130132 </Reference>
 <Match> eval\s?\(|setTimeout|setInterval</Match>
 <Result> Line: 3639 -  								window.setTimeout( process );

 Line: 3825 -  	window.setTimeout( function() {

 Line: 3898 -  	window.setTimeout( jQuery.ready );

 Line: 6809 -  			window.setTimeout( schedule, jQuery.fx.interval );

 Line: 6818 -  	window.setTimeout( function() {

 Line: 7481 -  		var timeout = window.setTimeout( next, time );

 Line: 9198 -  				timeoutTimer = window.setTimeout( function() {

 Line: 9584 -  							window.setTimeout( function() {

</Result>
</report_mosca>

<report_mosca>
 <Path>/src/modules/jquery/dist/jquery.js</Path>
 <Module>/app/Mosca/eggs/javascript_common_fail.egg</Module>
 <Title> Possible SQL injection</Title>
 <Description> notification possible SQL injection</Description>
 <Level> High</Level>
 <Reference> https://www.owasp.org/index.php/Testing_for_Stack_Overflow </Reference>
 <Match> query|YQL|WHERE|FROM|SELECT|UPDATE|DELETE|INSERT|UNION|getResults</Match>
 <Result> Line: 791 -  			// Take advantage of querySelectorAll

 Line: 6454 -  		// want to query the value if it is a CSS custom property

 Line: 8454 -  // key/values into a query string

</Result>
</report_mosca>

<report_mosca>
 <Path>/src/modules/jquery/dist/jquery.min.js</Path>
 <Module>/app/Mosca/eggs/javascript_common_fail.egg</Module>
 <Title> Possible code injection</Title>
 <Description> Command injection is an attack in which the goal is execution of arbitrary commands on the host operating system via a vulnerable application.</Description>
 <Level> High</Level>
 <Reference> https://www.securecoding.cert.org/confluence/pages/viewpage.action?pageId=2130132 </Reference>
 <Match> eval\s?\(|setTimeout|setInterval</Match>
 <Result> Line: 15 -  (r!==W&&(s=void 0,u=[e]),n.rejectWith(s,u))}};t?c():(w.Deferred.getStackHook&&(c.stackTrace=w.Deferred.getStackHook()),e.setTimeout(c))}}return w.Deferred(function(e){n[0][3].add(a(0,e,g(i)?i:I,e.notifyWith)),n[1][3].add(a(0,e,g(t)?t:I)),n[2][3].add(a(0,e,g(r)?r:W))}).promise()},promise:function(e){return null!=e?w.extend(e,i):i}},o={};return w.each(n,function(e,t){var a=t[2],s=t[5];i[t[1]]=a.add,s&&a.add(function(){r=s},n[3-e][2].disable,n[3-e][3].disable,n[0][2].lock,n[0][3].lock),a.add(t[3].fire),o[t[0]]=function(){return o[t[0]+"With"](this===o?void 0:this,arguments),this},o[t[0]+"With"]=a.fireWith}),i.promise(o),t&&t.call(o,o),o},when:function(e){var t=arguments.length,n=t,r=Array(n),i=o.call(arguments),a=w.Deferred(),s=function(e){return function(n){r[e]=this,i[e]=arguments.length>1?o.call(arguments):n,--t||a.resolveWith(r,i)}};if(t<=1&&($(e,a.done(s(n)).resolve,a.reject,!t),"pending"===a.state()||g(i[n]&&i[n].then)))return a.then();while(n--)$(i[n],s(n),a.reject);return a.promise()}});var B=/^(Eval|Internal|Range|Reference|Syntax|Type|URI)Error$/;w.Deferred.exceptionHook=function(t,n){e.console&&e.console.warn&&t&&B.test(t.name)&&e.console.warn("jQuery.Deferred exception: "+t.message,t.stack,n)},w.readyException=function(t){e.setTimeout(function(){throw t})};var F=w.Deferred();w.fn.ready=function(e){return F.then(e)["catch"](function(e){w.readyException(e)}),this},w.extend({isReady:!1,readyWait:1,ready:function(e){(!0===e?--w.readyWait:w.isReady)||(w.isReady=!0,!0!==e&&--w.readyWait>0||F.resolveWith(r,[w]))}}),w.ready.then=F.then;function _(){r.removeEventListener("DOMContentLoaded",_),e.removeEventListener("load",_),w.ready()}"complete"===r.readyState||"loading"!==r.readyState&&!r.documentElement.doScroll?e.setTimeout(w.ready):(r.addEventListener("DOMContentLoaded",_),e.addEventListener("load",_));var z=function(e,t,n,r,i,o,a){var s=0,u=e.length,l=null==n;if("object"===x(n)){i=!0;for(s in n)z(e,t,s,n[s],!0,o,a)}else if(void 0!==r&&(i=!0,g(r)||(a=!0),l&&(a?(t.call(e,r),t=null):(l=t,t=function(e,t,n){return l.call(w(e),n)})),t))for(;s<u;s++)t(e[s],n,a?r:r.call(e[s],s,t(e Line: 27 -  ]=w.css(e,t[a],!1,r);return o}return void 0!==n?w.style(e,t,n):w.css(e,t)},e,t,arguments.length>1)}});function tt(e,t,n,r,i){return new tt.prototype.init(e,t,n,r,i)}w.Tween=tt,tt.prototype={constructor:tt,init:function(e,t,n,r,i,o){this.elem=e,this.prop=n,this.easing=i||w.easing._default,this.options=t,this.start=this.now=this.cur(),this.end=r,this.unit=o||(w.cssNumber[n]?"":"px")},cur:function(){var e=tt.propHooks[this.prop];return e&&e.get?e.get(this):tt.propHooks._default.get(this)},run:function(e){var t,n=tt.propHooks[this.prop];return this.options.duration?this.pos=t=w.easing[this.easing](e,this.options.duration*e,0,1,this.options.duration):this.pos=t=e,this.now=(this.end-this.start)*t+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),n&&n.set?n.set(this):tt.propHooks._default.set(this),this}},tt.prototype.init.prototype=tt.prototype,tt.propHooks={_default:{get:function(e){var t;return 1!==e.elem.nodeType||null!=e.elem[e.prop]&&null==e.elem.style[e.prop]?e.elem[e.prop]:(t=w.css(e.elem,e.prop,""))&&"auto"!==t?t:0},set:function(e){w.fx.step[e.prop]?w.fx.step[e.prop](e):1!==e.elem.nodeType||null==e.elem.style[w.cssProps[e.prop]]&&!w.cssHooks[e.prop]?e.elem[e.prop]=e.now:w.style(e.elem,e.prop,e.now+e.unit)}}},tt.propHooks.scrollTop=tt.propHooks.scrollLeft={set:function(e){e.elem.nodeType&&e.elem.parentNode&&(e.elem[e.prop]=e.now)}},w.easing={linear:function(e){return e},swing:function(e){return.5-Math.cos(e*Math.PI)/2},_default:"swing"},w.fx=tt.prototype.init,w.fx.step={};var nt,rt,it=/^(?:toggle|show|hide)$/,ot=/queueHooks$/;function at(){rt&&(!1===r.hidden&&e.requestAnimationFrame?e.requestAnimationFrame(at):e.setTimeout(at,w.fx.interval),w.fx.tick())}function st(){return e.setTimeout(function(){nt=void 0}),nt=Date.now()}function ut(e,t){var n,r=0,i={height:e};for(t=t?1:0;r<4;r+=2-t)i["margin"+(n=oe[r])]=i["padding"+n]=e;return t&&(i.opacity=i.width=e),i}function lt(e,t,n){for(var r,i=(pt.tweeners[t]||[]).concat(pt.tweeners["*"]),o=0,a=i.length;o<a;o++)if(r=i[o].call(n,t,e))return r}function ct(e,t,n){var r,i,o,a,s,u,l,c,f="width"in t||"height"in Line: 30 -  ;i--;)o[i].elem!==this||null!=e&&o[i].queue!==e||(o[i].anim.stop(n),t=!1,o.splice(i,1));!t&&n||w.dequeue(this,e)})},finish:function(e){return!1!==e&&(e=e||"fx"),this.each(function(){var t,n=J.get(this),r=n[e+"queue"],i=n[e+"queueHooks"],o=w.timers,a=r?r.length:0;for(n.finish=!0,w.queue(this,e,[]),i&&i.stop&&i.stop.call(this,!0),t=o.length;t--;)o[t].elem===this&&o[t].queue===e&&(o[t].anim.stop(!0),o.splice(t,1));for(t=0;t<a;t++)r[t]&&r[t].finish&&r[t].finish.call(this);delete n.finish})}}),w.each(["toggle","show","hide"],function(e,t){var n=w.fn[t];w.fn[t]=function(e,r,i){return null==e||"boolean"==typeof e?n.apply(this,arguments):this.animate(ut(t,!0),e,r,i)}}),w.each({slideDown:ut("show"),slideUp:ut("hide"),slideToggle:ut("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(e,t){w.fn[e]=function(e,n,r){return this.animate(t,e,n,r)}}),w.timers=[],w.fx.tick=function(){var e,t=0,n=w.timers;for(nt=Date.now();t<n.length;t++)(e=n[t])()||n[t]!==e||n.splice(t--,1);n.length||w.fx.stop(),nt=void 0},w.fx.timer=function(e){w.timers.push(e),w.fx.start()},w.fx.interval=13,w.fx.start=function(){rt||(rt=!0,at())},w.fx.stop=function(){rt=null},w.fx.speeds={slow:600,fast:200,_default:400},w.fn.delay=function(t,n){return t=w.fx?w.fx.speeds[t]||t:t,n=n||"fx",this.queue(n,function(n,r){var i=e.setTimeout(n,t);r.stop=function(){e.clearTimeout(i)}})},function(){var e=r.createElement("input"),t=r.createElement("select").appendChild(r.createElement("option"));e.type="checkbox",h.checkOn=""!==e.value,h.optSelected=t.selected,(e=r.createElement("input")).value="t",e.type="radio",h.radioValue="t"===e.value}();var dt,ht=w.expr.attrHandle;w.fn.extend({attr:function(e,t){return z(this,w.attr,e,t,arguments.length>1)},removeAttr:function(e){return this.each(function(){w.removeAttr(this,e)})}}),w.extend({attr:function(e,t,n){var r,i,o=e.nodeType;if(3!==o&&8!==o&&2!==o)return"undefined"==typeof e.getAttribute?w.prop(e,t,n):(1===o&&w.isXMLDoc(e)||(i=w.attrHooks[t.toLowerCase()]||(w.expr.match.bool.test(t)?dt:void 0)),void 0!==n?null===n?void w.removeAttr(e,t):i&&"se Line: 37 -  e||n.contentType)&&E.setRequestHeader("Content-Type",h.contentType),E.setRequestHeader("Accept",h.dataTypes[0]&&h.accepts[h.dataTypes[0]]?h.accepts[h.dataTypes[0]]+("*"!==h.dataTypes[0]?", "+$t+"; q=0.01":""):h.accepts["*"]);for(p in h.headers)E.setRequestHeader(p,h.headers[p]);if(h.beforeSend&&(!1===h.beforeSend.call(g,E,h)||c))return E.abort();if(C="abort",m.add(h.complete),E.done(h.success),E.fail(h.error),i=_t(Wt,h,n,E)){if(E.readyState=1,f&&y.trigger("ajaxSend",[E,h]),c)return E;h.async&&h.timeout>0&&(u=e.setTimeout(function(){E.abort("timeout")},h.timeout));try{c=!1,i.send(b,k)}catch(e){if(c)throw e;k(-1,e)}}else k(-1,"No Transport");function k(t,n,r,s){var l,p,d,b,T,C=n;c||(c=!0,u&&e.clearTimeout(u),i=void 0,a=s||"",E.readyState=t>0?4:0,l=t>=200&&t<300||304===t,r&&(b=Xt(h,E,r)),b=Ut(h,b,E,l),l?(h.ifModified&&((T=E.getResponseHeader("Last-Modified"))&&(w.lastModified[o]=T),(T=E.getResponseHeader("etag"))&&(w.etag[o]=T)),204===t||"HEAD"===h.type?C="nocontent":304===t?C="notmodified":(C=b.state,p=b.data,l=!(d=b.error))):(d=C,!t&&C||(C="error",t<0&&(t=0))),E.status=t,E.statusText=(n||C)+"",l?v.resolveWith(g,[p,C,E]):v.rejectWith(g,[E,C,d]),E.statusCode(x),x=void 0,f&&y.trigger(l?"ajaxSuccess":"ajaxError",[E,h,l?p:d]),m.fireWith(g,[E,C]),f&&(y.trigger("ajaxComplete",[E,h]),--w.active||w.event.trigger("ajaxStop")))}return E},getJSON:function(e,t,n){return w.get(e,t,n,"json")},getScript:function(e,t){return w.get(e,void 0,t,"script")}}),w.each(["get","post"],function(e,t){w[t]=function(e,n,r,i){return g(n)&&(i=i||r,r=n,n=void 0),w.ajax(w.extend({url:e,type:t,dataType:i,data:n,success:r},w.isPlainObject(e)&&e))}}),w._evalUrl=function(e){return w.ajax({url:e,type:"GET",dataType:"script",cache:!0,async:!1,global:!1,"throws":!0})},w.fn.extend({wrapAll:function(e){var t;return this[0]&&(g(e)&&(e=e.call(this[0])),t=w(e,this[0].ownerDocument).eq(0).clone(!0),this[0].parentNode&&t.insertBefore(this[0]),t.map(function(){var e=this;while(e.firstElementChild)e=e.firstElementChild;return e}).append(this)),this},wrapInner:function(e){return g(e)?this.each(function(t){w(this).wrapInner(e.ca Line: 38 -  :this.each(function(){var t=w(this),n=t.contents();n.length?n.wrapAll(e):t.append(e)})},wrap:function(e){var t=g(e);return this.each(function(n){w(this).wrapAll(t?e.call(this,n):e)})},unwrap:function(e){return this.parent(e).not("body").each(function(){w(this).replaceWith(this.childNodes)}),this}}),w.expr.pseudos.hidden=function(e){return!w.expr.pseudos.visible(e)},w.expr.pseudos.visible=function(e){return!!(e.offsetWidth||e.offsetHeight||e.getClientRects().length)},w.ajaxSettings.xhr=function(){try{return new e.XMLHttpRequest}catch(e){}};var Vt={0:200,1223:204},Gt=w.ajaxSettings.xhr();h.cors=!!Gt&&"withCredentials"in Gt,h.ajax=Gt=!!Gt,w.ajaxTransport(function(t){var n,r;if(h.cors||Gt&&!t.crossDomain)return{send:function(i,o){var a,s=t.xhr();if(s.open(t.type,t.url,t.async,t.username,t.password),t.xhrFields)for(a in t.xhrFields)s[a]=t.xhrFields[a];t.mimeType&&s.overrideMimeType&&s.overrideMimeType(t.mimeType),t.crossDomain||i["X-Requested-With"]||(i["X-Requested-With"]="XMLHttpRequest");for(a in i)s.setRequestHeader(a,i[a]);n=function(e){return function(){n&&(n=r=s.onload=s.onerror=s.onabort=s.ontimeout=s.onreadystatechange=null,"abort"===e?s.abort():"error"===e?"number"!=typeof s.status?o(0,"error"):o(s.status,s.statusText):o(Vt[s.status]||s.status,s.statusText,"text"!==(s.responseType||"text")||"string"!=typeof s.responseText?{binary:s.response}:{text:s.responseText},s.getAllResponseHeaders()))}},s.onload=n(),r=s.onerror=s.ontimeout=n("error"),void 0!==s.onabort?s.onabort=r:s.onreadystatechange=function(){4===s.readyState&&e.setTimeout(function(){n&&r()})},n=n("abort");try{s.send(t.hasContent&&t.data||null)}catch(e){if(n)throw e}},abort:function(){n&&n()}}}),w.ajaxPrefilter(function(e){e.crossDomain&&(e.contents.script=!1)}),w.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/\b(?:java|ecma)script\b/},converters:{"text script":function(e){return w.globalEval(e),e}}}),w.ajaxPrefilter("script",function(e){void 0===e.cache&&(e.cache=!1),e.crossDomain&&(e.type="GET")}),w.ajaxTransport("script"</Result>
</report_mosca>

<report_mosca>
 <Path>/src/modules/smalltalk/dist/smalltalk.poly.min.js</Path>
 <Module>/app/Mosca/eggs/javascript_common_fail.egg</Module>
 <Title> Possible code injection</Title>
 <Description> Command injection is an attack in which the goal is execution of arbitrary commands on the host operating system via a vulnerable application.</Description>
 <Level> High</Level>
 <Reference> https://www.securecoding.cert.org/confluence/pages/viewpage.action?pageId=2130132 </Reference>
 <Match> eval\s?\(|setTimeout|setInterval</Match>
 <Result> Line: 0 -  var smalltalk=function(t){function n(r){if(e[r])return e[r].exports;var o=e[r]={i:r,l:!1,exports:{}};return t[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}var e={};return n.m=t,n.c=e,n.d=function(t,e,r){n.o(t,e)||Object.defineProperty(t,e,{configurable:!1,enumerable:!0,get:r})},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,n){return Object.prototype.hasOwnProperty.call(t,n)},n.p="",n(n.s=4)}([function(t,n,e){(function(n,r){!function(n,e){t.exports=e()}(0,function(){"use strict";function t(t){var n=typeof t;return null!==t&&("object"===n||"function"===n)}function o(t){return"function"==typeof t}function i(t){G=t}function u(t){I=t}function c(){return void 0!==W?function(){W(a)}:s()}function s(){var t=setTimeout;return function(){return t(a,1)}}function a(){for(var t=0;t<H;t+=2){(0,Z[t])(Z[t+1]),Z[t]=void 0,Z[t+1]=void 0}H=0}function f(t,n){var e=arguments,r=this,o=new this.constructor(h);void 0===o[tt]&&P(o);var i=r._state;return i?function(){var t=e[i-1];I(function(){return S(i,o,t,r._result)})}():A(r,o,t,n),o}function l(t){var n=this;if(t&&"object"==typeof t&&t.constructor===n)return t;var e=new n(h);return w(e,t),e}function h(){}function p(){return new TypeError("You cannot resolve a promise with itself")}function v(){return new TypeError("A promises callback cannot return that same promise.")}function d(t){try{return t.then}catch(t){return ot.error=t,ot}}function m(t,n,e,r){try{t.call(n,e,r)}catch(t){return t}}function y(t,n,e){I(function(t){var r=!1,o=m(e,n,function(e){r||(r=!0,n!==e?w(t,e):E(t,e))},function(n){r||(r=!0,T(t,n))},"Settle: "+(t._label||" unknown promise"));!r&&o&&(r=!0,T(t,o))},t)}function g(t,n){n._state===et?E(t,n._result):n._state===rt?T(t,n._result):A(n,void 0,function(n){return w(t,n)},function(n){return T(t,n)})}function _(t,n,e){n.constructor===t.constructor&&e===f&&n.constructor.resolve===l?g(t,n):e===ot?(T(t,ot.error),ot.error=null):void 0===e?E(t,n):o(e)?y(t,n,e):E(t,n)}function w(n,e){n===e?T(n,p()):t(e)?_(n,e,d(e)):E(n,e)}function b(t){t._onerror&&t._onerror(t._res Line: 3 -  turn e._settledAt(rt,n,t)})},q.all=N,q.race=D,q.resolve=l,q.reject=F,q._setScheduler=i,q._setAsap=u,q._asap=I,q.prototype={constructor:q,then:f,catch:function(t){return this.then(null,t)}},q.polyfill=U,q.Promise=q,q})}).call(n,e(1),e(2))},function(t,n){function e(){throw new Error("setTimeout has not been defined")}function r(){throw new Error("clearTimeout has not been defined")}function o(t){if(f===setTimeout)return setTimeout(t,0);if((f===e||!f)&&setTimeout)return f=setTimeout,setTimeout(t,0);try{return f(t,0)}catch(n){try{return f.call(null,t,0)}catch(n){return f.call(this,t,0)}}}function i(t){if(l===clearTimeout)return clearTimeout(t);if((l===r||!l)&&clearTimeout)return l=clearTimeout,clearTimeout(t);try{return l(t)}catch(n){try{return l.call(null,t)}catch(n){return l.call(this,t)}}}function u(){d&&p&&(d=!1,p.length?v=p.concat(v):m=-1,v.length&&c())}function c(){if(!d){var t=o(u);d=!0;for(var n=v.length;n;){for(p=v,v=[];++m<n;)p&&p[m].run();m=-1,n=v.length}p=null,d=!1,i(t)}}function s(t,n){this.fun=t,this.array=n}function a(){}var f,l,h=t.exports={};!function(){try{f="function"==typeof setTimeout?setTimeout:e}catch(t){f=e}try{l="function"==typeof clearTimeout?clearTimeout:r}catch(t){l=r}}();var p,v=[],d=!1,m=-1;h.nextTick=function(t){var n=new Array(arguments.length-1);if(arguments.length>1)for(var e=1;e<arguments.length;e++)n[e-1]=arguments[e];v.push(new s(t,n)),1!==v.length||d||o(c)},s.prototype.run=function(){this.fun.apply(null,this.array)},h.title="browser",h.browser=!0,h.env={},h.argv=[],h.version="",h.versions={},h.on=a,h.addListener=a,h.once=a,h.off=a,h.removeListener=a,h.removeAllListeners=a,h.emit=a,h.prependListener=a,h.prependOnceListener=a,h.listeners=function(t){return[]},h.binding=function(t){throw new Error("process.binding is not supported")},h.cwd=function(){return"/"},h.chdir=function(t){throw new Error("process.chdir is not supported")},h.umask=function(){return 0}},function(t,n){var e;e=function(){return this}();try{e=e||Function("return this")()||(0,eval)("this")}catch(t){"object"==typeof window&&(e=window)}t.exports=e},function(t,n){},function(t,n,e)</Result>
</report_mosca>

<report_mosca>
 <Path>/src/modules/smalltalk/dist/smalltalk.native.poly.min.js</Path>
 <Module>/app/Mosca/eggs/javascript_common_fail.egg</Module>
 <Title> Possible code injection</Title>
 <Description> Command injection is an attack in which the goal is execution of arbitrary commands on the host operating system via a vulnerable application.</Description>
 <Level> High</Level>
 <Reference> https://www.securecoding.cert.org/confluence/pages/viewpage.action?pageId=2130132 </Reference>
 <Match> eval\s?\(|setTimeout|setInterval</Match>
 <Result> Line: 0 -  var smalltalk=function(t){function n(e){if(r[e])return r[e].exports;var o=r[e]={i:e,l:!1,exports:{}};return t[e].call(o.exports,o,o.exports,n),o.l=!0,o.exports}var r={};return n.m=t,n.c=r,n.d=function(t,r,e){n.o(t,r)||Object.defineProperty(t,r,{configurable:!1,enumerable:!0,get:e})},n.n=function(t){var r=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(r,"a",r),r},n.o=function(t,n){return Object.prototype.hasOwnProperty.call(t,n)},n.p="",n(n.s=9)}([function(t,n,r){(function(n,e){!function(n,r){t.exports=r()}(0,function(){"use strict";function t(t){var n=typeof t;return null!==t&&("object"===n||"function"===n)}function o(t){return"function"==typeof t}function i(t){H=t}function u(t){I=t}function s(){return void 0!==G?function(){G(a)}:c()}function c(){var t=setTimeout;return function(){return t(a,1)}}function a(){for(var t=0;t<B;t+=2){(0,Z[t])(Z[t+1]),Z[t]=void 0,Z[t+1]=void 0}B=0}function f(t,n){var r=arguments,e=this,o=new this.constructor(h);void 0===o[tt]&&k(o);var i=e._state;return i?function(){var t=r[i-1];I(function(){return S(i,o,t,e._result)})}():j(e,o,t,n),o}function l(t){var n=this;if(t&&"object"==typeof t&&t.constructor===n)return t;var r=new n(h);return b(r,t),r}function h(){}function p(){return new TypeError("You cannot resolve a promise with itself")}function v(){return new TypeError("A promises callback cannot return that same promise.")}function d(t){try{return t.then}catch(t){return ot.error=t,ot}}function m(t,n,r,e){try{t.call(n,r,e)}catch(t){return t}}function _(t,n,r){I(function(t){var e=!1,o=m(r,n,function(r){e||(e=!0,n!==r?b(t,r):T(t,r))},function(n){e||(e=!0,A(t,n))},"Settle: "+(t._label||" unknown promise"));!e&&o&&(e=!0,A(t,o))},t)}function y(t,n){n._state===rt?T(t,n._result):n._state===et?A(t,n._result):j(n,void 0,function(n){return b(t,n)},function(n){return A(t,n)})}function w(t,n,r){n.constructor===t.constructor&&r===f&&n.constructor.resolve===l?y(t,n):r===ot?(A(t,ot.error),ot.error=null):void 0===r?T(t,n):o(r)?_(t,n,r):T(t,n)}function b(n,r){n===r?A(n,p()):t(r)?w(n,r,d(r)):T(n,r)}function g(t){t._onerror&&t._onerror(t._res Line: 3 -  turn r._settledAt(et,n,t)})},U.all=F,U.race=Y,U.resolve=l,U.reject=D,U._setScheduler=i,U._setAsap=u,U._asap=I,U.prototype={constructor:U,then:f,catch:function(t){return this.then(null,t)}},U.polyfill=W,U.Promise=U,U})}).call(n,r(1),r(2))},function(t,n){function r(){throw new Error("setTimeout has not been defined")}function e(){throw new Error("clearTimeout has not been defined")}function o(t){if(f===setTimeout)return setTimeout(t,0);if((f===r||!f)&&setTimeout)return f=setTimeout,setTimeout(t,0);try{return f(t,0)}catch(n){try{return f.call(null,t,0)}catch(n){return f.call(this,t,0)}}}function i(t){if(l===clearTimeout)return clearTimeout(t);if((l===e||!l)&&clearTimeout)return l=clearTimeout,clearTimeout(t);try{return l(t)}catch(n){try{return l.call(null,t)}catch(n){return l.call(this,t)}}}function u(){d&&p&&(d=!1,p.length?v=p.concat(v):m=-1,v.length&&s())}function s(){if(!d){var t=o(u);d=!0;for(var n=v.length;n;){for(p=v,v=[];++m<n;)p&&p[m].run();m=-1,n=v.length}p=null,d=!1,i(t)}}function c(t,n){this.fun=t,this.array=n}function a(){}var f,l,h=t.exports={};!function(){try{f="function"==typeof setTimeout?setTimeout:r}catch(t){f=r}try{l="function"==typeof clearTimeout?clearTimeout:e}catch(t){l=e}}();var p,v=[],d=!1,m=-1;h.nextTick=function(t){var n=new Array(arguments.length-1);if(arguments.length>1)for(var r=1;r<arguments.length;r++)n[r-1]=arguments[r];v.push(new c(t,n)),1!==v.length||d||o(s)},c.prototype.run=function(){this.fun.apply(null,this.array)},h.title="browser",h.browser=!0,h.env={},h.argv=[],h.version="",h.versions={},h.on=a,h.addListener=a,h.once=a,h.off=a,h.removeListener=a,h.removeAllListeners=a,h.emit=a,h.prependListener=a,h.prependOnceListener=a,h.listeners=function(t){return[]},h.binding=function(t){throw new Error("process.binding is not supported")},h.cwd=function(){return"/"},h.chdir=function(t){throw new Error("process.chdir is not supported")},h.umask=function(){return 0}},function(t,n){var r;r=function(){return this}();try{r=r||Function("return this")()||(0,eval)("this")}catch(t){"object"==typeof window&&(r=window)}t.exports=r},function(t,n){},,,,,,function(t</Result>
</report_mosca>

<report_mosca>
 <Path>/src/modules/jquery-mousewheel/jquery.mousewheel.js</Path>
 <Module>/app/Mosca/eggs/javascript_common_fail.egg</Module>
 <Title> Possible code injection</Title>
 <Description> Command injection is an attack in which the goal is execution of arbitrary commands on the host operating system via a vulnerable application.</Description>
 <Level> High</Level>
 <Reference> https://www.securecoding.cert.org/confluence/pages/viewpage.action?pageId=2130132 </Reference>
 <Match> eval\s?\(|setTimeout|setInterval</Match>
 <Result> Line: 200 -          nullLowestDeltaTimeout = setTimeout(nullLowestDelta, 200);

</Result>
</report_mosca>

<report_mosca>
 <Path>/src/modules/jquery-mousewheel/jquery.mousewheel.min.js</Path>
 <Module>/app/Mosca/eggs/javascript_common_fail.egg</Module>
 <Title> Possible code injection</Title>
 <Description> Command injection is an attack in which the goal is execution of arbitrary commands on the host operating system via a vulnerable application.</Description>
 <Level> High</Level>
 <Reference> https://www.securecoding.cert.org/confluence/pages/viewpage.action?pageId=2130132 </Reference>
 <Match> eval\s?\(|setTimeout|setInterval</Match>
 <Result> Line: 7 -  !function(a){"function"==typeof define&&define.amd?define(["jquery"],a):"object"==typeof exports?module.exports=a:a(jQuery)}(function(a){function b(b){var g=b||window.event,h=i.call(arguments,1),j=0,l=0,m=0,n=0,o=0,p=0;if(b=a.event.fix(g),b.type="mousewheel","detail"in g&&(m=-1*g.detail),"wheelDelta"in g&&(m=g.wheelDelta),"wheelDeltaY"in g&&(m=g.wheelDeltaY),"wheelDeltaX"in g&&(l=-1*g.wheelDeltaX),"axis"in g&&g.axis===g.HORIZONTAL_AXIS&&(l=-1*m,m=0),j=0===m?l:m,"deltaY"in g&&(m=-1*g.deltaY,j=m),"deltaX"in g&&(l=g.deltaX,0===m&&(j=-1*l)),0!==m||0!==l){if(1===g.deltaMode){var q=a.data(this,"mousewheel-line-height");j*=q,m*=q,l*=q}else if(2===g.deltaMode){var r=a.data(this,"mousewheel-page-height");j*=r,m*=r,l*=r}if(n=Math.max(Math.abs(m),Math.abs(l)),(!f||f>n)&&(f=n,d(g,n)&&(f/=40)),d(g,n)&&(j/=40,l/=40,m/=40),j=Math[j>=1?"floor":"ceil"](j/f),l=Math[l>=1?"floor":"ceil"](l/f),m=Math[m>=1?"floor":"ceil"](m/f),k.settings.normalizeOffset&&this.getBoundingClientRect){var s=this.getBoundingClientRect();o=b.clientX-s.left,p=b.clientY-s.top}return b.deltaX=l,b.deltaY=m,b.deltaFactor=f,b.offsetX=o,b.offsetY=p,b.deltaMode=0,h.unshift(b,j,l,m),e&&clearTimeout(e),e=setTimeout(c,200),(a.event.dispatch||a.event.handle).apply(this,h)}}function c(){f=null}function d(a,b){return k.settings.adjustOldDeltas&&"mousewheel"===a.type&&b%120===0}var e,f,g=["wheel","mousewheel","DOMMouseScroll","MozMousePixelScroll"],h="onwheel"in document||document.documentMode>=9?["wheel"]:["mousewheel","DomMouseScroll","MozMousePixelScroll"],i=Array.prototype.slice;if(a.event.fixHooks)for(var j=g.length;j;)a.event.fixHooks[g[--j]]=a.event.mouseHooks;var k=a.event.special.mousewheel={version:"3.1.12",setup:function(){if(this.addEventListener)for(var c=h.length;c;)this.addEventListener(h[--c],b,!1);else this.onmousewheel=b;a.data(this,"mousewheel-line-height",k.getLineHeight(this)),a.data(this,"mousewheel-page-height",k.getPageHeight(this))},teardown:function(){if(this.removeEventListener)for(var c=h.length;c;)this.removeEventListener(h[--c],b,!1);else this.onmousewheel=null;a.removeData(this,"mousewheel-line-height"),a</Result>
</report_mosca>

<report_mosca>
 <Path>/src/modules/olark/olark.js</Path>
 <Module>/app/Mosca/eggs/javascript_common_fail.egg</Module>
 <Title> Possible code injection</Title>
 <Description> Command injection is an attack in which the goal is execution of arbitrary commands on the host operating system via a vulnerable application.</Description>
 <Level> High</Level>
 <Reference> https://www.securecoding.cert.org/confluence/pages/viewpage.action?pageId=2130132 </Reference>
 <Match> eval\s?\(|setTimeout|setInterval</Match>
 <Result> Line: 40 -                  return setTimeout(ld, 100);

</Result>
</report_mosca>

<report_mosca>
 <Path>/src/modules/olark/olark.min.js</Path>
 <Module>/app/Mosca/eggs/javascript_common_fail.egg</Module>
 <Title> Possible code injection</Title>
 <Description> Command injection is an attack in which the goal is execution of arbitrary commands on the host operating system via a vulnerable application.</Description>
 <Level> High</Level>
 <Reference> https://www.securecoding.cert.org/confluence/pages/viewpage.action?pageId=2130132 </Reference>
 <Match> eval\s?\(|setTimeout|setInterval</Match>
 <Result> Line: 9 -  return setTimeout(ld,100)}a.P(1);var j="appendChild",h="createElement",k="src",n=d[h]("div"),v=n[j](d[h](z)),b=d[h]("iframe"),g="document",e="domain",o;n.style.display="none";m.insertBefore(n,m.firstChild).id=z;b.frameBorder="0";b.id=z+"-loader";if(/MSIE[ ]+6/.test(navigator.userAgent)){

</Result>
</report_mosca>

<report_mosca>
 <Path>/src/modules/fancybox/source/jquery.fancybox.js</Path>
 <Module>/app/Mosca/eggs/javascript_common_fail.egg</Module>
 <Title> Possible code injection</Title>
 <Description> Command injection is an attack in which the goal is execution of arbitrary commands on the host operating system via a vulnerable application.</Description>
 <Level> High</Level>
 <Reference> https://www.securecoding.cert.org/confluence/pages/viewpage.action?pageId=2130132 </Reference>
 <Match> eval\s?\(|setTimeout|setInterval</Match>
 <Result> Line: 441 -  						F.player.timer = setTimeout(F.next, F.current.playSpeed);

 Line: 566 -  			didUpdate = setTimeout(function() {

</Result>
</report_mosca>

<report_mosca>
 <Path>/src/modules/fancybox/source/jquery.fancybox.pack.js</Path>
 <Module>/app/Mosca/eggs/javascript_common_fail.egg</Module>
 <Title> Possible code injection</Title>
 <Description> Command injection is an attack in which the goal is execution of arbitrary commands on the host operating system via a vulnerable application.</Description>
 <Level> High</Level>
 <Reference> https://www.securecoding.cert.org/confluence/pages/viewpage.action?pageId=2130132 </Reference>
 <Match> eval\s?\(|setTimeout|setInterval</Match>
 <Result> Line: 10 -  (b.player.timer=setTimeout(b.next,b.current.playSpeed))},c=function(){d();p.unbind(".player");b.player.isActive=!1;b.trigger("onPlayEnd")};!0===a||!b.player.isActive&&!1!==a?b.current&&(b.current.loop||b.current.index<b.group.length-1)&&(b.player.isActive=!0,p.bind({"onCancel.player beforeClose.player":c,"onUpdate.player":e,"beforeLoad.player":d}),e(),b.trigger("onPlayStart")):c()},next:function(a){var d=b.current;d&&(r(a)||(a=d.direction.next),b.jumpto(d.index+1,a,"next"))},prev:function(a){var d=

 Line: 12 -  update:function(a){var d=a&&a.originalEvent&&a.originalEvent.type,e=!d||"orientationchange"===d;e&&(clearTimeout(C),C=null);b.isOpen&&!C&&(C=setTimeout(function(){var c=b.current;c&&!b.isClosing&&(b.wrap.removeClass("fancybox-tmp"),(e||"load"===d||"resize"===d&&c.autoResize)&&b._setDimension(),"scroll"===d&&c.canShrink||b.reposition(a),b.trigger("onUpdate"),C=null)},e&&!t?0:300))},toggle:function(a){b.isOpen&&(b.current.fitToView="boolean"===f.type(a)?a:!b.current.fitToView,t&&(b.wrap.removeAttr("style").addClass("fancybox-tmp"),

</Result>
</report_mosca>

<report_mosca>
 <Path>/src/dist-dev/cloudcmd.common.js</Path>
 <Module>/app/Mosca/eggs/javascript_common_fail.egg</Module>
 <Title> Possible code injection</Title>
 <Description> Command injection is an attack in which the goal is execution of arbitrary commands on the host operating system via a vulnerable application.</Description>
 <Level> High</Level>
 <Reference> https://www.securecoding.cert.org/confluence/pages/viewpage.action?pageId=2130132 </Reference>
 <Match> eval\s?\(|setTimeout|setInterval</Match>
 <Result> Line: 63 -  SON) {\n    let path;\n    const regExp = new RegExp(FILES_HTML_ROOT);\n    const isRoot = regExp.test(name);\n    \n    if (isHTML) {\n        if (isRoot)\n            path = DIR_HTML + name.replace('-tmpl', '');\n        else\n            path = DIR_HTML_FS  + name;\n        \n        path += '.hbs';\n    } else if (isJSON) {\n        path = DIR_JSON  + name + '.json';\n    }\n    \n    return path;\n}\n\nfunction showError(name) {\n    const str = 'Wrong file name: ' + name;\n    const error = new Error(str);\n    \n    throw(error);\n}\n\nfunction getSystemFile(file, callback) {\n    const prefix = CloudCmd.PREFIX;\n    \n    if (!Promises[file])\n        Promises[file] = new Promise((success, error) => {\n            const url = prefix + file;\n            \n            load.ajax({\n                url,\n                success,\n                error\n            });\n        });\n    \n    Promises[file].then((data) => {\n        callback(null, data);\n    }, (error) => {\n        Promises[file] = null;\n        callback(error);\n    });\n}\n\nfunction getConfig(callback) {\n    let is;\n    \n    if (!Promises.config)\n        Promises.config = new Promise((resolve, reject) => {\n            is = true;\n            RESTful.Config.read((error, data) => {\n                if (error)\n                    return reject(error);\n                \n                resolve(data);\n            });\n        });\n    \n    Promises.config.then(function(data) {\n        is = false;\n        Storage.setAllowed(data.localStorage);\n        \n        callback(null, data);\n        \n        timeout(() => {\n            if (!is)\n                Promises.config = null;\n        });\n    }, function() {\n        if (!is)\n            Promises.config = null;\n    });\n}\n\nfunction getTimeoutOnce(time) {\n    let is;\n    \n    return (callback) => {\n        if (is)\n            return;\n        \n        is = true;\n        \n        setTimeout(() => {\n            is = false;\n            callback();\n        }, time);\n    };\n}\n\n\n\n//# sourceURL=file://cloudcmd/client/dom/files. Line: 146 -            });\n        },\n        \n        render  : function(data, callback) {\n            sendRequest({\n                method      : 'PUT',\n                url         : '/markdown',\n                data        : data,\n                callback    : callback,\n                imgPosition : { top: true },\n                notLog      : true\n            });\n        }\n    };\n    \n    function sendRequest(params) {\n        const p = params;\n        const prefixUrl = CloudCmd.PREFIX_URL;\n        \n        p.url = prefixUrl + p.url;\n        p.url = encodeURI(p.url);\n        \n        /*\n         * if we send ajax request -\n         * no need in hash so we escape #\n         */\n        p.url = p.url.replace('#', '%23');\n        \n        load.ajax({\n            method      : p.method,\n            url         : p.url,\n            data        : p.data,\n            dataType    : p.dataType,\n            error       : (jqXHR) => {\n                const response = jqXHR.responseText;\n                const statusText = jqXHR.statusText;\n                const status = jqXHR.status;\n                const text = status === 404 ? response : statusText;\n                \n                Images.show.error(text);\n                setTimeout(() => {\n                    DOM.Dialog.alert(CloudCmd.TITLE, text);\n                }, 100);\n                \n                p.callback(Error(text));\n            },\n            success: (data) => {\n                Images.hide();\n                \n                if (!p.notLog)\n                    CloudCmd.log(data);\n                \n                p.callback(null, data);\n            }\n        });\n    }\n}\n\n\n//# sourceURL=file://cloudcmd/client/dom/rest.js");

 Line: 270 -  eval("\n\nvar Emitify = __webpack_require__(/*! emitify/legacy */ \"./node_modules/emitify/legacy/index.js\");\n\nmodule.exports = function (entry) {\n    var emitter = Emitify();\n\n    setTimeout(function () {\n        FindIt(emitter, entry);\n    }, 0);\n\n    return emitter;\n};\n\nfunction FindIt(emitter, entry) {\n    if (!(this instanceof FindIt)) return new FindIt(emitter, entry);\n\n    this._dirs = 0;\n    this._first = true;\n\n    this._find(emitter, entry);\n}\n\nFindIt.prototype._find = function (emitter, entry) {\n    var _this = this;\n\n    if (entry.isFile) {\n        emitter.emit('file', entry.fullPath, entry);\n\n        if (this._first) emitter.emit('end');\n\n        return;\n    }\n\n    if (this._first) this._first = false;\n\n    emitter.emit('directory', entry.fullPath, entry);\n\n    ++this._dirs;\n\n    entry.createReader().readEntries(function (entries) {\n        [].forEach.call(entries, function (entry) {\n            _this._find(emitter, entry);\n        });\n\n        --_this._dirs;\n\n        if (!_this._dirs) emitter.emit('end');\n    });\n};\n\n//# sourceURL=file://cloudcmd/node_modules/domfs-findit/legacy/findit.js");

</Result>
</report_mosca>

<report_mosca>
 <Path>/src/dist-dev/cloudcmd.common.js</Path>
 <Module>/app/Mosca/eggs/javascript_common_fail.egg</Module>
 <Title> Possible SQL injection</Title>
 <Description> notification possible SQL injection</Description>
 <Level> High</Level>
 <Reference> https://www.owasp.org/index.php/Testing_for_Stack_Overflow </Reference>
 <Match> query|YQL|WHERE|FROM|SELECT|UPDATE|DELETE|INSERT|UNION|getResults</Match>
 <Result> Line: 88 -  eval("/* global CloudCmd */\n\n\n\nconst itype = __webpack_require__(/*! itype/legacy */ \"./node_modules/itype/legacy/index.js\");\nconst exec = __webpack_require__(/*! execon */ \"./node_modules/execon/lib/exec.js\");\nconst jonny = __webpack_require__(/*! jonny/legacy */ \"./node_modules/jonny/legacy/index.js\");\nconst Util = __webpack_require__(/*! ../../common/util */ \"./common/util.js\");\n\nconst {\n    getTitle,\n    FS,\n    Entity,\n} = __webpack_require__(/*! ../../common/cloudfunc */ \"./common/cloudfunc.js\");\n\nconst DOMTree = __webpack_require__(/*! ./dom-tree */ \"./client/dom/dom-tree.js\");\n\nconst DOM = Object.assign({}, DOMTree, new CmdProto());\n\nmodule.exports = DOM;\n\nconst Images = __webpack_require__(/*! ./images */ \"./client/dom/images.js\");\nconst load = __webpack_require__(/*! ./load */ \"./client/dom/load.js\");\nconst Files = __webpack_require__(/*! ./files */ \"./client/dom/files.js\");\nconst RESTful = __webpack_require__(/*! ./rest */ \"./client/dom/rest.js\");\nconst Storage = __webpack_require__(/*! ./storage */ \"./client/dom/storage.js\");\n\nDOM.Images = Images;\nDOM.load = load;\nDOM.Files = Files;\nDOM.RESTful = RESTful;\nDOM.Storage = Storage;\n\nDOM.uploadDirectory = __webpack_require__(/*! ./directory */ \"./client/dom/directory.js\");\nDOM.Buffer = __webpack_require__(/*! ./buffer */ \"./client/dom/buffer.js\");\nDOM.Events = __webpack_require__(/*! ./events */ \"./client/dom/events.js\");\n\nconst loadRemote = __webpack_require__(/*! ./load-remote */ \"./client/dom/load-remote.js\");\nconst selectByPattern = __webpack_require__(/*! ./select-by-pattern */ \"./client/dom/select-by-pattern.js\");\n\nfunction CmdProto() {\n    let Title;\n    let CurrentInfo = {};\n    \n    const Cmd = this;\n    const CURRENT_FILE = 'current-file';\n    const SELECTED_FILE = 'selected-file';\n    const TITLE = 'Cloud Commander';\n    const TabPanel = {\n        'js-left'        : null,\n        'js-right'       : null\n    };\n    \n    this.loadRemote = (name, options, callback) => {\n        loadRemote(name, options, callback);\n        retu Line: 90 -  rent direcotory name\n     */\n    this.getCurrentDirName = () => {\n        const href = DOM.getCurrentDirPath()\n            .replace(/\\/$/, '');\n        \n        const substr  = href.substr(href, href.lastIndexOf('/'));\n        const ret     = href.replace(substr + '/', '') || '/';\n        \n        return ret;\n    };\n    \n    /**\n     * get current direcotory path\n     */\n    this.getCurrentDirPath = (panel = DOM.getPanel()) => {\n        const path = DOM.getByDataName('js-path', panel);\n        const ret = path && path.textContent;\n        \n        return ret;\n    };\n    \n    /**\n     * get current direcotory path\n     */\n    this.getParentDirPath = (panel) => {\n        const path = DOM.getCurrentDirPath(panel);\n        const dirName = DOM.getCurrentDirName() + '/';\n        \n        if (path !== '/')\n            return path.replace(RegExp(dirName + '$'), '');\n        \n        return path;\n    };\n    \n    /**\n     * get not current direcotory path\n     */\n    this.getNotCurrentDirPath = () => {\n        const panel = DOM.getPanel({active: false});\n        const path = DOM.getCurrentDirPath(panel);\n        \n        return path;\n    };\n    \n    /**\n     * unified way to get current file\n     *\n     * @currentFile\n     */\n    this.getCurrentFile = () => {\n        return DOM.getByClass(CURRENT_FILE);\n    };\n    \n    /**\n     * get current file by name\n     */\n    this.getCurrentByName = (name, panel = CurrentInfo.panel) => {\n        const dataName = 'js-file-' + name;\n        const element = DOM.getByDataName(dataName, panel);\n        \n        return element;\n    };\n    \n    /**\n     * unified way to get current file\n     *\n     * @currentFile\n     */\n    this.getSelectedFiles = () => {\n        const panel = DOM.getPanel();\n        const selected = DOM.getByClassAll(SELECTED_FILE, panel);\n        \n        return [...selected];\n    };\n    \n    /*\n     * unselect all files\n     */\n    this.unselectFiles = (files) => {\n        files = files || DOM.getSelectedFiles();\n        \n        [...files].forEach(DO Line: 91 -  tedFile);\n    };\n    \n    /**\n     * get all selected files or current when none selected\n     *\n     * @currentFile\n     */\n    this.getActiveFiles = () => {\n        const current = DOM.getCurrentFile();\n        const files = DOM.getSelectedFiles();\n        const name = DOM.getCurrentName(current);\n        \n        if (!files.length && name !== '..')\n            return [current];\n        \n        return files;\n    };\n    \n    this.getCurrentDate = (currentFile) => {\n        const current = currentFile || Cmd.getCurrentFile();\n        const date = DOM\n            .getByDataName('js-date', current)\n            .textContent;\n        \n        return date;\n    };\n    \n    /**\n     * get size\n     * @currentFile\n     */\n    this.getCurrentSize = (currentFile) => {\n        const current = currentFile || Cmd.getCurrentFile();\n        /* если это папка - возвращаем слово dir вместо размера*/\n        const size = DOM.getByDataName('js-size', current)\n            .textContent\n            .replace(/^<|>$/g, '');\n        \n        return size;\n    };\n    \n    /**\n     * get size\n     * @currentFile\n     */\n    this.loadCurrentSize = (callback, currentFile) => {\n        const current = currentFile || DOM.getCurrentFile();\n        const query = '?size';\n        const link = DOM.getCurrentPath(current);\n        \n        Images.show.load();\n        \n        if (name === '..')\n            return;\n        \n        RESTful.read(link + query, (error, size) => {\n            if (error)\n                return;\n                \n            DOM.setCurrentSize(size, current);\n            exec(callback, current);\n            Images.hide();\n        });\n    };\n    \n    /**\n     * load hash\n     * @callback\n     * @currentFile\n     */\n    this.loadCurrentHash = (callback, currentFile) => {\n        const current = currentFile || DOM.getCurrentFile();\n        const query = '?hash';\n        const link = DOM.getCurrentPath(current);\n        \n        RESTful.read(link + query, callback);\n    };\n  Line: 92 -  n     * load current modification time of file\n     * @callback\n     * @currentFile\n     */\n    this.loadCurrentTime = (callback, currentFile) => {\n        const current = currentFile || DOM.getCurrentFile();\n        const query = '?time';\n        const link = DOM.getCurrentPath(current);\n        \n        RESTful.read(link + query, callback);\n    };\n    \n    /**\n     * set size\n     * @currentFile\n     */\n    this.setCurrentSize = (size, currentFile) => {\n        const current = currentFile || DOM.getCurrentFile();\n        const sizeElement = DOM.getByDataName('js-size', current);\n        \n        sizeElement.textContent = size;\n    };\n    \n    /**\n     * @currentFile\n     */\n    this.getCurrentMode = (currentFile) => {\n        const current = currentFile || DOM.getCurrentFile();\n        const mode = DOM.getByDataName('js-mode', current);\n        \n        return mode.textContent;\n    };\n    \n    /**\n     * @currentFile\n     */\n    this.getCurrentOwner = (currentFile) => {\n        const current = currentFile || DOM.getCurrentFile();\n        const owner = DOM.getByDataName('js-owner', current);\n        \n        return owner.textContent;\n    };\n    \n    /**\n     * unified way to get current file content\n     *\n     * @param callback\n     * @param currentFile\n     */\n    this.getCurrentData = (callback, currentFile) => {\n        let hash;\n        const Dialog = DOM.Dialog;\n        const Info = DOM.CurrentInfo;\n        const current = currentFile || DOM.getCurrentFile();\n        const path = DOM.getCurrentPath(current);\n        const isDir = DOM.isCurrentIsDir(current);\n        \n        const func = (error, data) => {\n            const ONE_MEGABYTE = 1024 * 1024 * 1024;\n            \n            if (!error) {\n                if (itype.object(data))\n                    data = jonny.stringify(data);\n                \n                const length  = data.length;\n                \n                if (hash && length < ONE_MEGABYTE)\n                    DOM.saveDataToStorage(path, data, hash);\n            }\n            \n   Line: 93 -  lback(error, data);\n        };\n        \n        if (Info.name === '..') {\n            Dialog.alert.noFiles(TITLE);\n            return callback(Error('No files selected!'));\n        }\n        \n        if (isDir)\n            return RESTful.read(path, func);\n        \n        DOM.checkStorageHash(path, (error, equal, hashNew) => {\n            if (error)\n                return callback(error);\n            \n            if (equal)\n                return DOM.getDataFromStorage(path, callback);\n            \n            hash = hashNew;\n            RESTful.read(path, func);\n        });\n    };\n    \n    /**\n     * unified way to save current file content\n     *\n     * @callback - function({data, name}) {}\n     * @currentFile\n     */\n    this.saveCurrentData = (url, data, callback, query = '') => {\n        DOM.RESTful.write(url + query, data, (error) => {\n            !error && DOM.saveDataToStorage(url, data);\n        });\n    };\n    \n    /**\n     * unified way to get RefreshButton\n     */\n    this.getRefreshButton = (panel) => {\n        const currentPanel = panel || DOM.getPanel();\n        const refresh = DOM.getByDataName('js-refresh', currentPanel);\n        \n        return refresh;\n    };\n    \n    this.setCurrentByName = (name) => {\n        const current = DOM.getCurrentByName(name);\n        return DOM.setCurrentFile(current);\n    };\n    \n    /**\n     * private function thet unset currentfile\n     *\n     * @currentFile\n     */\n    function unsetCurrentFile(currentFile) {\n        const is = DOM.isCurrentFile(currentFile);\n        \n        if (!is)\n            return;\n        \n        currentFile.classList.remove(CURRENT_FILE);\n    }\n    \n    /**\n     * unified way to set current file\n     */\n    this.setCurrentFile = (currentFile, options) => {\n        const o = options;\n        const CENTER = true;\n        const currentFileWas = DOM.getCurrentFile();\n        \n        if (!currentFile)\n            return DOM;\n        \n        let pathWas = '';\n        \n        if (currentFileWas) {\n            pathWas = DOM.getCu Line: 95 -   current.classList.add(SELECTED_FILE);\n        \n        return Cmd;\n    };\n    \n    this.unselectFile = (currentFile) => {\n        const current = currentFile || DOM.getCurrentFile();\n        \n        current.classList.remove(SELECTED_FILE);\n        \n        return Cmd;\n    };\n    \n    this.toggleSelectedFile = (currentFile) => {\n        const current = currentFile || DOM.getCurrentFile();\n        const name = DOM.getCurrentName(current);\n        \n        if (name === '..')\n            return Cmd;\n        \n        current.classList.toggle(SELECTED_FILE);\n        \n        return Cmd;\n    };\n    \n    this.toggleAllSelectedFiles = () => {\n        DOM.getAllFiles().map(DOM.toggleSelectedFile);\n        \n        return Cmd;\n    };\n    \n    this.selectAllFiles = () => {\n        DOM.getAllFiles().map(DOM.selectFile);\n        \n        return Cmd;\n    };\n    \n    this.getAllFiles = () => {\n        const panel = DOM.getPanel();\n        const files = DOM.getFiles(panel);\n        const name = DOM.getCurrentName(files[0]);\n        \n        const from = (a) => a === '..' ? 1 : 0;\n        const i = from(name);\n        \n        return [...files].slice(i);\n    };\n    \n    /**\n     * open dialog with expand selection\n     */\n    this.expandSelection = () => {\n        const msg = 'expand';\n        const files = CurrentInfo.files;\n        \n        selectByPattern(msg, files);\n    };\n    \n    /**\n     * open dialog with shrink selection\n     */\n    this.shrinkSelection = () => {\n        const msg = 'shrink';\n        const files = CurrentInfo.files;\n       \n        selectByPattern(msg, files);\n    };\n    \n    /**\n     * setting history wrapper\n     */\n    this.setHistory = (data, title, url) => {\n        const ret = window.history;\n        \n        url = CloudCmd.PREFIX + url;\n        \n        if (ret)\n            history.pushState(data, title, url);\n        \n        return ret;\n    };\n    \n    /**\n     * set title or create title element\n     *\n     * @param name\n     */\n    \n    this.setTitle = (name) => {\n    Line: 96 -  le)\n            Title = DOM.getByTag('title')[0] ||\n                    DOM.load({\n                        name            : 'title',\n                        innerHTML       : name,\n                        parentElement   : document.head\n                    });\n        \n        Title.textContent = name;\n        \n        return DOM;\n    };\n    \n    /**\n     * current file check\n     *\n     * @param currentFile\n     */\n    this.isCurrentFile = (currentFile) => {\n        if (!currentFile)\n            return false;\n        \n        return DOM.isContainClass(currentFile, CURRENT_FILE);\n    };\n    \n    /**\n     * selected file check\n     *\n     * @param currentFile\n     */\n    this.isSelected = (selected) => {\n        if (!selected)\n            return false;\n        \n        return DOM.isContainClass(selected, SELECTED_FILE);\n    };\n    \n    /**\n     * check is current file is a directory\n     *\n     * @param currentFile\n     */\n    this.isCurrentIsDir = (currentFile) => {\n        const current = currentFile || this.getCurrentFile();\n        const fileType = DOM.getByDataName('js-type', current);\n        const ret = DOM.isContainClass(fileType, 'directory');\n        \n        return ret;\n    };\n    \n    /**\n     * get link from current (or param) file\n     *\n     * @param currentFile - current file by default\n     */\n    this.getCurrentLink = (currentFile) => {\n        const current = currentFile || this.getCurrentFile();\n        const link = DOM.getByTag('a', current);\n        \n        return link[0];\n    };\n    \n    /**\n     * get link from current (or param) file\n     *\n     * @param currentFile - current file by default\n     */\n    this.getCurrentPath = (currentFile) => {\n        const current = currentFile || DOM.getCurrentFile();\n        const element = DOM.getByTag('a', current)[0];\n        const prefix = CloudCmd.PREFIX;\n        const path = element.getAttribute('href')\n            .replace(RegExp('^' + prefix + FS), '');\n        \n        return path;\n    };\n    \n    /**\n     * get name from current Line: 144 -  eval("\n\n/* global CloudCmd, DOM */\n\nconst itype = __webpack_require__(/*! itype/legacy */ \"./node_modules/itype/legacy/index.js\");\n\nconst {FS} = __webpack_require__(/*! ../../common/cloudfunc */ \"./common/cloudfunc.js\");\n\nmodule.exports = new RESTful();\n\nconst Images = __webpack_require__(/*! ./images */ \"./client/dom/images.js\");\nconst load = __webpack_require__(/*! ./load */ \"./client/dom/load.js\");\n\nfunction RESTful() {\n    this.delete = (url, data, callback) => {\n        const isFunc = itype.function(data);\n        \n        if (!callback && isFunc) {\n            callback = data;\n            data = null;\n        }\n        \n        sendRequest({\n            method      : 'DELETE',\n            url         : FS + url,\n            data,\n            callback,\n            imgPosition : { top: !!data }\n        });\n    };\n    \n    this.patch = (url, data, callback) => {\n        const isFunc = itype.function(data);\n        \n        if (!callback && isFunc) {\n            callback = data;\n            data = null;\n        }\n        \n        const imgPosition = {\n            top: true\n        };\n        \n        sendRequest({\n            method: 'PATCH',\n            url: FS + url,\n            data,\n            callback,\n            imgPosition,\n        });\n    };\n    \n    this.write = (url, data, callback) => {\n        const isFunc = itype.function(data);\n        \n        if (!callback && isFunc) {\n            callback    = data;\n            data        = null;\n        }\n        \n        sendRequest({\n            method: 'PUT',\n            url: FS + url,\n            data,\n            callback,\n            imgPosition : { top: true }\n        });\n    };\n    \n    this.read = (url, dataType, callback) => {\n        const isQuery = /\\?/.test(url);\n        const isBeautify = /\\?beautify$/.test(url);\n        const isMinify = /\\?minify$/.test(url);\n        const notLog = !isQuery || isBeautify || isMinify;\n        const isFunc = itype.function(dataType);\n        \n        if (!callback && isFunc) {\n          </Result>
</report_mosca>

<report_mosca>
 <Path>/src/dist-dev/cloudcmd.js</Path>
 <Module>/app/Mosca/eggs/javascript_common_fail.egg</Module>
 <Title> Possible SQL injection</Title>
 <Description> notification possible SQL injection</Description>
 <Level> High</Level>
 <Reference> https://www.owasp.org/index.php/Testing_for_Stack_Overflow </Reference>
 <Match> query|YQL|WHERE|FROM|SELECT|UPDATE|DELETE|INSERT|UNION|getResults</Match>
 <Result> Line: 155 -    * should be called from config.js only\n             * after successful update on server\n             */\n            config[key] = value;\n        };\n        \n        DOM.Storage.setAllowed(CloudCmd.config('localStorage'));\n        \n        if (config.onePanelMode)\n            CloudCmd.MIN_ONE_PANEL_WIDTH = Infinity;\n        \n        exec.if(document.body.scrollIntoViewIfNeeded, func, funcBefore);\n    };\n    \n    function loadPlugins(callback) {\n        const prefix = CloudCmd.PREFIX;\n        const plugins = prefix + '/plugins.js';\n        \n        DOM.load.js(plugins, callback);\n    }\n    \n    this.join = (urls) => {\n        const prefix  = CloudCmd.PREFIX;\n        \n        if (!Array.isArray(urls))\n            throw Error('urls should be array!');\n        \n        const noPrefixUrls = urls.map((url) => {\n            return url.replace(prefix, '');\n        });\n        \n        return prefix + join(noPrefixUrls);\n    };\n    \n    this.route = (path) => {\n        const query = path.split('/');\n        \n        if (!path)\n            return;\n        \n        const [kebabModule] = query;\n        const module = kebabToCamelCase(kebabModule.slice(1));\n        \n        const file = query[1];\n        const current = DOM.getCurrentByName(file);\n        \n        if (file && !current) {\n            const msg = formatMsg('set current file', file, 'error');\n            CloudCmd.log(msg);\n            return;\n        }\n        \n        DOM.setCurrentFile(current);\n        \n        CloudCmd.execFromModule(module, 'show');\n    };\n    \n    this.logOut = () => {\n        const url = CloudCmd.PREFIX + '/logout';\n        const error = () => document.location.reload();\n        \n        DOM.load.ajax({url, error});\n    };\n    \n    function initModules(callback) {\n        exec.if(CloudCmd.Key, () => {\n            Key = new CloudCmd.Key();\n            CloudCmd.Key = Key;\n            Key.bind();\n        }, (func) => {\n            /* привязываем клавиши к функциям */\n            const path = 'key.js';\n     Line: 158 -   const position = DOM.getPanelPosition(panel);\n            const sort = CloudCmd.sort[position];\n            const order = CloudCmd.order[position];\n            \n            const query = rendy('?sort={{ sort }}&order={{ order }}', {\n                sort,\n                order,\n            });\n            \n            RESTful.read(path + query, 'json', (error, obj) => {\n                if (error)\n                    return;\n                \n                options.sort = sort;\n                options.order = order;\n                \n                createFileTable(obj, panel, options, () => {\n                    if (isRefresh && !noCurrent)\n                        DOM.setCurrentByName(name);\n                    \n                    exec(callback);\n                });\n                \n                if (!CloudCmd.config('dirStorage'))\n                    return;\n                \n                Storage.set(path, obj);\n            });\n        };\n        \n        if (!options)\n            options    = {};\n        \n        CloudCmd.log('reading dir: \"' + path + '\";');\n        \n        if (!CloudCmd.config('dirStorage'))\n            return create();\n        \n        Storage.get(path, create);\n    }\n    \n    /**\n     * Функция строит файловую таблицу\n     * @param json  - данные о файлах\n     * @param panelParam\n     * @param history\n     * @param callback\n     */\n    function createFileTable(json, panelParam, options, callback) {\n        const {\n            history,\n            noCurrent,\n        } = options;\n        \n        const names = ['file', 'path', 'link', 'pathLink'];\n        \n        Files.get(names, (error, templFile, templPath, templLink, templPathLink) => {\n            const Dialog = DOM.Dialog;\n            const panel = panelParam || DOM.getPanel();\n            \n            const {\n                dir,\n                name,\n            } = Info;\n            \n            if (error)\n                return Dialog.alert(TITLE, error.responseText);\n            \n  Line: 197 -  n        if (!Key.isBind())\n            return;\n        \n        const isVim = CloudCmd.config('vim');\n        \n        if (!isVim && !isNumpad && !alt && !ctrl && !meta && (isBetween || isSymbol))\n            return setCurrentByChar(char, Chars);\n        \n        Chars([]);\n        switchKey(event);\n        \n        if (isVim)\n            vim(char, event);\n    }\n    \n    function getSymbol(shift, keyCode) {\n        switch (keyCode) {\n        case KEY.DOT:\n            return '.';\n        \n        case KEY.HYPHEN:\n            return shift ? '_' : '-';\n        \n        case KEY.EQUAL:\n            return shift ? '+' : '=';\n        }\n    }\n    \n    function fromCharCode(keyIdentifier) {\n        const code = keyIdentifier.substring(2);\n        const hex = parseInt(code, 16);\n        const char = String.fromCharCode(hex);\n        \n        return char;\n    }\n    \n    function switchKey(event) {\n        let i, isSelected, prev, next;\n        let current = Info.element;\n        let dataName;\n        \n        const name = Info.name;\n        \n        const {Operation} = CloudCmd;\n        const panel = Info.panel;\n        const path = Info.path;\n        const isDir = Info.isDir;\n        \n        const keyCode = event.keyCode;\n        const alt = event.altKey;\n        const shift = event.shiftKey;\n        const ctrl = event.ctrlKey;\n        const meta = event.metaKey;\n        const ctrlMeta = ctrl || meta;\n        \n        if (current) {\n            prev = current.previousSibling;\n            next = current.nextSibling;\n        }\n        \n        switch (keyCode) {\n        case Key.TAB:\n            DOM.changePanel();\n            event.preventDefault();\n            break;\n        \n        case Key.INSERT:\n            DOM .toggleSelectedFile(current)\n                .setCurrentFile(next);\n            break;\n        \n        case Key.INSERT_MAC:\n            DOM .toggleSelectedFile(current)\n                .setCurrentFile(next);\n            break;\n        \n        case Key.DELETE:\n            if (shift)\n             Line: 214 -  eval("\n\nmodule.exports = {\n    BACKSPACE   : 8,\n    TAB         : 9,\n    ENTER       : 13,\n    ESC         : 27,\n    \n    SPACE       : 32,\n    PAGE_UP     : 33,\n    PAGE_DOWN   : 34,\n    END         : 35,\n    HOME        : 36,\n    \n    LEFT        : 37,\n    UP          : 38,\n    RIGHT       : 39,\n    DOWN        : 40,\n    \n    INSERT      : 45,\n    DELETE      : 46,\n    \n    ZERO        : 48,\n    \n    SEMICOLON   : 52,\n    \n    COLON       : 54,\n    \n    A           : 65,\n    \n    C           : 67,\n    D           : 68,\n    \n    G           : 71,\n    \n    J           : 74,\n    K           : 75,\n    \n    M           : 77,\n    \n    O           : 79,\n    Q           : 81,\n    R           : 82,\n    S           : 83,\n    T           : 84,\n    U           : 85,\n    \n    V           : 86,\n    \n    X           : 88,\n    \n    Z           : 90,\n    \n    INSERT_MAC  : 96,\n    \n    ASTERISK    : 106,\n    PLUS        : 107,\n    MINUS       : 109,\n    \n    F1          : 112,\n    F2          : 113,\n    F3          : 114,\n    F4          : 115,\n    F5          : 116,\n    F6          : 117,\n    F7          : 118,\n    F8          : 119,\n    F9          : 120,\n    F10         : 121,\n    \n    EQUAL       : 187,\n    HYPHEN      : 189,\n    DOT         : 190,\n    SLASH       : 191,\n    TRA         : 192, /* Typewritten Reverse Apostrophe (`) */\n    BACKSLASH   : 220,\n    \n    BRACKET_CLOSE: 221\n};\n\n\n\n//# sourceURL=file://cloudcmd/client/key/key.js");

</Result>
</report_mosca>

<report_mosca>
 <Path>/src/dist-dev/modules/menu.js</Path>
 <Module>/app/Mosca/eggs/javascript_common_fail.egg</Module>
 <Title> Possible code injection</Title>
 <Description> Command injection is an attack in which the goal is execution of arbitrary commands on the host operating system via a vulnerable application.</Description>
 <Level> High</Level>
 <Reference> https://www.securecoding.cert.org/confluence/pages/viewpage.action?pageId=2130132 </Reference>
 <Match> eval\s?\(|setTimeout|setInterval</Match>
 <Result> Line: 154 -  };\n        \n        return options;\n    }\n    \n    function getMenuData(isAuth) {\n        const menu = {\n            'Paste': Buffer.paste,\n            'New': {\n                'File': DOM.promptNewFile,\n                'Directory': DOM.promptNewDir\n            },\n            'Upload': () => {\n                CloudCmd.Upload.show();\n            },\n            'Upload From Cloud': uploadFromCloud,\n            '(Un)Select All': DOM.toggleAllSelectedFiles\n        };\n        \n        if (isAuth)\n            menu['Log Out'] = CloudCmd.logOut;\n        \n        return menu;\n    }\n    \n    function loadFileMenuData(callback) {\n        const is = CloudCmd.config('auth');\n        const show = wrap((name) => {\n            CloudCmd[name].show();\n        });\n        \n        const menuBottom = getMenuData(is);\n        \n        const menuTop = {\n            'View': show('View'),\n            'Edit': show('EditFile'),\n            'Rename': () => {\n                setTimeout(DOM.renameCurrent, 100);\n            },\n            'Delete': () => {\n                CloudCmd.Operation.show('delete');\n            },\n            'Pack': () => {\n                CloudCmd.Operation.show('pack');\n            },\n            'Extract': () => {\n                CloudCmd.Operation.show('extract');\n            },\n            'Download': preDownload,\n            'Upload To Cloud': uploadTo('Cloud'),\n            'Cut': () => {\n                isCurrent(Buffer.cut, alertNoFiles);\n            },\n            'Copy': () => {\n                isCurrent(Buffer.copy, alertNoFiles);\n            },\n        };\n        \n        const menu = Object.assign({}, menuTop, menuBottom);\n        \n        callback(is, menu);\n    }\n    \n    function isCurrent(yesFn, noFn) {\n        if (Info.name !== '..')\n            return yesFn();\n        \n        noFn();\n    }\n    \n    function isPath(x, y) {\n        const {panel} = Info;\n        const isEmptyRoot = !panel;\n        \n        if (isEmptyRoot)\n            return false;\n        \n        const el = document.ele Line: 156 -  oFiles();\n            \n        files.forEach((file) => {\n            const selected = DOM.isSelected(file);\n            const isDir = DOM.isCurrentIsDir(file);\n            const path = DOM.getCurrentPath(file);\n            \n            CloudCmd.log('downloading file ' + path + '...');\n            /*\n              * if we send ajax request -\n              * no need in hash so we escape #\n              * and all other characters, like \"%\"\n              */\n            const encodedPath = encodeURI(path).replace(/#/g, '%23');\n            const id = load.getIdBySrc(path);\n            \n            let src;\n            \n            if (isDir)\n                src = prefixUr + PACK + encodedPath + DOM.getPackerExt(type);\n            else\n                src = prefixUr + FS + encodedPath + '?download';\n            \n            const element = load({\n                id          : id + '-' + date,\n                name        : 'iframe',\n                async       : false,\n                className   : 'hidden',\n                src,\n            });\n            \n            const {body} = document;\n            const removeChild = body.removeChild.bind(body, element);\n            \n            setTimeout(removeChild, TIME);\n            \n            if (selected)\n                DOM.toggleSelectedFile(file);\n        });\n    }\n    \n    function getCurrentPosition() {\n        const current = Info.element;\n        const rect = current.getBoundingClientRect();\n        \n        const position = {\n            x: Math.round(rect.left + rect.width / 3),\n            y: Math.round(rect.top)\n        };\n        \n        return position;\n    }\n    \n    function listener(event) {\n        const F9 = Key.F9;\n        const ESC = Key.ESC;\n        const key = event.keyCode;\n        const isBind = Key.isBind();\n        \n        if (!isBind)\n            return;\n        \n        if (key === ESC)\n            return Menu.hide();\n        \n        if (key === F9) {\n            const position = getCurrentPosition();\n            MenuContext.show(posit</Result>
</report_mosca>

<report_mosca>
 <Path>/src/dist-dev/modules/operation.js</Path>
 <Module>/app/Mosca/eggs/javascript_common_fail.egg</Module>
 <Title> Possible SQL injection</Title>
 <Description> notification possible SQL injection</Description>
 <Level> High</Level>
 <Reference> https://www.owasp.org/index.php/Testing_for_Stack_Overflow </Reference>
 <Match> query|YQL|WHERE|FROM|SELECT|UPDATE|DELETE|INSERT|UNION|getResults</Match>
 <Result> Line: 155 -                 return isDir ? 'directory' : 'file';\n            };\n            \n            const type = getType(isDir) + ' ';\n            \n            const name = DOM.getCurrentName(current);\n            msg = msgAsk + msgSel + type + name + '?';\n        }\n        \n        const cancel = false;\n        \n        Dialog.confirm(TITLE, msg, {cancel}).then(() => {\n            deleteSilent(files);\n        });\n    }\n    \n    /**\n     * delete current or selected files\n     *\n     * @files\n     */\n    function deleteSilent(files = DOM.getActiveFiles()) {\n        const query = '?files';\n        const path = Info.dirPath;\n        \n        if (noFilesCheck())\n            return;\n        \n        showLoad();\n        \n        const names = DOM.getFilenames(files);\n        \n        deleteFn(path + query, names, (error) => {\n            const Storage = DOM.Storage;\n            const dirPath = Info.dirPath;\n            \n            if (error)\n                return CloudCmd.refresh();\n             \n            DOM.deleteSelected(files);\n            Storage.removeMatch(dirPath);\n        });\n    }\n    \n    /*\n     * process files (copy or move)\n     * @param data\n     * @param operation\n     */\n    function _processFiles(options, data) {\n        let selFiles, files;\n        let panel;\n        let shouldAsk;\n        let sameName;\n        let ok;\n        \n        let from = '';\n        let to = '';\n        \n        let names = [];\n        \n        if (data) {\n            from        = data.from;\n            to          = data.to;\n            names       = data.names;\n            panel       = Info.panel;\n        } else {\n            from        = Info.dirPath;\n            to          = DOM.getNotCurrentDirPath();\n            selFiles    = DOM.getSelectedFiles();\n            names       = DOM.getFilenames(selFiles);\n            data        = {};\n            shouldAsk   = true;\n            panel       = Info.panelPassive;\n        }\n        \n        if (!names.length)\n            names.push(DOM.getCurrentName());\n     </Result>
</report_mosca>

<report_mosca>
 <Path>/src/dist/cloudcmd.common.js</Path>
 <Module>/app/Mosca/eggs/javascript_common_fail.egg</Module>
 <Title> Possible code injection</Title>
 <Description> Command injection is an attack in which the goal is execution of arbitrary commands on the host operating system via a vulnerable application.</Description>
 <Level> High</Level>
 <Reference> https://www.securecoding.cert.org/confluence/pages/viewpage.action?pageId=2130132 </Reference>
 <Match> eval\s?\(|setTimeout|setInterval</Match>
 <Result> Line: 4 -  f t&&(t=t.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&")),t},t.exports.getRegExp=function(t){var e="^"+(t=t||"*").replace(".","\\.").replace("*",".*").replace("?",".?")+"$";return RegExp(e)},t.exports.exec=n,t.exports.getExt=function(t){if(!("string"==typeof t))return"";var e=t.lastIndexOf(".");return~e?t.substr(e):""},t.exports.findObjByNameInArr=function(t,e){var r=void 0;if(!Array.isArray(t))throw Error("array should be array!");if("string"!=typeof e)throw Error("name should be string!");return t.some(function(t){var n=t.name===e,o=Array.isArray(t);return n?(r=t,n):o?t.some(function(t){var n=t.name===e;return n&&(r=t.data),n}):n}),r},t.exports.time=function(t){n.ifExist(console,"time",[t])},t.exports.timeEnd=function(t){n.ifExist(console,"timeEnd",[t])}},function(t,e,r){"use strict";var n,o,i=r(4),a=r(1),u=r(0),s=r(17),c=r(3),l=r(10),f={},d="config|modules",h="file|path|link|pathLink|media",p="view/media-tmpl|config-tmpl|upload",v="/tmpl/",g=v+"fs/",m="/json/",y=(n=2e3,o=void 0,function(t){o||(o=!0,setTimeout(function(){o=!1,t()},n))}),b=a(function(t,e){var r=i(t),n=void 0;switch(function(t,e){if(!t)throw Error("name could not be empty!");if("function"!=typeof e)throw Error("callback should be a function")}(t,e),r){case"string":!function(t,e){var r=new RegExp(h+"|"+p),n=new RegExp(d),o=r.test(t),i=n.test(t);o||i?"config"===t?function(t){var e=void 0;f.config||(f.config=new Promise(function(t,r){e=!0,l.Config.read(function(e,n){if(e)return r(e);t(n)})}));f.config.then(function(r){e=!1,s.setAllowed(r.localStorage),t(null,r),y(function(){e||(f.config=null)})},function(){e||(f.config=null)})}(e):function(t,e){var r=CloudCmd.PREFIX;f[t]||(f[t]=new Promise(function(e,n){var o=r+t;c.ajax({url:o,success:e,error:n})}));f[t].then(function(t){e(null,t)},function(r){f[t]=null,e(r)})}(function(t,e,r){var n=void 0,o=new RegExp(p).test(t);e?(n=o?v+t.replace("-tmpl",""):g+t,n+=".hbs"):r&&(n=m+t+".json");return n}(t,o,i),e):function(t){throw new Error("Wrong file name: "+t)}(t)}(t,e);break;case"array":n=C(t,b),u.parallel(n,e)}}),C=function(t,e){return t.map(function(t){return e(t)})};t.exports.g Line: 11 -  tPanel({active:!1}),c=h.getFiles(u),l=n.getCurrentName(r);e.dir=n.getCurrentDirName(),e.dirPath=n.getCurrentDirPath(),e.parentDirPath=n.getParentDirPath(),e.element=r,e.ext=s.getExt(l),e.files=[].concat(o(i.children)),e.filesPassive=[].concat(o(c)),e.first=i.firstChild,e.getData=n.getCurrentData,e.last=i.lastChild,e.link=n.getCurrentLink(r),e.mode=n.getCurrentMode(r),e.name=l,e.path=n.getCurrentPath(r),e.panel=a,e.panelPassive=u,e.size=n.getCurrentSize(r),e.isDir=n.isCurrentIsDir(),e.isSelected=n.isSelected(r),e.panelPosition=n.getPanel().dataset.name.replace("js-",""),e.isOnePanel=e.panel.getAttribute("data-name")===e.panelPassive.getAttribute("data-name")}});t.exports=h;var p=r(2),v=r(3),g=r(7),m=r(10),y=r(17);h.Images=p,h.load=v,h.Files=g,h.RESTful=m,h.Storage=y,h.uploadDirectory=r(70),h.Buffer=r(20),h.Events=r(8);var b=r(65),C=r(64)},function(t,e,r){"use strict";var n=r(4),o=r(5).FS;t.exports=new function(){function t(t){var e=t,r=CloudCmd.PREFIX_URL;e.url=r+e.url,e.url=encodeURI(e.url),e.url=e.url.replace("#","%23"),a.ajax({method:e.method,url:e.url,data:e.data,dataType:e.dataType,error:function(t){var r=t.responseText,n=t.statusText,o=t.status,a=404===o?r:n;i.show.error(a),setTimeout(function(){DOM.Dialog.alert(CloudCmd.TITLE,a)},100),e.callback(Error(a))},success:function(t){i.hide(),e.notLog||CloudCmd.log(t),e.callback(null,t)}})}this.delete=function(e,r,i){var a=n.function(r);!i&&a&&(i=r,r=null),t({method:"DELETE",url:o+e,data:r,callback:i,imgPosition:{top:!!r}})},this.patch=function(e,r,i){var a=n.function(r);!i&&a&&(i=r,r=null);t({method:"PATCH",url:o+e,data:r,callback:i,imgPosition:{top:!0}})},this.write=function(e,r,i){var a=n.function(r);!i&&a&&(i=r,r=null),t({method:"PUT",url:o+e,data:r,callback:i,imgPosition:{top:!0}})},this.read=function(e,r,i){var a=/\?/.test(e),u=/\?beautify$/.test(e),s=/\?minify$/.test(e),c=!a||u||s,l=n.function(r);!i&&l&&(i=r,r="text"),t({method:"GET",url:o+e,callback:i,notLog:c,dataType:r})},this.cp=function(e,r){t({method:"PUT",url:"/cp",data:e,callback:r,imgPosition:{top:!0}})},this.pack=function(e,r){t({method:"PUT",url:"/pack",data:e, Line: 17 -  );function c(t,e){return function(){u.parallel(t,e)}}t.exports=function(t,e){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e,l=CloudCmd,f=l.PREFIX,d=l.config,h=e;if(h.name&&window[h.name])return r();s.get("modules",function(e,s){var l=d("online")&&navigator.onLine,h=a(s.remote,t),p=i.array(h.local),v=h.version,g=void 0,m=void 0;p?(g=h.remote,m=h.local):(g=[h.remote],m=[h.local]);var y=m.map(function(t){return f+t}),b=function(t,e,r){return function(){u.parallel(e,function(t){if(t)return c();r()})}}(0,g.map(function(t){return o(t,{version:v})}),r),C=c(y,r);n.if(l,b,C)})}},function(t,e,r){"use strict";t.exports=function(t,e,r){!function(t,e,r){if(!Array.isArray(t))throw Error("array should be an array!");if("function"!=typeof e)throw Error("iterator should be a function!");if("function"!=typeof r)throw Error("done should be a function!")}(t,e,r);var n=-1,o=t.length,i=function(a){if(++n,a||n===o)return r(a);e(t[n],i)};i()}},function(t,e,r){t.exports=r(66)},function(t,e,r){"use strict";var n=r(14);function o(t,e){if(!(this instanceof o))return new o(t,e);this._dirs=0,this._first=!0,this._find(t,e)}t.exports=function(t){var e=n();return setTimeout(function(){o(e,t)},0),e},o.prototype._find=function(t,e){var r=this;if(e.isFile)return t.emit("file",e.fullPath,e),void(this._first&&t.emit("end"));this._first&&(this._first=!1),t.emit("directory",e.fullPath,e),++this._dirs,e.createReader().readEntries(function(e){[].forEach.call(e,function(e){r._find(t,e)}),--r._dirs,r._dirs||t.emit("end")})}},function(t,e,r){"use strict";var n=r(68),o=r(14),i=r(67),a=r(21);function u(t,e){var r=this;if(!(this instanceof u))return new u(t,e);if("function"!=typeof e)throw Error("processingFn should be function!");o.call(this);var n=Array.isArray(t)?t:[t];this._i=0,this._n=0,this._processingFn=e,this._pause=!1,this._prev=0,this._find(n,function(t,e){r._files=t,r._dirs=e,r._n=t.length+e.length,r._data={},r._getFiles(t,r._data,function(){r._process()})})}t.exports=u,a(u,o),u.prototype._process=function(){var t=this,e=this._processingFn.length,r=void 0,n=this._dirs.shift(),o="directory";if(!n){ Line: 20 -  keys(n);t.exports.encode=function(t){return o.forEach(function(e){var r=RegExp(n[e],"g");t=t.replace(r,e)}),t},t.exports.decode=function(t){return o.forEach(function(e){var r=n[e],o=RegExp(e,"g");t=t.replace(o,r)}),t}},function(t,e,r){"use strict";t.exports=function(t){var e={value:t};return function(t){return arguments.length?(e.value=t,t):e.value}}},function(t,e,r){"use strict";t.exports=function t(e){for(var r=arguments.length,n=Array(r>1?r-1:0),o=1;o<r;o++)n[o-1]=arguments[o];if(function(t){if("function"!=typeof t)throw Error("fn should be function!")}(e),n.length>=e.length)return e.apply(void 0,n);var i=function(){return t.apply(void 0,[e].concat(n,Array.prototype.slice.call(arguments)))},a=e.length-n.length-1;return function(t){return[function(e){return t.apply(void 0,arguments)},function(e,r){return t.apply(void 0,arguments)},function(e,r,n){return t.apply(void 0,arguments)},function(e,r,n,o){return t.apply(void 0,arguments)},function(e,r,n,o,i){return t.apply(void 0,arguments)}]}(i)[a]||i}},function(t,e){var r,n,o=t.exports={};function i(){throw new Error("setTimeout has not been defined")}function a(){throw new Error("clearTimeout has not been defined")}function u(t){if(r===setTimeout)return setTimeout(t,0);if((r===i||!r)&&setTimeout)return r=setTimeout,setTimeout(t,0);try{return r(t,0)}catch(e){try{return r.call(null,t,0)}catch(e){return r.call(this,t,0)}}}!function(){try{r="function"==typeof setTimeout?setTimeout:i}catch(t){r=i}try{n="function"==typeof clearTimeout?clearTimeout:a}catch(t){n=a}}();var s,c=[],l=!1,f=-1;function d(){l&&s&&(l=!1,s.length?c=s.concat(c):f=-1,c.length&&h())}function h(){if(!l){var t=u(d);l=!0;for(var e=c.length;e;){for(s=c,c=[];++f<e;)s&&s[f].run();f=-1,e=c.length}s=null,l=!1,function(t){if(n===clearTimeout)return clearTimeout(t);if((n===a||!n)&&clearTimeout)return n=clearTimeout,clearTimeout(t);try{n(t)}catch(e){try{return n.call(null,t)}catch(e){return n.call(this,t)}}}(t)}}function p(t,e){this.fun=t,this.array=e}function v(){}o.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var r=1;r<arguments.length; Line: 28 -   */var n;n=function(){"use strict";function t(t){return"function"==typeof t}var n=Array.isArray?Array.isArray:function(t){return"[object Array]"===Object.prototype.toString.call(t)},o=0,i=void 0,a=void 0,u=function(t,e){p[o]=t,p[o+1]=e,2===(o+=2)&&(a?a(v):C())};var s="undefined"!=typeof window?window:void 0,c=s||{},l=c.MutationObserver||c.WebKitMutationObserver,f="undefined"==typeof self&&void 0!==e&&"[object process]"==={}.toString.call(e),d="undefined"!=typeof Uint8ClampedArray&&"undefined"!=typeof importScripts&&"undefined"!=typeof MessageChannel;function h(){var t=setTimeout;return function(){return t(v,1)}}var p=new Array(1e3);function v(){for(var t=0;t<o;t+=2){(0,p[t])(p[t+1]),p[t]=void 0,p[t+1]=void 0}o=0}var g,m,y,b,C=void 0;function w(t,e){var r=this,n=new this.constructor(A);void 0===n[E]&&M(n);var o=r._state;if(o){var i=arguments[o-1];u(function(){return B(o,n,i,r._result)})}else I(r,n,t,e);return n}function x(t){if(t&&"object"==typeof t&&t.constructor===this)return t;var e=new this(A);return k(e,t),e}f?C=function(){return e.nextTick(v)}:l?(m=0,y=new l(v),b=document.createTextNode(""),y.observe(b,{characterData:!0}),C=function(){b.data=m=++m%2}):d?((g=new MessageChannel).port1.onmessage=v,C=function(){return g.port2.postMessage(0)}):C=void 0===s?function(){try{var t=Function("return this")().require("vertx");return void 0!==(i=t.runOnLoop||t.runOnContext)?function(){i(v)}:h()}catch(t){return h()}}():h();var E=Math.random().toString(36).substring(2);function A(){}var _=void 0,P=1,F=2,S={error:null};function D(t){try{return t.then}catch(t){return S.error=t,S}}function j(e,r,n){r.constructor===e.constructor&&n===w&&r.constructor.resolve===x?function(t,e){e._state===P?N(t,e._result):e._state===F?O(t,e._result):I(e,void 0,function(e){return k(t,e)},function(e){return O(t,e)})}(e,r):n===S?(O(e,S.error),S.error=null):void 0===n?N(e,r):t(n)?function(t,e,r){u(function(t){var n=!1,o=function(t,e,r,n){try{t.call(e,r,n)}catch(t){return t}}(r,e,function(r){n||(n=!0,e!==r?k(t,r):N(t,r))},function(e){n||(n=!0,O(t,e))},t._label);!n&&o&&(n=!0,O(t,o))},t)}(e,r,n):N(e,r)}function k(t,</Result>
</report_mosca>

<report_mosca>
 <Path>/src/dist/cloudcmd.common.js</Path>
 <Module>/app/Mosca/eggs/javascript_common_fail.egg</Module>
 <Title> Possible SQL injection</Title>
 <Description> notification possible SQL injection</Description>
 <Level> High</Level>
 <Reference> https://www.owasp.org/index.php/Testing_for_Stack_Overflow </Reference>
 <Match> query|YQL|WHERE|FROM|SELECT|UPDATE|DELETE|INSERT|UNION|getResults</Match>
 <Result> Line: 11 -  tPanel({active:!1}),c=h.getFiles(u),l=n.getCurrentName(r);e.dir=n.getCurrentDirName(),e.dirPath=n.getCurrentDirPath(),e.parentDirPath=n.getParentDirPath(),e.element=r,e.ext=s.getExt(l),e.files=[].concat(o(i.children)),e.filesPassive=[].concat(o(c)),e.first=i.firstChild,e.getData=n.getCurrentData,e.last=i.lastChild,e.link=n.getCurrentLink(r),e.mode=n.getCurrentMode(r),e.name=l,e.path=n.getCurrentPath(r),e.panel=a,e.panelPassive=u,e.size=n.getCurrentSize(r),e.isDir=n.isCurrentIsDir(),e.isSelected=n.isSelected(r),e.panelPosition=n.getPanel().dataset.name.replace("js-",""),e.isOnePanel=e.panel.getAttribute("data-name")===e.panelPassive.getAttribute("data-name")}});t.exports=h;var p=r(2),v=r(3),g=r(7),m=r(10),y=r(17);h.Images=p,h.load=v,h.Files=g,h.RESTful=m,h.Storage=y,h.uploadDirectory=r(70),h.Buffer=r(20),h.Events=r(8);var b=r(65),C=r(64)},function(t,e,r){"use strict";var n=r(4),o=r(5).FS;t.exports=new function(){function t(t){var e=t,r=CloudCmd.PREFIX_URL;e.url=r+e.url,e.url=encodeURI(e.url),e.url=e.url.replace("#","%23"),a.ajax({method:e.method,url:e.url,data:e.data,dataType:e.dataType,error:function(t){var r=t.responseText,n=t.statusText,o=t.status,a=404===o?r:n;i.show.error(a),setTimeout(function(){DOM.Dialog.alert(CloudCmd.TITLE,a)},100),e.callback(Error(a))},success:function(t){i.hide(),e.notLog||CloudCmd.log(t),e.callback(null,t)}})}this.delete=function(e,r,i){var a=n.function(r);!i&&a&&(i=r,r=null),t({method:"DELETE",url:o+e,data:r,callback:i,imgPosition:{top:!!r}})},this.patch=function(e,r,i){var a=n.function(r);!i&&a&&(i=r,r=null);t({method:"PATCH",url:o+e,data:r,callback:i,imgPosition:{top:!0}})},this.write=function(e,r,i){var a=n.function(r);!i&&a&&(i=r,r=null),t({method:"PUT",url:o+e,data:r,callback:i,imgPosition:{top:!0}})},this.read=function(e,r,i){var a=/\?/.test(e),u=/\?beautify$/.test(e),s=/\?minify$/.test(e),c=!a||u||s,l=n.function(r);!i&&l&&(i=r,r="text"),t({method:"GET",url:o+e,callback:i,notLog:c,dataType:r})},this.cp=function(e,r){t({method:"PUT",url:"/cp",data:e,callback:r,imgPosition:{top:!0}})},this.pack=function(e,r){t({method:"PUT",url:"/pack",data:e,</Result>
</report_mosca>

<report_mosca>
 <Path>/src/dist/cloudcmd.js</Path>
 <Module>/app/Mosca/eggs/javascript_common_fail.egg</Module>
 <Title> Possible SQL injection</Title>
 <Description> notification possible SQL injection</Description>
 <Level> High</Level>
 <Reference> https://www.owasp.org/index.php/Testing_for_Stack_Overflow </Reference>
 <Match> query|YQL|WHERE|FROM|SELECT|UPDATE|DELETE|INSERT|UNION|getResults</Match>
 <Result> Line: 0 -  !function(e){function t(t){for(var n,i,u=t[0],l=t[1],s=t[2],f=0,d=[];f<u.length;f++)i=u[f],a[i]&&d.push(a[i][0]),a[i]=0;for(n in l)Object.prototype.hasOwnProperty.call(l,n)&&(e[n]=l[n]);for(c&&c(t);d.length;)d.shift()();return o.push.apply(o,s||[]),r()}function r(){for(var e,t=0;t<o.length;t++){for(var r=o[t],n=!0,u=1;u<r.length;u++){var l=r[u];0!==a[l]&&(n=!1)}n&&(o.splice(t--,1),e=i(i.s=r[0]))}return e}var n={},a={17:0};var o=[];function i(t){if(n[t])return n[t].exports;var r=n[t]={i:t,l:!1,exports:{}};return e[t].call(r.exports,r,r.exports,i),r.l=!0,r.exports}i.m=e,i.c=n,i.d=function(e,t,r){i.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:r})},i.r=function(e){Object.defineProperty(e,"__esModule",{value:!0})},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="";var u=window.webpackJsonp=window.webpackJsonp||[],l=u.push.bind(u);u.push=t,u=u.slice();for(var s=0;s<u.length;s++)t(u[s]);var c=l;o.push([80,0]),r()}({109:function(e,t){},18:function(e,t,r){"use strict";e.exports={BACKSPACE:8,TAB:9,ENTER:13,ESC:27,SPACE:32,PAGE_UP:33,PAGE_DOWN:34,END:35,HOME:36,LEFT:37,UP:38,RIGHT:39,DOWN:40,INSERT:45,DELETE:46,ZERO:48,SEMICOLON:52,COLON:54,A:65,C:67,D:68,G:71,J:74,K:75,M:77,O:79,Q:81,R:82,S:83,T:84,U:85,V:86,X:88,Z:90,INSERT_MAC:96,ASTERISK:106,PLUS:107,MINUS:109,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,EQUAL:187,HYPHEN:189,DOT:190,SLASH:191,TRA:192,BACKSLASH:220,BRACKET_CLOSE:221}},46:function(e,t,r){"use strict";var n=r(9),a=n.CurrentInfo,o=CloudCmd.sort,i=CloudCmd.order,u=n.getPanelPosition(),l=o[u],s=n.getPanel;CloudCmd.sortPanel=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:s(),r=t.dataset.name.replace("js-","");e!==l?i[r]="asc":"asc"===i[r]?i[r]="desc":i[r]="asc",l=o[r]=e;var n=r!==a.panelPosition;CloudCmd.refresh({panel:t,noCurrent:n})}},47:function(e,t,r){"use strict";var n=DOM.CurrentInfo,a=r(6).escapeRegExp;e.exports=function(e,t){for(var r=void 0,o=0,i=!1,u=0,l=a(e Line: 2 -  ult(),o.prompt("Cloud Commander","Find","",{cancel:!1}).then(c),v()):"n"===e?(f(),v()):"N"===e?(d(),v()):void 0:(CloudCmd.Operation.show("delete"),p(),v())},e.exports.selectFile=m},56:function(e,t,r){"use strict";var n=DOM.CurrentInfo,a=r(0),o=r(8),i=r(20),u=r(18),l=r(55),s=r(47),c=r(12)();function f(){var e=void 0,t=this;function r(e){return e.key?e.key:(t=e.keyIdentifier,r=t.substring(2),n=parseInt(r,16),String.fromCharCode(n));var t,r,n}function f(e){var o=e.keyCode,f=e.altKey,d=e.ctrlKey,p=e.shiftKey,v=e.metaKey,C=o>=u.ZERO&&o<=u.Z,h=/Numpad/.test(e.code),m=r(e),D=~[".","_","-","+","="].indexOf(m);if(D||(D=function(e,t){switch(t){case u.DOT:return".";case u.HYPHEN:return e?"_":"-";case u.EQUAL:return e?"+":"="}}(p,o))&&(m=D),t.isBind()){var g=CloudCmd.config("vim");if(!g&&!h&&!f&&!d&&!v&&(C||D))return s(m,c);c([]),function(e){var r=void 0,o=void 0,l=void 0,s=void 0,c=n.element,f=n.name,d=CloudCmd.Operation,p=n.panel,v=n.path,C=n.isDir,h=e.keyCode,m=e.altKey,D=e.shiftKey,g=e.ctrlKey,O=e.metaKey,M=g||O;c&&(l=c.previousSibling,s=c.nextSibling);switch(h){case t.TAB:DOM.changePanel(),e.preventDefault();break;case t.INSERT:case t.INSERT_MAC:DOM.toggleSelectedFile(c).setCurrentFile(s);break;case t.DELETE:D?d.show("delete:silent"):d.show("delete");break;case t.ASTERISK:DOM.toggleAllSelectedFiles(c);break;case t.PLUS:DOM.expandSelection(),e.preventDefault();break;case t.MINUS:DOM.shrinkSelection(),e.preventDefault();break;case t.F1:CloudCmd.Help.show(),e.preventDefault();break;case t.F2:DOM.renameCurrent(c);break;case t.F3:D?CloudCmd.Markdown.show(v):M?CloudCmd.sortPanel("name"):CloudCmd.View.show(),e.preventDefault();break;case t.F4:D?CloudCmd.EditFileVim.show():CloudCmd.EditFile.show(),e.preventDefault();break;case t.F5:M?CloudCmd.sortPanel("date"):m?d.show("pack"):d.show("copy"),e.preventDefault();break;case t.F6:M?CloudCmd.sortPanel("size"):d.show("move"),e.preventDefault();break;case t.F7:D?DOM.promptNewFile():DOM.promptNewDir(),e.preventDefault();break;case t.F8:d.show("delete"),e.preventDefault();break;case t.F9:m?d.show("extract"):CloudCmd.Menu.show(),e.preventDefault();brea</Result>
</report_mosca>

<report_mosca>
 <Path>/src/dist/modules/menu.js</Path>
 <Module>/app/Mosca/eggs/javascript_common_fail.egg</Module>
 <Title> Possible code injection</Title>
 <Description> Command injection is an attack in which the goal is execution of arbitrary commands on the host operating system via a vulnerable application.</Description>
 <Level> High</Level>
 <Reference> https://www.securecoding.cert.org/confluence/pages/viewpage.action?pageId=2130132 </Reference>
 <Match> eval\s?\(|setTimeout|setInterval</Match>
 <Result> Line: 1 -  !1,e=null},i=CloudCmd.config("auth"),a=u(function(e){CloudCmd[e].show()}),l=b(i),d={View:a("View"),Edit:a("EditFile"),Rename:function(){setTimeout(DOM.renameCurrent,100)},Delete:function(){CloudCmd.Operation.show("delete")},Pack:function(){CloudCmd.Operation.show("pack")},Extract:function(){CloudCmd.Operation.show("extract")},Download:S,"Upload To Cloud":O("Cloud"),Cut:function(){P(t.cut,w)},Copy:function(){P(t.copy,w)}},c=o({},d,l),r(i,c)}function F(e){var n=void 0,t=void 0;e?(n="context",t=s.unsetBind):n="contextFile";var o={icon:!0,beforeClose:s.setBind,beforeShow:r.with(E,t),beforeClick:k,name:n};return o}function b(e){var n={Paste:t.paste,New:{File:DOM.promptNewFile,Directory:DOM.promptNewDir},Upload:function(){CloudCmd.Upload.show()},"Upload From Cloud":B,"(Un)Select All":DOM.toggleAllSelectedFiles};return e&&(n["Log Out"]=CloudCmd.logOut),n}function P(e,n){if(".."!==c.name)return e();n()}function E(e,n){var t=n.name,o=DOM.getCurrentByPosition({x:n.x,y:n.y}),i=D(o),u="contextFile"===i;return"contextFile"===n.name&&(u=!u),u||(g=t),r(e),u||(u=function(e,n){var t=c.panel;if(!t)return!1;var o=document.elementFromPoint(e,n),r=t.querySelectorAll('[data-name="js-path"] *');return~[].indexOf.call(r,o)}(n.x,n.y)),u}function k(e){return g!==e}function B(){h.show.load("top"),CloudCmd.execFromModule("Cloud","saveFile",function(e,n){var t=DOM.getCurrentDirPath()+e;d.write(t,n,function(n){n||CloudCmd.refresh({currentName:e})})})}function S(){!function(e){var n=CloudCmd.PREFIX_URL,t=Date.now(),o=DOM.getActiveFiles();if(!o.length)return w();o.forEach(function(o){var r=DOM.isSelected(o),i=DOM.isCurrentIsDir(o),u=DOM.getCurrentPath(o);CloudCmd.log("downloading file "+u+"...");var d=encodeURI(u).replace(/#/g,"%23"),c=l.getIdBySrc(u),f=void 0;f=i?n+"/pack"+d+DOM.getPackerExt(e):n+a+d+"?download";var s=l({id:c+"-"+t,name:"iframe",async:!1,className:"hidden",src:f}),C=document,p=C.body,h=p.removeChild.bind(p,s);setTimeout(h,3e4),r&&DOM.toggleSelectedFile(o)})}(n("packer"))}function I(){var e=c.element,n=e.getBoundingClientRect(),t={x:Math.round(n.left+n.width/3),y:Math.round(n.top)};return t}f</Result>
</report_mosca>

