{
  "errors": [
    {
      "code": 9,
      "level": "warn",
      "path": "/src/build/npm.js",
      "rule_id": "usr.local.lib.python3.8.site-packages.njsscan.rules.semantic_grep.xss.express_xss",
      "type": "MatchTimeoutError"
    },
    {
      "code": 9,
      "level": "warn",
      "path": "/src/tools/jslint.js",
      "rule_id": "usr.local.lib.python3.8.site-packages.njsscan.rules.semantic_grep.headers.cookie_session_default",
      "type": "MatchTimeoutError"
    },
    {
      "code": 3,
      "help": "If the code appears to be valid, this may be a semgrep bug.",
      "level": "warn",
      "long_msg": "Could not parse .empty as typescript",
      "short_msg": "parse error",
      "spans": [
        {
          "context_end": null,
          "context_start": null,
          "end": {
            "col": 2,
            "line": 1
          },
          "file": "/src/build/.empty",
          "source_hash": "f652a6c3c6999a18a42a0021ad71aa6b8b42ff12be86dd9443cc13960c3ee6f0",
          "start": {
            "col": 1,
            "line": 1
          }
        }
      ],
      "type": "SourceParseError"
    },
    {
      "code": 9,
      "level": "warn",
      "path": "/src/build/npm.js",
      "rule_id": "usr.local.lib.python3.8.site-packages.njsscan.rules.semantic_grep.headers.cookie_session_default",
      "type": "MatchTimeoutError"
    },
    {
      "code": 3,
      "help": "If the code appears to be valid, this may be a semgrep bug.",
      "level": "warn",
      "long_msg": "Could not parse Makefile as javascript",
      "short_msg": "parse error",
      "spans": [
        {
          "context_end": null,
          "context_start": null,
          "end": {
            "col": 8,
            "line": 1
          },
          "file": "/src/Makefile",
          "source_hash": "b79a1139771900aa938b6f63aef108f9c35a00b57d9692048f3b119ece22b18f",
          "start": {
            "col": 7,
            "line": 1
          }
        }
      ],
      "type": "SourceParseError"
    },
    {
      "code": 9,
      "level": "warn",
      "path": "/src/build/npm.js",
      "rule_id": "usr.local.lib.python3.8.site-packages.njsscan.rules.semantic_grep.headers.cookie_session_no_secure",
      "type": "MatchTimeoutError"
    },
    {
      "code": 3,
      "help": "If the code appears to be valid, this may be a semgrep bug.",
      "level": "warn",
      "long_msg": "Could not parse Makefile as typescript",
      "short_msg": "parse error",
      "spans": [
        {
          "context_end": null,
          "context_start": null,
          "end": {
            "col": 8,
            "line": 1
          },
          "file": "/src/Makefile",
          "source_hash": "b79a1139771900aa938b6f63aef108f9c35a00b57d9692048f3b119ece22b18f",
          "start": {
            "col": 7,
            "line": 1
          }
        }
      ],
      "type": "SourceParseError"
    },
    {
      "code": 9,
      "level": "warn",
      "path": "/src/tools/jslint.js",
      "rule_id": "usr.local.lib.python3.8.site-packages.njsscan.rules.semantic_grep.dos.regex_dos",
      "type": "MatchTimeoutError"
    },
    {
      "code": 3,
      "help": "If the code appears to be valid, this may be a semgrep bug.",
      "level": "warn",
      "long_msg": "Could not parse .empty as javascript",
      "short_msg": "parse error",
      "spans": [
        {
          "context_end": null,
          "context_start": null,
          "end": {
            "col": 2,
            "line": 1
          },
          "file": "/src/build/.empty",
          "source_hash": "f652a6c3c6999a18a42a0021ad71aa6b8b42ff12be86dd9443cc13960c3ee6f0",
          "start": {
            "col": 1,
            "line": 1
          }
        }
      ],
      "type": "SourceParseError"
    }
  ],
  "njsscan_version": "0.2.8",
  "nodejs": {
    "eval_nodejs": {
      "files": [
        {
          "file_path": "/src/lib/phpjsutil.js",
          "match_lines": [
            284,
            284
          ],
          "match_position": [
            7,
            76
          ],
          "match_string": "      eval('test.expected = ' + params.headKeys.returns[i].join('\\n') + '');"
        },
        {
          "file_path": "/src/lib/phpjsutil.js",
          "match_lines": [
            290,
            290
          ],
          "match_position": [
            11,
            70
          ],
          "match_string": "          eval('test.result = ' + params.headKeys.example[i][j] + '');"
        },
        {
          "file_path": "/src/lib/phpjsutil.js",
          "match_lines": [
            292,
            292
          ],
          "match_position": [
            11,
            51
          ],
          "match_string": "          eval(params.headKeys.example[i][j] + '');"
        }
      ],
      "metadata": {
        "cwe": "CWE-95: Improper Neutralization of Directives in Dynamically Evaluated Code ('Eval Injection')",
        "description": "User controlled data in eval() or similar functions may result in Server Side Injection or Remote Code Injection",
        "owasp": "A1: Injection",
        "severity": "ERROR"
      }
    },
    "node_insecure_random_generator": {
      "files": [
        {
          "file_path": "/src/functions/strings/str_shuffle.js",
          "match_lines": [
            22,
            22
          ],
          "match_position": [
            23,
            36
          ],
          "match_string": "    rand = Math.floor(Math.random() * i);"
        },
        {
          "file_path": "/src/functions/misc/uniqid.js",
          "match_lines": [
            38,
            38
          ],
          "match_position": [
            41,
            54
          ],
          "match_string": "    this.php_js.uniqidSeed = Math.floor(Math.random() * 0x75bcd15);"
        },
        {
          "file_path": "/src/functions/misc/uniqid.js",
          "match_lines": [
            48,
            48
          ],
          "match_position": [
            15,
            28
          ],
          "match_string": "    retId += (Math.random() * 10)"
        },
        {
          "file_path": "/src/functions/math/mt_rand.js",
          "match_lines": [
            19,
            19
          ],
          "match_position": [
            21,
            34
          ],
          "match_string": "  return Math.floor(Math.random() * (max - min + 1)) + min;"
        },
        {
          "file_path": "/src/functions/math/lcg_value.js",
          "match_lines": [
            8,
            8
          ],
          "match_position": [
            10,
            23
          ],
          "match_string": "  return Math.random();"
        },
        {
          "file_path": "/src/functions/array/shuffle.js",
          "match_lines": [
            43,
            43
          ],
          "match_position": [
            18,
            31
          ],
          "match_string": "    return 0.5 - Math.random();"
        },
        {
          "file_path": "/src/functions/array/array_rand.js",
          "match_lines": [
            25,
            25
          ],
          "match_position": [
            30,
            43
          ],
          "match_string": "      var rand = Math.floor((Math.random() * input.length));"
        },
        {
          "file_path": "/src/functions/math/rand.js",
          "match_lines": [
            16,
            16
          ],
          "match_position": [
            21,
            34
          ],
          "match_string": "  return Math.floor(Math.random() * (max - min + 1)) + min;"
        }
      ],
      "metadata": {
        "cwe": "CWE-327: Use of a Broken or Risky Cryptographic Algorithm",
        "description": "crypto.pseudoRandomBytes()/Math.random() is a cryptographically weak random number generator.",
        "owasp": "A9: Using Components with Known Vulnerabilities",
        "severity": "WARNING"
      }
    },
    "regex_dos": {
      "files": [
        {
          "file_path": "/src/functions/strings/substr.js",
          "match_lines": [
            48,
            48
          ],
          "match_position": [
            13,
            50
          ],
          "match_string": "        if (/[\\uD800-\\uDBFF]/.test(str.charAt(i)) && /[\\uDC00-\\uDFFF]/.test(str.charAt(i + 1))) {"
        },
        {
          "file_path": "/src/functions/strings/substr.js",
          "match_lines": [
            48,
            48
          ],
          "match_position": [
            54,
            95
          ],
          "match_string": "        if (/[\\uD800-\\uDBFF]/.test(str.charAt(i)) && /[\\uDC00-\\uDFFF]/.test(str.charAt(i + 1))) {"
        },
        {
          "file_path": "/src/functions/strings/substr.js",
          "match_lines": [
            57,
            57
          ],
          "match_position": [
            17,
            54
          ],
          "match_string": "            if (/[\\uDC00-\\uDFFF]/.test(str.charAt(i)) && /[\\uD800-\\uDBFF]/.test(str.charAt(i - 1))) {"
        },
        {
          "file_path": "/src/functions/strings/substr.js",
          "match_lines": [
            57,
            57
          ],
          "match_position": [
            58,
            99
          ],
          "match_string": "            if (/[\\uDC00-\\uDFFF]/.test(str.charAt(i)) && /[\\uD800-\\uDBFF]/.test(str.charAt(i - 1))) {"
        },
        {
          "file_path": "/src/functions/strings/substr.js",
          "match_lines": [
            79,
            79
          ],
          "match_position": [
            17,
            54
          ],
          "match_string": "            if (/[\\uDC00-\\uDFFF]/.test(str.charAt(i)) && /[\\uD800-\\uDBFF]/.test(str.charAt(i - 1))) {"
        },
        {
          "file_path": "/src/functions/strings/substr.js",
          "match_lines": [
            79,
            79
          ],
          "match_position": [
            58,
            99
          ],
          "match_string": "            if (/[\\uDC00-\\uDFFF]/.test(str.charAt(i)) && /[\\uD800-\\uDBFF]/.test(str.charAt(i - 1))) {"
        },
        {
          "file_path": "/src/functions/strings/substr.js",
          "match_lines": [
            92,
            92
          ],
          "match_position": [
            17,
            54
          ],
          "match_string": "            if (/[\\uD800-\\uDBFF]/.test(str.charAt(i)) && /[\\uDC00-\\uDFFF]/.test(str.charAt(i + 1))) {"
        },
        {
          "file_path": "/src/functions/strings/substr.js",
          "match_lines": [
            92,
            92
          ],
          "match_position": [
            58,
            99
          ],
          "match_string": "            if (/[\\uD800-\\uDBFF]/.test(str.charAt(i)) && /[\\uDC00-\\uDFFF]/.test(str.charAt(i + 1))) {"
        },
        {
          "file_path": "/src/functions/strings/sscanf.js",
          "match_lines": [
            232,
            233
          ],
          "match_position": [
            12,
            29
          ],
          "match_string": "      if ((_NWS)\n        .test(str.charAt(j)) || str.charAt(j) === '') { // Whitespace doesn't need to be an exact match)"
        },
        {
          "file_path": "/src/functions/filesystem/file_get_contents.js",
          "match_lines": [
            70,
            70
          ],
          "match_position": [
            15,
            42
          ],
          "match_string": "  } else if (!/^(https?|file):/.test(url)) { // Allow references within or below the same directory (should fix to allow other relative references or root reference; could make dependent on parse_url())"
        }
      ],
      "metadata": {
        "cwe": "CWE-185: Incorrect Regular Expression",
        "description": "Ensure that the regex used to compare with user supplied input is safe from regular expression denial of service.",
        "owasp": "A6: Security Misconfiguration",
        "severity": "WARNING"
      }
    }
  },
  "templates": {}
}