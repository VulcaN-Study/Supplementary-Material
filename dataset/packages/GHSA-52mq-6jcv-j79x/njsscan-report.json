{
  "errors": [
    {
      "code": 3,
      "help": "If the code appears to be valid, this may be a semgrep bug.",
      "level": "warn",
      "long_msg": "Could not parse InviteDialog.js as javascript",
      "short_msg": "parse error",
      "spans": [
        {
          "context_end": null,
          "context_start": null,
          "end": {
            "col": 28,
            "line": 1146
          },
          "file": "/src/lib/components/views/dialogs/InviteDialog.js",
          "source_hash": "d35439c350ca11e095a8fb328211a7c6e9662fbdbbfdbd810e5672e140ab58be",
          "start": {
            "col": 25,
            "line": 1146
          }
        }
      ],
      "type": "SourceParseError"
    },
    {
      "code": 9,
      "level": "warn",
      "path": "/src/src/component-index.js",
      "rule_id": "usr.local.lib.python3.8.site-packages.njsscan.rules.semantic_grep.headers.cookie_session_no_samesite",
      "type": "MatchTimeoutError"
    },
    {
      "code": 3,
      "help": "If the code appears to be valid, this may be a semgrep bug.",
      "level": "warn",
      "long_msg": "Could not parse FilePanel.js as javascript",
      "short_msg": "parse error",
      "spans": [
        {
          "context_end": null,
          "context_start": null,
          "end": {
            "col": 36,
            "line": 157
          },
          "file": "/src/src/components/structures/FilePanel.js",
          "source_hash": "df04949539c7559c6806820b28e2e5cca5362512394fedf6b0bf02c1e71bc920",
          "start": {
            "col": 29,
            "line": 157
          }
        }
      ],
      "type": "SourceParseError"
    },
    {
      "code": 9,
      "level": "warn",
      "path": "/src/lib/component-index.js",
      "rule_id": "usr.local.lib.python3.8.site-packages.njsscan.rules.semantic_grep.xss.express_xss",
      "type": "MatchTimeoutError"
    },
    {
      "code": 3,
      "help": "If the code appears to be valid, this may be a semgrep bug.",
      "level": "warn",
      "long_msg": "Could not parse generate-eslint-error-ignore-file as typescript",
      "short_msg": "parse error",
      "spans": [
        {
          "context_end": null,
          "context_start": null,
          "end": {
            "col": 67,
            "line": 2
          },
          "file": "/src/scripts/generate-eslint-error-ignore-file",
          "source_hash": "0434b318fd130debb6f01a204efe50ea57f55566d3101b7be998bac8147c22d0",
          "start": {
            "col": 1,
            "line": 2
          }
        }
      ],
      "type": "SourceParseError"
    },
    {
      "code": 9,
      "level": "warn",
      "path": "/src/lib/components/views/right_panel/UserInfo.js",
      "rule_id": "usr.local.lib.python3.8.site-packages.njsscan.rules.semantic_grep.headers.cookie_session_default",
      "type": "MatchTimeoutError"
    },
    {
      "code": 3,
      "help": "If the code appears to be valid, this may be a semgrep bug.",
      "level": "warn",
      "long_msg": "Could not parse Dockerfile as typescript",
      "short_msg": "parse error",
      "spans": [
        {
          "context_end": null,
          "context_start": null,
          "end": {
            "col": 42,
            "line": 1
          },
          "file": "/src/scripts/ci/Dockerfile",
          "source_hash": "336176db1172c394e48be0780225c6c1c4a9950aeeec762d6f3bee0bb3a4c0da",
          "start": {
            "col": 1,
            "line": 1
          }
        }
      ],
      "type": "SourceParseError"
    },
    {
      "code": 3,
      "help": "If the code appears to be valid, this may be a semgrep bug.",
      "level": "warn",
      "long_msg": "Could not parse LICENSE as typescript",
      "short_msg": "parse error",
      "spans": [
        {
          "context_end": null,
          "context_start": null,
          "end": {
            "col": 82,
            "line": 2
          },
          "file": "/src/LICENSE",
          "source_hash": "0d542e0c8804e39aa7f37eb00da5a762149dc682d7829451287e11b938e94594",
          "start": {
            "col": 34,
            "line": 2
          }
        }
      ],
      "type": "SourceParseError"
    },
    {
      "code": 9,
      "level": "warn",
      "path": "/src/lib/component-index.js",
      "rule_id": "usr.local.lib.python3.8.site-packages.njsscan.rules.semantic_grep.redirect.express_open_redirect2",
      "type": "MatchTimeoutError"
    },
    {
      "code": 3,
      "help": "If the code appears to be valid, this may be a semgrep bug.",
      "level": "warn",
      "long_msg": "Could not parse generate-eslint-error-ignore-file as javascript",
      "short_msg": "parse error",
      "spans": [
        {
          "context_end": null,
          "context_start": null,
          "end": {
            "col": 67,
            "line": 2
          },
          "file": "/src/scripts/generate-eslint-error-ignore-file",
          "source_hash": "0434b318fd130debb6f01a204efe50ea57f55566d3101b7be998bac8147c22d0",
          "start": {
            "col": 1,
            "line": 2
          }
        }
      ],
      "type": "SourceParseError"
    },
    {
      "code": 9,
      "level": "warn",
      "path": "/src/lib/utils/permalinks/Permalinks.js",
      "rule_id": "usr.local.lib.python3.8.site-packages.njsscan.rules.semantic_grep.headers.cookie_session_no_domain",
      "type": "MatchTimeoutError"
    },
    {
      "code": 3,
      "help": "If the code appears to be valid, this may be a semgrep bug.",
      "level": "warn",
      "long_msg": "Could not parse Dockerfile as javascript",
      "short_msg": "parse error",
      "spans": [
        {
          "context_end": null,
          "context_start": null,
          "end": {
            "col": 42,
            "line": 1
          },
          "file": "/src/scripts/ci/Dockerfile",
          "source_hash": "336176db1172c394e48be0780225c6c1c4a9950aeeec762d6f3bee0bb3a4c0da",
          "start": {
            "col": 1,
            "line": 1
          }
        }
      ],
      "type": "SourceParseError"
    },
    {
      "code": 3,
      "help": "If the code appears to be valid, this may be a semgrep bug.",
      "level": "warn",
      "long_msg": "Could not parse RoomDirectory.js as javascript",
      "short_msg": "parse error",
      "spans": [
        {
          "context_end": null,
          "context_start": null,
          "end": {
            "col": 31,
            "line": 394
          },
          "file": "/src/lib/components/structures/RoomDirectory.js",
          "source_hash": "11002d534e381fad153e522a77de8125ae353af652a2a28e1a375219bf11c8cc",
          "start": {
            "col": 28,
            "line": 394
          }
        }
      ],
      "type": "SourceParseError"
    },
    {
      "code": 3,
      "help": "If the code appears to be valid, this may be a semgrep bug.",
      "level": "warn",
      "long_msg": "Could not parse InteractiveAuthEntryComponents.js as javascript",
      "short_msg": "parse error",
      "spans": [
        {
          "context_end": null,
          "context_start": null,
          "end": {
            "col": 13,
            "line": 600
          },
          "file": "/src/src/components/views/auth/InteractiveAuthEntryComponents.js",
          "source_hash": "bcfee6baeac34c40e06b17e709b7333b94d271875476dae2a8ff124612c0aa1b",
          "start": {
            "col": 5,
            "line": 600
          }
        }
      ],
      "type": "SourceParseError"
    },
    {
      "code": 3,
      "help": "If the code appears to be valid, this may be a semgrep bug.",
      "level": "warn",
      "long_msg": "Could not parse DevtoolsDialog.js as javascript",
      "short_msg": "parse error",
      "spans": [
        {
          "context_end": null,
          "context_start": null,
          "end": {
            "col": 51,
            "line": 287
          },
          "file": "/src/src/components/views/dialogs/DevtoolsDialog.js",
          "source_hash": "4bda3b3008337dfbeaef4bdeb5c17e4e0ff15c3073864c4c3f5973bdd64bcd45",
          "start": {
            "col": 43,
            "line": 287
          }
        }
      ],
      "type": "SourceParseError"
    },
    {
      "code": 9,
      "level": "warn",
      "path": "/src/lib/components/structures/MatrixChat.js",
      "rule_id": "usr.local.lib.python3.8.site-packages.njsscan.rules.semantic_grep.headers.cookie_session_default",
      "type": "MatchTimeoutError"
    },
    {
      "code": 9,
      "level": "warn",
      "path": "/src/lib/CallHandler.js",
      "rule_id": "usr.local.lib.python3.8.site-packages.njsscan.rules.semantic_grep.headers.cookie_session_no_domain",
      "type": "MatchTimeoutError"
    },
    {
      "code": 9,
      "level": "warn",
      "path": "/src/src/component-index.js",
      "rule_id": "usr.local.lib.python3.8.site-packages.njsscan.rules.semantic_grep.headers.cookie_session_no_path",
      "type": "MatchTimeoutError"
    },
    {
      "code": 3,
      "help": "If the code appears to be valid, this may be a semgrep bug.",
      "level": "warn",
      "long_msg": "Could not parse LICENSE as javascript",
      "short_msg": "parse error",
      "spans": [
        {
          "context_end": null,
          "context_start": null,
          "end": {
            "col": 82,
            "line": 2
          },
          "file": "/src/LICENSE",
          "source_hash": "0d542e0c8804e39aa7f37eb00da5a762149dc682d7829451287e11b938e94594",
          "start": {
            "col": 34,
            "line": 2
          }
        }
      ],
      "type": "SourceParseError"
    },
    {
      "code": 9,
      "level": "warn",
      "path": "/src/lib/components/structures/RoomView.js",
      "rule_id": "usr.local.lib.python3.8.site-packages.njsscan.rules.semantic_grep.headers.cookie_session_default",
      "type": "MatchTimeoutError"
    },
    {
      "code": 9,
      "level": "warn",
      "path": "/src/src/component-index.js",
      "rule_id": "usr.local.lib.python3.8.site-packages.njsscan.rules.semantic_grep.headers.cookie_session_no_domain",
      "type": "MatchTimeoutError"
    },
    {
      "code": 9,
      "level": "warn",
      "path": "/src/lib/component-index.js",
      "rule_id": "usr.local.lib.python3.8.site-packages.njsscan.rules.semantic_grep.headers.cookie_session_default",
      "type": "MatchTimeoutError"
    },
    {
      "code": 9,
      "level": "warn",
      "path": "/src/lib/components/structures/MessagePanel.js",
      "rule_id": "usr.local.lib.python3.8.site-packages.njsscan.rules.semantic_grep.headers.cookie_session_default",
      "type": "MatchTimeoutError"
    }
  ],
  "njsscan_version": "0.2.8",
  "nodejs": {
    "generic_error_disclosure": {
      "files": [
        {
          "file_path": "/src/lib/components/views/rooms/BasicMessageComposer.js",
          "match_lines": [
            176,
            180
          ],
          "match_position": [
            9,
            10
          ],
          "match_string": "        try {\n          (0, _caret.setSelection)(this.editorRef.current, this.props.model, selection);\n        } catch (err) {\n          console.error(err);\n        } // if caret selection is a range, take the end position"
        },
        {
          "file_path": "/src/lib/components/views/rooms/BasicMessageComposer.js",
          "match_lines": [
            668,
            702
          ],
          "match_position": [
            5,
            6
          ],
          "match_string": "    try {\n      await new Promise(resolve => this.setState({\n        showVisualBell: false\n      }, resolve));\n      const {\n        model\n      } = this.props;\n      const caret = this.getCaret();\n      const position = model.positionForOffset(caret.offset, caret.atNodeEnd);\n      const range = model.startRange(position);\n      range.expandBackwardsWhile((index, offset, part) => {\n        return part.text[offset] !== \" \" && part.text[offset] !== \"+\" && (part.type === \"plain\" || part.type === \"pill-candidate\" || part.type === \"command\");\n      });\n      const {\n        partCreator\n      } = model; // await for auto-complete to be open\n\n      await model.transform(() => {\n        const addedLen = range.replace([partCreator.pillCandidate(range.text)]);\n        return model.positionForOffset(caret.offset + addedLen, true);\n      }); // Don't try to do things with the autocomplete if there is none shown\n\n      if (model.autoComplete) {\n        await model.autoComplete.onTab(event);\n\n        if (!model.autoComplete.hasSelection()) {\n          this.setState({\n            showVisualBell: true\n          });\n          model.autoComplete.close();\n        }\n      }\n    } catch (err) {\n      console.error(err);\n    }"
        },
        {
          "file_path": "/src/lib/components/views/rooms/EventTile.js",
          "match_lines": [
            263,
            263
          ],
          "match_position": [
            9,
            94
          ],
          "match_string": "        console.trace(\"Stacktrace for https://github.com/vector-im/element-web/issues/11120\");"
        },
        {
          "file_path": "/src/lib/components/views/messages/MKeyVerificationRequest.js",
          "match_lines": [
            75,
            81
          ],
          "match_position": [
            9,
            10
          ],
          "match_string": "        try {\n          this._openRequest();\n\n          await request.accept();\n        } catch (err) {\n          console.error(err.message);\n        }"
        },
        {
          "file_path": "/src/lib/components/views/messages/MKeyVerificationRequest.js",
          "match_lines": [
            88,
            92
          ],
          "match_position": [
            9,
            10
          ],
          "match_string": "        try {\n          await request.cancel();\n        } catch (err) {\n          console.error(err.message);\n        }"
        },
        {
          "file_path": "/src/src/components/views/rooms/EventTile.js",
          "match_lines": [
            622,
            622
          ],
          "match_position": [
            13,
            98
          ],
          "match_string": "            console.trace(\"Stacktrace for https://github.com/vector-im/element-web/issues/11120\");"
        },
        {
          "file_path": "/src/src/components/structures/ScrollPanel.js",
          "match_lines": [
            355,
            359
          ],
          "match_position": [
            13,
            14
          ],
          "match_string": "            try {\n                await Promise.all(fillPromises);\n            } catch (err) {\n                console.error(err);\n            }"
        },
        {
          "file_path": "/src/lib/components/structures/ScrollPanel.js",
          "match_lines": [
            209,
            213
          ],
          "match_position": [
            9,
            10
          ],
          "match_string": "        try {\n          await Promise.all(fillPromises);\n        } catch (err) {\n          console.error(err);\n        }"
        },
        {
          "file_path": "/src/src/components/views/rooms/SendMessageComposer.js",
          "match_lines": [
            435,
            447
          ],
          "match_position": [
            13,
            14
          ],
          "match_string": "            try {\n                const {parts: serializedParts, replyEventId} = JSON.parse(json);\n                const parts = serializedParts.map(p => partCreator.deserializePart(p));\n                if (replyEventId) {\n                    dis.dispatch({\n                        action: 'reply_to_event',\n                        event: this.props.room.findEventById(replyEventId),\n                    });\n                }\n                return parts;\n            } catch (e) {\n                console.error(e);\n            }"
        },
        {
          "file_path": "/src/src/components/views/messages/MKeyVerificationRequest.js",
          "match_lines": [
            66,
            71
          ],
          "match_position": [
            13,
            14
          ],
          "match_string": "            try {\n                this._openRequest();\n                await request.accept();\n            } catch (err) {\n                console.error(err.message);\n            }"
        },
        {
          "file_path": "/src/src/components/views/messages/MKeyVerificationRequest.js",
          "match_lines": [
            78,
            82
          ],
          "match_position": [
            13,
            14
          ],
          "match_string": "            try {\n                await request.cancel();\n            } catch (err) {\n                console.error(err.message);\n            }"
        },
        {
          "file_path": "/src/lib/components/views/toasts/VerificationRequestToast.js",
          "match_lines": [
            84,
            115
          ],
          "match_position": [
            7,
            8
          ],
          "match_string": "      try {\n        if (request.channel.roomId) {\n          _dispatcher.default.dispatch({\n            action: 'view_room',\n            room_id: request.channel.roomId,\n            should_peek: false\n          });\n\n          _dispatcher.default.dispatch({\n            action: _actions.Action.SetRightPanelPhase,\n            phase: _RightPanelStorePhases.RightPanelPhases.EncryptionPanel,\n            refireParams: {\n              verificationRequest: request,\n              member: cli.getUser(request.otherUserId)\n            }\n          });\n        } else {\n          const VerificationRequestDialog = sdk.getComponent(\"views.dialogs.VerificationRequestDialog\");\n\n          _Modal.default.createTrackedDialog('Incoming Verification', '', VerificationRequestDialog, {\n            verificationRequest: request\n          }, null,\n          /* priority = */\n          false,\n          /* static = */\n          true);\n        }\n\n        await request.accept();\n      } catch (err) {\n        console.error(err.message);\n      }"
        },
        {
          "file_path": "/src/lib/components/views/rooms/SendMessageComposer.js",
          "match_lines": [
            568,
            585
          ],
          "match_position": [
            7,
            8
          ],
          "match_string": "      try {\n        const {\n          parts: serializedParts,\n          replyEventId\n        } = JSON.parse(json);\n        const parts = serializedParts.map(p => partCreator.deserializePart(p));\n\n        if (replyEventId) {\n          _dispatcher.default.dispatch({\n            action: 'reply_to_event',\n            event: this.props.room.findEventById(replyEventId)\n          });\n        }\n\n        return parts;\n      } catch (e) {\n        console.error(e);\n      }"
        },
        {
          "file_path": "/src/lib/components/views/right_panel/VerificationPanel.js",
          "match_lines": [
            89,
            93
          ],
          "match_position": [
            7,
            8
          ],
          "match_string": "      try {\n        await verifier.verify();\n      } catch (err) {\n        console.error(err);\n      }"
        },
        {
          "file_path": "/src/lib/Avatar.js",
          "match_lines": [
            163,
            163
          ],
          "match_position": [
            5,
            72
          ],
          "match_string": "    console.trace(\"`name` argument to `getInitialLetter` not supplied\");"
        }
      ],
      "metadata": {
        "cwe": "CWE-209: Generation of Error Message Containing Sensitive Information",
        "description": "Error messages with stack traces may expose sensitive information about the application.",
        "owasp": "A3: Sensitive Data Exposure",
        "severity": "WARNING"
      }
    },
    "node_insecure_random_generator": {
      "files": [
        {
          "file_path": "/src/lib/rageshake/rageshake.js",
          "match_lines": [
            144,
            144
          ],
          "match_position": [
            29,
            42
          ],
          "match_string": "    this.id = \"instance-\" + Math.random() + Date.now();"
        },
        {
          "file_path": "/src/lib/stores/GroupFilterOrderStore.js",
          "match_lines": [
            308,
            308
          ],
          "match_position": [
            31,
            44
          ],
          "match_string": "    if (!this._id) this._id = Math.random().toString(16).slice(2, 10);"
        },
        {
          "file_path": "/src/lib/effects/snowfall/index.js",
          "match_lines": [
            73,
            73
          ],
          "match_position": [
            20,
            33
          ],
          "match_string": "      particle.x = Math.random() * width;"
        },
        {
          "file_path": "/src/lib/effects/snowfall/index.js",
          "match_lines": [
            74,
            74
          ],
          "match_position": [
            20,
            33
          ],
          "match_string": "      particle.y = Math.random() * -height;"
        },
        {
          "file_path": "/src/lib/effects/snowfall/index.js",
          "match_lines": [
            76,
            76
          ],
          "match_position": [
            27,
            40
          ],
          "match_string": "      particle.diameter = Math.random() * 7 + 4;"
        },
        {
          "file_path": "/src/lib/effects/snowfall/index.js",
          "match_lines": [
            77,
            77
          ],
          "match_position": [
            31,
            44
          ],
          "match_string": "      particle.maximumDrift = Math.random() * this.options.maxDrift + 3.5;"
        },
        {
          "file_path": "/src/lib/effects/snowfall/index.js",
          "match_lines": [
            78,
            78
          ],
          "match_position": [
            49,
            62
          ],
          "match_string": "      particle.gravity = this.options.gravity + Math.random() * 6 + 4;"
        },
        {
          "file_path": "/src/lib/Analytics.js",
          "match_lines": [
            162,
            162
          ],
          "match_position": [
            69,
            82
          ],
          "match_string": "      localStorage.setItem(UID_KEY, data = [...Array(16)].map(() => Math.random().toString(16)[2]).join(''));"
        },
        {
          "file_path": "/src/lib/Analytics.js",
          "match_lines": [
            348,
            348
          ],
          "match_position": [
            20,
            33
          ],
          "match_string": "      rand: String(Math.random()).slice(2, 8),"
        },
        {
          "file_path": "/src/src/stores/GroupFilterOrderStore.js",
          "match_lines": [
            262,
            262
          ],
          "match_position": [
            35,
            48
          ],
          "match_string": "        if (!this._id) this._id = Math.random().toString(16).slice(2, 10);"
        },
        {
          "file_path": "/src/src/rageshake/rageshake.js",
          "match_lines": [
            134,
            134
          ],
          "match_position": [
            33,
            46
          ],
          "match_string": "        this.id = \"instance-\" + Math.random() + Date.now();"
        },
        {
          "file_path": "/src/lib/effects/confetti/index.js",
          "match_lines": [
            114,
            114
          ],
          "match_position": [
            36,
            49
          ],
          "match_string": "      particle.color = this.colors[Math.random() * this.colors.length | 0] + (this.options.alpha + ')');"
        },
        {
          "file_path": "/src/lib/effects/confetti/index.js",
          "match_lines": [
            117,
            117
          ],
          "match_position": [
            39,
            52
          ],
          "match_string": "        particle.color2 = this.colors[Math.random() * this.colors.length | 0] + (this.options.alpha + ')');"
        },
        {
          "file_path": "/src/lib/effects/confetti/index.js",
          "match_lines": [
            122,
            122
          ],
          "match_position": [
            20,
            33
          ],
          "match_string": "      particle.x = Math.random() * width;"
        },
        {
          "file_path": "/src/lib/effects/confetti/index.js",
          "match_lines": [
            123,
            123
          ],
          "match_position": [
            20,
            33
          ],
          "match_string": "      particle.y = Math.random() * -height;"
        },
        {
          "file_path": "/src/lib/effects/confetti/index.js",
          "match_lines": [
            124,
            124
          ],
          "match_position": [
            27,
            40
          ],
          "match_string": "      particle.diameter = Math.random() * 10 + 5;"
        },
        {
          "file_path": "/src/lib/effects/confetti/index.js",
          "match_lines": [
            125,
            125
          ],
          "match_position": [
            23,
            36
          ],
          "match_string": "      particle.tilt = Math.random() * -10;"
        },
        {
          "file_path": "/src/lib/effects/confetti/index.js",
          "match_lines": [
            126,
            126
          ],
          "match_position": [
            37,
            50
          ],
          "match_string": "      particle.tiltAngleIncrement = Math.random() * 0.07 + 0.05;"
        },
        {
          "file_path": "/src/lib/effects/confetti/index.js",
          "match_lines": [
            127,
            127
          ],
          "match_position": [
            28,
            41
          ],
          "match_string": "      particle.tiltAngle = Math.random() * Math.PI;"
        },
        {
          "file_path": "/src/lib/effects/fireworks/index.js",
          "match_lines": [
            113,
            113
          ],
          "match_position": [
            22,
            35
          ],
          "match_string": "      const xPoint = Math.random() * (width - 200) + 100;"
        },
        {
          "file_path": "/src/lib/effects/fireworks/index.js",
          "match_lines": [
            114,
            114
          ],
          "match_position": [
            22,
            35
          ],
          "match_string": "      const yPoint = Math.random() * (height - 200) + 100;"
        },
        {
          "file_path": "/src/lib/effects/fireworks/index.js",
          "match_lines": [
            115,
            115
          ],
          "match_position": [
            21,
            34
          ],
          "match_string": "      const nFire = Math.random() * 50 + 100;"
        },
        {
          "file_path": "/src/lib/effects/fireworks/index.js",
          "match_lines": [
            116,
            116
          ],
          "match_position": [
            33,
            46
          ],
          "match_string": "      const color = \"rgb(\" + ~~(Math.random() * 200 + 55) + \",\" + ~~(Math.random() * 200 + 55) + \",\" + ~~(Math.random() * 200 + 55) + \")\";"
        },
        {
          "file_path": "/src/lib/effects/fireworks/index.js",
          "match_lines": [
            116,
            116
          ],
          "match_position": [
            70,
            83
          ],
          "match_string": "      const color = \"rgb(\" + ~~(Math.random() * 200 + 55) + \",\" + ~~(Math.random() * 200 + 55) + \",\" + ~~(Math.random() * 200 + 55) + \")\";"
        },
        {
          "file_path": "/src/lib/effects/fireworks/index.js",
          "match_lines": [
            116,
            116
          ],
          "match_position": [
            107,
            120
          ],
          "match_string": "      const color = \"rgb(\" + ~~(Math.random() * 200 + 55) + \",\" + ~~(Math.random() * 200 + 55) + \",\" + ~~(Math.random() * 200 + 55) + \")\";"
        },
        {
          "file_path": "/src/lib/effects/fireworks/index.js",
          "match_lines": [
            121,
            121
          ],
          "match_position": [
            35,
            48
          ],
          "match_string": "        particle.w = particle.h = Math.random() * 4 + 1;"
        },
        {
          "file_path": "/src/lib/effects/fireworks/index.js",
          "match_lines": [
            124,
            124
          ],
          "match_position": [
            24,
            37
          ],
          "match_string": "        particle.vx = (Math.random() - 0.5) * 10;"
        },
        {
          "file_path": "/src/lib/effects/fireworks/index.js",
          "match_lines": [
            125,
            125
          ],
          "match_position": [
            24,
            37
          ],
          "match_string": "        particle.vy = (Math.random() - 0.5) * 10;"
        },
        {
          "file_path": "/src/lib/effects/fireworks/index.js",
          "match_lines": [
            126,
            126
          ],
          "match_position": [
            26,
            39
          ],
          "match_string": "        particle.alpha = Math.random() * .5 + .5;"
        }
      ],
      "metadata": {
        "cwe": "CWE-327: Use of a Broken or Risky Cryptographic Algorithm",
        "description": "crypto.pseudoRandomBytes()/Math.random() is a cryptographically weak random number generator.",
        "owasp": "A9: Using Components with Known Vulnerabilities",
        "severity": "WARNING"
      }
    },
    "node_password": {
      "files": [
        {
          "file_path": "/src/src/components/views/settings/ChangePassword.js",
          "match_lines": [
            31,
            31
          ],
          "match_position": [
            7,
            48
          ],
          "match_string": "const FIELD_OLD_PASSWORD = 'field_old_password';"
        },
        {
          "file_path": "/src/src/components/views/settings/ChangePassword.js",
          "match_lines": [
            32,
            32
          ],
          "match_position": [
            7,
            48
          ],
          "match_string": "const FIELD_NEW_PASSWORD = 'field_new_password';"
        },
        {
          "file_path": "/src/src/components/views/settings/ChangePassword.js",
          "match_lines": [
            33,
            33
          ],
          "match_position": [
            7,
            64
          ],
          "match_string": "const FIELD_NEW_PASSWORD_CONFIRM = 'field_new_password_confirm';"
        },
        {
          "file_path": "/src/lib/components/structures/MatrixChat.js",
          "match_lines": [
            153,
            153
          ],
          "match_position": [
            3,
            58
          ],
          "match_string": "  Views[Views[\"FORGOT_PASSWORD\"] = 4] = \"FORGOT_PASSWORD\";"
        },
        {
          "file_path": "/src/lib/utils/WellKnownUtils.js",
          "match_lines": [
            81,
            81
          ],
          "match_position": [
            3,
            55
          ],
          "match_string": "  SecureBackupSetupMethod[\"Passphrase\"] = \"passphrase\";"
        },
        {
          "file_path": "/src/src/async-components/views/dialogs/security/CreateSecretStorageDialog.js",
          "match_lines": [
            51,
            51
          ],
          "match_position": [
            7,
            54
          ],
          "match_string": "const CREATE_STORAGE_OPTION_PASSPHRASE = 'passphrase';"
        },
        {
          "file_path": "/src/src/async-components/views/dialogs/security/CreateSecretStorageDialog.js",
          "match_lines": [
            96,
            96
          ],
          "match_position": [
            13,
            73
          ],
          "match_string": "            this.state.passPhraseKeySelected = CREATE_STORAGE_OPTION_KEY;"
        },
        {
          "file_path": "/src/src/async-components/views/dialogs/security/CreateSecretStorageDialog.js",
          "match_lines": [
            98,
            98
          ],
          "match_position": [
            13,
            80
          ],
          "match_string": "            this.state.passPhraseKeySelected = CREATE_STORAGE_OPTION_PASSPHRASE;"
        },
        {
          "file_path": "/src/lib/settings/UIFeature.js",
          "match_lines": [
            34,
            34
          ],
          "match_position": [
            3,
            57
          ],
          "match_string": "  UIFeature[\"PasswordReset\"] = \"UIFeature.passwordReset\";"
        },
        {
          "file_path": "/src/lib/components/views/settings/ChangePassword.js",
          "match_lines": [
            56,
            56
          ],
          "match_position": [
            7,
            48
          ],
          "match_string": "const FIELD_OLD_PASSWORD = 'field_old_password';"
        },
        {
          "file_path": "/src/lib/components/views/settings/ChangePassword.js",
          "match_lines": [
            57,
            57
          ],
          "match_position": [
            7,
            48
          ],
          "match_string": "const FIELD_NEW_PASSWORD = 'field_new_password';"
        },
        {
          "file_path": "/src/lib/components/views/settings/ChangePassword.js",
          "match_lines": [
            58,
            58
          ],
          "match_position": [
            7,
            64
          ],
          "match_string": "const FIELD_NEW_PASSWORD_CONFIRM = 'field_new_password_confirm';"
        },
        {
          "file_path": "/src/lib/async-components/views/dialogs/security/CreateSecretStorageDialog.js",
          "match_lines": [
            79,
            79
          ],
          "match_position": [
            7,
            54
          ],
          "match_string": "const CREATE_STORAGE_OPTION_PASSPHRASE = 'passphrase';"
        },
        {
          "file_path": "/src/lib/async-components/views/dialogs/security/CreateSecretStorageDialog.js",
          "match_lines": [
            395,
            395
          ],
          "match_position": [
            7,
            67
          ],
          "match_string": "      this.state.passPhraseKeySelected = CREATE_STORAGE_OPTION_KEY;"
        },
        {
          "file_path": "/src/lib/async-components/views/dialogs/security/CreateSecretStorageDialog.js",
          "match_lines": [
            397,
            397
          ],
          "match_position": [
            7,
            74
          ],
          "match_string": "      this.state.passPhraseKeySelected = CREATE_STORAGE_OPTION_PASSPHRASE;"
        },
        {
          "file_path": "/src/lib/components/views/auth/PasswordLogin.js",
          "match_lines": [
            61,
            61
          ],
          "match_position": [
            3,
            47
          ],
          "match_string": "  LoginField[\"Password\"] = \"login_field_phone\";"
        },
        {
          "file_path": "/src/lib/components/views/auth/RegistrationForm.js",
          "match_lines": [
            62,
            62
          ],
          "match_position": [
            3,
            51
          ],
          "match_string": "  RegistrationField[\"Password\"] = \"field_password\";"
        },
        {
          "file_path": "/src/lib/components/views/auth/RegistrationForm.js",
          "match_lines": [
            63,
            63
          ],
          "match_position": [
            3,
            66
          ],
          "match_string": "  RegistrationField[\"PasswordConfirm\"] = \"field_password_confirm\";"
        }
      ],
      "metadata": {
        "cwe": "CWE-798: Use of Hard-coded Credentials",
        "description": "A hardcoded password in plain text is identified. Store it properly in an environment variable.",
        "owasp": "A3: Sensitive Data Exposure",
        "severity": "ERROR"
      }
    },
    "node_username": {
      "files": [
        {
          "file_path": "/src/src/components/views/elements/Pill.js",
          "match_lines": [
            39,
            39
          ],
          "match_position": [
            12,
            51
          ],
          "match_string": "    static TYPE_USER_MENTION = 'TYPE_USER_MENTION';"
        },
        {
          "file_path": "/src/src/components/views/dialogs/UserSettingsDialog.js",
          "match_lines": [
            37,
            37
          ],
          "match_position": [
            14,
            51
          ],
          "match_string": "export const USER_GENERAL_TAB = \"USER_GENERAL_TAB\";"
        },
        {
          "file_path": "/src/src/components/views/dialogs/UserSettingsDialog.js",
          "match_lines": [
            38,
            38
          ],
          "match_position": [
            14,
            57
          ],
          "match_string": "export const USER_APPEARANCE_TAB = \"USER_APPEARANCE_TAB\";"
        },
        {
          "file_path": "/src/src/components/views/dialogs/UserSettingsDialog.js",
          "match_lines": [
            39,
            39
          ],
          "match_position": [
            14,
            47
          ],
          "match_string": "export const USER_FLAIR_TAB = \"USER_FLAIR_TAB\";"
        },
        {
          "file_path": "/src/src/components/views/dialogs/UserSettingsDialog.js",
          "match_lines": [
            40,
            40
          ],
          "match_position": [
            14,
            63
          ],
          "match_string": "export const USER_NOTIFICATIONS_TAB = \"USER_NOTIFICATIONS_TAB\";"
        },
        {
          "file_path": "/src/src/components/views/dialogs/UserSettingsDialog.js",
          "match_lines": [
            41,
            41
          ],
          "match_position": [
            14,
            59
          ],
          "match_string": "export const USER_PREFERENCES_TAB = \"USER_PREFERENCES_TAB\";"
        },
        {
          "file_path": "/src/src/components/views/dialogs/UserSettingsDialog.js",
          "match_lines": [
            42,
            42
          ],
          "match_position": [
            14,
            47
          ],
          "match_string": "export const USER_VOICE_TAB = \"USER_VOICE_TAB\";"
        },
        {
          "file_path": "/src/src/components/views/dialogs/UserSettingsDialog.js",
          "match_lines": [
            43,
            43
          ],
          "match_position": [
            14,
            53
          ],
          "match_string": "export const USER_SECURITY_TAB = \"USER_SECURITY_TAB\";"
        },
        {
          "file_path": "/src/src/components/views/dialogs/UserSettingsDialog.js",
          "match_lines": [
            44,
            44
          ],
          "match_position": [
            14,
            45
          ],
          "match_string": "export const USER_LABS_TAB = \"USER_LABS_TAB\";"
        },
        {
          "file_path": "/src/src/components/views/dialogs/UserSettingsDialog.js",
          "match_lines": [
            45,
            45
          ],
          "match_position": [
            14,
            51
          ],
          "match_string": "export const USER_MJOLNIR_TAB = \"USER_MJOLNIR_TAB\";"
        },
        {
          "file_path": "/src/src/components/views/dialogs/UserSettingsDialog.js",
          "match_lines": [
            46,
            46
          ],
          "match_position": [
            14,
            45
          ],
          "match_string": "export const USER_HELP_TAB = \"USER_HELP_TAB\";"
        },
        {
          "file_path": "/src/lib/rageshake/submit-rageshake.js",
          "match_lines": [
            66,
            66
          ],
          "match_position": [
            7,
            28
          ],
          "match_string": "  let userAgent = \"UNKNOWN\";"
        },
        {
          "file_path": "/src/lib/components/views/dialogs/UserSettingsDialog.js",
          "match_lines": [
            66,
            66
          ],
          "match_position": [
            7,
            44
          ],
          "match_string": "const USER_GENERAL_TAB = \"USER_GENERAL_TAB\";"
        },
        {
          "file_path": "/src/lib/components/views/dialogs/UserSettingsDialog.js",
          "match_lines": [
            67,
            67
          ],
          "match_position": [
            1,
            44
          ],
          "match_string": "exports.USER_GENERAL_TAB = USER_GENERAL_TAB;"
        },
        {
          "file_path": "/src/lib/components/views/dialogs/UserSettingsDialog.js",
          "match_lines": [
            68,
            68
          ],
          "match_position": [
            7,
            50
          ],
          "match_string": "const USER_APPEARANCE_TAB = \"USER_APPEARANCE_TAB\";"
        },
        {
          "file_path": "/src/lib/components/views/dialogs/UserSettingsDialog.js",
          "match_lines": [
            69,
            69
          ],
          "match_position": [
            1,
            50
          ],
          "match_string": "exports.USER_APPEARANCE_TAB = USER_APPEARANCE_TAB;"
        },
        {
          "file_path": "/src/lib/components/views/dialogs/UserSettingsDialog.js",
          "match_lines": [
            70,
            70
          ],
          "match_position": [
            7,
            40
          ],
          "match_string": "const USER_FLAIR_TAB = \"USER_FLAIR_TAB\";"
        },
        {
          "file_path": "/src/lib/components/views/dialogs/UserSettingsDialog.js",
          "match_lines": [
            71,
            71
          ],
          "match_position": [
            1,
            40
          ],
          "match_string": "exports.USER_FLAIR_TAB = USER_FLAIR_TAB;"
        },
        {
          "file_path": "/src/lib/components/views/dialogs/UserSettingsDialog.js",
          "match_lines": [
            72,
            72
          ],
          "match_position": [
            7,
            56
          ],
          "match_string": "const USER_NOTIFICATIONS_TAB = \"USER_NOTIFICATIONS_TAB\";"
        },
        {
          "file_path": "/src/lib/components/views/dialogs/UserSettingsDialog.js",
          "match_lines": [
            73,
            73
          ],
          "match_position": [
            1,
            56
          ],
          "match_string": "exports.USER_NOTIFICATIONS_TAB = USER_NOTIFICATIONS_TAB;"
        },
        {
          "file_path": "/src/lib/components/views/dialogs/UserSettingsDialog.js",
          "match_lines": [
            74,
            74
          ],
          "match_position": [
            7,
            52
          ],
          "match_string": "const USER_PREFERENCES_TAB = \"USER_PREFERENCES_TAB\";"
        },
        {
          "file_path": "/src/lib/components/views/dialogs/UserSettingsDialog.js",
          "match_lines": [
            75,
            75
          ],
          "match_position": [
            1,
            52
          ],
          "match_string": "exports.USER_PREFERENCES_TAB = USER_PREFERENCES_TAB;"
        },
        {
          "file_path": "/src/lib/components/views/dialogs/UserSettingsDialog.js",
          "match_lines": [
            76,
            76
          ],
          "match_position": [
            7,
            40
          ],
          "match_string": "const USER_VOICE_TAB = \"USER_VOICE_TAB\";"
        },
        {
          "file_path": "/src/lib/components/views/dialogs/UserSettingsDialog.js",
          "match_lines": [
            77,
            77
          ],
          "match_position": [
            1,
            40
          ],
          "match_string": "exports.USER_VOICE_TAB = USER_VOICE_TAB;"
        },
        {
          "file_path": "/src/lib/components/views/dialogs/UserSettingsDialog.js",
          "match_lines": [
            78,
            78
          ],
          "match_position": [
            7,
            46
          ],
          "match_string": "const USER_SECURITY_TAB = \"USER_SECURITY_TAB\";"
        },
        {
          "file_path": "/src/lib/components/views/dialogs/UserSettingsDialog.js",
          "match_lines": [
            79,
            79
          ],
          "match_position": [
            1,
            46
          ],
          "match_string": "exports.USER_SECURITY_TAB = USER_SECURITY_TAB;"
        },
        {
          "file_path": "/src/lib/components/views/dialogs/UserSettingsDialog.js",
          "match_lines": [
            80,
            80
          ],
          "match_position": [
            7,
            38
          ],
          "match_string": "const USER_LABS_TAB = \"USER_LABS_TAB\";"
        },
        {
          "file_path": "/src/lib/components/views/dialogs/UserSettingsDialog.js",
          "match_lines": [
            81,
            81
          ],
          "match_position": [
            1,
            38
          ],
          "match_string": "exports.USER_LABS_TAB = USER_LABS_TAB;"
        },
        {
          "file_path": "/src/lib/components/views/dialogs/UserSettingsDialog.js",
          "match_lines": [
            82,
            82
          ],
          "match_position": [
            7,
            44
          ],
          "match_string": "const USER_MJOLNIR_TAB = \"USER_MJOLNIR_TAB\";"
        },
        {
          "file_path": "/src/lib/components/views/dialogs/UserSettingsDialog.js",
          "match_lines": [
            83,
            83
          ],
          "match_position": [
            1,
            44
          ],
          "match_string": "exports.USER_MJOLNIR_TAB = USER_MJOLNIR_TAB;"
        },
        {
          "file_path": "/src/lib/components/views/dialogs/UserSettingsDialog.js",
          "match_lines": [
            84,
            84
          ],
          "match_position": [
            7,
            38
          ],
          "match_string": "const USER_HELP_TAB = \"USER_HELP_TAB\";"
        },
        {
          "file_path": "/src/lib/components/views/dialogs/UserSettingsDialog.js",
          "match_lines": [
            85,
            85
          ],
          "match_position": [
            1,
            38
          ],
          "match_string": "exports.USER_HELP_TAB = USER_HELP_TAB;"
        },
        {
          "file_path": "/src/lib/components/structures/TimelinePanel.js",
          "match_lines": [
            1114,
            1114
          ],
          "match_position": [
            9,
            33
          ],
          "match_string": "    let userMembership = \"leave\";"
        },
        {
          "file_path": "/src/src/mjolnir/BanList.js",
          "match_lines": [
            22,
            22
          ],
          "match_position": [
            14,
            44
          ],
          "match_string": "export const RULE_USER = \"m.room.rule.user\";"
        },
        {
          "file_path": "/src/src/components/structures/TimelinePanel.js",
          "match_lines": [
            1174,
            1174
          ],
          "match_position": [
            13,
            37
          ],
          "match_string": "        let userMembership = \"leave\";"
        },
        {
          "file_path": "/src/lib/mjolnir/BanList.js",
          "match_lines": [
            33,
            33
          ],
          "match_position": [
            7,
            37
          ],
          "match_string": "const RULE_USER = \"m.room.rule.user\";"
        },
        {
          "file_path": "/src/lib/mjolnir/BanList.js",
          "match_lines": [
            34,
            34
          ],
          "match_position": [
            1,
            30
          ],
          "match_string": "exports.RULE_USER = RULE_USER;"
        },
        {
          "file_path": "/src/lib/editor/parts.js",
          "match_lines": [
            41,
            41
          ],
          "match_position": [
            3,
            33
          ],
          "match_string": "  Type[\"UserPill\"] = \"user-pill\";"
        },
        {
          "file_path": "/src/lib/dispatcher/actions.js",
          "match_lines": [
            30,
            30
          ],
          "match_position": [
            3,
            35
          ],
          "match_string": "  Action[\"ViewUser\"] = \"view_user\";"
        },
        {
          "file_path": "/src/lib/dispatcher/actions.js",
          "match_lines": [
            31,
            31
          ],
          "match_position": [
            3,
            52
          ],
          "match_string": "  Action[\"ViewUserSettings\"] = \"view_user_settings\";"
        },
        {
          "file_path": "/src/lib/dispatcher/actions.js",
          "match_lines": [
            36,
            36
          ],
          "match_position": [
            3,
            48
          ],
          "match_string": "  Action[\"ToggleUserMenu\"] = \"toggle_user_menu\";"
        },
        {
          "file_path": "/src/lib/components/views/auth/RegistrationForm.js",
          "match_lines": [
            61,
            61
          ],
          "match_position": [
            3,
            51
          ],
          "match_string": "  RegistrationField[\"Username\"] = \"field_username\";"
        }
      ],
      "metadata": {
        "cwe": "CWE-798: Use of Hard-coded Credentials",
        "description": "A hardcoded username in plain text is identified. Store it properly in an environment variable.",
        "owasp": "A3: Sensitive Data Exposure",
        "severity": "ERROR"
      }
    },
    "regex_dos": {
      "files": [
        {
          "file_path": "/src/src/utils/permalinks/Permalinks.js",
          "match_lines": [
            439,
            439
          ],
          "match_position": [
            32,
            48
          ],
          "match_string": "    return regexps.filter(h => h.test(hostname)).length > 0;"
        },
        {
          "file_path": "/src/lib/utils/permalinks/Permalinks.js",
          "match_lines": [
            528,
            528
          ],
          "match_position": [
            30,
            46
          ],
          "match_string": "  return regexps.filter(h => h.test(hostname)).length > 0;"
        },
        {
          "file_path": "/src/src/components/structures/RoomDirectory.js",
          "match_lines": [
            588,
            588
          ],
          "match_position": [
            16,
            27
          ],
          "match_string": "        return pat.test(s);"
        },
        {
          "file_path": "/src/lib/autocomplete/CommunityProvider.js",
          "match_lines": [
            81,
            81
          ],
          "match_position": [
            9,
            40
          ],
          "match_string": "    if (/^(\\/join|\\/leave)/.test(query)) {"
        }
      ],
      "metadata": {
        "cwe": "CWE-185: Incorrect Regular Expression",
        "description": "Ensure that the regex used to compare with user supplied input is safe from regular expression denial of service.",
        "owasp": "A6: Security Misconfiguration",
        "severity": "WARNING"
      }
    }
  },
  "templates": {}
}