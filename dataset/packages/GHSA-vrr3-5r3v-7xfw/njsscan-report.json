{
  "errors": [
    {
      "code": 3,
      "help": "If the code appears to be valid, this may be a semgrep bug.",
      "level": "warn",
      "long_msg": "Could not parse Makefile as typescript",
      "short_msg": "parse error",
      "spans": [
        {
          "context_end": null,
          "context_start": null,
          "end": {
            "col": 2,
            "line": 1
          },
          "file": "/src/docs/Makefile",
          "source_hash": "79116c796cee45048d9a7d27b6aa247ab370ad119933c231bec06fe5151be9ab",
          "start": {
            "col": 1,
            "line": 1
          }
        }
      ],
      "type": "SourceParseError"
    },
    {
      "code": 3,
      "help": "If the code appears to be valid, this may be a semgrep bug.",
      "level": "warn",
      "long_msg": "Could not parse .eslintignore as typescript",
      "short_msg": "parse error",
      "spans": [
        {
          "context_end": null,
          "context_start": null,
          "end": {
            "col": 113,
            "line": 5
          },
          "file": "/src/.eslintignore",
          "source_hash": "b8296f78081c7ec17c84bfd0449145da796060a2b913838e51e01dfd20ebbdca",
          "start": {
            "col": 1,
            "line": 5
          }
        }
      ],
      "type": "SourceParseError"
    },
    {
      "code": 9,
      "level": "warn",
      "path": "/src/modules/casper.js",
      "rule_id": "usr.local.lib.python3.8.site-packages.njsscan.rules.semantic_grep.ssrf.node_ssrf",
      "type": "MatchTimeoutError"
    },
    {
      "code": 3,
      "help": "If the code appears to be valid, this may be a semgrep bug.",
      "level": "warn",
      "long_msg": "Could not parse syntax.js as javascript",
      "short_msg": "parse error",
      "spans": [
        {
          "context_end": null,
          "context_start": null,
          "end": {
            "col": 8,
            "line": 1
          },
          "file": "/src/tests/clitests/error/syntax.js",
          "source_hash": "4540a156d1799bb65db77ba65736b7778567fac44fd14772755bf57f1cd4168e",
          "start": {
            "col": 1,
            "line": 1
          }
        }
      ],
      "type": "SourceParseError"
    },
    {
      "code": 3,
      "help": "If the code appears to be valid, this may be a semgrep bug.",
      "level": "warn",
      "long_msg": "Could not parse .npmignore as javascript",
      "short_msg": "parse error",
      "spans": [
        {
          "context_end": null,
          "context_start": null,
          "end": {
            "col": 2,
            "line": 1
          },
          "file": "/src/.npmignore",
          "source_hash": "a23ae216c1c1d787d7d87003c025aecd675be6a060f488e7c203c6172b14db5a",
          "start": {
            "col": 1,
            "line": 1
          }
        }
      ],
      "type": "SourceParseError"
    },
    {
      "code": 3,
      "help": "If the code appears to be valid, this may be a semgrep bug.",
      "level": "warn",
      "long_msg": "Could not parse .npmignore as typescript",
      "short_msg": "parse error",
      "spans": [
        {
          "context_end": null,
          "context_start": null,
          "end": {
            "col": 2,
            "line": 1
          },
          "file": "/src/.npmignore",
          "source_hash": "a23ae216c1c1d787d7d87003c025aecd675be6a060f488e7c203c6172b14db5a",
          "start": {
            "col": 1,
            "line": 1
          }
        }
      ],
      "type": "SourceParseError"
    },
    {
      "code": 3,
      "help": "If the code appears to be valid, this may be a semgrep bug.",
      "level": "warn",
      "long_msg": "Could not parse build as typescript",
      "short_msg": "parse error",
      "spans": [
        {
          "context_end": null,
          "context_start": null,
          "end": {
            "col": 39,
            "line": 2
          },
          "file": "/src/rpm/build",
          "source_hash": "6a67bab48eae22998d9d9545ba7458b7305714649c8806c9091fa1c5c4cb2a50",
          "start": {
            "col": 1,
            "line": 2
          }
        }
      ],
      "type": "SourceParseError"
    },
    {
      "code": 3,
      "help": "If the code appears to be valid, this may be a semgrep bug.",
      "level": "warn",
      "long_msg": "Could not parse .eslintignore as javascript",
      "short_msg": "parse error",
      "spans": [
        {
          "context_end": null,
          "context_start": null,
          "end": {
            "col": 113,
            "line": 5
          },
          "file": "/src/.eslintignore",
          "source_hash": "b8296f78081c7ec17c84bfd0449145da796060a2b913838e51e01dfd20ebbdca",
          "start": {
            "col": 1,
            "line": 5
          }
        }
      ],
      "type": "SourceParseError"
    },
    {
      "code": 9,
      "level": "warn",
      "path": "/src/modules/tester.js",
      "rule_id": "usr.local.lib.python3.8.site-packages.njsscan.rules.semantic_grep.dos.regex_dos",
      "type": "MatchTimeoutError"
    },
    {
      "code": 3,
      "help": "If the code appears to be valid, this may be a semgrep bug.",
      "level": "warn",
      "long_msg": "Could not parse Makefile as javascript",
      "short_msg": "parse error",
      "spans": [
        {
          "context_end": null,
          "context_start": null,
          "end": {
            "col": 2,
            "line": 1
          },
          "file": "/src/Makefile",
          "source_hash": "167984c6385662352935a1657c58315e91c9b8ff6d545755a31cd6bbc2d1328c",
          "start": {
            "col": 1,
            "line": 1
          }
        }
      ],
      "type": "SourceParseError"
    },
    {
      "code": 9,
      "level": "warn",
      "path": "/src/modules/tester.js",
      "rule_id": "usr.local.lib.python3.8.site-packages.njsscan.rules.semantic_grep.xss.express_xss",
      "type": "MatchTimeoutError"
    },
    {
      "code": 3,
      "help": "If the code appears to be valid, this may be a semgrep bug.",
      "level": "warn",
      "long_msg": "Could not parse Makefile as javascript",
      "short_msg": "parse error",
      "spans": [
        {
          "context_end": null,
          "context_start": null,
          "end": {
            "col": 2,
            "line": 1
          },
          "file": "/src/docs/Makefile",
          "source_hash": "79116c796cee45048d9a7d27b6aa247ab370ad119933c231bec06fe5151be9ab",
          "start": {
            "col": 1,
            "line": 1
          }
        }
      ],
      "type": "SourceParseError"
    },
    {
      "code": 3,
      "help": "If the code appears to be valid, this may be a semgrep bug.",
      "level": "warn",
      "long_msg": "Could not parse casperjs as typescript",
      "short_msg": "parse error",
      "spans": [
        {
          "context_end": null,
          "context_start": null,
          "end": {
            "col": 32,
            "line": 3
          },
          "file": "/src/bin/casperjs",
          "source_hash": "2aec7e39c8910671becc08e54844ad04052bb13498a0dcff8c151be0871b603a",
          "start": {
            "col": 1,
            "line": 3
          }
        }
      ],
      "type": "SourceParseError"
    },
    {
      "code": 9,
      "level": "warn",
      "path": "/src/modules/casper.js",
      "rule_id": "usr.local.lib.python3.8.site-packages.njsscan.rules.semantic_grep.headers.cookie_session_default",
      "type": "MatchTimeoutError"
    },
    {
      "code": 9,
      "level": "warn",
      "path": "/src/modules/tester.js",
      "rule_id": "usr.local.lib.python3.8.site-packages.njsscan.rules.semantic_grep.headers.cookie_session_no_path",
      "type": "MatchTimeoutError"
    },
    {
      "code": 3,
      "help": "If the code appears to be valid, this may be a semgrep bug.",
      "level": "warn",
      "long_msg": "Could not parse casperjs as javascript",
      "short_msg": "parse error",
      "spans": [
        {
          "context_end": null,
          "context_start": null,
          "end": {
            "col": 32,
            "line": 3
          },
          "file": "/src/bin/casperjs",
          "source_hash": "2aec7e39c8910671becc08e54844ad04052bb13498a0dcff8c151be0871b603a",
          "start": {
            "col": 1,
            "line": 3
          }
        }
      ],
      "type": "SourceParseError"
    },
    {
      "code": 3,
      "help": "If the code appears to be valid, this may be a semgrep bug.",
      "level": "warn",
      "long_msg": "Could not parse build as javascript",
      "short_msg": "parse error",
      "spans": [
        {
          "context_end": null,
          "context_start": null,
          "end": {
            "col": 1224,
            "line": 1
          },
          "file": "/src/rpm/build",
          "source_hash": "6a67bab48eae22998d9d9545ba7458b7305714649c8806c9091fa1c5c4cb2a50",
          "start": {
            "col": 1,
            "line": 1
          }
        }
      ],
      "type": "SourceParseError"
    },
    {
      "code": 9,
      "level": "warn",
      "path": "/src/modules/casper.js",
      "rule_id": "usr.local.lib.python3.8.site-packages.njsscan.rules.semantic_grep.ssrf.phantom_ssrf",
      "type": "MatchTimeoutError"
    },
    {
      "code": 3,
      "help": "If the code appears to be valid, this may be a semgrep bug.",
      "level": "warn",
      "long_msg": "Could not parse Makefile as typescript",
      "short_msg": "parse error",
      "spans": [
        {
          "context_end": null,
          "context_start": null,
          "end": {
            "col": 2,
            "line": 1
          },
          "file": "/src/Makefile",
          "source_hash": "167984c6385662352935a1657c58315e91c9b8ff6d545755a31cd6bbc2d1328c",
          "start": {
            "col": 1,
            "line": 1
          }
        }
      ],
      "type": "SourceParseError"
    }
  ],
  "njsscan_version": "0.2.8",
  "nodejs": {
    "express_xss": {
      "files": [
        {
          "file_path": "/src/tests/suites/casper/headers.js",
          "match_lines": [
            11,
            11
          ],
          "match_position": [
            9,
            63
          ],
          "match_string": "        response.write(\"ok \" + request.headers[\"User-Agent\"] );"
        },
        {
          "file_path": "/src/tests/selftest.js",
          "match_lines": [
            29,
            61
          ],
          "match_position": [
            5,
            6
          ],
          "match_string": "    var requestPath = request.url;\n    if (requestPath.indexOf('?') !== -1) {\n        requestPath = request.url.split('?')[0];\n    }\n    var pageFile = fs.pathJoin(phantom.casperPath, requestPath);\n    if (!fs.exists(pageFile) || !fs.isFile(pageFile)) {\n        response.statusCode = 404;\n        console.log(utils.format('Test server url not found: %s (file: %s)', request.url, pageFile), \"warning\");\n        response.write(\"404 - NOT FOUND\");\n    } else {\n        var headers = {};\n        var binMode;\n\n        var extension = extensionRE.exec(pageFile);\n        extension = extension && extension[1];\n        var contentType = contentTypes[extension] ||\n                          contentTypes._default;\n\n        if (contentType.type) {\n            headers['Content-Type'] = contentType.type;\n        }\n        binMode = contentType.binMode;\n\n        response.writeHead(200, headers);\n\n        if (binMode) {\n            response.setEncoding(\"binary\");\n            response.write(fs.read(pageFile, 'b'));\n        }\n        else {\n            response.write(fs.read(pageFile));\n        }\n    }"
        }
      ],
      "metadata": {
        "cwe": "CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')",
        "description": "Untrusted User Input in Response will result in Reflected Cross Site Scripting Vulnerability.",
        "owasp": "A1: Injection",
        "severity": "ERROR"
      }
    },
    "generic_error_disclosure": {
      "files": [
        {
          "file_path": "/src/modules/events.js",
          "match_lines": [
            187,
            187
          ],
          "match_position": [
            17,
            32
          ],
          "match_string": "                console.trace();"
        },
        {
          "file_path": "/src/modules/events.js",
          "match_lines": [
            242,
            242
          ],
          "match_position": [
            17,
            32
          ],
          "match_string": "                console.trace();"
        }
      ],
      "metadata": {
        "cwe": "CWE-209: Generation of Error Message Containing Sensitive Information",
        "description": "Error messages with stack traces may expose sensitive information about the application.",
        "owasp": "A3: Sensitive Data Exposure",
        "severity": "WARNING"
      }
    }
  },
  "templates": {}
}