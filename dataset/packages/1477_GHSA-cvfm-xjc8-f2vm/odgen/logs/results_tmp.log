|checker| success id$0$color:green$: 
==========================
$FilePath$/home/tiago/empirical-jsvuln-tools-study/framework/src/packages/CWE-400/1477/package/lib/index.js
Line 481	internals.Counter = function (options) {

    Stream.Transform.call(this);
    this.bytes = 0;
    this._maxBytes = options.maxBytes;
};
$FilePath$/home/tiago/empirical-jsvuln-tools-study/framework/src/packages/CWE-400/1477/package/lib/index.js
Line 488	Hoek.inherits(internals.Counter, Stream.Transform);
$FilePath$/home/tiago/empirical-jsvuln-tools-study/framework/src/packages/CWE-400/1477/package/lib/index.js
Line 28	    Hoek.assert(options.parse !== undefined, 'Missing parse option setting');
$FilePath$/home/tiago/empirical-jsvuln-tools-study/framework/src/packages/CWE-400/1477/package/lib/index.js
Line 64	    const contentType = Content.type(this.settings.override || req.headers['content-type'] || this.settings.defaultContentType || 'application/octet-stream');
$FilePath$/home/tiago/empirical-jsvuln-tools-study/framework/src/packages/CWE-400/1477/package/lib/index.js
Line 305	    const dispenserOptions = Hoek.applyToDefaults(contentType, { maxBytes: this.settings.maxBytes });
$FilePath$/home/tiago/empirical-jsvuln-tools-study/framework/src/packages/CWE-400/1477/package/lib/index.js
Line 446	    const path = Hoek.uniqueFilename(this.settings.uploads || Os.tmpdir());
$FilePath$/home/tiago/empirical-jsvuln-tools-study/framework/src/packages/CWE-400/1477/package/lib/index.js
Line 447	    const file = Fs.createWriteStream(path, { flags: 'wx' });
$FilePath$/home/tiago/empirical-jsvuln-tools-study/framework/src/packages/CWE-400/1477/package/lib/index.js
Line 513	    return from.pipe(to);

|checker| success id$1$color:green$: 
==========================
$FilePath$/home/tiago/empirical-jsvuln-tools-study/framework/src/packages/CWE-400/1477/package/lib/index.js
Line 481	internals.Counter = function (options) {

    Stream.Transform.call(this);
    this.bytes = 0;
    this._maxBytes = options.maxBytes;
};
$FilePath$/home/tiago/empirical-jsvuln-tools-study/framework/src/packages/CWE-400/1477/package/lib/index.js
Line 488	Hoek.inherits(internals.Counter, Stream.Transform);
$FilePath$/home/tiago/empirical-jsvuln-tools-study/framework/src/packages/CWE-400/1477/package/lib/index.js
Line 28	    Hoek.assert(options.parse !== undefined, 'Missing parse option setting');
$FilePath$/home/tiago/empirical-jsvuln-tools-study/framework/src/packages/CWE-400/1477/package/lib/index.js
Line 64	    const contentType = Content.type(this.settings.override || req.headers['content-type'] || this.settings.defaultContentType || 'application/octet-stream');
$FilePath$/home/tiago/empirical-jsvuln-tools-study/framework/src/packages/CWE-400/1477/package/lib/index.js
Line 305	    const dispenserOptions = Hoek.applyToDefaults(contentType, { maxBytes: this.settings.maxBytes });
$FilePath$/home/tiago/empirical-jsvuln-tools-study/framework/src/packages/CWE-400/1477/package/lib/index.js
Line 306	    const dispenser = new Pez.Dispenser(dispenserOptions);
$FilePath$/home/tiago/empirical-jsvuln-tools-study/framework/src/packages/CWE-400/1477/package/lib/index.js
Line 513	    return from.pipe(to);

|checker| success id$2$color:green$: 
==========================
$FilePath$/home/tiago/empirical-jsvuln-tools-study/framework/src/packages/CWE-400/1477/package/lib/index.js
Line 481	internals.Counter = function (options) {

    Stream.Transform.call(this);
    this.bytes = 0;
    this._maxBytes = options.maxBytes;
};
$FilePath$/home/tiago/empirical-jsvuln-tools-study/framework/src/packages/CWE-400/1477/package/lib/index.js
Line 488	Hoek.inherits(internals.Counter, Stream.Transform);
$FilePath$/home/tiago/empirical-jsvuln-tools-study/framework/src/packages/CWE-400/1477/package/lib/index.js
Line 28	    Hoek.assert(options.parse !== undefined, 'Missing parse option setting');
$FilePath$/home/tiago/empirical-jsvuln-tools-study/framework/src/packages/CWE-400/1477/package/lib/index.js
Line 446	    const path = Hoek.uniqueFilename(this.settings.uploads || Os.tmpdir());
$FilePath$/home/tiago/empirical-jsvuln-tools-study/framework/src/packages/CWE-400/1477/package/lib/index.js
Line 447	    const file = Fs.createWriteStream(path, { flags: 'wx' });
$FilePath$/home/tiago/empirical-jsvuln-tools-study/framework/src/packages/CWE-400/1477/package/lib/index.js
Line 513	    return from.pipe(to);

|checker| success id$3$color:green$: 
==========================
$FilePath$/home/tiago/empirical-jsvuln-tools-study/framework/src/packages/CWE-400/1477/package/lib/index.js
Line 25	exports.parse = function (req, tap, options, next) {

    Hoek.assert(options, 'Missing options');
    Hoek.assert(options.parse !== undefined, 'Missing parse option setting');
    Hoek.assert(options.output !== undefined, 'Missing output option setting');

    const parser = new internals.Parser(req, tap, options, next);
    return parser.read();
};
$FilePath$/home/tiago/empirical-jsvuln-tools-study/framework/src/packages/CWE-400/1477/package/lib/index.js
Line 64	    const contentType = Content.type(this.settings.override || req.headers['content-type'] || this.settings.defaultContentType || 'application/octet-stream');
$FilePath$/home/tiago/empirical-jsvuln-tools-study/framework/src/packages/CWE-400/1477/package/lib/index.js
Line 305	    const dispenserOptions = Hoek.applyToDefaults(contentType, { maxBytes: this.settings.maxBytes });
$FilePath$/home/tiago/empirical-jsvuln-tools-study/framework/src/packages/CWE-400/1477/package/lib/index.js
Line 446	    const path = Hoek.uniqueFilename(this.settings.uploads || Os.tmpdir());
$FilePath$/home/tiago/empirical-jsvuln-tools-study/framework/src/packages/CWE-400/1477/package/lib/index.js
Line 447	    const file = Fs.createWriteStream(path, { flags: 'wx' });
$FilePath$/home/tiago/empirical-jsvuln-tools-study/framework/src/packages/CWE-400/1477/package/lib/index.js
Line 513	    return from.pipe(to);

|checker| success id$4$color:green$: 
==========================
$FilePath$/home/tiago/empirical-jsvuln-tools-study/framework/src/packages/CWE-400/1477/package/lib/index.js
Line 54	    const contentLength = req.headers['content-length'];
$FilePath$/home/tiago/empirical-jsvuln-tools-study/framework/src/packages/CWE-400/1477/package/lib/index.js
Line 64	    const contentType = Content.type(this.settings.override || req.headers['content-type'] || this.settings.defaultContentType || 'application/octet-stream');
$FilePath$/home/tiago/empirical-jsvuln-tools-study/framework/src/packages/CWE-400/1477/package/lib/index.js
Line 305	    const dispenserOptions = Hoek.applyToDefaults(contentType, { maxBytes: this.settings.maxBytes });
$FilePath$/home/tiago/empirical-jsvuln-tools-study/framework/src/packages/CWE-400/1477/package/lib/index.js
Line 446	    const path = Hoek.uniqueFilename(this.settings.uploads || Os.tmpdir());
$FilePath$/home/tiago/empirical-jsvuln-tools-study/framework/src/packages/CWE-400/1477/package/lib/index.js
Line 447	    const file = Fs.createWriteStream(path, { flags: 'wx' });
$FilePath$/home/tiago/empirical-jsvuln-tools-study/framework/src/packages/CWE-400/1477/package/lib/index.js
Line 513	    return from.pipe(to);

|checker| success id$5$color:green$: 
==========================
$FilePath$/home/tiago/empirical-jsvuln-tools-study/framework/src/packages/CWE-400/1477/package/lib/index.js
Line 31	    const parser = new internals.Parser(req, tap, options, next);
$FilePath$/home/tiago/empirical-jsvuln-tools-study/framework/src/packages/CWE-400/1477/package/lib/index.js
Line 64	    const contentType = Content.type(this.settings.override || req.headers['content-type'] || this.settings.defaultContentType || 'application/octet-stream');
$FilePath$/home/tiago/empirical-jsvuln-tools-study/framework/src/packages/CWE-400/1477/package/lib/index.js
Line 305	    const dispenserOptions = Hoek.applyToDefaults(contentType, { maxBytes: this.settings.maxBytes });
$FilePath$/home/tiago/empirical-jsvuln-tools-study/framework/src/packages/CWE-400/1477/package/lib/index.js
Line 446	    const path = Hoek.uniqueFilename(this.settings.uploads || Os.tmpdir());
$FilePath$/home/tiago/empirical-jsvuln-tools-study/framework/src/packages/CWE-400/1477/package/lib/index.js
Line 447	    const file = Fs.createWriteStream(path, { flags: 'wx' });
$FilePath$/home/tiago/empirical-jsvuln-tools-study/framework/src/packages/CWE-400/1477/package/lib/index.js
Line 513	    return from.pipe(to);

|checker| success id$6$color:green$: 
==========================
$FilePath$/home/tiago/empirical-jsvuln-tools-study/framework/src/packages/CWE-400/1477/package/lib/index.js
Line 481	internals.Counter = function (options) {

    Stream.Transform.call(this);
    this.bytes = 0;
    this._maxBytes = options.maxBytes;
};
$FilePath$/home/tiago/empirical-jsvuln-tools-study/framework/src/packages/CWE-400/1477/package/lib/index.js
Line 488	Hoek.inherits(internals.Counter, Stream.Transform);
$FilePath$/home/tiago/empirical-jsvuln-tools-study/framework/src/packages/CWE-400/1477/package/lib/index.js
Line 305	    const dispenserOptions = Hoek.applyToDefaults(contentType, { maxBytes: this.settings.maxBytes });
$FilePath$/home/tiago/empirical-jsvuln-tools-study/framework/src/packages/CWE-400/1477/package/lib/index.js
Line 446	    const path = Hoek.uniqueFilename(this.settings.uploads || Os.tmpdir());
$FilePath$/home/tiago/empirical-jsvuln-tools-study/framework/src/packages/CWE-400/1477/package/lib/index.js
Line 447	    const file = Fs.createWriteStream(path, { flags: 'wx' });
$FilePath$/home/tiago/empirical-jsvuln-tools-study/framework/src/packages/CWE-400/1477/package/lib/index.js
Line 513	    return from.pipe(to);

|checker| success id$7$color:green$: 
==========================
$FilePath$/home/tiago/empirical-jsvuln-tools-study/framework/src/packages/CWE-400/1477/package/lib/index.js
Line 25	exports.parse = function (req, tap, options, next) {

    Hoek.assert(options, 'Missing options');
    Hoek.assert(options.parse !== undefined, 'Missing parse option setting');
    Hoek.assert(options.output !== undefined, 'Missing output option setting');

    const parser = new internals.Parser(req, tap, options, next);
    return parser.read();
};
$FilePath$/home/tiago/empirical-jsvuln-tools-study/framework/src/packages/CWE-400/1477/package/lib/index.js
Line 64	    const contentType = Content.type(this.settings.override || req.headers['content-type'] || this.settings.defaultContentType || 'application/octet-stream');
$FilePath$/home/tiago/empirical-jsvuln-tools-study/framework/src/packages/CWE-400/1477/package/lib/index.js
Line 305	    const dispenserOptions = Hoek.applyToDefaults(contentType, { maxBytes: this.settings.maxBytes });
$FilePath$/home/tiago/empirical-jsvuln-tools-study/framework/src/packages/CWE-400/1477/package/lib/index.js
Line 306	    const dispenser = new Pez.Dispenser(dispenserOptions);
$FilePath$/home/tiago/empirical-jsvuln-tools-study/framework/src/packages/CWE-400/1477/package/lib/index.js
Line 513	    return from.pipe(to);

|checker| success id$8$color:green$: 
==========================
$FilePath$/home/tiago/empirical-jsvuln-tools-study/framework/src/packages/CWE-400/1477/package/lib/index.js
Line 54	    const contentLength = req.headers['content-length'];
$FilePath$/home/tiago/empirical-jsvuln-tools-study/framework/src/packages/CWE-400/1477/package/lib/index.js
Line 64	    const contentType = Content.type(this.settings.override || req.headers['content-type'] || this.settings.defaultContentType || 'application/octet-stream');
$FilePath$/home/tiago/empirical-jsvuln-tools-study/framework/src/packages/CWE-400/1477/package/lib/index.js
Line 305	    const dispenserOptions = Hoek.applyToDefaults(contentType, { maxBytes: this.settings.maxBytes });
$FilePath$/home/tiago/empirical-jsvuln-tools-study/framework/src/packages/CWE-400/1477/package/lib/index.js
Line 306	    const dispenser = new Pez.Dispenser(dispenserOptions);
$FilePath$/home/tiago/empirical-jsvuln-tools-study/framework/src/packages/CWE-400/1477/package/lib/index.js
Line 513	    return from.pipe(to);

|checker| success id$9$color:green$: 
==========================
$FilePath$/home/tiago/empirical-jsvuln-tools-study/framework/src/packages/CWE-400/1477/package/lib/index.js
Line 31	    const parser = new internals.Parser(req, tap, options, next);
$FilePath$/home/tiago/empirical-jsvuln-tools-study/framework/src/packages/CWE-400/1477/package/lib/index.js
Line 64	    const contentType = Content.type(this.settings.override || req.headers['content-type'] || this.settings.defaultContentType || 'application/octet-stream');
$FilePath$/home/tiago/empirical-jsvuln-tools-study/framework/src/packages/CWE-400/1477/package/lib/index.js
Line 305	    const dispenserOptions = Hoek.applyToDefaults(contentType, { maxBytes: this.settings.maxBytes });
$FilePath$/home/tiago/empirical-jsvuln-tools-study/framework/src/packages/CWE-400/1477/package/lib/index.js
Line 306	    const dispenser = new Pez.Dispenser(dispenserOptions);
$FilePath$/home/tiago/empirical-jsvuln-tools-study/framework/src/packages/CWE-400/1477/package/lib/index.js
Line 513	    return from.pipe(to);

|checker| success id$10$color:green$: 
==========================
$FilePath$/home/tiago/empirical-jsvuln-tools-study/framework/src/packages/CWE-400/1477/package/lib/index.js
Line 481	internals.Counter = function (options) {

    Stream.Transform.call(this);
    this.bytes = 0;
    this._maxBytes = options.maxBytes;
};
$FilePath$/home/tiago/empirical-jsvuln-tools-study/framework/src/packages/CWE-400/1477/package/lib/index.js
Line 488	Hoek.inherits(internals.Counter, Stream.Transform);
$FilePath$/home/tiago/empirical-jsvuln-tools-study/framework/src/packages/CWE-400/1477/package/lib/index.js
Line 305	    const dispenserOptions = Hoek.applyToDefaults(contentType, { maxBytes: this.settings.maxBytes });
$FilePath$/home/tiago/empirical-jsvuln-tools-study/framework/src/packages/CWE-400/1477/package/lib/index.js
Line 306	    const dispenser = new Pez.Dispenser(dispenserOptions);
$FilePath$/home/tiago/empirical-jsvuln-tools-study/framework/src/packages/CWE-400/1477/package/lib/index.js
Line 513	    return from.pipe(to);

|checker| success id$11$color:green$: 
==========================
$FilePath$/home/tiago/empirical-jsvuln-tools-study/framework/src/packages/CWE-400/1477/package/lib/index.js
Line 481	internals.Counter = function (options) {

    Stream.Transform.call(this);
    this.bytes = 0;
    this._maxBytes = options.maxBytes;
};
$FilePath$/home/tiago/empirical-jsvuln-tools-study/framework/src/packages/CWE-400/1477/package/lib/index.js
Line 488	Hoek.inherits(internals.Counter, Stream.Transform);
$FilePath$/home/tiago/empirical-jsvuln-tools-study/framework/src/packages/CWE-400/1477/package/lib/index.js
Line 446	    const path = Hoek.uniqueFilename(this.settings.uploads || Os.tmpdir());
$FilePath$/home/tiago/empirical-jsvuln-tools-study/framework/src/packages/CWE-400/1477/package/lib/index.js
Line 447	    const file = Fs.createWriteStream(path, { flags: 'wx' });
$FilePath$/home/tiago/empirical-jsvuln-tools-study/framework/src/packages/CWE-400/1477/package/lib/index.js
Line 513	    return from.pipe(to);

|checker| success id$12$color:green$: 
==========================
$FilePath$/home/tiago/empirical-jsvuln-tools-study/framework/src/packages/CWE-400/1477/package/lib/index.js
Line 90	internals.Parser.prototype.parse = function (contentType) {

    let next = this.next;

    const output = this.settings.output;        // Output: 'data', 'stream', 'file'
    let source = this.req;

    // Content-encoding

    const contentEncoding = source.headers['content-encoding'];
    const decoder = (this.settings.decoders || internals.decoders)[contentEncoding];
    if (decoder) {
        const decoderOptions = (this.settings.compression && this.settings.compression[contentEncoding]) || null;
        const stream = decoder(decoderOptions);
        next = Hoek.once(next);                 // Modify next() for async events
        this.next = next;
        stream.once('error', (err) => {

            return next(Boom.badRequest('Invalid compressed payload', err));
        });

        source = internals.pipe(source, stream);
    }

    // Tap request

    if (this.tap) {
        source = internals.pipe(source, this.tap);
    }

    // Multipart

    if (this.result.contentType.mime === 'multipart/form-data') {
        if (this.settings.multipart === false) {                            // Defaults to true
            return next(Boom.unsupportedMediaType());
        }

        return this.multipart(source, contentType);
    }

    // Output: 'stream'

    if (output === 'stream') {
        this.result.payload = source;
        return next();
    }

    // Output: 'file'

    if (output === 'file') {
        this.writeFile(source, this.settings, (err, path, bytes) => {

            if (err) {
                return next(err);
            }

            this.result.payload = { path, bytes };
            return next();
        });

        return;
    }

    // Output: 'data'

    return Wreck.read(source, { timeout: this.settings.timeout, maxBytes: this.settings.maxBytes }, (err, payload) => {

        if (err) {
            return next(err);
        }

        this.object(payload, this.result.contentType.mime, (err, result) => {

            if (err) {
                this.result.payload = null;
                err.raw = payload;
                return next(err);
            }

            this.result.payload = result;
            return next();
        });
    });
};
$FilePath$/home/tiago/empirical-jsvuln-tools-study/framework/src/packages/CWE-400/1477/package/lib/index.js
Line 305	    const dispenserOptions = Hoek.applyToDefaults(contentType, { maxBytes: this.settings.maxBytes });
$FilePath$/home/tiago/empirical-jsvuln-tools-study/framework/src/packages/CWE-400/1477/package/lib/index.js
Line 446	    const path = Hoek.uniqueFilename(this.settings.uploads || Os.tmpdir());
$FilePath$/home/tiago/empirical-jsvuln-tools-study/framework/src/packages/CWE-400/1477/package/lib/index.js
Line 447	    const file = Fs.createWriteStream(path, { flags: 'wx' });
$FilePath$/home/tiago/empirical-jsvuln-tools-study/framework/src/packages/CWE-400/1477/package/lib/index.js
Line 513	    return from.pipe(to);

|checker| success id$13$color:green$: 
==========================
$FilePath$/home/tiago/empirical-jsvuln-tools-study/framework/src/packages/CWE-400/1477/package/lib/index.js
Line 294	internals.Parser.prototype.multipart = function (source, contentType) {

    let next = this.next;
    next = Hoek.once(next);                                            // Modify next() for async events
    this.next = next;

    // Set stream timeout

    const clientTimeout = this.settings.timeout;
    let clientTimeoutId = null;

    const dispenserOptions = Hoek.applyToDefaults(contentType, { maxBytes: this.settings.maxBytes });
    const dispenser = new Pez.Dispenser(dispenserOptions);

    const onError = (err) => {

        return next(Boom.badRequest('Invalid multipart payload format', err));
    };

    dispenser.once('error', onError);

    const data = {};
    const finalize = () => {

        clearTimeout(clientTimeoutId);
        dispenser.removeListener('error', onError);
        dispenser.removeListener('part', onPart);
        dispenser.removeListener('field', onField);
        dispenser.removeListener('close', onClose);

        this.result.payload = data;
        return next();
    };

    if (clientTimeout &&
        clientTimeout > 0) {

        clientTimeoutId = setTimeout(() => {

            return next(Boom.clientTimeout());
        }, clientTimeout);
    }

    const set = (name, value) => {

        if (!data.hasOwnProperty(name)) {
            data[name] = value;
        }
        else if (Array.isArray(data[name])) {
            data[name].push(value);
        }
        else {
            data[name] = [data[name], value];
        }
    };

    const pendingFiles = {};
    let nextId = 0;
    let closed = false;

    const output = (this.settings.multipart ? this.settings.multipart.output : this.settings.output);

    const onPart = (part) => {

        if (output === 'file') {                                                                // Output: 'file'
            const id = nextId++;
            pendingFiles[id] = true;
            this.writeFile(part, this.settings, (err, path, bytes) => {

                delete pendingFiles[id];

                if (err) {
                    return next(err);
                }

                const item = {
                    filename: part.filename,
                    path,
                    headers: part.headers,
                    bytes
                };

                set(part.name, item);

                /* $lab:coverage:off$ */
                if (closed &&
                    !Object.keys(pendingFiles).length) {

                    return finalize(data);
                }
                /* $lab:coverage:on$ */
            });
        }
        else {                                                                                  // Output: 'data'
            Wreck.read(part, {}, (ignoreErr, payload) => {

                // Error handled by dispenser.once('error')

                if (output === 'stream') {                                                      // Output: 'stream'
                    const item = Wreck.toReadableStream(payload);

                    item.hapi = {
                        filename: part.filename,
                        headers: part.headers
                    };

                    return set(part.name, item);
                }

                const ct = part.headers['content-type'] || '';
                const mime = ct.split(';')[0].trim().toLowerCase();
                const annotate = (value) => set(part.name, output === 'annotated' ? { filename: part.filename, headers: part.headers, payload: value } : value);

                if (!mime) {
                    return annotate(payload);
                }

                if (!payload.length) {
                    return annotate({});
                }

                this.object(payload, mime, (err, result) => annotate(err ? payload : result));
            });
        }
    };

    dispenser.on('part', onPart);

    const onField = (name, value) => set(name, value);

    dispenser.on('field', onField);

    const onClose = () => {

        /* $lab:coverage:off$ */
        if (Object.keys(pendingFiles).length) {
            closed = true;
            return;
        }
        /* $lab:coverage:on$ */

        return finalize(data);
    };

    dispenser.once('close', onClose);

    internals.pipe(source, dispenser);
};
$FilePath$/home/tiago/empirical-jsvuln-tools-study/framework/src/packages/CWE-400/1477/package/lib/index.js
Line 305	    const dispenserOptions = Hoek.applyToDefaults(contentType, { maxBytes: this.settings.maxBytes });
$FilePath$/home/tiago/empirical-jsvuln-tools-study/framework/src/packages/CWE-400/1477/package/lib/index.js
Line 446	    const path = Hoek.uniqueFilename(this.settings.uploads || Os.tmpdir());
$FilePath$/home/tiago/empirical-jsvuln-tools-study/framework/src/packages/CWE-400/1477/package/lib/index.js
Line 447	    const file = Fs.createWriteStream(path, { flags: 'wx' });
$FilePath$/home/tiago/empirical-jsvuln-tools-study/framework/src/packages/CWE-400/1477/package/lib/index.js
Line 513	    return from.pipe(to);

|checker| success id$14$color:green$: 
==========================
$FilePath$/home/tiago/empirical-jsvuln-tools-study/framework/src/packages/CWE-400/1477/package/lib/index.js
Line 42	    this.result = {};
$FilePath$/home/tiago/empirical-jsvuln-tools-study/framework/src/packages/CWE-400/1477/package/lib/index.js
Line 305	    const dispenserOptions = Hoek.applyToDefaults(contentType, { maxBytes: this.settings.maxBytes });
$FilePath$/home/tiago/empirical-jsvuln-tools-study/framework/src/packages/CWE-400/1477/package/lib/index.js
Line 446	    const path = Hoek.uniqueFilename(this.settings.uploads || Os.tmpdir());
$FilePath$/home/tiago/empirical-jsvuln-tools-study/framework/src/packages/CWE-400/1477/package/lib/index.js
Line 447	    const file = Fs.createWriteStream(path, { flags: 'wx' });
$FilePath$/home/tiago/empirical-jsvuln-tools-study/framework/src/packages/CWE-400/1477/package/lib/index.js
Line 513	    return from.pipe(to);

|checker| success id$15$color:green$: 
==========================
$FilePath$/home/tiago/empirical-jsvuln-tools-study/framework/src/packages/CWE-400/1477/package/lib/index.js
Line 388	            Wreck.read(part, {}, (ignoreErr, payload) => {

                // Error handled by dispenser.once('error')

                if (output === 'stream') {                                                      // Output: 'stream'
                    const item = Wreck.toReadableStream(payload);

                    item.hapi = {
                        filename: part.filename,
                        headers: part.headers
                    };

                    return set(part.name, item);
                }

                const ct = part.headers['content-type'] || '';
                const mime = ct.split(';')[0].trim().toLowerCase();
                const annotate = (value) => set(part.name, output === 'annotated' ? { filename: part.filename, headers: part.headers, payload: value } : value);

                if (!mime) {
                    return annotate(payload);
                }

                if (!payload.length) {
                    return annotate({});
                }

                this.object(payload, mime, (err, result) => annotate(err ? payload : result));
            });
$FilePath$/home/tiago/empirical-jsvuln-tools-study/framework/src/packages/CWE-400/1477/package/lib/index.js
Line 155	    return Wreck.read(source, { timeout: this.settings.timeout, maxBytes: this.settings.maxBytes }, (err, payload) => {

        if (err) {
            return next(err);
        }

        this.object(payload, this.result.contentType.mime, (err, result) => {

            if (err) {
                this.result.payload = null;
                err.raw = payload;
                return next(err);
            }

            this.result.payload = result;
            return next();
        });
    });
$FilePath$/home/tiago/empirical-jsvuln-tools-study/framework/src/packages/CWE-400/1477/package/lib/index.js
Line 446	    const path = Hoek.uniqueFilename(this.settings.uploads || Os.tmpdir());
$FilePath$/home/tiago/empirical-jsvuln-tools-study/framework/src/packages/CWE-400/1477/package/lib/index.js
Line 447	    const file = Fs.createWriteStream(path, { flags: 'wx' });
$FilePath$/home/tiago/empirical-jsvuln-tools-study/framework/src/packages/CWE-400/1477/package/lib/index.js
Line 513	    return from.pipe(to);

|checker| success id$16$color:green$: 
==========================
$FilePath$/home/tiago/empirical-jsvuln-tools-study/framework/src/packages/CWE-400/1477/package/lib/index.js
Line 42	    this.result = {};
$FilePath$/home/tiago/empirical-jsvuln-tools-study/framework/src/packages/CWE-400/1477/package/lib/index.js
Line 155	    return Wreck.read(source, { timeout: this.settings.timeout, maxBytes: this.settings.maxBytes }, (err, payload) => {

        if (err) {
            return next(err);
        }

        this.object(payload, this.result.contentType.mime, (err, result) => {

            if (err) {
                this.result.payload = null;
                err.raw = payload;
                return next(err);
            }

            this.result.payload = result;
            return next();
        });
    });
$FilePath$/home/tiago/empirical-jsvuln-tools-study/framework/src/packages/CWE-400/1477/package/lib/index.js
Line 446	    const path = Hoek.uniqueFilename(this.settings.uploads || Os.tmpdir());
$FilePath$/home/tiago/empirical-jsvuln-tools-study/framework/src/packages/CWE-400/1477/package/lib/index.js
Line 447	    const file = Fs.createWriteStream(path, { flags: 'wx' });
$FilePath$/home/tiago/empirical-jsvuln-tools-study/framework/src/packages/CWE-400/1477/package/lib/index.js
Line 513	    return from.pipe(to);

|checker| success id$17$color:green$: 
==========================
$FilePath$/home/tiago/empirical-jsvuln-tools-study/framework/src/packages/CWE-400/1477/package/lib/index.js
Line 90	internals.Parser.prototype.parse = function (contentType) {

    let next = this.next;

    const output = this.settings.output;        // Output: 'data', 'stream', 'file'
    let source = this.req;

    // Content-encoding

    const contentEncoding = source.headers['content-encoding'];
    const decoder = (this.settings.decoders || internals.decoders)[contentEncoding];
    if (decoder) {
        const decoderOptions = (this.settings.compression && this.settings.compression[contentEncoding]) || null;
        const stream = decoder(decoderOptions);
        next = Hoek.once(next);                 // Modify next() for async events
        this.next = next;
        stream.once('error', (err) => {

            return next(Boom.badRequest('Invalid compressed payload', err));
        });

        source = internals.pipe(source, stream);
    }

    // Tap request

    if (this.tap) {
        source = internals.pipe(source, this.tap);
    }

    // Multipart

    if (this.result.contentType.mime === 'multipart/form-data') {
        if (this.settings.multipart === false) {                            // Defaults to true
            return next(Boom.unsupportedMediaType());
        }

        return this.multipart(source, contentType);
    }

    // Output: 'stream'

    if (output === 'stream') {
        this.result.payload = source;
        return next();
    }

    // Output: 'file'

    if (output === 'file') {
        this.writeFile(source, this.settings, (err, path, bytes) => {

            if (err) {
                return next(err);
            }

            this.result.payload = { path, bytes };
            return next();
        });

        return;
    }

    // Output: 'data'

    return Wreck.read(source, { timeout: this.settings.timeout, maxBytes: this.settings.maxBytes }, (err, payload) => {

        if (err) {
            return next(err);
        }

        this.object(payload, this.result.contentType.mime, (err, result) => {

            if (err) {
                this.result.payload = null;
                err.raw = payload;
                return next(err);
            }

            this.result.payload = result;
            return next();
        });
    });
};
$FilePath$/home/tiago/empirical-jsvuln-tools-study/framework/src/packages/CWE-400/1477/package/lib/index.js
Line 305	    const dispenserOptions = Hoek.applyToDefaults(contentType, { maxBytes: this.settings.maxBytes });
$FilePath$/home/tiago/empirical-jsvuln-tools-study/framework/src/packages/CWE-400/1477/package/lib/index.js
Line 306	    const dispenser = new Pez.Dispenser(dispenserOptions);
$FilePath$/home/tiago/empirical-jsvuln-tools-study/framework/src/packages/CWE-400/1477/package/lib/index.js
Line 513	    return from.pipe(to);

|checker| success id$18$color:green$: 
==========================
$FilePath$/home/tiago/empirical-jsvuln-tools-study/framework/src/packages/CWE-400/1477/package/lib/index.js
Line 294	internals.Parser.prototype.multipart = function (source, contentType) {

    let next = this.next;
    next = Hoek.once(next);                                            // Modify next() for async events
    this.next = next;

    // Set stream timeout

    const clientTimeout = this.settings.timeout;
    let clientTimeoutId = null;

    const dispenserOptions = Hoek.applyToDefaults(contentType, { maxBytes: this.settings.maxBytes });
    const dispenser = new Pez.Dispenser(dispenserOptions);

    const onError = (err) => {

        return next(Boom.badRequest('Invalid multipart payload format', err));
    };

    dispenser.once('error', onError);

    const data = {};
    const finalize = () => {

        clearTimeout(clientTimeoutId);
        dispenser.removeListener('error', onError);
        dispenser.removeListener('part', onPart);
        dispenser.removeListener('field', onField);
        dispenser.removeListener('close', onClose);

        this.result.payload = data;
        return next();
    };

    if (clientTimeout &&
        clientTimeout > 0) {

        clientTimeoutId = setTimeout(() => {

            return next(Boom.clientTimeout());
        }, clientTimeout);
    }

    const set = (name, value) => {

        if (!data.hasOwnProperty(name)) {
            data[name] = value;
        }
        else if (Array.isArray(data[name])) {
            data[name].push(value);
        }
        else {
            data[name] = [data[name], value];
        }
    };

    const pendingFiles = {};
    let nextId = 0;
    let closed = false;

    const output = (this.settings.multipart ? this.settings.multipart.output : this.settings.output);

    const onPart = (part) => {

        if (output === 'file') {                                                                // Output: 'file'
            const id = nextId++;
            pendingFiles[id] = true;
            this.writeFile(part, this.settings, (err, path, bytes) => {

                delete pendingFiles[id];

                if (err) {
                    return next(err);
                }

                const item = {
                    filename: part.filename,
                    path,
                    headers: part.headers,
                    bytes
                };

                set(part.name, item);

                /* $lab:coverage:off$ */
                if (closed &&
                    !Object.keys(pendingFiles).length) {

                    return finalize(data);
                }
                /* $lab:coverage:on$ */
            });
        }
        else {                                                                                  // Output: 'data'
            Wreck.read(part, {}, (ignoreErr, payload) => {

                // Error handled by dispenser.once('error')

                if (output === 'stream') {                                                      // Output: 'stream'
                    const item = Wreck.toReadableStream(payload);

                    item.hapi = {
                        filename: part.filename,
                        headers: part.headers
                    };

                    return set(part.name, item);
                }

                const ct = part.headers['content-type'] || '';
                const mime = ct.split(';')[0].trim().toLowerCase();
                const annotate = (value) => set(part.name, output === 'annotated' ? { filename: part.filename, headers: part.headers, payload: value } : value);

                if (!mime) {
                    return annotate(payload);
                }

                if (!payload.length) {
                    return annotate({});
                }

                this.object(payload, mime, (err, result) => annotate(err ? payload : result));
            });
        }
    };

    dispenser.on('part', onPart);

    const onField = (name, value) => set(name, value);

    dispenser.on('field', onField);

    const onClose = () => {

        /* $lab:coverage:off$ */
        if (Object.keys(pendingFiles).length) {
            closed = true;
            return;
        }
        /* $lab:coverage:on$ */

        return finalize(data);
    };

    dispenser.once('close', onClose);

    internals.pipe(source, dispenser);
};
$FilePath$/home/tiago/empirical-jsvuln-tools-study/framework/src/packages/CWE-400/1477/package/lib/index.js
Line 305	    const dispenserOptions = Hoek.applyToDefaults(contentType, { maxBytes: this.settings.maxBytes });
$FilePath$/home/tiago/empirical-jsvuln-tools-study/framework/src/packages/CWE-400/1477/package/lib/index.js
Line 306	    const dispenser = new Pez.Dispenser(dispenserOptions);
$FilePath$/home/tiago/empirical-jsvuln-tools-study/framework/src/packages/CWE-400/1477/package/lib/index.js
Line 513	    return from.pipe(to);

|checker| success id$19$color:green$: 
==========================
$FilePath$/home/tiago/empirical-jsvuln-tools-study/framework/src/packages/CWE-400/1477/package/lib/index.js
Line 42	    this.result = {};
$FilePath$/home/tiago/empirical-jsvuln-tools-study/framework/src/packages/CWE-400/1477/package/lib/index.js
Line 305	    const dispenserOptions = Hoek.applyToDefaults(contentType, { maxBytes: this.settings.maxBytes });
$FilePath$/home/tiago/empirical-jsvuln-tools-study/framework/src/packages/CWE-400/1477/package/lib/index.js
Line 306	    const dispenser = new Pez.Dispenser(dispenserOptions);
$FilePath$/home/tiago/empirical-jsvuln-tools-study/framework/src/packages/CWE-400/1477/package/lib/index.js
Line 513	    return from.pipe(to);

|checker| success id$20$color:green$: 
==========================
$FilePath$/home/tiago/empirical-jsvuln-tools-study/framework/src/packages/CWE-400/1477/package/lib/index.js
Line 448	    const counter = new internals.Counter(options);
$FilePath$/home/tiago/empirical-jsvuln-tools-study/framework/src/packages/CWE-400/1477/package/lib/index.js
Line 446	    const path = Hoek.uniqueFilename(this.settings.uploads || Os.tmpdir());
$FilePath$/home/tiago/empirical-jsvuln-tools-study/framework/src/packages/CWE-400/1477/package/lib/index.js
Line 447	    const file = Fs.createWriteStream(path, { flags: 'wx' });
$FilePath$/home/tiago/empirical-jsvuln-tools-study/framework/src/packages/CWE-400/1477/package/lib/index.js
Line 513	    return from.pipe(to);

|checker| success id$21$color:green$: 
==========================
$FilePath$/home/tiago/empirical-jsvuln-tools-study/framework/src/packages/CWE-400/1477/package/lib/index.js
Line 25	exports.parse = function (req, tap, options, next) {

    Hoek.assert(options, 'Missing options');
    Hoek.assert(options.parse !== undefined, 'Missing parse option setting');
    Hoek.assert(options.output !== undefined, 'Missing output option setting');

    const parser = new internals.Parser(req, tap, options, next);
    return parser.read();
};
$FilePath$/home/tiago/empirical-jsvuln-tools-study/framework/src/packages/CWE-400/1477/package/lib/index.js
Line 446	    const path = Hoek.uniqueFilename(this.settings.uploads || Os.tmpdir());
$FilePath$/home/tiago/empirical-jsvuln-tools-study/framework/src/packages/CWE-400/1477/package/lib/index.js
Line 447	    const file = Fs.createWriteStream(path, { flags: 'wx' });
$FilePath$/home/tiago/empirical-jsvuln-tools-study/framework/src/packages/CWE-400/1477/package/lib/index.js
Line 513	    return from.pipe(to);

|checker| success id$22$color:green$: 
==========================
$FilePath$/home/tiago/empirical-jsvuln-tools-study/framework/src/packages/CWE-400/1477/package/lib/index.js
Line 444	internals.Parser.prototype.writeFile = function (stream, options, callback) {

    const path = Hoek.uniqueFilename(this.settings.uploads || Os.tmpdir());
    const file = Fs.createWriteStream(path, { flags: 'wx' });
    const counter = new internals.Counter(options);

    const finalize = Hoek.once((err) => {

        this.req.removeListener('aborted', onAbort);
        file.removeListener('close', finalize);
        file.removeListener('error', finalize);

        if (!err) {
            return callback(null, path, counter.bytes);
        }

        file.destroy();
        Fs.unlink(path, (/* fsErr */) => {      // Ignore unlink errors

            return callback(err);
        });
    });

    file.once('close', finalize);
    file.once('error', finalize);

    const onAbort = () => {

        return finalize(Boom.badRequest('Client connection aborted'));
    };

    this.req.once('aborted', onAbort);

    internals.pipe(internals.pipe(stream, counter), file);
};
$FilePath$/home/tiago/empirical-jsvuln-tools-study/framework/src/packages/CWE-400/1477/package/lib/index.js
Line 446	    const path = Hoek.uniqueFilename(this.settings.uploads || Os.tmpdir());
$FilePath$/home/tiago/empirical-jsvuln-tools-study/framework/src/packages/CWE-400/1477/package/lib/index.js
Line 447	    const file = Fs.createWriteStream(path, { flags: 'wx' });
$FilePath$/home/tiago/empirical-jsvuln-tools-study/framework/src/packages/CWE-400/1477/package/lib/index.js
Line 513	    return from.pipe(to);

|checker| success id$23$color:green$: 
==========================
$FilePath$/home/tiago/empirical-jsvuln-tools-study/framework/src/packages/CWE-400/1477/package/lib/index.js
Line 31	    const parser = new internals.Parser(req, tap, options, next);
$FilePath$/home/tiago/empirical-jsvuln-tools-study/framework/src/packages/CWE-400/1477/package/lib/index.js
Line 446	    const path = Hoek.uniqueFilename(this.settings.uploads || Os.tmpdir());
$FilePath$/home/tiago/empirical-jsvuln-tools-study/framework/src/packages/CWE-400/1477/package/lib/index.js
Line 447	    const file = Fs.createWriteStream(path, { flags: 'wx' });
$FilePath$/home/tiago/empirical-jsvuln-tools-study/framework/src/packages/CWE-400/1477/package/lib/index.js
Line 513	    return from.pipe(to);

|checker| success id$24$color:green$: 
==========================
$FilePath$/home/tiago/empirical-jsvuln-tools-study/tools-testing/tools-docker/odgen/ODGen/builtin_packages/fs.js
Line 22	module.exports = {
  read: read,
  readdir: readFile,
  readdirSync: readFile,
  readFile: readFile,
  readFileSync: readFile,
  readlink: read,
  readlinkSync: read,
  readSync: read,
  createReadStream: read
}
$FilePath$/home/tiago/empirical-jsvuln-tools-study/framework/src/packages/CWE-400/1477/package/lib/index.js
Line 447	    const file = Fs.createWriteStream(path, { flags: 'wx' });
$FilePath$/home/tiago/empirical-jsvuln-tools-study/framework/src/packages/CWE-400/1477/package/lib/index.js
Line 513	    return from.pipe(to);

|checker| success id$25$color:green$: 
==========================
$FilePath$/home/tiago/empirical-jsvuln-tools-study/framework/src/packages/CWE-400/1477/package/lib/index.js
Line 25	exports.parse = function (req, tap, options, next) {

    Hoek.assert(options, 'Missing options');
    Hoek.assert(options.parse !== undefined, 'Missing parse option setting');
    Hoek.assert(options.output !== undefined, 'Missing output option setting');

    const parser = new internals.Parser(req, tap, options, next);
    return parser.read();
};
$FilePath$/home/tiago/empirical-jsvuln-tools-study/framework/src/packages/CWE-400/1477/package/lib/index.js
Line 513	    return from.pipe(to);

|checker| success id$0$color:green$: 
==========================
$FilePath$/home/tiago/empirical-jsvuln-tools-study/framework/src/packages/CWE-400/1477/package/lib/index.js
Line 481	internals.Counter = function (options) {

    Stream.Transform.call(this);
    this.bytes = 0;
    this._maxBytes = options.maxBytes;
};
$FilePath$/home/tiago/empirical-jsvuln-tools-study/framework/src/packages/CWE-400/1477/package/lib/index.js
Line 488	Hoek.inherits(internals.Counter, Stream.Transform);
$FilePath$/home/tiago/empirical-jsvuln-tools-study/framework/src/packages/CWE-400/1477/package/lib/index.js
Line 28	    Hoek.assert(options.parse !== undefined, 'Missing parse option setting');
$FilePath$/home/tiago/empirical-jsvuln-tools-study/framework/src/packages/CWE-400/1477/package/lib/index.js
Line 64	    const contentType = Content.type(this.settings.override || req.headers['content-type'] || this.settings.defaultContentType || 'application/octet-stream');
$FilePath$/home/tiago/empirical-jsvuln-tools-study/framework/src/packages/CWE-400/1477/package/lib/index.js
Line 305	    const dispenserOptions = Hoek.applyToDefaults(contentType, { maxBytes: this.settings.maxBytes });
$FilePath$/home/tiago/empirical-jsvuln-tools-study/framework/src/packages/CWE-400/1477/package/lib/index.js
Line 446	    const path = Hoek.uniqueFilename(this.settings.uploads || Os.tmpdir());
$FilePath$/home/tiago/empirical-jsvuln-tools-study/framework/src/packages/CWE-400/1477/package/lib/index.js
Line 447	    const file = Fs.createWriteStream(path, { flags: 'wx' });
$FilePath$/home/tiago/empirical-jsvuln-tools-study/framework/src/packages/CWE-400/1477/package/lib/index.js
Line 513	    return from.pipe(to);

|checker| success id$1$color:green$: 
==========================
$FilePath$/home/tiago/empirical-jsvuln-tools-study/framework/src/packages/CWE-400/1477/package/lib/index.js
Line 481	internals.Counter = function (options) {

    Stream.Transform.call(this);
    this.bytes = 0;
    this._maxBytes = options.maxBytes;
};
$FilePath$/home/tiago/empirical-jsvuln-tools-study/framework/src/packages/CWE-400/1477/package/lib/index.js
Line 488	Hoek.inherits(internals.Counter, Stream.Transform);
$FilePath$/home/tiago/empirical-jsvuln-tools-study/framework/src/packages/CWE-400/1477/package/lib/index.js
Line 28	    Hoek.assert(options.parse !== undefined, 'Missing parse option setting');
$FilePath$/home/tiago/empirical-jsvuln-tools-study/framework/src/packages/CWE-400/1477/package/lib/index.js
Line 64	    const contentType = Content.type(this.settings.override || req.headers['content-type'] || this.settings.defaultContentType || 'application/octet-stream');
$FilePath$/home/tiago/empirical-jsvuln-tools-study/framework/src/packages/CWE-400/1477/package/lib/index.js
Line 305	    const dispenserOptions = Hoek.applyToDefaults(contentType, { maxBytes: this.settings.maxBytes });
$FilePath$/home/tiago/empirical-jsvuln-tools-study/framework/src/packages/CWE-400/1477/package/lib/index.js
Line 306	    const dispenser = new Pez.Dispenser(dispenserOptions);
$FilePath$/home/tiago/empirical-jsvuln-tools-study/framework/src/packages/CWE-400/1477/package/lib/index.js
Line 513	    return from.pipe(to);

|checker| success id$2$color:green$: 
==========================
$FilePath$/home/tiago/empirical-jsvuln-tools-study/framework/src/packages/CWE-400/1477/package/lib/index.js
Line 481	internals.Counter = function (options) {

    Stream.Transform.call(this);
    this.bytes = 0;
    this._maxBytes = options.maxBytes;
};
$FilePath$/home/tiago/empirical-jsvuln-tools-study/framework/src/packages/CWE-400/1477/package/lib/index.js
Line 488	Hoek.inherits(internals.Counter, Stream.Transform);
$FilePath$/home/tiago/empirical-jsvuln-tools-study/framework/src/packages/CWE-400/1477/package/lib/index.js
Line 28	    Hoek.assert(options.parse !== undefined, 'Missing parse option setting');
$FilePath$/home/tiago/empirical-jsvuln-tools-study/framework/src/packages/CWE-400/1477/package/lib/index.js
Line 446	    const path = Hoek.uniqueFilename(this.settings.uploads || Os.tmpdir());
$FilePath$/home/tiago/empirical-jsvuln-tools-study/framework/src/packages/CWE-400/1477/package/lib/index.js
Line 447	    const file = Fs.createWriteStream(path, { flags: 'wx' });
$FilePath$/home/tiago/empirical-jsvuln-tools-study/framework/src/packages/CWE-400/1477/package/lib/index.js
Line 513	    return from.pipe(to);

|checker| success id$3$color:green$: 
==========================
$FilePath$/home/tiago/empirical-jsvuln-tools-study/framework/src/packages/CWE-400/1477/package/lib/index.js
Line 25	exports.parse = function (req, tap, options, next) {

    Hoek.assert(options, 'Missing options');
    Hoek.assert(options.parse !== undefined, 'Missing parse option setting');
    Hoek.assert(options.output !== undefined, 'Missing output option setting');

    const parser = new internals.Parser(req, tap, options, next);
    return parser.read();
};
$FilePath$/home/tiago/empirical-jsvuln-tools-study/framework/src/packages/CWE-400/1477/package/lib/index.js
Line 64	    const contentType = Content.type(this.settings.override || req.headers['content-type'] || this.settings.defaultContentType || 'application/octet-stream');
$FilePath$/home/tiago/empirical-jsvuln-tools-study/framework/src/packages/CWE-400/1477/package/lib/index.js
Line 305	    const dispenserOptions = Hoek.applyToDefaults(contentType, { maxBytes: this.settings.maxBytes });
$FilePath$/home/tiago/empirical-jsvuln-tools-study/framework/src/packages/CWE-400/1477/package/lib/index.js
Line 446	    const path = Hoek.uniqueFilename(this.settings.uploads || Os.tmpdir());
$FilePath$/home/tiago/empirical-jsvuln-tools-study/framework/src/packages/CWE-400/1477/package/lib/index.js
Line 447	    const file = Fs.createWriteStream(path, { flags: 'wx' });
$FilePath$/home/tiago/empirical-jsvuln-tools-study/framework/src/packages/CWE-400/1477/package/lib/index.js
Line 513	    return from.pipe(to);

|checker| success id$4$color:green$: 
==========================
$FilePath$/home/tiago/empirical-jsvuln-tools-study/framework/src/packages/CWE-400/1477/package/lib/index.js
Line 54	    const contentLength = req.headers['content-length'];
$FilePath$/home/tiago/empirical-jsvuln-tools-study/framework/src/packages/CWE-400/1477/package/lib/index.js
Line 64	    const contentType = Content.type(this.settings.override || req.headers['content-type'] || this.settings.defaultContentType || 'application/octet-stream');
$FilePath$/home/tiago/empirical-jsvuln-tools-study/framework/src/packages/CWE-400/1477/package/lib/index.js
Line 305	    const dispenserOptions = Hoek.applyToDefaults(contentType, { maxBytes: this.settings.maxBytes });
$FilePath$/home/tiago/empirical-jsvuln-tools-study/framework/src/packages/CWE-400/1477/package/lib/index.js
Line 446	    const path = Hoek.uniqueFilename(this.settings.uploads || Os.tmpdir());
$FilePath$/home/tiago/empirical-jsvuln-tools-study/framework/src/packages/CWE-400/1477/package/lib/index.js
Line 447	    const file = Fs.createWriteStream(path, { flags: 'wx' });
$FilePath$/home/tiago/empirical-jsvuln-tools-study/framework/src/packages/CWE-400/1477/package/lib/index.js
Line 513	    return from.pipe(to);

|checker| success id$5$color:green$: 
==========================
$FilePath$/home/tiago/empirical-jsvuln-tools-study/framework/src/packages/CWE-400/1477/package/lib/index.js
Line 31	    const parser = new internals.Parser(req, tap, options, next);
$FilePath$/home/tiago/empirical-jsvuln-tools-study/framework/src/packages/CWE-400/1477/package/lib/index.js
Line 64	    const contentType = Content.type(this.settings.override || req.headers['content-type'] || this.settings.defaultContentType || 'application/octet-stream');
$FilePath$/home/tiago/empirical-jsvuln-tools-study/framework/src/packages/CWE-400/1477/package/lib/index.js
Line 305	    const dispenserOptions = Hoek.applyToDefaults(contentType, { maxBytes: this.settings.maxBytes });
$FilePath$/home/tiago/empirical-jsvuln-tools-study/framework/src/packages/CWE-400/1477/package/lib/index.js
Line 446	    const path = Hoek.uniqueFilename(this.settings.uploads || Os.tmpdir());
$FilePath$/home/tiago/empirical-jsvuln-tools-study/framework/src/packages/CWE-400/1477/package/lib/index.js
Line 447	    const file = Fs.createWriteStream(path, { flags: 'wx' });
$FilePath$/home/tiago/empirical-jsvuln-tools-study/framework/src/packages/CWE-400/1477/package/lib/index.js
Line 513	    return from.pipe(to);

|checker| success id$6$color:green$: 
==========================
$FilePath$/home/tiago/empirical-jsvuln-tools-study/framework/src/packages/CWE-400/1477/package/lib/index.js
Line 481	internals.Counter = function (options) {

    Stream.Transform.call(this);
    this.bytes = 0;
    this._maxBytes = options.maxBytes;
};
$FilePath$/home/tiago/empirical-jsvuln-tools-study/framework/src/packages/CWE-400/1477/package/lib/index.js
Line 488	Hoek.inherits(internals.Counter, Stream.Transform);
$FilePath$/home/tiago/empirical-jsvuln-tools-study/framework/src/packages/CWE-400/1477/package/lib/index.js
Line 305	    const dispenserOptions = Hoek.applyToDefaults(contentType, { maxBytes: this.settings.maxBytes });
$FilePath$/home/tiago/empirical-jsvuln-tools-study/framework/src/packages/CWE-400/1477/package/lib/index.js
Line 446	    const path = Hoek.uniqueFilename(this.settings.uploads || Os.tmpdir());
$FilePath$/home/tiago/empirical-jsvuln-tools-study/framework/src/packages/CWE-400/1477/package/lib/index.js
Line 447	    const file = Fs.createWriteStream(path, { flags: 'wx' });
$FilePath$/home/tiago/empirical-jsvuln-tools-study/framework/src/packages/CWE-400/1477/package/lib/index.js
Line 513	    return from.pipe(to);

|checker| success id$7$color:green$: 
==========================
$FilePath$/home/tiago/empirical-jsvuln-tools-study/framework/src/packages/CWE-400/1477/package/lib/index.js
Line 25	exports.parse = function (req, tap, options, next) {

    Hoek.assert(options, 'Missing options');
    Hoek.assert(options.parse !== undefined, 'Missing parse option setting');
    Hoek.assert(options.output !== undefined, 'Missing output option setting');

    const parser = new internals.Parser(req, tap, options, next);
    return parser.read();
};
$FilePath$/home/tiago/empirical-jsvuln-tools-study/framework/src/packages/CWE-400/1477/package/lib/index.js
Line 64	    const contentType = Content.type(this.settings.override || req.headers['content-type'] || this.settings.defaultContentType || 'application/octet-stream');
$FilePath$/home/tiago/empirical-jsvuln-tools-study/framework/src/packages/CWE-400/1477/package/lib/index.js
Line 305	    const dispenserOptions = Hoek.applyToDefaults(contentType, { maxBytes: this.settings.maxBytes });
$FilePath$/home/tiago/empirical-jsvuln-tools-study/framework/src/packages/CWE-400/1477/package/lib/index.js
Line 306	    const dispenser = new Pez.Dispenser(dispenserOptions);
$FilePath$/home/tiago/empirical-jsvuln-tools-study/framework/src/packages/CWE-400/1477/package/lib/index.js
Line 513	    return from.pipe(to);

|checker| success id$8$color:green$: 
==========================
$FilePath$/home/tiago/empirical-jsvuln-tools-study/framework/src/packages/CWE-400/1477/package/lib/index.js
Line 54	    const contentLength = req.headers['content-length'];
$FilePath$/home/tiago/empirical-jsvuln-tools-study/framework/src/packages/CWE-400/1477/package/lib/index.js
Line 64	    const contentType = Content.type(this.settings.override || req.headers['content-type'] || this.settings.defaultContentType || 'application/octet-stream');
$FilePath$/home/tiago/empirical-jsvuln-tools-study/framework/src/packages/CWE-400/1477/package/lib/index.js
Line 305	    const dispenserOptions = Hoek.applyToDefaults(contentType, { maxBytes: this.settings.maxBytes });
$FilePath$/home/tiago/empirical-jsvuln-tools-study/framework/src/packages/CWE-400/1477/package/lib/index.js
Line 306	    const dispenser = new Pez.Dispenser(dispenserOptions);
$FilePath$/home/tiago/empirical-jsvuln-tools-study/framework/src/packages/CWE-400/1477/package/lib/index.js
Line 513	    return from.pipe(to);

|checker| success id$9$color:green$: 
==========================
$FilePath$/home/tiago/empirical-jsvuln-tools-study/framework/src/packages/CWE-400/1477/package/lib/index.js
Line 31	    const parser = new internals.Parser(req, tap, options, next);
$FilePath$/home/tiago/empirical-jsvuln-tools-study/framework/src/packages/CWE-400/1477/package/lib/index.js
Line 64	    const contentType = Content.type(this.settings.override || req.headers['content-type'] || this.settings.defaultContentType || 'application/octet-stream');
$FilePath$/home/tiago/empirical-jsvuln-tools-study/framework/src/packages/CWE-400/1477/package/lib/index.js
Line 305	    const dispenserOptions = Hoek.applyToDefaults(contentType, { maxBytes: this.settings.maxBytes });
$FilePath$/home/tiago/empirical-jsvuln-tools-study/framework/src/packages/CWE-400/1477/package/lib/index.js
Line 306	    const dispenser = new Pez.Dispenser(dispenserOptions);
$FilePath$/home/tiago/empirical-jsvuln-tools-study/framework/src/packages/CWE-400/1477/package/lib/index.js
Line 513	    return from.pipe(to);

|checker| success id$10$color:green$: 
==========================
$FilePath$/home/tiago/empirical-jsvuln-tools-study/framework/src/packages/CWE-400/1477/package/lib/index.js
Line 481	internals.Counter = function (options) {

    Stream.Transform.call(this);
    this.bytes = 0;
    this._maxBytes = options.maxBytes;
};
$FilePath$/home/tiago/empirical-jsvuln-tools-study/framework/src/packages/CWE-400/1477/package/lib/index.js
Line 488	Hoek.inherits(internals.Counter, Stream.Transform);
$FilePath$/home/tiago/empirical-jsvuln-tools-study/framework/src/packages/CWE-400/1477/package/lib/index.js
Line 305	    const dispenserOptions = Hoek.applyToDefaults(contentType, { maxBytes: this.settings.maxBytes });
$FilePath$/home/tiago/empirical-jsvuln-tools-study/framework/src/packages/CWE-400/1477/package/lib/index.js
Line 306	    const dispenser = new Pez.Dispenser(dispenserOptions);
$FilePath$/home/tiago/empirical-jsvuln-tools-study/framework/src/packages/CWE-400/1477/package/lib/index.js
Line 513	    return from.pipe(to);

|checker| success id$11$color:green$: 
==========================
$FilePath$/home/tiago/empirical-jsvuln-tools-study/framework/src/packages/CWE-400/1477/package/lib/index.js
Line 481	internals.Counter = function (options) {

    Stream.Transform.call(this);
    this.bytes = 0;
    this._maxBytes = options.maxBytes;
};
$FilePath$/home/tiago/empirical-jsvuln-tools-study/framework/src/packages/CWE-400/1477/package/lib/index.js
Line 488	Hoek.inherits(internals.Counter, Stream.Transform);
$FilePath$/home/tiago/empirical-jsvuln-tools-study/framework/src/packages/CWE-400/1477/package/lib/index.js
Line 446	    const path = Hoek.uniqueFilename(this.settings.uploads || Os.tmpdir());
$FilePath$/home/tiago/empirical-jsvuln-tools-study/framework/src/packages/CWE-400/1477/package/lib/index.js
Line 447	    const file = Fs.createWriteStream(path, { flags: 'wx' });
$FilePath$/home/tiago/empirical-jsvuln-tools-study/framework/src/packages/CWE-400/1477/package/lib/index.js
Line 513	    return from.pipe(to);

|checker| success id$12$color:green$: 
==========================
$FilePath$/home/tiago/empirical-jsvuln-tools-study/framework/src/packages/CWE-400/1477/package/lib/index.js
Line 90	internals.Parser.prototype.parse = function (contentType) {

    let next = this.next;

    const output = this.settings.output;        // Output: 'data', 'stream', 'file'
    let source = this.req;

    // Content-encoding

    const contentEncoding = source.headers['content-encoding'];
    const decoder = (this.settings.decoders || internals.decoders)[contentEncoding];
    if (decoder) {
        const decoderOptions = (this.settings.compression && this.settings.compression[contentEncoding]) || null;
        const stream = decoder(decoderOptions);
        next = Hoek.once(next);                 // Modify next() for async events
        this.next = next;
        stream.once('error', (err) => {

            return next(Boom.badRequest('Invalid compressed payload', err));
        });

        source = internals.pipe(source, stream);
    }

    // Tap request

    if (this.tap) {
        source = internals.pipe(source, this.tap);
    }

    // Multipart

    if (this.result.contentType.mime === 'multipart/form-data') {
        if (this.settings.multipart === false) {                            // Defaults to true
            return next(Boom.unsupportedMediaType());
        }

        return this.multipart(source, contentType);
    }

    // Output: 'stream'

    if (output === 'stream') {
        this.result.payload = source;
        return next();
    }

    // Output: 'file'

    if (output === 'file') {
        this.writeFile(source, this.settings, (err, path, bytes) => {

            if (err) {
                return next(err);
            }

            this.result.payload = { path, bytes };
            return next();
        });

        return;
    }

    // Output: 'data'

    return Wreck.read(source, { timeout: this.settings.timeout, maxBytes: this.settings.maxBytes }, (err, payload) => {

        if (err) {
            return next(err);
        }

        this.object(payload, this.result.contentType.mime, (err, result) => {

            if (err) {
                this.result.payload = null;
                err.raw = payload;
                return next(err);
            }

            this.result.payload = result;
            return next();
        });
    });
};
$FilePath$/home/tiago/empirical-jsvuln-tools-study/framework/src/packages/CWE-400/1477/package/lib/index.js
Line 305	    const dispenserOptions = Hoek.applyToDefaults(contentType, { maxBytes: this.settings.maxBytes });
$FilePath$/home/tiago/empirical-jsvuln-tools-study/framework/src/packages/CWE-400/1477/package/lib/index.js
Line 446	    const path = Hoek.uniqueFilename(this.settings.uploads || Os.tmpdir());
$FilePath$/home/tiago/empirical-jsvuln-tools-study/framework/src/packages/CWE-400/1477/package/lib/index.js
Line 447	    const file = Fs.createWriteStream(path, { flags: 'wx' });
$FilePath$/home/tiago/empirical-jsvuln-tools-study/framework/src/packages/CWE-400/1477/package/lib/index.js
Line 513	    return from.pipe(to);

|checker| success id$13$color:green$: 
==========================
$FilePath$/home/tiago/empirical-jsvuln-tools-study/framework/src/packages/CWE-400/1477/package/lib/index.js
Line 294	internals.Parser.prototype.multipart = function (source, contentType) {

    let next = this.next;
    next = Hoek.once(next);                                            // Modify next() for async events
    this.next = next;

    // Set stream timeout

    const clientTimeout = this.settings.timeout;
    let clientTimeoutId = null;

    const dispenserOptions = Hoek.applyToDefaults(contentType, { maxBytes: this.settings.maxBytes });
    const dispenser = new Pez.Dispenser(dispenserOptions);

    const onError = (err) => {

        return next(Boom.badRequest('Invalid multipart payload format', err));
    };

    dispenser.once('error', onError);

    const data = {};
    const finalize = () => {

        clearTimeout(clientTimeoutId);
        dispenser.removeListener('error', onError);
        dispenser.removeListener('part', onPart);
        dispenser.removeListener('field', onField);
        dispenser.removeListener('close', onClose);

        this.result.payload = data;
        return next();
    };

    if (clientTimeout &&
        clientTimeout > 0) {

        clientTimeoutId = setTimeout(() => {

            return next(Boom.clientTimeout());
        }, clientTimeout);
    }

    const set = (name, value) => {

        if (!data.hasOwnProperty(name)) {
            data[name] = value;
        }
        else if (Array.isArray(data[name])) {
            data[name].push(value);
        }
        else {
            data[name] = [data[name], value];
        }
    };

    const pendingFiles = {};
    let nextId = 0;
    let closed = false;

    const output = (this.settings.multipart ? this.settings.multipart.output : this.settings.output);

    const onPart = (part) => {

        if (output === 'file') {                                                                // Output: 'file'
            const id = nextId++;
            pendingFiles[id] = true;
            this.writeFile(part, this.settings, (err, path, bytes) => {

                delete pendingFiles[id];

                if (err) {
                    return next(err);
                }

                const item = {
                    filename: part.filename,
                    path,
                    headers: part.headers,
                    bytes
                };

                set(part.name, item);

                /* $lab:coverage:off$ */
                if (closed &&
                    !Object.keys(pendingFiles).length) {

                    return finalize(data);
                }
                /* $lab:coverage:on$ */
            });
        }
        else {                                                                                  // Output: 'data'
            Wreck.read(part, {}, (ignoreErr, payload) => {

                // Error handled by dispenser.once('error')

                if (output === 'stream') {                                                      // Output: 'stream'
                    const item = Wreck.toReadableStream(payload);

                    item.hapi = {
                        filename: part.filename,
                        headers: part.headers
                    };

                    return set(part.name, item);
                }

                const ct = part.headers['content-type'] || '';
                const mime = ct.split(';')[0].trim().toLowerCase();
                const annotate = (value) => set(part.name, output === 'annotated' ? { filename: part.filename, headers: part.headers, payload: value } : value);

                if (!mime) {
                    return annotate(payload);
                }

                if (!payload.length) {
                    return annotate({});
                }

                this.object(payload, mime, (err, result) => annotate(err ? payload : result));
            });
        }
    };

    dispenser.on('part', onPart);

    const onField = (name, value) => set(name, value);

    dispenser.on('field', onField);

    const onClose = () => {

        /* $lab:coverage:off$ */
        if (Object.keys(pendingFiles).length) {
            closed = true;
            return;
        }
        /* $lab:coverage:on$ */

        return finalize(data);
    };

    dispenser.once('close', onClose);

    internals.pipe(source, dispenser);
};
$FilePath$/home/tiago/empirical-jsvuln-tools-study/framework/src/packages/CWE-400/1477/package/lib/index.js
Line 305	    const dispenserOptions = Hoek.applyToDefaults(contentType, { maxBytes: this.settings.maxBytes });
$FilePath$/home/tiago/empirical-jsvuln-tools-study/framework/src/packages/CWE-400/1477/package/lib/index.js
Line 446	    const path = Hoek.uniqueFilename(this.settings.uploads || Os.tmpdir());
$FilePath$/home/tiago/empirical-jsvuln-tools-study/framework/src/packages/CWE-400/1477/package/lib/index.js
Line 447	    const file = Fs.createWriteStream(path, { flags: 'wx' });
$FilePath$/home/tiago/empirical-jsvuln-tools-study/framework/src/packages/CWE-400/1477/package/lib/index.js
Line 513	    return from.pipe(to);

|checker| success id$14$color:green$: 
==========================
$FilePath$/home/tiago/empirical-jsvuln-tools-study/framework/src/packages/CWE-400/1477/package/lib/index.js
Line 42	    this.result = {};
$FilePath$/home/tiago/empirical-jsvuln-tools-study/framework/src/packages/CWE-400/1477/package/lib/index.js
Line 305	    const dispenserOptions = Hoek.applyToDefaults(contentType, { maxBytes: this.settings.maxBytes });
$FilePath$/home/tiago/empirical-jsvuln-tools-study/framework/src/packages/CWE-400/1477/package/lib/index.js
Line 446	    const path = Hoek.uniqueFilename(this.settings.uploads || Os.tmpdir());
$FilePath$/home/tiago/empirical-jsvuln-tools-study/framework/src/packages/CWE-400/1477/package/lib/index.js
Line 447	    const file = Fs.createWriteStream(path, { flags: 'wx' });
$FilePath$/home/tiago/empirical-jsvuln-tools-study/framework/src/packages/CWE-400/1477/package/lib/index.js
Line 513	    return from.pipe(to);

|checker| success id$15$color:green$: 
==========================
$FilePath$/home/tiago/empirical-jsvuln-tools-study/framework/src/packages/CWE-400/1477/package/lib/index.js
Line 388	            Wreck.read(part, {}, (ignoreErr, payload) => {

                // Error handled by dispenser.once('error')

                if (output === 'stream') {                                                      // Output: 'stream'
                    const item = Wreck.toReadableStream(payload);

                    item.hapi = {
                        filename: part.filename,
                        headers: part.headers
                    };

                    return set(part.name, item);
                }

                const ct = part.headers['content-type'] || '';
                const mime = ct.split(';')[0].trim().toLowerCase();
                const annotate = (value) => set(part.name, output === 'annotated' ? { filename: part.filename, headers: part.headers, payload: value } : value);

                if (!mime) {
                    return annotate(payload);
                }

                if (!payload.length) {
                    return annotate({});
                }

                this.object(payload, mime, (err, result) => annotate(err ? payload : result));
            });
$FilePath$/home/tiago/empirical-jsvuln-tools-study/framework/src/packages/CWE-400/1477/package/lib/index.js
Line 155	    return Wreck.read(source, { timeout: this.settings.timeout, maxBytes: this.settings.maxBytes }, (err, payload) => {

        if (err) {
            return next(err);
        }

        this.object(payload, this.result.contentType.mime, (err, result) => {

            if (err) {
                this.result.payload = null;
                err.raw = payload;
                return next(err);
            }

            this.result.payload = result;
            return next();
        });
    });
$FilePath$/home/tiago/empirical-jsvuln-tools-study/framework/src/packages/CWE-400/1477/package/lib/index.js
Line 446	    const path = Hoek.uniqueFilename(this.settings.uploads || Os.tmpdir());
$FilePath$/home/tiago/empirical-jsvuln-tools-study/framework/src/packages/CWE-400/1477/package/lib/index.js
Line 447	    const file = Fs.createWriteStream(path, { flags: 'wx' });
$FilePath$/home/tiago/empirical-jsvuln-tools-study/framework/src/packages/CWE-400/1477/package/lib/index.js
Line 513	    return from.pipe(to);

|checker| success id$16$color:green$: 
==========================
$FilePath$/home/tiago/empirical-jsvuln-tools-study/framework/src/packages/CWE-400/1477/package/lib/index.js
Line 42	    this.result = {};
$FilePath$/home/tiago/empirical-jsvuln-tools-study/framework/src/packages/CWE-400/1477/package/lib/index.js
Line 155	    return Wreck.read(source, { timeout: this.settings.timeout, maxBytes: this.settings.maxBytes }, (err, payload) => {

        if (err) {
            return next(err);
        }

        this.object(payload, this.result.contentType.mime, (err, result) => {

            if (err) {
                this.result.payload = null;
                err.raw = payload;
                return next(err);
            }

            this.result.payload = result;
            return next();
        });
    });
$FilePath$/home/tiago/empirical-jsvuln-tools-study/framework/src/packages/CWE-400/1477/package/lib/index.js
Line 446	    const path = Hoek.uniqueFilename(this.settings.uploads || Os.tmpdir());
$FilePath$/home/tiago/empirical-jsvuln-tools-study/framework/src/packages/CWE-400/1477/package/lib/index.js
Line 447	    const file = Fs.createWriteStream(path, { flags: 'wx' });
$FilePath$/home/tiago/empirical-jsvuln-tools-study/framework/src/packages/CWE-400/1477/package/lib/index.js
Line 513	    return from.pipe(to);

|checker| success id$17$color:green$: 
==========================
$FilePath$/home/tiago/empirical-jsvuln-tools-study/framework/src/packages/CWE-400/1477/package/lib/index.js
Line 90	internals.Parser.prototype.parse = function (contentType) {

    let next = this.next;

    const output = this.settings.output;        // Output: 'data', 'stream', 'file'
    let source = this.req;

    // Content-encoding

    const contentEncoding = source.headers['content-encoding'];
    const decoder = (this.settings.decoders || internals.decoders)[contentEncoding];
    if (decoder) {
        const decoderOptions = (this.settings.compression && this.settings.compression[contentEncoding]) || null;
        const stream = decoder(decoderOptions);
        next = Hoek.once(next);                 // Modify next() for async events
        this.next = next;
        stream.once('error', (err) => {

            return next(Boom.badRequest('Invalid compressed payload', err));
        });

        source = internals.pipe(source, stream);
    }

    // Tap request

    if (this.tap) {
        source = internals.pipe(source, this.tap);
    }

    // Multipart

    if (this.result.contentType.mime === 'multipart/form-data') {
        if (this.settings.multipart === false) {                            // Defaults to true
            return next(Boom.unsupportedMediaType());
        }

        return this.multipart(source, contentType);
    }

    // Output: 'stream'

    if (output === 'stream') {
        this.result.payload = source;
        return next();
    }

    // Output: 'file'

    if (output === 'file') {
        this.writeFile(source, this.settings, (err, path, bytes) => {

            if (err) {
                return next(err);
            }

            this.result.payload = { path, bytes };
            return next();
        });

        return;
    }

    // Output: 'data'

    return Wreck.read(source, { timeout: this.settings.timeout, maxBytes: this.settings.maxBytes }, (err, payload) => {

        if (err) {
            return next(err);
        }

        this.object(payload, this.result.contentType.mime, (err, result) => {

            if (err) {
                this.result.payload = null;
                err.raw = payload;
                return next(err);
            }

            this.result.payload = result;
            return next();
        });
    });
};
$FilePath$/home/tiago/empirical-jsvuln-tools-study/framework/src/packages/CWE-400/1477/package/lib/index.js
Line 305	    const dispenserOptions = Hoek.applyToDefaults(contentType, { maxBytes: this.settings.maxBytes });
$FilePath$/home/tiago/empirical-jsvuln-tools-study/framework/src/packages/CWE-400/1477/package/lib/index.js
Line 306	    const dispenser = new Pez.Dispenser(dispenserOptions);
$FilePath$/home/tiago/empirical-jsvuln-tools-study/framework/src/packages/CWE-400/1477/package/lib/index.js
Line 513	    return from.pipe(to);

|checker| success id$18$color:green$: 
==========================
$FilePath$/home/tiago/empirical-jsvuln-tools-study/framework/src/packages/CWE-400/1477/package/lib/index.js
Line 294	internals.Parser.prototype.multipart = function (source, contentType) {

    let next = this.next;
    next = Hoek.once(next);                                            // Modify next() for async events
    this.next = next;

    // Set stream timeout

    const clientTimeout = this.settings.timeout;
    let clientTimeoutId = null;

    const dispenserOptions = Hoek.applyToDefaults(contentType, { maxBytes: this.settings.maxBytes });
    const dispenser = new Pez.Dispenser(dispenserOptions);

    const onError = (err) => {

        return next(Boom.badRequest('Invalid multipart payload format', err));
    };

    dispenser.once('error', onError);

    const data = {};
    const finalize = () => {

        clearTimeout(clientTimeoutId);
        dispenser.removeListener('error', onError);
        dispenser.removeListener('part', onPart);
        dispenser.removeListener('field', onField);
        dispenser.removeListener('close', onClose);

        this.result.payload = data;
        return next();
    };

    if (clientTimeout &&
        clientTimeout > 0) {

        clientTimeoutId = setTimeout(() => {

            return next(Boom.clientTimeout());
        }, clientTimeout);
    }

    const set = (name, value) => {

        if (!data.hasOwnProperty(name)) {
            data[name] = value;
        }
        else if (Array.isArray(data[name])) {
            data[name].push(value);
        }
        else {
            data[name] = [data[name], value];
        }
    };

    const pendingFiles = {};
    let nextId = 0;
    let closed = false;

    const output = (this.settings.multipart ? this.settings.multipart.output : this.settings.output);

    const onPart = (part) => {

        if (output === 'file') {                                                                // Output: 'file'
            const id = nextId++;
            pendingFiles[id] = true;
            this.writeFile(part, this.settings, (err, path, bytes) => {

                delete pendingFiles[id];

                if (err) {
                    return next(err);
                }

                const item = {
                    filename: part.filename,
                    path,
                    headers: part.headers,
                    bytes
                };

                set(part.name, item);

                /* $lab:coverage:off$ */
                if (closed &&
                    !Object.keys(pendingFiles).length) {

                    return finalize(data);
                }
                /* $lab:coverage:on$ */
            });
        }
        else {                                                                                  // Output: 'data'
            Wreck.read(part, {}, (ignoreErr, payload) => {

                // Error handled by dispenser.once('error')

                if (output === 'stream') {                                                      // Output: 'stream'
                    const item = Wreck.toReadableStream(payload);

                    item.hapi = {
                        filename: part.filename,
                        headers: part.headers
                    };

                    return set(part.name, item);
                }

                const ct = part.headers['content-type'] || '';
                const mime = ct.split(';')[0].trim().toLowerCase();
                const annotate = (value) => set(part.name, output === 'annotated' ? { filename: part.filename, headers: part.headers, payload: value } : value);

                if (!mime) {
                    return annotate(payload);
                }

                if (!payload.length) {
                    return annotate({});
                }

                this.object(payload, mime, (err, result) => annotate(err ? payload : result));
            });
        }
    };

    dispenser.on('part', onPart);

    const onField = (name, value) => set(name, value);

    dispenser.on('field', onField);

    const onClose = () => {

        /* $lab:coverage:off$ */
        if (Object.keys(pendingFiles).length) {
            closed = true;
            return;
        }
        /* $lab:coverage:on$ */

        return finalize(data);
    };

    dispenser.once('close', onClose);

    internals.pipe(source, dispenser);
};
$FilePath$/home/tiago/empirical-jsvuln-tools-study/framework/src/packages/CWE-400/1477/package/lib/index.js
Line 305	    const dispenserOptions = Hoek.applyToDefaults(contentType, { maxBytes: this.settings.maxBytes });
$FilePath$/home/tiago/empirical-jsvuln-tools-study/framework/src/packages/CWE-400/1477/package/lib/index.js
Line 306	    const dispenser = new Pez.Dispenser(dispenserOptions);
$FilePath$/home/tiago/empirical-jsvuln-tools-study/framework/src/packages/CWE-400/1477/package/lib/index.js
Line 513	    return from.pipe(to);

|checker| success id$19$color:green$: 
==========================
$FilePath$/home/tiago/empirical-jsvuln-tools-study/framework/src/packages/CWE-400/1477/package/lib/index.js
Line 42	    this.result = {};
$FilePath$/home/tiago/empirical-jsvuln-tools-study/framework/src/packages/CWE-400/1477/package/lib/index.js
Line 305	    const dispenserOptions = Hoek.applyToDefaults(contentType, { maxBytes: this.settings.maxBytes });
$FilePath$/home/tiago/empirical-jsvuln-tools-study/framework/src/packages/CWE-400/1477/package/lib/index.js
Line 306	    const dispenser = new Pez.Dispenser(dispenserOptions);
$FilePath$/home/tiago/empirical-jsvuln-tools-study/framework/src/packages/CWE-400/1477/package/lib/index.js
Line 513	    return from.pipe(to);

|checker| success id$20$color:green$: 
==========================
$FilePath$/home/tiago/empirical-jsvuln-tools-study/framework/src/packages/CWE-400/1477/package/lib/index.js
Line 448	    const counter = new internals.Counter(options);
$FilePath$/home/tiago/empirical-jsvuln-tools-study/framework/src/packages/CWE-400/1477/package/lib/index.js
Line 446	    const path = Hoek.uniqueFilename(this.settings.uploads || Os.tmpdir());
$FilePath$/home/tiago/empirical-jsvuln-tools-study/framework/src/packages/CWE-400/1477/package/lib/index.js
Line 447	    const file = Fs.createWriteStream(path, { flags: 'wx' });
$FilePath$/home/tiago/empirical-jsvuln-tools-study/framework/src/packages/CWE-400/1477/package/lib/index.js
Line 513	    return from.pipe(to);

|checker| success id$21$color:green$: 
==========================
$FilePath$/home/tiago/empirical-jsvuln-tools-study/framework/src/packages/CWE-400/1477/package/lib/index.js
Line 25	exports.parse = function (req, tap, options, next) {

    Hoek.assert(options, 'Missing options');
    Hoek.assert(options.parse !== undefined, 'Missing parse option setting');
    Hoek.assert(options.output !== undefined, 'Missing output option setting');

    const parser = new internals.Parser(req, tap, options, next);
    return parser.read();
};
$FilePath$/home/tiago/empirical-jsvuln-tools-study/framework/src/packages/CWE-400/1477/package/lib/index.js
Line 446	    const path = Hoek.uniqueFilename(this.settings.uploads || Os.tmpdir());
$FilePath$/home/tiago/empirical-jsvuln-tools-study/framework/src/packages/CWE-400/1477/package/lib/index.js
Line 447	    const file = Fs.createWriteStream(path, { flags: 'wx' });
$FilePath$/home/tiago/empirical-jsvuln-tools-study/framework/src/packages/CWE-400/1477/package/lib/index.js
Line 513	    return from.pipe(to);

|checker| success id$22$color:green$: 
==========================
$FilePath$/home/tiago/empirical-jsvuln-tools-study/framework/src/packages/CWE-400/1477/package/lib/index.js
Line 444	internals.Parser.prototype.writeFile = function (stream, options, callback) {

    const path = Hoek.uniqueFilename(this.settings.uploads || Os.tmpdir());
    const file = Fs.createWriteStream(path, { flags: 'wx' });
    const counter = new internals.Counter(options);

    const finalize = Hoek.once((err) => {

        this.req.removeListener('aborted', onAbort);
        file.removeListener('close', finalize);
        file.removeListener('error', finalize);

        if (!err) {
            return callback(null, path, counter.bytes);
        }

        file.destroy();
        Fs.unlink(path, (/* fsErr */) => {      // Ignore unlink errors

            return callback(err);
        });
    });

    file.once('close', finalize);
    file.once('error', finalize);

    const onAbort = () => {

        return finalize(Boom.badRequest('Client connection aborted'));
    };

    this.req.once('aborted', onAbort);

    internals.pipe(internals.pipe(stream, counter), file);
};
$FilePath$/home/tiago/empirical-jsvuln-tools-study/framework/src/packages/CWE-400/1477/package/lib/index.js
Line 446	    const path = Hoek.uniqueFilename(this.settings.uploads || Os.tmpdir());
$FilePath$/home/tiago/empirical-jsvuln-tools-study/framework/src/packages/CWE-400/1477/package/lib/index.js
Line 447	    const file = Fs.createWriteStream(path, { flags: 'wx' });
$FilePath$/home/tiago/empirical-jsvuln-tools-study/framework/src/packages/CWE-400/1477/package/lib/index.js
Line 513	    return from.pipe(to);

|checker| success id$23$color:green$: 
==========================
$FilePath$/home/tiago/empirical-jsvuln-tools-study/framework/src/packages/CWE-400/1477/package/lib/index.js
Line 31	    const parser = new internals.Parser(req, tap, options, next);
$FilePath$/home/tiago/empirical-jsvuln-tools-study/framework/src/packages/CWE-400/1477/package/lib/index.js
Line 446	    const path = Hoek.uniqueFilename(this.settings.uploads || Os.tmpdir());
$FilePath$/home/tiago/empirical-jsvuln-tools-study/framework/src/packages/CWE-400/1477/package/lib/index.js
Line 447	    const file = Fs.createWriteStream(path, { flags: 'wx' });
$FilePath$/home/tiago/empirical-jsvuln-tools-study/framework/src/packages/CWE-400/1477/package/lib/index.js
Line 513	    return from.pipe(to);

|checker| success id$24$color:green$: 
==========================
$FilePath$/home/tiago/empirical-jsvuln-tools-study/tools-testing/tools-docker/odgen/ODGen/builtin_packages/fs.js
Line 22	module.exports = {
  read: read,
  readdir: readFile,
  readdirSync: readFile,
  readFile: readFile,
  readFileSync: readFile,
  readlink: read,
  readlinkSync: read,
  readSync: read,
  createReadStream: read
}
$FilePath$/home/tiago/empirical-jsvuln-tools-study/framework/src/packages/CWE-400/1477/package/lib/index.js
Line 447	    const file = Fs.createWriteStream(path, { flags: 'wx' });
$FilePath$/home/tiago/empirical-jsvuln-tools-study/framework/src/packages/CWE-400/1477/package/lib/index.js
Line 513	    return from.pipe(to);

|checker| success id$25$color:green$: 
==========================
$FilePath$/home/tiago/empirical-jsvuln-tools-study/framework/src/packages/CWE-400/1477/package/lib/index.js
Line 25	exports.parse = function (req, tap, options, next) {

    Hoek.assert(options, 'Missing options');
    Hoek.assert(options.parse !== undefined, 'Missing parse option setting');
    Hoek.assert(options.output !== undefined, 'Missing output option setting');

    const parser = new internals.Parser(req, tap, options, next);
    return parser.read();
};
$FilePath$/home/tiago/empirical-jsvuln-tools-study/framework/src/packages/CWE-400/1477/package/lib/index.js
Line 513	    return from.pipe(to);

|checker| success id$0$color:green$: 
==========================
$FilePath$/home/tiago/empirical-jsvuln-tools-study/framework/src/packages/CWE-400/1477/package/lib/index.js
Line 481	internals.Counter = function (options) {

    Stream.Transform.call(this);
    this.bytes = 0;
    this._maxBytes = options.maxBytes;
};
$FilePath$/home/tiago/empirical-jsvuln-tools-study/framework/src/packages/CWE-400/1477/package/lib/index.js
Line 488	Hoek.inherits(internals.Counter, Stream.Transform);
$FilePath$/home/tiago/empirical-jsvuln-tools-study/framework/src/packages/CWE-400/1477/package/lib/index.js
Line 28	    Hoek.assert(options.parse !== undefined, 'Missing parse option setting');
$FilePath$/home/tiago/empirical-jsvuln-tools-study/framework/src/packages/CWE-400/1477/package/lib/index.js
Line 64	    const contentType = Content.type(this.settings.override || req.headers['content-type'] || this.settings.defaultContentType || 'application/octet-stream');
$FilePath$/home/tiago/empirical-jsvuln-tools-study/framework/src/packages/CWE-400/1477/package/lib/index.js
Line 305	    const dispenserOptions = Hoek.applyToDefaults(contentType, { maxBytes: this.settings.maxBytes });
$FilePath$/home/tiago/empirical-jsvuln-tools-study/framework/src/packages/CWE-400/1477/package/lib/index.js
Line 446	    const path = Hoek.uniqueFilename(this.settings.uploads || Os.tmpdir());
$FilePath$/home/tiago/empirical-jsvuln-tools-study/framework/src/packages/CWE-400/1477/package/lib/index.js
Line 447	    const file = Fs.createWriteStream(path, { flags: 'wx' });
$FilePath$/home/tiago/empirical-jsvuln-tools-study/framework/src/packages/CWE-400/1477/package/lib/index.js
Line 513	    return from.pipe(to);

|checker| success id$1$color:green$: 
==========================
$FilePath$/home/tiago/empirical-jsvuln-tools-study/framework/src/packages/CWE-400/1477/package/lib/index.js
Line 481	internals.Counter = function (options) {

    Stream.Transform.call(this);
    this.bytes = 0;
    this._maxBytes = options.maxBytes;
};
$FilePath$/home/tiago/empirical-jsvuln-tools-study/framework/src/packages/CWE-400/1477/package/lib/index.js
Line 488	Hoek.inherits(internals.Counter, Stream.Transform);
$FilePath$/home/tiago/empirical-jsvuln-tools-study/framework/src/packages/CWE-400/1477/package/lib/index.js
Line 28	    Hoek.assert(options.parse !== undefined, 'Missing parse option setting');
$FilePath$/home/tiago/empirical-jsvuln-tools-study/framework/src/packages/CWE-400/1477/package/lib/index.js
Line 64	    const contentType = Content.type(this.settings.override || req.headers['content-type'] || this.settings.defaultContentType || 'application/octet-stream');
$FilePath$/home/tiago/empirical-jsvuln-tools-study/framework/src/packages/CWE-400/1477/package/lib/index.js
Line 305	    const dispenserOptions = Hoek.applyToDefaults(contentType, { maxBytes: this.settings.maxBytes });
$FilePath$/home/tiago/empirical-jsvuln-tools-study/framework/src/packages/CWE-400/1477/package/lib/index.js
Line 306	    const dispenser = new Pez.Dispenser(dispenserOptions);
$FilePath$/home/tiago/empirical-jsvuln-tools-study/framework/src/packages/CWE-400/1477/package/lib/index.js
Line 513	    return from.pipe(to);

|checker| success id$2$color:green$: 
==========================
$FilePath$/home/tiago/empirical-jsvuln-tools-study/framework/src/packages/CWE-400/1477/package/lib/index.js
Line 481	internals.Counter = function (options) {

    Stream.Transform.call(this);
    this.bytes = 0;
    this._maxBytes = options.maxBytes;
};
$FilePath$/home/tiago/empirical-jsvuln-tools-study/framework/src/packages/CWE-400/1477/package/lib/index.js
Line 488	Hoek.inherits(internals.Counter, Stream.Transform);
$FilePath$/home/tiago/empirical-jsvuln-tools-study/framework/src/packages/CWE-400/1477/package/lib/index.js
Line 28	    Hoek.assert(options.parse !== undefined, 'Missing parse option setting');
$FilePath$/home/tiago/empirical-jsvuln-tools-study/framework/src/packages/CWE-400/1477/package/lib/index.js
Line 446	    const path = Hoek.uniqueFilename(this.settings.uploads || Os.tmpdir());
$FilePath$/home/tiago/empirical-jsvuln-tools-study/framework/src/packages/CWE-400/1477/package/lib/index.js
Line 447	    const file = Fs.createWriteStream(path, { flags: 'wx' });
$FilePath$/home/tiago/empirical-jsvuln-tools-study/framework/src/packages/CWE-400/1477/package/lib/index.js
Line 513	    return from.pipe(to);

|checker| success id$3$color:green$: 
==========================
$FilePath$/home/tiago/empirical-jsvuln-tools-study/framework/src/packages/CWE-400/1477/package/lib/index.js
Line 25	exports.parse = function (req, tap, options, next) {

    Hoek.assert(options, 'Missing options');
    Hoek.assert(options.parse !== undefined, 'Missing parse option setting');
    Hoek.assert(options.output !== undefined, 'Missing output option setting');

    const parser = new internals.Parser(req, tap, options, next);
    return parser.read();
};
$FilePath$/home/tiago/empirical-jsvuln-tools-study/framework/src/packages/CWE-400/1477/package/lib/index.js
Line 64	    const contentType = Content.type(this.settings.override || req.headers['content-type'] || this.settings.defaultContentType || 'application/octet-stream');
$FilePath$/home/tiago/empirical-jsvuln-tools-study/framework/src/packages/CWE-400/1477/package/lib/index.js
Line 305	    const dispenserOptions = Hoek.applyToDefaults(contentType, { maxBytes: this.settings.maxBytes });
$FilePath$/home/tiago/empirical-jsvuln-tools-study/framework/src/packages/CWE-400/1477/package/lib/index.js
Line 446	    const path = Hoek.uniqueFilename(this.settings.uploads || Os.tmpdir());
$FilePath$/home/tiago/empirical-jsvuln-tools-study/framework/src/packages/CWE-400/1477/package/lib/index.js
Line 447	    const file = Fs.createWriteStream(path, { flags: 'wx' });
$FilePath$/home/tiago/empirical-jsvuln-tools-study/framework/src/packages/CWE-400/1477/package/lib/index.js
Line 513	    return from.pipe(to);

|checker| success id$4$color:green$: 
==========================
$FilePath$/home/tiago/empirical-jsvuln-tools-study/framework/src/packages/CWE-400/1477/package/lib/index.js
Line 54	    const contentLength = req.headers['content-length'];
$FilePath$/home/tiago/empirical-jsvuln-tools-study/framework/src/packages/CWE-400/1477/package/lib/index.js
Line 64	    const contentType = Content.type(this.settings.override || req.headers['content-type'] || this.settings.defaultContentType || 'application/octet-stream');
$FilePath$/home/tiago/empirical-jsvuln-tools-study/framework/src/packages/CWE-400/1477/package/lib/index.js
Line 305	    const dispenserOptions = Hoek.applyToDefaults(contentType, { maxBytes: this.settings.maxBytes });
$FilePath$/home/tiago/empirical-jsvuln-tools-study/framework/src/packages/CWE-400/1477/package/lib/index.js
Line 446	    const path = Hoek.uniqueFilename(this.settings.uploads || Os.tmpdir());
$FilePath$/home/tiago/empirical-jsvuln-tools-study/framework/src/packages/CWE-400/1477/package/lib/index.js
Line 447	    const file = Fs.createWriteStream(path, { flags: 'wx' });
$FilePath$/home/tiago/empirical-jsvuln-tools-study/framework/src/packages/CWE-400/1477/package/lib/index.js
Line 513	    return from.pipe(to);

|checker| success id$5$color:green$: 
==========================
$FilePath$/home/tiago/empirical-jsvuln-tools-study/framework/src/packages/CWE-400/1477/package/lib/index.js
Line 31	    const parser = new internals.Parser(req, tap, options, next);
$FilePath$/home/tiago/empirical-jsvuln-tools-study/framework/src/packages/CWE-400/1477/package/lib/index.js
Line 64	    const contentType = Content.type(this.settings.override || req.headers['content-type'] || this.settings.defaultContentType || 'application/octet-stream');
$FilePath$/home/tiago/empirical-jsvuln-tools-study/framework/src/packages/CWE-400/1477/package/lib/index.js
Line 305	    const dispenserOptions = Hoek.applyToDefaults(contentType, { maxBytes: this.settings.maxBytes });
$FilePath$/home/tiago/empirical-jsvuln-tools-study/framework/src/packages/CWE-400/1477/package/lib/index.js
Line 446	    const path = Hoek.uniqueFilename(this.settings.uploads || Os.tmpdir());
$FilePath$/home/tiago/empirical-jsvuln-tools-study/framework/src/packages/CWE-400/1477/package/lib/index.js
Line 447	    const file = Fs.createWriteStream(path, { flags: 'wx' });
$FilePath$/home/tiago/empirical-jsvuln-tools-study/framework/src/packages/CWE-400/1477/package/lib/index.js
Line 513	    return from.pipe(to);

|checker| success id$6$color:green$: 
==========================
$FilePath$/home/tiago/empirical-jsvuln-tools-study/framework/src/packages/CWE-400/1477/package/lib/index.js
Line 481	internals.Counter = function (options) {

    Stream.Transform.call(this);
    this.bytes = 0;
    this._maxBytes = options.maxBytes;
};
$FilePath$/home/tiago/empirical-jsvuln-tools-study/framework/src/packages/CWE-400/1477/package/lib/index.js
Line 488	Hoek.inherits(internals.Counter, Stream.Transform);
$FilePath$/home/tiago/empirical-jsvuln-tools-study/framework/src/packages/CWE-400/1477/package/lib/index.js
Line 305	    const dispenserOptions = Hoek.applyToDefaults(contentType, { maxBytes: this.settings.maxBytes });
$FilePath$/home/tiago/empirical-jsvuln-tools-study/framework/src/packages/CWE-400/1477/package/lib/index.js
Line 446	    const path = Hoek.uniqueFilename(this.settings.uploads || Os.tmpdir());
$FilePath$/home/tiago/empirical-jsvuln-tools-study/framework/src/packages/CWE-400/1477/package/lib/index.js
Line 447	    const file = Fs.createWriteStream(path, { flags: 'wx' });
$FilePath$/home/tiago/empirical-jsvuln-tools-study/framework/src/packages/CWE-400/1477/package/lib/index.js
Line 513	    return from.pipe(to);

|checker| success id$7$color:green$: 
==========================
$FilePath$/home/tiago/empirical-jsvuln-tools-study/framework/src/packages/CWE-400/1477/package/lib/index.js
Line 25	exports.parse = function (req, tap, options, next) {

    Hoek.assert(options, 'Missing options');
    Hoek.assert(options.parse !== undefined, 'Missing parse option setting');
    Hoek.assert(options.output !== undefined, 'Missing output option setting');

    const parser = new internals.Parser(req, tap, options, next);
    return parser.read();
};
$FilePath$/home/tiago/empirical-jsvuln-tools-study/framework/src/packages/CWE-400/1477/package/lib/index.js
Line 64	    const contentType = Content.type(this.settings.override || req.headers['content-type'] || this.settings.defaultContentType || 'application/octet-stream');
$FilePath$/home/tiago/empirical-jsvuln-tools-study/framework/src/packages/CWE-400/1477/package/lib/index.js
Line 305	    const dispenserOptions = Hoek.applyToDefaults(contentType, { maxBytes: this.settings.maxBytes });
$FilePath$/home/tiago/empirical-jsvuln-tools-study/framework/src/packages/CWE-400/1477/package/lib/index.js
Line 306	    const dispenser = new Pez.Dispenser(dispenserOptions);
$FilePath$/home/tiago/empirical-jsvuln-tools-study/framework/src/packages/CWE-400/1477/package/lib/index.js
Line 513	    return from.pipe(to);

|checker| success id$8$color:green$: 
==========================
$FilePath$/home/tiago/empirical-jsvuln-tools-study/framework/src/packages/CWE-400/1477/package/lib/index.js
Line 54	    const contentLength = req.headers['content-length'];
$FilePath$/home/tiago/empirical-jsvuln-tools-study/framework/src/packages/CWE-400/1477/package/lib/index.js
Line 64	    const contentType = Content.type(this.settings.override || req.headers['content-type'] || this.settings.defaultContentType || 'application/octet-stream');
$FilePath$/home/tiago/empirical-jsvuln-tools-study/framework/src/packages/CWE-400/1477/package/lib/index.js
Line 305	    const dispenserOptions = Hoek.applyToDefaults(contentType, { maxBytes: this.settings.maxBytes });
$FilePath$/home/tiago/empirical-jsvuln-tools-study/framework/src/packages/CWE-400/1477/package/lib/index.js
Line 306	    const dispenser = new Pez.Dispenser(dispenserOptions);
$FilePath$/home/tiago/empirical-jsvuln-tools-study/framework/src/packages/CWE-400/1477/package/lib/index.js
Line 513	    return from.pipe(to);

|checker| success id$9$color:green$: 
==========================
$FilePath$/home/tiago/empirical-jsvuln-tools-study/framework/src/packages/CWE-400/1477/package/lib/index.js
Line 31	    const parser = new internals.Parser(req, tap, options, next);
$FilePath$/home/tiago/empirical-jsvuln-tools-study/framework/src/packages/CWE-400/1477/package/lib/index.js
Line 64	    const contentType = Content.type(this.settings.override || req.headers['content-type'] || this.settings.defaultContentType || 'application/octet-stream');
$FilePath$/home/tiago/empirical-jsvuln-tools-study/framework/src/packages/CWE-400/1477/package/lib/index.js
Line 305	    const dispenserOptions = Hoek.applyToDefaults(contentType, { maxBytes: this.settings.maxBytes });
$FilePath$/home/tiago/empirical-jsvuln-tools-study/framework/src/packages/CWE-400/1477/package/lib/index.js
Line 306	    const dispenser = new Pez.Dispenser(dispenserOptions);
$FilePath$/home/tiago/empirical-jsvuln-tools-study/framework/src/packages/CWE-400/1477/package/lib/index.js
Line 513	    return from.pipe(to);

|checker| success id$10$color:green$: 
==========================
$FilePath$/home/tiago/empirical-jsvuln-tools-study/framework/src/packages/CWE-400/1477/package/lib/index.js
Line 481	internals.Counter = function (options) {

    Stream.Transform.call(this);
    this.bytes = 0;
    this._maxBytes = options.maxBytes;
};
$FilePath$/home/tiago/empirical-jsvuln-tools-study/framework/src/packages/CWE-400/1477/package/lib/index.js
Line 488	Hoek.inherits(internals.Counter, Stream.Transform);
$FilePath$/home/tiago/empirical-jsvuln-tools-study/framework/src/packages/CWE-400/1477/package/lib/index.js
Line 305	    const dispenserOptions = Hoek.applyToDefaults(contentType, { maxBytes: this.settings.maxBytes });
$FilePath$/home/tiago/empirical-jsvuln-tools-study/framework/src/packages/CWE-400/1477/package/lib/index.js
Line 306	    const dispenser = new Pez.Dispenser(dispenserOptions);
$FilePath$/home/tiago/empirical-jsvuln-tools-study/framework/src/packages/CWE-400/1477/package/lib/index.js
Line 513	    return from.pipe(to);

|checker| success id$11$color:green$: 
==========================
$FilePath$/home/tiago/empirical-jsvuln-tools-study/framework/src/packages/CWE-400/1477/package/lib/index.js
Line 481	internals.Counter = function (options) {

    Stream.Transform.call(this);
    this.bytes = 0;
    this._maxBytes = options.maxBytes;
};
$FilePath$/home/tiago/empirical-jsvuln-tools-study/framework/src/packages/CWE-400/1477/package/lib/index.js
Line 488	Hoek.inherits(internals.Counter, Stream.Transform);
$FilePath$/home/tiago/empirical-jsvuln-tools-study/framework/src/packages/CWE-400/1477/package/lib/index.js
Line 446	    const path = Hoek.uniqueFilename(this.settings.uploads || Os.tmpdir());
$FilePath$/home/tiago/empirical-jsvuln-tools-study/framework/src/packages/CWE-400/1477/package/lib/index.js
Line 447	    const file = Fs.createWriteStream(path, { flags: 'wx' });
$FilePath$/home/tiago/empirical-jsvuln-tools-study/framework/src/packages/CWE-400/1477/package/lib/index.js
Line 513	    return from.pipe(to);

|checker| success id$12$color:green$: 
==========================
$FilePath$/home/tiago/empirical-jsvuln-tools-study/framework/src/packages/CWE-400/1477/package/lib/index.js
Line 90	internals.Parser.prototype.parse = function (contentType) {

    let next = this.next;

    const output = this.settings.output;        // Output: 'data', 'stream', 'file'
    let source = this.req;

    // Content-encoding

    const contentEncoding = source.headers['content-encoding'];
    const decoder = (this.settings.decoders || internals.decoders)[contentEncoding];
    if (decoder) {
        const decoderOptions = (this.settings.compression && this.settings.compression[contentEncoding]) || null;
        const stream = decoder(decoderOptions);
        next = Hoek.once(next);                 // Modify next() for async events
        this.next = next;
        stream.once('error', (err) => {

            return next(Boom.badRequest('Invalid compressed payload', err));
        });

        source = internals.pipe(source, stream);
    }

    // Tap request

    if (this.tap) {
        source = internals.pipe(source, this.tap);
    }

    // Multipart

    if (this.result.contentType.mime === 'multipart/form-data') {
        if (this.settings.multipart === false) {                            // Defaults to true
            return next(Boom.unsupportedMediaType());
        }

        return this.multipart(source, contentType);
    }

    // Output: 'stream'

    if (output === 'stream') {
        this.result.payload = source;
        return next();
    }

    // Output: 'file'

    if (output === 'file') {
        this.writeFile(source, this.settings, (err, path, bytes) => {

            if (err) {
                return next(err);
            }

            this.result.payload = { path, bytes };
            return next();
        });

        return;
    }

    // Output: 'data'

    return Wreck.read(source, { timeout: this.settings.timeout, maxBytes: this.settings.maxBytes }, (err, payload) => {

        if (err) {
            return next(err);
        }

        this.object(payload, this.result.contentType.mime, (err, result) => {

            if (err) {
                this.result.payload = null;
                err.raw = payload;
                return next(err);
            }

            this.result.payload = result;
            return next();
        });
    });
};
$FilePath$/home/tiago/empirical-jsvuln-tools-study/framework/src/packages/CWE-400/1477/package/lib/index.js
Line 305	    const dispenserOptions = Hoek.applyToDefaults(contentType, { maxBytes: this.settings.maxBytes });
$FilePath$/home/tiago/empirical-jsvuln-tools-study/framework/src/packages/CWE-400/1477/package/lib/index.js
Line 446	    const path = Hoek.uniqueFilename(this.settings.uploads || Os.tmpdir());
$FilePath$/home/tiago/empirical-jsvuln-tools-study/framework/src/packages/CWE-400/1477/package/lib/index.js
Line 447	    const file = Fs.createWriteStream(path, { flags: 'wx' });
$FilePath$/home/tiago/empirical-jsvuln-tools-study/framework/src/packages/CWE-400/1477/package/lib/index.js
Line 513	    return from.pipe(to);

|checker| success id$13$color:green$: 
==========================
$FilePath$/home/tiago/empirical-jsvuln-tools-study/framework/src/packages/CWE-400/1477/package/lib/index.js
Line 294	internals.Parser.prototype.multipart = function (source, contentType) {

    let next = this.next;
    next = Hoek.once(next);                                            // Modify next() for async events
    this.next = next;

    // Set stream timeout

    const clientTimeout = this.settings.timeout;
    let clientTimeoutId = null;

    const dispenserOptions = Hoek.applyToDefaults(contentType, { maxBytes: this.settings.maxBytes });
    const dispenser = new Pez.Dispenser(dispenserOptions);

    const onError = (err) => {

        return next(Boom.badRequest('Invalid multipart payload format', err));
    };

    dispenser.once('error', onError);

    const data = {};
    const finalize = () => {

        clearTimeout(clientTimeoutId);
        dispenser.removeListener('error', onError);
        dispenser.removeListener('part', onPart);
        dispenser.removeListener('field', onField);
        dispenser.removeListener('close', onClose);

        this.result.payload = data;
        return next();
    };

    if (clientTimeout &&
        clientTimeout > 0) {

        clientTimeoutId = setTimeout(() => {

            return next(Boom.clientTimeout());
        }, clientTimeout);
    }

    const set = (name, value) => {

        if (!data.hasOwnProperty(name)) {
            data[name] = value;
        }
        else if (Array.isArray(data[name])) {
            data[name].push(value);
        }
        else {
            data[name] = [data[name], value];
        }
    };

    const pendingFiles = {};
    let nextId = 0;
    let closed = false;

    const output = (this.settings.multipart ? this.settings.multipart.output : this.settings.output);

    const onPart = (part) => {

        if (output === 'file') {                                                                // Output: 'file'
            const id = nextId++;
            pendingFiles[id] = true;
            this.writeFile(part, this.settings, (err, path, bytes) => {

                delete pendingFiles[id];

                if (err) {
                    return next(err);
                }

                const item = {
                    filename: part.filename,
                    path,
                    headers: part.headers,
                    bytes
                };

                set(part.name, item);

                /* $lab:coverage:off$ */
                if (closed &&
                    !Object.keys(pendingFiles).length) {

                    return finalize(data);
                }
                /* $lab:coverage:on$ */
            });
        }
        else {                                                                                  // Output: 'data'
            Wreck.read(part, {}, (ignoreErr, payload) => {

                // Error handled by dispenser.once('error')

                if (output === 'stream') {                                                      // Output: 'stream'
                    const item = Wreck.toReadableStream(payload);

                    item.hapi = {
                        filename: part.filename,
                        headers: part.headers
                    };

                    return set(part.name, item);
                }

                const ct = part.headers['content-type'] || '';
                const mime = ct.split(';')[0].trim().toLowerCase();
                const annotate = (value) => set(part.name, output === 'annotated' ? { filename: part.filename, headers: part.headers, payload: value } : value);

                if (!mime) {
                    return annotate(payload);
                }

                if (!payload.length) {
                    return annotate({});
                }

                this.object(payload, mime, (err, result) => annotate(err ? payload : result));
            });
        }
    };

    dispenser.on('part', onPart);

    const onField = (name, value) => set(name, value);

    dispenser.on('field', onField);

    const onClose = () => {

        /* $lab:coverage:off$ */
        if (Object.keys(pendingFiles).length) {
            closed = true;
            return;
        }
        /* $lab:coverage:on$ */

        return finalize(data);
    };

    dispenser.once('close', onClose);

    internals.pipe(source, dispenser);
};
$FilePath$/home/tiago/empirical-jsvuln-tools-study/framework/src/packages/CWE-400/1477/package/lib/index.js
Line 305	    const dispenserOptions = Hoek.applyToDefaults(contentType, { maxBytes: this.settings.maxBytes });
$FilePath$/home/tiago/empirical-jsvuln-tools-study/framework/src/packages/CWE-400/1477/package/lib/index.js
Line 446	    const path = Hoek.uniqueFilename(this.settings.uploads || Os.tmpdir());
$FilePath$/home/tiago/empirical-jsvuln-tools-study/framework/src/packages/CWE-400/1477/package/lib/index.js
Line 447	    const file = Fs.createWriteStream(path, { flags: 'wx' });
$FilePath$/home/tiago/empirical-jsvuln-tools-study/framework/src/packages/CWE-400/1477/package/lib/index.js
Line 513	    return from.pipe(to);

|checker| success id$14$color:green$: 
==========================
$FilePath$/home/tiago/empirical-jsvuln-tools-study/framework/src/packages/CWE-400/1477/package/lib/index.js
Line 42	    this.result = {};
$FilePath$/home/tiago/empirical-jsvuln-tools-study/framework/src/packages/CWE-400/1477/package/lib/index.js
Line 305	    const dispenserOptions = Hoek.applyToDefaults(contentType, { maxBytes: this.settings.maxBytes });
$FilePath$/home/tiago/empirical-jsvuln-tools-study/framework/src/packages/CWE-400/1477/package/lib/index.js
Line 446	    const path = Hoek.uniqueFilename(this.settings.uploads || Os.tmpdir());
$FilePath$/home/tiago/empirical-jsvuln-tools-study/framework/src/packages/CWE-400/1477/package/lib/index.js
Line 447	    const file = Fs.createWriteStream(path, { flags: 'wx' });
$FilePath$/home/tiago/empirical-jsvuln-tools-study/framework/src/packages/CWE-400/1477/package/lib/index.js
Line 513	    return from.pipe(to);

|checker| success id$15$color:green$: 
==========================
$FilePath$/home/tiago/empirical-jsvuln-tools-study/framework/src/packages/CWE-400/1477/package/lib/index.js
Line 388	            Wreck.read(part, {}, (ignoreErr, payload) => {

                // Error handled by dispenser.once('error')

                if (output === 'stream') {                                                      // Output: 'stream'
                    const item = Wreck.toReadableStream(payload);

                    item.hapi = {
                        filename: part.filename,
                        headers: part.headers
                    };

                    return set(part.name, item);
                }

                const ct = part.headers['content-type'] || '';
                const mime = ct.split(';')[0].trim().toLowerCase();
                const annotate = (value) => set(part.name, output === 'annotated' ? { filename: part.filename, headers: part.headers, payload: value } : value);

                if (!mime) {
                    return annotate(payload);
                }

                if (!payload.length) {
                    return annotate({});
                }

                this.object(payload, mime, (err, result) => annotate(err ? payload : result));
            });
$FilePath$/home/tiago/empirical-jsvuln-tools-study/framework/src/packages/CWE-400/1477/package/lib/index.js
Line 155	    return Wreck.read(source, { timeout: this.settings.timeout, maxBytes: this.settings.maxBytes }, (err, payload) => {

        if (err) {
            return next(err);
        }

        this.object(payload, this.result.contentType.mime, (err, result) => {

            if (err) {
                this.result.payload = null;
                err.raw = payload;
                return next(err);
            }

            this.result.payload = result;
            return next();
        });
    });
$FilePath$/home/tiago/empirical-jsvuln-tools-study/framework/src/packages/CWE-400/1477/package/lib/index.js
Line 446	    const path = Hoek.uniqueFilename(this.settings.uploads || Os.tmpdir());
$FilePath$/home/tiago/empirical-jsvuln-tools-study/framework/src/packages/CWE-400/1477/package/lib/index.js
Line 447	    const file = Fs.createWriteStream(path, { flags: 'wx' });
$FilePath$/home/tiago/empirical-jsvuln-tools-study/framework/src/packages/CWE-400/1477/package/lib/index.js
Line 513	    return from.pipe(to);

|checker| success id$16$color:green$: 
==========================
$FilePath$/home/tiago/empirical-jsvuln-tools-study/framework/src/packages/CWE-400/1477/package/lib/index.js
Line 42	    this.result = {};
$FilePath$/home/tiago/empirical-jsvuln-tools-study/framework/src/packages/CWE-400/1477/package/lib/index.js
Line 155	    return Wreck.read(source, { timeout: this.settings.timeout, maxBytes: this.settings.maxBytes }, (err, payload) => {

        if (err) {
            return next(err);
        }

        this.object(payload, this.result.contentType.mime, (err, result) => {

            if (err) {
                this.result.payload = null;
                err.raw = payload;
                return next(err);
            }

            this.result.payload = result;
            return next();
        });
    });
$FilePath$/home/tiago/empirical-jsvuln-tools-study/framework/src/packages/CWE-400/1477/package/lib/index.js
Line 446	    const path = Hoek.uniqueFilename(this.settings.uploads || Os.tmpdir());
$FilePath$/home/tiago/empirical-jsvuln-tools-study/framework/src/packages/CWE-400/1477/package/lib/index.js
Line 447	    const file = Fs.createWriteStream(path, { flags: 'wx' });
$FilePath$/home/tiago/empirical-jsvuln-tools-study/framework/src/packages/CWE-400/1477/package/lib/index.js
Line 513	    return from.pipe(to);

|checker| success id$17$color:green$: 
==========================
$FilePath$/home/tiago/empirical-jsvuln-tools-study/framework/src/packages/CWE-400/1477/package/lib/index.js
Line 90	internals.Parser.prototype.parse = function (contentType) {

    let next = this.next;

    const output = this.settings.output;        // Output: 'data', 'stream', 'file'
    let source = this.req;

    // Content-encoding

    const contentEncoding = source.headers['content-encoding'];
    const decoder = (this.settings.decoders || internals.decoders)[contentEncoding];
    if (decoder) {
        const decoderOptions = (this.settings.compression && this.settings.compression[contentEncoding]) || null;
        const stream = decoder(decoderOptions);
        next = Hoek.once(next);                 // Modify next() for async events
        this.next = next;
        stream.once('error', (err) => {

            return next(Boom.badRequest('Invalid compressed payload', err));
        });

        source = internals.pipe(source, stream);
    }

    // Tap request

    if (this.tap) {
        source = internals.pipe(source, this.tap);
    }

    // Multipart

    if (this.result.contentType.mime === 'multipart/form-data') {
        if (this.settings.multipart === false) {                            // Defaults to true
            return next(Boom.unsupportedMediaType());
        }

        return this.multipart(source, contentType);
    }

    // Output: 'stream'

    if (output === 'stream') {
        this.result.payload = source;
        return next();
    }

    // Output: 'file'

    if (output === 'file') {
        this.writeFile(source, this.settings, (err, path, bytes) => {

            if (err) {
                return next(err);
            }

            this.result.payload = { path, bytes };
            return next();
        });

        return;
    }

    // Output: 'data'

    return Wreck.read(source, { timeout: this.settings.timeout, maxBytes: this.settings.maxBytes }, (err, payload) => {

        if (err) {
            return next(err);
        }

        this.object(payload, this.result.contentType.mime, (err, result) => {

            if (err) {
                this.result.payload = null;
                err.raw = payload;
                return next(err);
            }

            this.result.payload = result;
            return next();
        });
    });
};
$FilePath$/home/tiago/empirical-jsvuln-tools-study/framework/src/packages/CWE-400/1477/package/lib/index.js
Line 305	    const dispenserOptions = Hoek.applyToDefaults(contentType, { maxBytes: this.settings.maxBytes });
$FilePath$/home/tiago/empirical-jsvuln-tools-study/framework/src/packages/CWE-400/1477/package/lib/index.js
Line 306	    const dispenser = new Pez.Dispenser(dispenserOptions);
$FilePath$/home/tiago/empirical-jsvuln-tools-study/framework/src/packages/CWE-400/1477/package/lib/index.js
Line 513	    return from.pipe(to);

|checker| success id$18$color:green$: 
==========================
$FilePath$/home/tiago/empirical-jsvuln-tools-study/framework/src/packages/CWE-400/1477/package/lib/index.js
Line 294	internals.Parser.prototype.multipart = function (source, contentType) {

    let next = this.next;
    next = Hoek.once(next);                                            // Modify next() for async events
    this.next = next;

    // Set stream timeout

    const clientTimeout = this.settings.timeout;
    let clientTimeoutId = null;

    const dispenserOptions = Hoek.applyToDefaults(contentType, { maxBytes: this.settings.maxBytes });
    const dispenser = new Pez.Dispenser(dispenserOptions);

    const onError = (err) => {

        return next(Boom.badRequest('Invalid multipart payload format', err));
    };

    dispenser.once('error', onError);

    const data = {};
    const finalize = () => {

        clearTimeout(clientTimeoutId);
        dispenser.removeListener('error', onError);
        dispenser.removeListener('part', onPart);
        dispenser.removeListener('field', onField);
        dispenser.removeListener('close', onClose);

        this.result.payload = data;
        return next();
    };

    if (clientTimeout &&
        clientTimeout > 0) {

        clientTimeoutId = setTimeout(() => {

            return next(Boom.clientTimeout());
        }, clientTimeout);
    }

    const set = (name, value) => {

        if (!data.hasOwnProperty(name)) {
            data[name] = value;
        }
        else if (Array.isArray(data[name])) {
            data[name].push(value);
        }
        else {
            data[name] = [data[name], value];
        }
    };

    const pendingFiles = {};
    let nextId = 0;
    let closed = false;

    const output = (this.settings.multipart ? this.settings.multipart.output : this.settings.output);

    const onPart = (part) => {

        if (output === 'file') {                                                                // Output: 'file'
            const id = nextId++;
            pendingFiles[id] = true;
            this.writeFile(part, this.settings, (err, path, bytes) => {

                delete pendingFiles[id];

                if (err) {
                    return next(err);
                }

                const item = {
                    filename: part.filename,
                    path,
                    headers: part.headers,
                    bytes
                };

                set(part.name, item);

                /* $lab:coverage:off$ */
                if (closed &&
                    !Object.keys(pendingFiles).length) {

                    return finalize(data);
                }
                /* $lab:coverage:on$ */
            });
        }
        else {                                                                                  // Output: 'data'
            Wreck.read(part, {}, (ignoreErr, payload) => {

                // Error handled by dispenser.once('error')

                if (output === 'stream') {                                                      // Output: 'stream'
                    const item = Wreck.toReadableStream(payload);

                    item.hapi = {
                        filename: part.filename,
                        headers: part.headers
                    };

                    return set(part.name, item);
                }

                const ct = part.headers['content-type'] || '';
                const mime = ct.split(';')[0].trim().toLowerCase();
                const annotate = (value) => set(part.name, output === 'annotated' ? { filename: part.filename, headers: part.headers, payload: value } : value);

                if (!mime) {
                    return annotate(payload);
                }

                if (!payload.length) {
                    return annotate({});
                }

                this.object(payload, mime, (err, result) => annotate(err ? payload : result));
            });
        }
    };

    dispenser.on('part', onPart);

    const onField = (name, value) => set(name, value);

    dispenser.on('field', onField);

    const onClose = () => {

        /* $lab:coverage:off$ */
        if (Object.keys(pendingFiles).length) {
            closed = true;
            return;
        }
        /* $lab:coverage:on$ */

        return finalize(data);
    };

    dispenser.once('close', onClose);

    internals.pipe(source, dispenser);
};
$FilePath$/home/tiago/empirical-jsvuln-tools-study/framework/src/packages/CWE-400/1477/package/lib/index.js
Line 305	    const dispenserOptions = Hoek.applyToDefaults(contentType, { maxBytes: this.settings.maxBytes });
$FilePath$/home/tiago/empirical-jsvuln-tools-study/framework/src/packages/CWE-400/1477/package/lib/index.js
Line 306	    const dispenser = new Pez.Dispenser(dispenserOptions);
$FilePath$/home/tiago/empirical-jsvuln-tools-study/framework/src/packages/CWE-400/1477/package/lib/index.js
Line 513	    return from.pipe(to);

|checker| success id$19$color:green$: 
==========================
$FilePath$/home/tiago/empirical-jsvuln-tools-study/framework/src/packages/CWE-400/1477/package/lib/index.js
Line 42	    this.result = {};
$FilePath$/home/tiago/empirical-jsvuln-tools-study/framework/src/packages/CWE-400/1477/package/lib/index.js
Line 305	    const dispenserOptions = Hoek.applyToDefaults(contentType, { maxBytes: this.settings.maxBytes });
$FilePath$/home/tiago/empirical-jsvuln-tools-study/framework/src/packages/CWE-400/1477/package/lib/index.js
Line 306	    const dispenser = new Pez.Dispenser(dispenserOptions);
$FilePath$/home/tiago/empirical-jsvuln-tools-study/framework/src/packages/CWE-400/1477/package/lib/index.js
Line 513	    return from.pipe(to);

|checker| success id$20$color:green$: 
==========================
$FilePath$/home/tiago/empirical-jsvuln-tools-study/framework/src/packages/CWE-400/1477/package/lib/index.js
Line 448	    const counter = new internals.Counter(options);
$FilePath$/home/tiago/empirical-jsvuln-tools-study/framework/src/packages/CWE-400/1477/package/lib/index.js
Line 446	    const path = Hoek.uniqueFilename(this.settings.uploads || Os.tmpdir());
$FilePath$/home/tiago/empirical-jsvuln-tools-study/framework/src/packages/CWE-400/1477/package/lib/index.js
Line 447	    const file = Fs.createWriteStream(path, { flags: 'wx' });
$FilePath$/home/tiago/empirical-jsvuln-tools-study/framework/src/packages/CWE-400/1477/package/lib/index.js
Line 513	    return from.pipe(to);

|checker| success id$21$color:green$: 
==========================
$FilePath$/home/tiago/empirical-jsvuln-tools-study/framework/src/packages/CWE-400/1477/package/lib/index.js
Line 25	exports.parse = function (req, tap, options, next) {

    Hoek.assert(options, 'Missing options');
    Hoek.assert(options.parse !== undefined, 'Missing parse option setting');
    Hoek.assert(options.output !== undefined, 'Missing output option setting');

    const parser = new internals.Parser(req, tap, options, next);
    return parser.read();
};
$FilePath$/home/tiago/empirical-jsvuln-tools-study/framework/src/packages/CWE-400/1477/package/lib/index.js
Line 446	    const path = Hoek.uniqueFilename(this.settings.uploads || Os.tmpdir());
$FilePath$/home/tiago/empirical-jsvuln-tools-study/framework/src/packages/CWE-400/1477/package/lib/index.js
Line 447	    const file = Fs.createWriteStream(path, { flags: 'wx' });
$FilePath$/home/tiago/empirical-jsvuln-tools-study/framework/src/packages/CWE-400/1477/package/lib/index.js
Line 513	    return from.pipe(to);

|checker| success id$22$color:green$: 
==========================
$FilePath$/home/tiago/empirical-jsvuln-tools-study/framework/src/packages/CWE-400/1477/package/lib/index.js
Line 444	internals.Parser.prototype.writeFile = function (stream, options, callback) {

    const path = Hoek.uniqueFilename(this.settings.uploads || Os.tmpdir());
    const file = Fs.createWriteStream(path, { flags: 'wx' });
    const counter = new internals.Counter(options);

    const finalize = Hoek.once((err) => {

        this.req.removeListener('aborted', onAbort);
        file.removeListener('close', finalize);
        file.removeListener('error', finalize);

        if (!err) {
            return callback(null, path, counter.bytes);
        }

        file.destroy();
        Fs.unlink(path, (/* fsErr */) => {      // Ignore unlink errors

            return callback(err);
        });
    });

    file.once('close', finalize);
    file.once('error', finalize);

    const onAbort = () => {

        return finalize(Boom.badRequest('Client connection aborted'));
    };

    this.req.once('aborted', onAbort);

    internals.pipe(internals.pipe(stream, counter), file);
};
$FilePath$/home/tiago/empirical-jsvuln-tools-study/framework/src/packages/CWE-400/1477/package/lib/index.js
Line 446	    const path = Hoek.uniqueFilename(this.settings.uploads || Os.tmpdir());
$FilePath$/home/tiago/empirical-jsvuln-tools-study/framework/src/packages/CWE-400/1477/package/lib/index.js
Line 447	    const file = Fs.createWriteStream(path, { flags: 'wx' });
$FilePath$/home/tiago/empirical-jsvuln-tools-study/framework/src/packages/CWE-400/1477/package/lib/index.js
Line 513	    return from.pipe(to);

|checker| success id$23$color:green$: 
==========================
$FilePath$/home/tiago/empirical-jsvuln-tools-study/framework/src/packages/CWE-400/1477/package/lib/index.js
Line 31	    const parser = new internals.Parser(req, tap, options, next);
$FilePath$/home/tiago/empirical-jsvuln-tools-study/framework/src/packages/CWE-400/1477/package/lib/index.js
Line 446	    const path = Hoek.uniqueFilename(this.settings.uploads || Os.tmpdir());
$FilePath$/home/tiago/empirical-jsvuln-tools-study/framework/src/packages/CWE-400/1477/package/lib/index.js
Line 447	    const file = Fs.createWriteStream(path, { flags: 'wx' });
$FilePath$/home/tiago/empirical-jsvuln-tools-study/framework/src/packages/CWE-400/1477/package/lib/index.js
Line 513	    return from.pipe(to);

|checker| success id$24$color:green$: 
==========================
$FilePath$/home/tiago/empirical-jsvuln-tools-study/tools-testing/tools-docker/odgen/ODGen/builtin_packages/fs.js
Line 22	module.exports = {
  read: read,
  readdir: readFile,
  readdirSync: readFile,
  readFile: readFile,
  readFileSync: readFile,
  readlink: read,
  readlinkSync: read,
  readSync: read,
  createReadStream: read
}
$FilePath$/home/tiago/empirical-jsvuln-tools-study/framework/src/packages/CWE-400/1477/package/lib/index.js
Line 447	    const file = Fs.createWriteStream(path, { flags: 'wx' });
$FilePath$/home/tiago/empirical-jsvuln-tools-study/framework/src/packages/CWE-400/1477/package/lib/index.js
Line 513	    return from.pipe(to);

|checker| success id$25$color:green$: 
==========================
$FilePath$/home/tiago/empirical-jsvuln-tools-study/framework/src/packages/CWE-400/1477/package/lib/index.js
Line 25	exports.parse = function (req, tap, options, next) {

    Hoek.assert(options, 'Missing options');
    Hoek.assert(options.parse !== undefined, 'Missing parse option setting');
    Hoek.assert(options.output !== undefined, 'Missing output option setting');

    const parser = new internals.Parser(req, tap, options, next);
    return parser.read();
};
$FilePath$/home/tiago/empirical-jsvuln-tools-study/framework/src/packages/CWE-400/1477/package/lib/index.js
Line 513	    return from.pipe(to);

