{
  "errors": [
    {
      "code": 9,
      "level": "warn",
      "path": "/src/dist/joint.nowrap.js",
      "rule_id": "usr.local.lib.python3.8.site-packages.njsscan.rules.semantic_grep.redirect.express_open_redirect2",
      "type": "MatchTimeoutError"
    },
    {
      "code": 3,
      "help": "If the code appears to be valid, this may be a semgrep bug.",
      "level": "warn",
      "long_msg": "Could not parse Makefile as typescript",
      "short_msg": "parse error",
      "spans": [
        {
          "context_end": null,
          "context_start": null,
          "end": {
            "col": 41,
            "line": 2
          },
          "file": "/src/Makefile",
          "source_hash": "69191f967c4cb267152917055033753640eeacafa991a092ea4000fc83f31295",
          "start": {
            "col": 1,
            "line": 2
          }
        }
      ],
      "type": "SourceParseError"
    },
    {
      "code": 9,
      "level": "warn",
      "path": "/src/dist/vectorizer.js",
      "rule_id": "usr.local.lib.python3.8.site-packages.njsscan.rules.semantic_grep.headers.cookie_session_no_path",
      "type": "MatchTimeoutError"
    },
    {
      "code": 9,
      "level": "warn",
      "path": "/src/test/geometry/path.js",
      "rule_id": "usr.local.lib.python3.8.site-packages.njsscan.rules.semantic_grep.headers.cookie_session_no_domain",
      "type": "MatchTimeoutError"
    },
    {
      "code": 9,
      "level": "warn",
      "path": "/src/dist/joint.js",
      "rule_id": "usr.local.lib.python3.8.site-packages.njsscan.rules.semantic_grep.redirect.express_open_redirect2",
      "type": "MatchTimeoutError"
    },
    {
      "code": 9,
      "level": "warn",
      "path": "/src/dist/geometry.js",
      "rule_id": "usr.local.lib.python3.8.site-packages.njsscan.rules.semantic_grep.dos.regex_dos",
      "type": "MatchTimeoutError"
    },
    {
      "code": 3,
      "help": "If the code appears to be valid, this may be a semgrep bug.",
      "level": "warn",
      "long_msg": "Could not parse .editorconfig as javascript",
      "short_msg": "parse error",
      "spans": [
        {
          "context_end": null,
          "context_start": null,
          "end": {
            "col": 18,
            "line": 1
          },
          "file": "/src/.editorconfig",
          "source_hash": "55457262681d81847a822c224ca5f99cb40da60994056acba84b8620fbeb66f0",
          "start": {
            "col": 1,
            "line": 1
          }
        }
      ],
      "type": "SourceParseError"
    },
    {
      "code": 9,
      "level": "warn",
      "path": "/src/dist/joint.core.js",
      "rule_id": "usr.local.lib.python3.8.site-packages.njsscan.rules.semantic_grep.redirect.express_open_redirect",
      "type": "MatchTimeoutError"
    },
    {
      "code": 3,
      "help": "If the code appears to be valid, this may be a semgrep bug.",
      "level": "warn",
      "long_msg": "Could not parse .editorconfig as typescript",
      "short_msg": "parse error",
      "spans": [
        {
          "context_end": null,
          "context_start": null,
          "end": {
            "col": 18,
            "line": 1
          },
          "file": "/src/.editorconfig",
          "source_hash": "55457262681d81847a822c224ca5f99cb40da60994056acba84b8620fbeb66f0",
          "start": {
            "col": 1,
            "line": 1
          }
        }
      ],
      "type": "SourceParseError"
    },
    {
      "code": 9,
      "level": "warn",
      "path": "/src/dist/joint.nowrap.js",
      "rule_id": "usr.local.lib.python3.8.site-packages.njsscan.rules.semantic_grep.xss.express_xss",
      "type": "MatchTimeoutError"
    },
    {
      "code": 9,
      "level": "warn",
      "path": "/src/dist/joint.js",
      "rule_id": "usr.local.lib.python3.8.site-packages.njsscan.rules.semantic_grep.xss.express_xss",
      "type": "MatchTimeoutError"
    },
    {
      "code": 9,
      "level": "warn",
      "path": "/src/test/geometry/path.js",
      "rule_id": "usr.local.lib.python3.8.site-packages.njsscan.rules.semantic_grep.headers.cookie_session_default",
      "type": "MatchTimeoutError"
    },
    {
      "code": 3,
      "help": "If the code appears to be valid, this may be a semgrep bug.",
      "level": "warn",
      "long_msg": "Could not parse LICENSE as javascript",
      "short_msg": "parse error",
      "spans": [
        {
          "context_end": null,
          "context_start": null,
          "end": {
            "col": 22,
            "line": 1
          },
          "file": "/src/LICENSE",
          "source_hash": "c87b2072cc960fceb3852757b598d27cd0767582c405ad0e02e780dce3f44431",
          "start": {
            "col": 1,
            "line": 1
          }
        }
      ],
      "type": "SourceParseError"
    },
    {
      "code": 9,
      "level": "warn",
      "path": "/src/dist/joint.core.js",
      "rule_id": "usr.local.lib.python3.8.site-packages.njsscan.rules.semantic_grep.redirect.express_open_redirect2",
      "type": "MatchTimeoutError"
    },
    {
      "code": 9,
      "level": "warn",
      "path": "/src/dist/vectorizer.js",
      "rule_id": "usr.local.lib.python3.8.site-packages.njsscan.rules.semantic_grep.headers.cookie_session_no_domain",
      "type": "MatchTimeoutError"
    },
    {
      "code": 9,
      "level": "warn",
      "path": "/src/test/geometry/path.js",
      "rule_id": "usr.local.lib.python3.8.site-packages.njsscan.rules.semantic_grep.headers.cookie_session_no_path",
      "type": "MatchTimeoutError"
    },
    {
      "code": 3,
      "help": "If the code appears to be valid, this may be a semgrep bug.",
      "level": "warn",
      "long_msg": "Could not parse LICENSE as typescript",
      "short_msg": "parse error",
      "spans": [
        {
          "context_end": null,
          "context_start": null,
          "end": {
            "col": 22,
            "line": 1
          },
          "file": "/src/LICENSE",
          "source_hash": "c87b2072cc960fceb3852757b598d27cd0767582c405ad0e02e780dce3f44431",
          "start": {
            "col": 1,
            "line": 1
          }
        }
      ],
      "type": "SourceParseError"
    },
    {
      "code": 9,
      "level": "warn",
      "path": "/src/dist/joint.core.js",
      "rule_id": "usr.local.lib.python3.8.site-packages.njsscan.rules.semantic_grep.xss.express_xss",
      "type": "MatchTimeoutError"
    },
    {
      "code": 9,
      "level": "warn",
      "path": "/src/dist/joint.nowrap.js",
      "rule_id": "usr.local.lib.python3.8.site-packages.njsscan.rules.semantic_grep.redirect.express_open_redirect",
      "type": "MatchTimeoutError"
    },
    {
      "code": 3,
      "help": "If the code appears to be valid, this may be a semgrep bug.",
      "level": "warn",
      "long_msg": "Could not parse CHANGELOG as typescript",
      "short_msg": "parse error",
      "spans": [
        {
          "context_end": null,
          "context_start": null,
          "end": {
            "col": 18,
            "line": 1
          },
          "file": "/src/CHANGELOG",
          "source_hash": "5098b9847de1d3d1ef000ee181bc37b150f2fe125ac0be496234019231604168",
          "start": {
            "col": 14,
            "line": 1
          }
        }
      ],
      "type": "SourceParseError"
    },
    {
      "code": 9,
      "level": "warn",
      "path": "/src/dist/vectorizer.js",
      "rule_id": "usr.local.lib.python3.8.site-packages.njsscan.rules.semantic_grep.headers.cookie_session_default",
      "type": "MatchTimeoutError"
    },
    {
      "code": 3,
      "help": "If the code appears to be valid, this may be a semgrep bug.",
      "level": "warn",
      "long_msg": "Could not parse CHANGELOG as javascript",
      "short_msg": "parse error",
      "spans": [
        {
          "context_end": null,
          "context_start": null,
          "end": {
            "col": 18,
            "line": 1
          },
          "file": "/src/CHANGELOG",
          "source_hash": "5098b9847de1d3d1ef000ee181bc37b150f2fe125ac0be496234019231604168",
          "start": {
            "col": 14,
            "line": 1
          }
        }
      ],
      "type": "SourceParseError"
    },
    {
      "code": 9,
      "level": "warn",
      "path": "/src/dist/joint.js",
      "rule_id": "usr.local.lib.python3.8.site-packages.njsscan.rules.semantic_grep.redirect.express_open_redirect",
      "type": "MatchTimeoutError"
    },
    {
      "code": 3,
      "help": "If the code appears to be valid, this may be a semgrep bug.",
      "level": "warn",
      "long_msg": "Could not parse Makefile as javascript",
      "short_msg": "parse error",
      "spans": [
        {
          "context_end": null,
          "context_start": null,
          "end": {
            "col": 41,
            "line": 2
          },
          "file": "/src/Makefile",
          "source_hash": "69191f967c4cb267152917055033753640eeacafa991a092ea4000fc83f31295",
          "start": {
            "col": 1,
            "line": 2
          }
        }
      ],
      "type": "SourceParseError"
    }
  ],
  "njsscan_version": "0.2.8",
  "nodejs": {
    "node_insecure_random_generator": {
      "files": [
        {
          "file_path": "/src/demo/transitions/transition2.js",
          "match_lines": [
            35,
            35
          ],
          "match_position": [
            25,
            38
          ],
          "match_string": "            delay: (1 + Math.random()) * 3000,"
        },
        {
          "file_path": "/src/demo/puzzle/src/puzzle.js",
          "match_lines": [
            142,
            142
          ],
          "match_position": [
            36,
            49
          ],
          "match_string": "                x: this.PADDING + (Math.random() * this.width) - this.pieceSize / 2,"
        },
        {
          "file_path": "/src/demo/puzzle/src/puzzle.js",
          "match_lines": [
            143,
            143
          ],
          "match_position": [
            36,
            49
          ],
          "match_string": "                y: this.PADDING + (Math.random() * this.height) - this.pieceSize / 2"
        },
        {
          "file_path": "/src/demo/puzzle/src/puzzle.js",
          "match_lines": [
            250,
            250
          ],
          "match_position": [
            29,
            42
          ],
          "match_string": "    return values[Math.ceil(Math.random() * values.length) - 1];"
        },
        {
          "file_path": "/src/demo/petri nets/src/pn.js",
          "match_lines": [
            182,
            182
          ],
          "match_position": [
            13,
            26
          ],
          "match_string": "        if (Math.random() < 0.7) {"
        },
        {
          "file_path": "/src/demo/petri nets/src/pn.js",
          "match_lines": [
            189,
            189
          ],
          "match_position": [
            17,
            30
          ],
          "match_string": "            if (Math.random() < 0.7) {"
        },
        {
          "file_path": "/src/demo/layout/src/spiral.js",
          "match_lines": [
            23,
            23
          ],
          "match_position": [
            33,
            46
          ],
          "match_string": "        return array[Math.floor(Math.random() * array.length)];"
        },
        {
          "file_path": "/src/demo/links/src/custom-connector.js",
          "match_lines": [
            33,
            33
          ],
          "match_position": [
            32,
            45
          ],
          "match_string": "                Math.floor(7 * Math.random()) - 3,"
        },
        {
          "file_path": "/src/demo/links/src/custom-connector.js",
          "match_lines": [
            34,
            34
          ],
          "match_position": [
            32,
            45
          ],
          "match_string": "                Math.floor(7 * Math.random()) - 3"
        },
        {
          "file_path": "/src/demo/hull/src/hull.js",
          "match_lines": [
            20,
            20
          ],
          "match_position": [
            27,
            40
          ],
          "match_string": "        return Math.floor(Math.random() * (max - min)) + min;"
        },
        {
          "file_path": "/src/tutorials/js/custom-links.js",
          "match_lines": [
            69,
            69
          ],
          "match_position": [
            55,
            68
          ],
          "match_string": "            var stroke = '#' + ('000000' + Math.floor(Math.random() * 16777215).toString(16)).slice(-6);"
        },
        {
          "file_path": "/src/tutorials/js/custom-links.js",
          "match_lines": [
            70,
            70
          ],
          "match_position": [
            42,
            55
          ],
          "match_string": "            var strokeWidth = Math.floor(Math.random() * 10) + 1;"
        },
        {
          "file_path": "/src/tutorials/js/custom-links.js",
          "match_lines": [
            71,
            71
          ],
          "match_position": [
            47,
            60
          ],
          "match_string": "            var strokeDasharray = (Math.floor(Math.random() * 5) + 1) + ' ' + (Math.floor(Math.random() * 5) + 1);"
        },
        {
          "file_path": "/src/tutorials/js/custom-links.js",
          "match_lines": [
            71,
            71
          ],
          "match_position": [
            91,
            104
          ],
          "match_string": "            var strokeDasharray = (Math.floor(Math.random() * 5) + 1) + ' ' + (Math.floor(Math.random() * 5) + 1);"
        },
        {
          "file_path": "/src/tutorials/js/custom-elements.js",
          "match_lines": [
            34,
            34
          ],
          "match_position": [
            53,
            66
          ],
          "match_string": "            var fill = '#' + ('000000' + Math.floor(Math.random() * 16777215).toString(16)).slice(-6);"
        },
        {
          "file_path": "/src/tutorials/js/custom-elements.js",
          "match_lines": [
            35,
            35
          ],
          "match_position": [
            55,
            68
          ],
          "match_string": "            var stroke = '#' + ('000000' + Math.floor(Math.random() * 16777215).toString(16)).slice(-6);"
        },
        {
          "file_path": "/src/tutorials/js/custom-elements.js",
          "match_lines": [
            36,
            36
          ],
          "match_position": [
            42,
            55
          ],
          "match_string": "            var strokeWidth = Math.floor(Math.random() * 6);"
        },
        {
          "file_path": "/src/tutorials/js/custom-elements.js",
          "match_lines": [
            37,
            37
          ],
          "match_position": [
            46,
            59
          ],
          "match_string": "            var strokeDasharray = Math.floor(Math.random() * 6) + ' ' + Math.floor(Math.random() * 6);"
        },
        {
          "file_path": "/src/tutorials/js/custom-elements.js",
          "match_lines": [
            37,
            37
          ],
          "match_position": [
            84,
            97
          ],
          "match_string": "            var strokeDasharray = Math.floor(Math.random() * 6) + ' ' + Math.floor(Math.random() * 6);"
        },
        {
          "file_path": "/src/tutorials/js/custom-elements.js",
          "match_lines": [
            38,
            38
          ],
          "match_position": [
            37,
            50
          ],
          "match_string": "            var radius = Math.floor(Math.random() * 21);"
        },
        {
          "file_path": "/src/demo/logic/src/logic.js",
          "match_lines": [
            55,
            55
          ],
          "match_position": [
            18,
            31
          ],
          "match_string": "    var signal = Math.random();"
        }
      ],
      "metadata": {
        "cwe": "CWE-327: Use of a Broken or Risky Cryptographic Algorithm",
        "description": "crypto.pseudoRandomBytes()/Math.random() is a cryptographically weak random number generator.",
        "owasp": "A9: Using Components with Known Vulnerabilities",
        "severity": "WARNING"
      }
    },
    "regex_injection_dos": {
      "files": [
        {
          "file_path": "/src/dist/geometry.js",
          "match_lines": [
            2969,
            2969
          ],
          "match_position": [
            22,
            64
          ],
          "match_string": "            var xy = x.split(x.indexOf('@') === -1 ? ' ' : '@');"
        }
      ],
      "metadata": {
        "cwe": "CWE-400: Uncontrolled Resource Consumption",
        "description": "User controlled data in RegExp() can make the application vulnerable to layer 7 DoS.",
        "owasp": "A1: Injection",
        "severity": "ERROR"
      }
    }
  },
  "templates": {
    "handlebar_mustache_template": {
      "files": [
        {
          "file_path": "/src/docs/templates/partials/contentItems.html",
          "match_lines": [
            7,
            8
          ],
          "match_position": [
            285,
            300
          ],
          "match_string": "{{{ content }}}"
        },
        {
          "file_path": "/src/docs/templates/api.html",
          "match_lines": [
            20,
            21
          ],
          "match_position": [
            812,
            825
          ],
          "match_string": "{{{ intro }}}"
        },
        {
          "file_path": "/src/docs/templates/api.html",
          "match_lines": [
            23,
            23
          ],
          "match_position": [
            879,
            892
          ],
          "match_string": "{{{ index }}}"
        }
      ],
      "metadata": {
        "cwe": "CWE-79 Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')",
        "description": "The Handlebar.js/Mustache.js template has an unescaped variable. Untrusted user input passed to this variable results in Cross Site Scripting (XSS).",
        "owasp": "A1: Injection",
        "severity": "ERROR"
      }
    }
  }
}